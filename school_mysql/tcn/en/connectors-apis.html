<!--?xml version="1.0" encoding="utf-8"?-->



<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Chapter&nbsp;28 Connectors and APIs</title>
<link rel="stylesheet" href="mvl.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2">
<link rel="start" href="index.html" title="{书名}">
<link rel="up" href="" title="">
<link rel="prev" href="sys-schema.html" title="第27章MySQL sys Schema">
<link rel="next" href="extending-mysql.html" title="第29章扩展MySQL">


<div class="navheader">
<table width="100%" summary="Navigation header">
<tbody><tr>
<th colspan="3" align="center">Chapter&nbsp;28 Connectors and APIs</th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="sys-schema.html">Prev</a>&nbsp;</td>
<th width="60%" align="center"></th>
<td width="20%" align="right">&nbsp;<a accesskey="n" href="extending-mysql.html">Next</a></td>
</tr>
</tbody></table>
<hr>
</div>
<div class="chapter">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="connectors-apis"></a>Chapter&nbsp;28&nbsp;Connectors and APIs</h1>

</div>

</div>

</div>
<div class="toc">
<p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="connectors-apis.html#connector-c-info">28.1 MySQL Connector/C</a></span></dt><dt><span class="section"><a href="connectors-apis.html#connector-cpp-info">28.2 MySQL Connector/C++</a></span></dt><dt><span class="section"><a href="connectors-apis.html#connector-j-info">28.3 MySQL Connector/J</a></span></dt><dt><span class="section"><a href="connectors-apis.html#connector-net-info">28.4 MySQL Connector/NET</a></span></dt><dt><span class="section"><a href="connectors-apis.html#connector-odbc-info">28.5 MySQL Connector/ODBC</a></span></dt><dt><span class="section"><a href="connectors-apis.html#connector-python-info">28.6 MySQL Connector/Python</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api">28.7 MySQL C API</a></span></dt><dd><dl><dt><span class="section"><a href="connectors-apis.html#c-api-implementations">28.7.1 MySQL C API Implementations</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-multiple-installations">28.7.2 Simultaneous MySQL Server and Connector/C Installations</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-example-programs">28.7.3 Example C API Client Programs</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-building-running-clients">28.7.4 Building and Running C API Client Programs</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-data-structures">28.7.5 C API Data Structures</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-function-overview">28.7.6 C API Function Overview</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-functions">28.7.7 C API Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statements">28.7.8 C API Prepared Statements</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-data-structures">28.7.9 C API Prepared Statement Data Structures</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-function-overview">28.7.10 C API Prepared Statement Function Overview</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-functions">28.7.11 C API Prepared Statement Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-asynchronous-interface">28.7.12 C API Asynchronous Interface</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-asynchronous-data-structures">28.7.13 C API Asynchronous Interface Data Structures</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-asynchronous-function-overview">28.7.14 C API Asynchronous Function Overview</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-asynchronous-functions">28.7.15 C API Asynchronous Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-thread-functions">28.7.16 C API Threaded Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-plugin-functions">28.7.17 C API Client Plugin Functions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-binary-log-interface">28.7.18 C API Binary Log Interface</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-binary-log-data-structures">28.7.19 C API Binary Log Data Structures</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-binary-log-function-overview">28.7.20 C API Binary Log Function Overview</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-binary-log-functions">28.7.21 C API Binary Log Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-encrypted-connections">28.7.22 C API Encrypted Connection Support</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-multiple-queries">28.7.23 C API Multiple Statement Execution Support</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-date-handling">28.7.24 C API Prepared Statement Handling of Date and Time Values</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-call-statements">28.7.25 C API Prepared CALL Statement Support</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-problems">28.7.26 C API Prepared Statement Problems</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-optional-metadata">28.7.27 C API Optional Result Set Metadata</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-auto-reconnect">28.7.28 C API Automatic Reconnection Control</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-common-issues">28.7.29 C API Common Issues</a></span></dt></dl></dd><dt><span class="section"><a href="connectors-apis.html#apis-php-info">28.8 MySQL PHP API</a></span></dt><dt><span class="section"><a href="connectors-apis.html#apis-perl">28.9 MySQL Perl API</a></span></dt><dt><span class="section"><a href="connectors-apis.html#apis-python">28.10 MySQL Python API</a></span></dt><dt><span class="section"><a href="connectors-apis.html#apis-ruby">28.11 MySQL Ruby APIs</a></span></dt><dd><dl><dt><span class="section"><a href="connectors-apis.html#apis-ruby-mysqlruby">28.11.1 The MySQL/Ruby API</a></span></dt><dt><span class="section"><a href="connectors-apis.html#apis-ruby-rubymysql">28.11.2 The Ruby/MySQL API</a></span></dt></dl></dd><dt><span class="section"><a href="connectors-apis.html#apis-tcl">28.12 MySQL Tcl API</a></span></dt><dt><span class="section"><a href="connectors-apis.html#apis-eiffel">28.13 MySQL Eiffel Wrapper</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091552579856"></a><a class="indexterm" name="idm140091552578784"></a><a class="indexterm" name="idm140091552577712"></a><a class="indexterm" name="idm140091552576640"></a><a class="indexterm" name="idm140091552575568"></a><a class="indexterm" name="idm140091552574496"></a><a class="indexterm" name="idm140091552573424"></a><a class="indexterm" name="idm140091552572352"></a><a class="indexterm" name="idm140091552571280"></a><a class="indexterm" name="idm140091552570208"></a><a class="indexterm" name="idm140091552569136"></a><a class="indexterm" name="idm140091552568064"></a><a class="indexterm" name="idm140091552566992"></a><a class="indexterm" name="idm140091552565504"></a><p>
    MySQL Connectors provide connectivity to the MySQL server for client
    programs. APIs provide low-level access to the MySQL protocol and
    MySQL resources. Both Connectors and the APIs enable you to connect
    and execute MySQL statements from another language or environment,
    including ODBC, Java (JDBC), Perl, Python, PHP, Ruby, and native C
    MySQL instances.
</p>
<h2><a name="idm140091552563232"></a>MySQL Connectors</h2>
<p>
    Oracle develops a number of connectors:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/connector-c/en/" target="_top">Connector/C</a> is a standalone
        replacement for the MySQL Client Library
        (<code class="literal">libmysqlclient</code>), to be used for C
        applications.
      </p></li><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/connector-cpp/8.0/en/" target="_top">Connector/C++</a> enables
        C++ applications to connect to MySQL.
      </p></li><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/connector-j/8.0/en/" target="_top">Connector/J</a> provides
        driver support for connecting to MySQL from Java applications
        using the standard Java Database Connectivity (JDBC) API.
      </p></li><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/connector-net/en/" target="_top">Connector/NET</a> enables developers
        to create .NET applications that connect to MySQL. Connector/NET
        implements a fully functional ADO.NET interface and provides
        support for use with ADO.NET aware tools. Applications that use
        Connector/NET can be written in any supported .NET language.
      </p><p>
        <a class="ulink" href="https://dev.mysql.com/doc/visual-studio/en/" target="_top">MySQL for Visual Studio</a> works with Connector/NET
        and Microsoft Visual Studio 2012, 2013, 2015, and 2017. MySQL for Visual Studio
        provides access to MySQL objects and data from Visual Studio. As
        a Visual Studio package, it integrates directly into Server
        Explorer providing the ability to create new connections and
        work with MySQL database objects.
      </p></li><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/connector-odbc/en/" target="_top">Connector/ODBC</a> provides
        driver support for connecting to MySQL using the Open Database
        Connectivity (ODBC) API. Support is available for ODBC
        connectivity from Windows, Unix, and OS X platforms.
      </p></li><li class="listitem"><p>
        <a class="ulink" href="https://dev.mysql.com/doc/connector-python/en/" target="_top">Connector/Python</a>
        provides driver support for connecting to MySQL from Python
        applications using an API that is compliant with the
        <a class="ulink" href="http://www.python.org/dev/peps/pep-0249/" target="_top">Python DB
        API version 2.0</a>. No additional Python modules or MySQL
        client libraries are required.
</p></li></ul>
</div>
<h2><a name="idm140091552548656"></a>The MySQL C API</h2>
<p>
    For direct access to using MySQL natively within a C application,
    the <a class="link" href="connectors-apis.html#c-api" title="28.7 MySQL C API">C API</a> provides low-level access to
    the MySQL client/server protocol through the
    <code class="literal">libmysqlclient</code> client library. This is the
    primary method used to connect to an instance of the MySQL server,
    and is used both by MySQL command-line clients and many of the MySQL
    Connectors and third-party APIs detailed here.
  </p><p>
    <code class="literal">libmysqlclient</code> is included in MySQL distributions
    and in Connector/C distributions.
  </p><p>
    See also <a class="xref" href="connectors-apis.html#c-api-implementations" title="28.7.1 MySQL C API实现">Section&nbsp;28.7.1, “MySQL C API Implementations”</a>.
  </p><p>
    To access MySQL from a C application, or to build an interface to
    MySQL for a language not supported by the Connectors or APIs in this
    chapter, the <a class="link" href="connectors-apis.html#c-api" title="28.7 MySQL C API">C API</a> is where to start. A
    number of programmer's utilities are available to help with the
    process; see <a class="xref" href="programs.html#programs-development" title="4.7 MySQL程序开发实用程序">Section&nbsp;4.7, “MySQL Program Development Utilities”</a>.
</p>
<h2><a name="idm140091552540944"></a>Third-Party MySQL APIs</h2>
<p>
    The remaining APIs described in this chapter provide an interface to
    MySQL from specific application languages. These third-party
    solutions are not developed or supported by Oracle. Basic
    information on their usage and abilities is provided here for
    reference purposes only.
  </p><p>
    All the third-party language APIs are developed using one of two
    methods, using <code class="literal">libmysqlclient</code> or by implementing
    a <span class="firstterm">native driver</span>. The two
    solutions offer different benefits:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Using <span class="emphasis"><em><code class="literal">libmysqlclient</code></em></span>
        offers complete compatibility with MySQL because it uses the
        same libraries as the MySQL client applications. However, the
        feature set is limited to the implementation and interfaces
        exposed through <code class="literal">libmysqlclient</code> and the
        performance may be lower as data is copied between the native
        language, and the MySQL API components.
      </p></li><li class="listitem"><p>
        <span class="emphasis"><em>Native drivers</em></span> are an implementation of the
        MySQL network protocol entirely within the host language or
        environment. Native drivers are fast, as there is less copying
        of data between components, and they can offer advanced
        functionality not available through the standard MySQL API.
        Native drivers are also easier for end users to build and deploy
        because no copy of the MySQL client libraries is needed to build
        the native driver components.
</p></li></ul>
</div>
<p>
    <a class="xref" href="connectors-apis.html#connectors-apis-summary" title="表28.1 MySQL API和接口">Table&nbsp;28.1, “MySQL APIs and Interfaces”</a> lists many of the
    libraries and interfaces available for MySQL.

</p>
<div class="table">
<a name="connectors-apis-summary"></a><p class="title"><b>Table&nbsp;28.1&nbsp;MySQL APIs and Interfaces</b></p>
<div class="table-contents">
<table summary="Summary of MySQL APIs and interfaces showing the environment, API, type, and related notes."><colgroup><col width="10%"><col width="35%"><col width="15%"><col width="40%"></colgroup><thead><tr>
      <th scope="col">Environment</th>
      <th scope="col">API</th>
      <th scope="col">Type</th>
      <th scope="col">Notes</th>
    </tr></thead><tbody><tr>
      <td scope="row">Ada</td>
      <td>GNU Ada MySQL Bindings</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="http://gnade.sourceforge.net/" target="_top">MySQL Bindings for GNU
        Ada</a></td>
    </tr><tr>
      <td scope="row">C</td>
      <td>C API</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="xref" href="connectors-apis.html#c-api" title="28.7 MySQL C API">Section&nbsp;28.7, “MySQL C API”</a>.</td>
    </tr><tr>
      <td scope="row">C</td>
      <td>Connector/C</td>
      <td>Replacement for <code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/connector-c/en/" target="_top">MySQL Connector/C Developer Guide</a>.</td>
    </tr><tr>
      <td scope="row">C++</td>
      <td>Connector/C++</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/connector-cpp/8.0/en/" target="_top">MySQL Connector/C++ 8.0 Developer Guide</a>.</td>
    </tr><tr>
      <td scope="row"></td>
      <td>MySQL++</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="http://tangentsoft.net/mysql++/doc/" target="_top">MySQL++
        website</a>.</td>
    </tr><tr>
      <td scope="row"></td>
      <td>MySQL wrapped</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="http://www.alhem.net/project/mysql/" target="_top">MySQL
        wrapped</a>.</td>
    </tr><tr>
      <td scope="row">Cocoa</td>
      <td>MySQL-Cocoa</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>Compatible with the Objective-C Cocoa environment. See
        <a class="ulink" href="http://mysql-cocoa.sourceforge.net/" target="_top">http://mysql-cocoa.sourceforge.net/</a></td>
    </tr><tr>
      <td scope="row">D</td>
      <td>MySQL for D</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="http://www.steinmole.de/d/" target="_top">MySQL for D</a>.</td>
    </tr><tr>
      <td scope="row">Eiffel</td>
      <td>Eiffel MySQL</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="xref" href="connectors-apis.html#apis-eiffel" title="28.13 MySQL Eiffel Wrapper">Section&nbsp;28.13, “MySQL Eiffel Wrapper”</a>.</td>
    </tr><tr>
      <td scope="row">Erlang</td>
      <td><code class="literal">erlang-mysql-driver</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See
        <a class="ulink" href="http://code.google.com/p/erlang-mysql-driver/" target="_top"><code class="literal">erlang-mysql-driver</code>.</a></td>
    </tr><tr>
      <td scope="row">Haskell</td>
      <td>Haskell MySQL Bindings</td>
      <td>Native Driver</td>
      <td>See <a class="ulink" href="http://www.serpentine.com/blog/software/mysql/" target="_top">Brian
        O'Sullivan's pure Haskell MySQL bindings</a>.</td>
    </tr><tr>
      <td scope="row"></td>
      <td><code class="literal">hsql-mysql</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See
        <a class="ulink" href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/hsql-mysql-1.7" target="_top">MySQL
        driver for Haskell</a>.</td>
    </tr><tr>
      <td scope="row">Java/JDBC</td>
      <td>Connector/J</td>
      <td>Native Driver</td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/connector-j/5.1/en/" target="_top">MySQL Connector/J 5.1 Developer Guide</a>.</td>
    </tr><tr>
      <td scope="row">Kaya</td>
      <td>MyDB</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="http://kayalang.org/library/latest/MyDB" target="_top">MyDB</a>.</td>
    </tr><tr>
      <td scope="row">Lua</td>
      <td>LuaSQL</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See
        <a class="ulink" href="http://keplerproject.github.io/luasql/doc/us/" target="_top">LuaSQL</a>.</td>
    </tr><tr>
      <td scope="row">.NET/Mono</td>
      <td>Connector/NET</td>
      <td>Native Driver</td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/connector-net/en/" target="_top">MySQL Connector/NET Developer Guide</a>.</td>
    </tr><tr>
      <td scope="row">Objective Caml</td>
      <td>OBjective Caml MySQL Bindings</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="http://raevnos.pennmush.org/code/ocaml-mysql/" target="_top">MySQL
        Bindings for Objective Caml</a>.</td>
    </tr><tr>
      <td scope="row">Octave</td>
      <td>Database bindings for GNU Octave</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See
        <a class="ulink" href="http://octave.sourceforge.net/database/index.html" target="_top">Database
        bindings for GNU Octave</a>.</td>
    </tr><tr>
      <td scope="row">ODBC</td>
      <td>Connector/ODBC</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/connector-odbc/en/" target="_top">MySQL Connector/ODBC Developer Guide</a>.</td>
    </tr><tr>
      <td scope="row">Perl</td>
      <td><code class="literal">DBI</code>/<code class="literal">DBD::mysql</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="xref" href="connectors-apis.html#apis-perl" title="28.9 MySQL Perl API">Section&nbsp;28.9, “MySQL Perl API”</a>.</td>
    </tr><tr>
      <td scope="row"></td>
      <td><code class="literal">Net::MySQL</code></td>
      <td>Native Driver</td>
      <td>See
        <a class="ulink" href="http://search.cpan.org/dist/Net-MySQL/MySQL.pm" target="_top"><code class="literal">Net::MySQL</code></a>
        at CPAN</td>
    </tr><tr>
      <td scope="row">PHP</td>
      <td><code class="literal">mysql</code>, <code class="literal">ext/mysql</code> interface
        (deprecated)</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/apis-php/en/apis-php-mysql.html" target="_top">Original MySQL API</a>.</td>
    </tr><tr>
      <td scope="row"></td>
      <td><code class="literal">mysqli</code>, <code class="literal">ext/mysqli</code> interface</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/apis-php/en/apis-php-mysqli.html" target="_top">MySQL Improved Extension</a>.</td>
    </tr><tr>
      <td scope="row"></td>
      <td><code class="literal">PDO_MYSQL</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/apis-php/en/apis-php-pdo-mysql.html" target="_top">MySQL Functions (PDO_MYSQL)</a>.</td>
    </tr><tr>
      <td scope="row"></td>
      <td>PDO mysqlnd</td>
      <td>Native Driver</td>
      <td></td>
    </tr><tr>
      <td scope="row">Python</td>
      <td>Connector/Python</td>
      <td>Native Driver</td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/connector-python/en/" target="_top">MySQL Connector/Python Developer Guide</a>.</td>
    </tr><tr>
      <td scope="row">Python</td>
      <td>Connector/Python C Extension</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="ulink" href="https://dev.mysql.com/doc/connector-python/en/" target="_top">MySQL Connector/Python Developer Guide</a>.</td>
    </tr><tr>
      <td scope="row"></td>
      <td>MySQLdb</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="xref" href="connectors-apis.html#apis-python" title="28.10 MySQL Python API">Section&nbsp;28.10, “MySQL Python API”</a>.</td>
    </tr><tr>
      <td scope="row">Ruby</td>
      <td>MySQL/Ruby</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>Uses <code class="literal">libmysqlclient</code>. See
        <a class="xref" href="connectors-apis.html#apis-ruby-mysqlruby" title="28.11.1 MySQL / Ruby API">Section&nbsp;28.11.1, “The MySQL/Ruby API”</a>.</td>
    </tr><tr>
      <td scope="row"></td>
      <td>Ruby/MySQL</td>
      <td>Native Driver</td>
      <td>See <a class="xref" href="connectors-apis.html#apis-ruby-rubymysql" title="28.11.2 Ruby / MySQL API">Section&nbsp;28.11.2, “The Ruby/MySQL API”</a>.</td>
    </tr><tr>
      <td scope="row">Scheme</td>
      <td><code class="literal">Myscsh</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See
        <a class="ulink" href="https://github.com/aehrisch/myscsh" target="_top"><code class="literal">Myscsh</code></a>.</td>
    </tr><tr>
      <td scope="row">SPL</td>
      <td><code class="literal">sql_mysql</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See
        <a class="ulink" href="http://www.clifford.at/spl/spldoc/sql_mysql.html" target="_top"><code class="literal">sql_mysql</code>
        for SPL</a>.</td>
    </tr><tr>
      <td scope="row">Tcl</td>
      <td>MySQLtcl</td>
      <td><code class="literal">libmysqlclient</code></td>
      <td>See <a class="xref" href="connectors-apis.html#apis-tcl" title="28.12 MySQL Tcl API">Section&nbsp;28.12, “MySQL Tcl API”</a>.</td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-c-info"></a>28.1&nbsp;MySQL Connector/C</h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552339728"></a><p>
    The MySQL Connector/C manual is published in standalone form, not as
    part of the MySQL Reference Manual. For information, see these
    documents:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Main manual: <a class="ulink" href="https://dev.mysql.com/doc/connector-c/en/" target="_top">MySQL Connector/C Developer Guide</a>
      </p></li><li class="listitem"><p>
        Release notes:
        <a class="ulink" href="https://dev.mysql.com/doc/relnotes/connector-c/en/" target="_top">MySQL
        Connector/C Release Notes</a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-cpp-info"></a>28.2&nbsp;MySQL Connector/C++</h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552333056"></a><a class="indexterm" name="idm140091552332016"></a><p>
    The MySQL Connector/C++ manual is published in standalone form, not
    as part of the MySQL Reference Manual. For information, see these
    documents:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Main manual: <a class="ulink" href="https://dev.mysql.com/doc/connector-cpp/8.0/en/" target="_top">MySQL Connector/C++ 8.0 Developer Guide</a>
      </p></li><li class="listitem"><p>
        Release notes:
        <a class="ulink" href="https://dev.mysql.com/doc/relnotes/connector-cpp/en/" target="_top">MySQL
        Connector/C++ Release Notes</a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-j-info"></a>28.3&nbsp;MySQL Connector/J</h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552325328"></a><a class="indexterm" name="idm140091552324288"></a><p>
    The MySQL Connector/J manual is published in standalone form, not as
    part of the MySQL Reference Manual. For information, see these
    documents:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Main manual: <a class="ulink" href="https://dev.mysql.com/doc/connector-j/en/" target="_top">MySQL
        Connector/J Developer Guide</a>
      </p></li><li class="listitem"><p>
        Release notes:
        <a class="ulink" href="https://dev.mysql.com/doc/relnotes/connector-j/en/" target="_top">MySQL
        Connector/J Release Notes</a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-net-info"></a>28.4&nbsp;MySQL Connector/NET</h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552317632"></a><p>
    The MySQL Connector/NET manual is published in standalone form, not as part of
    the MySQL Reference Manual. For information, see these documents:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Main manual: <a class="ulink" href="https://dev.mysql.com/doc/connector-net/en/" target="_top">MySQL Connector/NET Developer Guide</a>
      </p></li><li class="listitem"><p>
        Release notes:
        <a class="ulink" href="https://dev.mysql.com/doc/relnotes/connector-net/en/" target="_top">MySQL Connector/NET
        Release Notes</a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-odbc-info"></a>28.5&nbsp;MySQL Connector/ODBC</h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552311040"></a><p>
    The MySQL Connector/ODBC manual is published in standalone form, not
    as part of the MySQL Reference Manual. For information, see these
    documents:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Main manual: <a class="ulink" href="https://dev.mysql.com/doc/connector-odbc/en/" target="_top">MySQL Connector/ODBC Developer Guide</a>
      </p></li><li class="listitem"><p>
        Release notes:
        <a class="ulink" href="https://dev.mysql.com/doc/relnotes/connector-odbc/en/" target="_top">MySQL
        Connector/ODBC Release Notes</a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-python-info"></a>28.6&nbsp;MySQL Connector/Python</h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552304384"></a><a class="indexterm" name="idm140091552303344"></a><p>
    The MySQL Connector/Python manual is published in standalone form,
    not as part of the MySQL Reference Manual. For information, see
    these documents:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Main manual: <a class="ulink" href="https://dev.mysql.com/doc/connector-python/en/" target="_top">MySQL Connector/Python Developer Guide</a>
      </p></li><li class="listitem"><p>
        Release notes:
        <a class="ulink" href="https://dev.mysql.com/doc/relnotes/connector-python/en/" target="_top">MySQL
        Connector/Python Release Notes</a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="c-api"></a>28.7&nbsp;MySQL C API</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#c-api-implementations">28.7.1 MySQL C API Implementations</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-multiple-installations">28.7.2 Simultaneous MySQL Server and Connector/C Installations</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-example-programs">28.7.3 Example C API Client Programs</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-building-running-clients">28.7.4 Building and Running C API Client Programs</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-data-structures">28.7.5 C API Data Structures</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-function-overview">28.7.6 C API Function Overview</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-functions">28.7.7 C API Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statements">28.7.8 C API Prepared Statements</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-data-structures">28.7.9 C API Prepared Statement Data Structures</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-function-overview">28.7.10 C API Prepared Statement Function Overview</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-functions">28.7.11 C API Prepared Statement Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-asynchronous-interface">28.7.12 C API Asynchronous Interface</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-asynchronous-data-structures">28.7.13 C API Asynchronous Interface Data Structures</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-asynchronous-function-overview">28.7.14 C API Asynchronous Function Overview</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-asynchronous-functions">28.7.15 C API Asynchronous Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-thread-functions">28.7.16 C API Threaded Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-plugin-functions">28.7.17 C API Client Plugin Functions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-binary-log-interface">28.7.18 C API Binary Log Interface</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-binary-log-data-structures">28.7.19 C API Binary Log Data Structures</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-binary-log-function-overview">28.7.20 C API Binary Log Function Overview</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-binary-log-functions">28.7.21 C API Binary Log Function Descriptions</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-encrypted-connections">28.7.22 C API Encrypted Connection Support</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-multiple-queries">28.7.23 C API Multiple Statement Execution Support</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-date-handling">28.7.24 C API Prepared Statement Handling of Date and Time Values</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-call-statements">28.7.25 C API Prepared CALL Statement Support</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-problems">28.7.26 C API Prepared Statement Problems</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-optional-metadata">28.7.27 C API Optional Result Set Metadata</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-auto-reconnect">28.7.28 C API Automatic Reconnection Control</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-common-issues">28.7.29 C API Common Issues</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091552296992"></a><a class="indexterm" name="idm140091552295504"></a><p>
    The C API provides low-level access to the MySQL client/server
    protocol and enables C programs to access database contents. The C
    API code is distributed with MySQL and implemented in the
    <code class="literal">libmysqlclient</code> library. See
    <a class="xref" href="connectors-apis.html#c-api-implementations" title="28.7.1 MySQL C API实现">Section&nbsp;28.7.1, “MySQL C API Implementations”</a>.
  </p><p>
    Most other client APIs use the <code class="literal">libmysqlclient</code>
    library to communicate with the MySQL server. (Exceptions are
    Connector/J and Connector/NET.) This means that, for example, you can take
    advantage of many of the same environment variables that are used by
    other client programs because they are referenced from the library.
    For a list of these variables, see
    <a class="xref" href="programs.html#programs-overview" title="4.1 MySQL程序概述">Section&nbsp;4.1, “Overview of MySQL Programs”</a>.
  </p><p>
    For instructions on building client programs using the C API, see
    <a class="xref" href="connectors-apis.html#c-api-building-clients" title="28.7.4.1构建C API客户端程序">Section&nbsp;28.7.4.1, “Building C API Client Programs”</a>. For programming with
    threads, see <a class="xref" href="connectors-apis.html#c-api-threaded-clients" title="28.7.4.3编写C API线程客户端程序">Section&nbsp;28.7.4.3, “Writing C API Threaded Client Programs”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
      If, after an upgrade, you experience problems with compiled client
      programs, such as <code class="literal">Commands out of sync</code> or
      unexpected core dumps, the programs were probably compiled using
      old header or library files. In this case, check the date of the
      <code class="filename">mysql.h</code> file and
      <code class="filename">libmysqlclient.a</code> library used for compilation
      to verify that they are from the new MySQL distribution. If not,
      recompile the programs with the new headers and libraries.
      Recompilation might also be necessary for programs compiled
      against the shared client library if the library major version
      number has changed (for example, from
      <code class="filename">libmysqlclient.so.17</code> to
      <code class="filename">libmysqlclient.so.18</code>). For additional
      compatibility information, see
      <a class="xref" href="connectors-apis.html#c-api-running-clients" title="28.7.4.4运行C API客户端程序">Section&nbsp;28.7.4.4, “Running C API Client Programs”</a>.
</p>
</div>
<p>
    Clients have a maximum communication buffer size. The size of the
    buffer that is allocated initially (16KB) is automatically increased
    up to the maximum size (16MB by default). Because buffer sizes are
    increased only as demand warrants, simply increasing the maximum
    limit does not in itself cause more resources to be used. This size
    check is mostly a precaution against erroneous statements and
    communication packets.
  </p><p>
    The communication buffer must be large enough to contain a single
    SQL statement (for client-to-server traffic) and one row of returned
    data (for server-to-client traffic). Each session's communication
    buffer is dynamically enlarged to handle any query or row up to the
    maximum limit. For example, if you have
    <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a> values that contain up to 16MB
    of data, you must have a communication buffer limit of at least 16MB
    (in both server and client). The default maximum built into the
    client library is 1GB, but the default maximum in the server is 1MB.
    You can increase this by changing the value of the
    <a class="link" href="server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a> parameter at
    server startup. See <a class="xref" href="server-administration.html#server-configuration" title="5.1.1配置服务器">Section&nbsp;5.1.1, “Configuring the Server”</a>.
  </p><p>
    The MySQL server shrinks each communication buffer to
    <a class="link" href="server-administration.html#sysvar_net_buffer_length"><code class="literal">net_buffer_length</code></a> bytes after each
    query. For clients, the size of the buffer associated with a
    connection is not decreased until the connection is closed, at which
    time client memory is reclaimed.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-implementations"></a>28.7.1&nbsp;MySQL C API Implementations</h3>
</div>
</div>
</div>
<p>
      The MySQL C API is a C-based API that client applications written
      in C can use to communicate with MySQL Server. Client programs
      refer to C API header files at compile time and link to a C API
      library file, <code class="literal">libmysqlclient</code>, at link time.
    </p><p>
      There are two ways to obtain the C API header and library files
      required to build C API client programs:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Install a MySQL Server distribution.
        </p></li><li class="listitem"><p>
          Install a Connector/C distribution.
</p></li></ul>
</div>
<p>
      For both MySQL Server and Connector/C, you can install a binary
      distribution that contains the C API files pre-built, or you can
      use a source distribution and build the C API files yourself.
    </p><p>
      Normally, you install either a MySQL Server distribution or a Connector/C
      distribution, but not both. For information about issues involved
      with simultaneous MySQL Server and Connector/C installations, see
      <a class="xref" href="connectors-apis.html#c-api-multiple-installations" title="28.7.2同时MySQL服务器和Connector / C安装">Section&nbsp;28.7.2, “Simultaneous MySQL Server and Connector/C Installations”</a>.
    </p><p>
      The names of the library files to use when linking C API client
      applications depend on the library type and platform for which a
      distribution is built:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          On Unix (and Unix-like) systems, the static library is
          <code class="filename">libmysqlclient.a</code>. The dynamic library is
          <code class="filename">libmysqlclient.so</code> on most Unix systems
          and <code class="filename">libmysqlclient.dylib</code> on OS X.
        </p></li><li class="listitem"><p>
          On Windows, the static library is
          <code class="filename">mysqlclient.lib</code> and the dynamic library
          is <code class="filename">libmysql.dll</code>. Windows distributions
          also include <code class="filename">libmysql.lib</code>, a static
          import library needed for using the dynamic library.
        </p><p>
          Windows distributions also include a set of debug libraries.
          These have the same names as the nondebug libraries, but are
          located in the <code class="filename">lib/debug</code> library. You
          must use the debug libraries when compiling clients built
          using the debug C runtime.
</p></li></ul>
</div>
<p>
      On Unix, you may also see libraries that include
      <code class="literal">_r</code> in the names. Before MySQL 5.5, these were
      built as thread-safe (re-entrant) libraries separately from the
      non-<code class="literal">_r</code> libraries. As of 5.5, both libraries are
      the same and the <code class="literal">_r</code> names are symbolic links to
      the corresponding non-<code class="literal">_r</code> names. There is no
      need to use the <code class="literal">_r</code> libraries. For example, if
      you use <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a> to obtain linker flags,
      you can use <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config --libs</strong></span></a> in all cases,
      even for threaded clients. There is no need to use
      <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config --libs_r</strong></span></a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-multiple-installations"></a>28.7.2&nbsp;Simultaneous MySQL Server and Connector/C Installations</h3>

</div>

</div>

</div>
<p>
      MySQL Server and Connector/C installation packages both provide the files
      needed to build and run MySQL C API client programs. This section
      discusses when it is possible to install both products on the same
      system. For some packaging formats, this is possible without
      conflict. For others, both products cannot be installed at the
      same time.
    </p><p>
      This discussion assumes the use of similar package types for both
      products (for example, RPM packages for both products). It does
      not try to describe coexistence between packaging types (for
      example, use of RPM packages for one product and a
      <span class="command"><strong>tar</strong></span> file package for the other). Nor does it
      describe coexistence of packages provided by Oracle and those
      provided by third-party vendors.
    </p><p>
      If you install both products, it may be necessary to adjust your
      development tools or runtime environment to choose one set of
      header files and libraries over the other. See
      <a class="xref" href="connectors-apis.html#c-api-building-clients" title="28.7.4.1&nbsp;Building C API Client Programs">Section&nbsp;28.7.4.1, “Building C API Client Programs”</a>, and
      <a class="xref" href="connectors-apis.html#c-api-running-clients" title="28.7.4.4&nbsp;Running C API Client Programs">Section&nbsp;28.7.4.4, “Running C API Client Programs”</a>.
    </p><p>
      <span class="command"><strong>tar</strong></span> and Zip file packages install under the
      directory into which you unpack them. For example, you can unpack
      MySQL Server and Connector/C <span class="command"><strong>tar</strong></span> packages under
      <code class="filename">/usr/local</code> and they will unpack into distinct
      directory names without conflict.
    </p><p>
      Windows MSI installers use their own installation directory, so
      MySQL Server and Connector/C installers do not conflict.
    </p><p>
      OS X DMG packages install under the same parent directory but in a
      different subdirectory, so there is no conflict. For example:
    </p><pre data-lang="none" class="programlisting">/usr/local/mysql-5.6.11-osx10.7-x86_64/<font></font>
/usr/local/mysql-connector-c-6.1.0-osx10.7-x86/<font></font>
</pre><p>
      Solaris PKG packages install under the same parent directory but
      in a different subdirectory, so there is no conflict. For example:
    </p><pre data-lang="none" class="programlisting">/opt/mysql/mysql<font></font>
/opt/mysql/connector-c<font></font>
</pre><p>
      The Solaris Connector/C installer does not create any symlinks from
      system directories such as <code class="filename">/usr/bin</code> or
      <code class="filename">/usr/lib</code> into the installation directory.
      That must be done manually if desired after installation.
    </p><p>
      For RPM installations, there are several types of RPM packages.
      MySQL Server <code class="literal">shared</code> and
      <code class="literal">devel</code> RPM packages are similar to the
      corresponding Connector/C RPM packages. These RPM package types cannot
      coexist because the MySQL Server and Connector/C RPM packages use the
      same installation locations for the client library-related files.
      This means the following conditions hold:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If MySQL Server <code class="literal">shared</code> and
          <code class="literal">devel</code> RPM packages are installed, they
          provide the C API headers and libraries, and there is no need
          to install the Connector/C RPM packages. To install the Connector/C packages
          anyway, you must first remove the corresponding MySQL Server
          packages.
        </p></li><li class="listitem"><p>
          To install MySQL Server RPM packages if you already have Connector/C
          RPM packages installed, you must first remove the Connector/C RPM
          packages.
</p></li></ul>
</div>
<p>
      MySQL Server RPM packages other than <code class="literal">shared</code> and
      <code class="literal">devel</code> do not conflict with Connector/C packages and
      can be installed if Connector/C is installed. This includes the main
      server RPM that includes the <a class="link" href="programs.html#mysqld" title="4.3.1&nbsp;mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> server
      itself.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-example-programs"></a>28.7.3&nbsp;Example C API Client Programs</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552226224"></a><a class="indexterm" name="idm140091552224768"></a><p>
      Many of the clients in MySQL source distributions are written in
      C, such as <a class="link" href="programs.html#mysql" title="4.5.1&nbsp;mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a>,
      <a class="link" href="programs.html#mysqladmin" title="4.5.2&nbsp;mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin</strong></span></a>, and <a class="link" href="programs.html#mysqlshow" title="4.5.7&nbsp;mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow</strong></span></a>.
      If you are looking for examples that demonstrate how to use the C
      API, take a look at these clients: Obtain a source distribution
      and look in its <code class="literal">client</code> directory. See
      <a class="xref" href="installing.html#getting-mysql" title="2.1.2&nbsp;How to Get MySQL">Section&nbsp;2.1.2, “How to Get MySQL”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-building-running-clients"></a>28.7.4&nbsp;Building and Running C API Client Programs</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#c-api-building-clients">28.7.4.1 Building C API Client Programs</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-building-clients-pkg-config">28.7.4.2 Building C API Client Programs Using pkg-config</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-threaded-clients">28.7.4.3 Writing C API Threaded Client Programs</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-running-clients">28.7.4.4 Running C API Client Programs</a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-server-client-versions">28.7.4.5 C API Server and Client Library Versions</a></span></dt></dl>
</div>
<p>
      The following sections provide information on building client
      programs that use the C API. Topics include compiling and linking
      clients, writing threaded clients, and troubleshooting runtime
      problems.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-building-clients"></a>28.7.4.1&nbsp;Building C API Client Programs</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091552214496"></a><a class="indexterm" name="idm140091552213040"></a><a class="indexterm" name="idm140091552211968"></a><a class="indexterm" name="idm140091552210480"></a><p>
        This section provides guidelines for compiling C programs that
        use the MySQL C API.
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="c-api-building-clients-compiling-mysql-clients-on-unix"></a>Compiling MySQL Clients on Unix</h5>
</div>
</div>
</div>
<a class="indexterm" name="idm140091552207248"></a><a class="indexterm" name="idm140091552205760"></a><p>
          The examples here use <span class="command"><strong>gcc</strong></span> as the compiler.
          A different compiler might be appropriate on some systems (for
          example, <span class="command"><strong>clang</strong></span> on OS X or FreeBSD, or Sun
          Studio on Solaris). Adjust the examples as necessary.
        </p><p>
          You may need to specify an <code class="option">-I</code> option when you
          compile client programs that use MySQL header files, so that
          the compiler can find them. For example, if the header files
          are installed in <code class="literal">/usr/local/mysql/include</code>,
          use this option in the compile command:
        </p><pre data-lang="none" class="programlisting">-I/usr/local/mysql/include
</pre><p>
          MySQL clients must be linked using the
          <code class="option">-lmysqlclient</code> option in the link command. You
          may also need to specify a <code class="option">-L</code> option to tell
          the linker where to find the library. For example, if the
          library is installed in
          <code class="filename">/usr/local/mysql/lib</code>, use these options
          in the link command:
        </p><pre data-lang="none" class="programlisting">-L/usr/local/mysql/lib -lmysqlclient
</pre><p>
          The path names may differ on your system. Adjust the
          <code class="option">-I</code> and <code class="option">-L</code> options as
          necessary.
        </p><p>
          To make it simpler to compile MySQL programs on Unix, use the
          <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a> script. See
          <a class="xref" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients">Section&nbsp;4.7.1, “<span class="command"><strong>mysql_config</strong></span> — Display Options for Compiling Clients”</a>.
        </p><p>
          <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a> displays the options needed
          for compiling or linking:
        </p><pre data-lang="bash" class="programlisting">shell&gt; <strong class="userinput"><code>mysql_config --cflags</code></strong>
shell&gt; <strong class="userinput"><code>mysql_config --libs</code></strong>
</pre><p>
          You can run those commands to get the proper options and add
          them manually to compilation or link commands. Alternatively,
          include the output from <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a>
          directly within command lines using backticks:
        </p><pre data-lang="bash" class="programlisting">shell&gt; <strong class="userinput"><code>gcc -c `mysql_config --cflags` progname.c</code></strong>
shell&gt; <strong class="userinput"><code>gcc -o progname progname.o `mysql_config --libs`</code></strong>
</pre><p>
          On Unix, linking uses dynamic libraries by default. To link to
          the static client library instead, add its path name to the
          link command. For example, if the library is located in
          <code class="filename">/usr/local/mysql/lib</code>, link like this:
        </p><pre data-lang="bash" class="programlisting">shell&gt; <strong class="userinput"><code>gcc -o progname progname.o /usr/local/mysql/lib/libmysqlclient.a</code></strong>
</pre><p>
          Or use <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a> to provide the library
          name:
        </p><pre data-lang="bash" class="programlisting">shell&gt; <strong class="userinput"><code>gcc -o progname progname.o `mysql_config --variable=pkglibdir`/libmysqlclient.a</code></strong>
</pre><p>
          <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a> does not currently provide a
          way to list all libraries needed for static linking, so it
          might be necessary to name additional libraries on the link
          command (for example, <code class="literal">-lnsl -lsocket</code> on
          Solaris). To get an idea which libraries to add, use
          <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config --libs</strong></span></a> and <span class="command"><strong>ldd
          libmysqlclient.so</strong></span> (or <span class="command"><strong>otool -L
          libmysqlclient.dylib</strong></span> on OS X).
        </p><p>
          <span class="command"><strong>pkg-config</strong></span> can be used as an alternative to
          <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a> for obtaining information such
          as compiler flags or link libraries required to compile MySQL
          applications. For example, the following pairs of commands are
          equivalent:
        </p><pre data-lang="bash" class="programlisting">mysql_config --cflags<font></font>
pkg-config --cflags mysqlclient<font></font>
<font></font>
mysql_config --libs<font></font>
pkg-config --libs mysqlclient<font></font>
</pre><p>
          To produce flags for static linking, use this command:
        </p><pre data-lang="bash" class="programlisting">pkg-config --static --libs mysqlclient
</pre><p>
          For more information, see
          <a class="xref" href="connectors-apis.html#c-api-building-clients-pkg-config" title="28.7.4.2&nbsp;Building C API Client Programs Using pkg-config">Section&nbsp;28.7.4.2, “Building C API Client Programs Using pkg-config”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="c-api-building-clients-compiling-mysql-clients-on-microsoft-windows"></a>Compiling MySQL Clients on Microsoft Windows</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552164832"></a><a class="indexterm" name="idm140091552163344"></a><p>
          To specify header and library file locations, use the
          facilities provided by your development environment.
        </p><p>
          To build C API clients on Windows, you must link in the C
          client library, as well as the Windows ws2_32 sockets library
          and Secur32 security library.
        </p><p>
          You link your code with either the dynamic or static C client
          library. On Windows, the static library is named
          <code class="filename">mysqlclient.lib</code> and the dynamic library
          is named <code class="filename">libmysql.dll</code>. In addition, the
          <code class="filename">libmysql.lib</code> static import library is
          needed for using the dynamic library. If the static C client
          library is used, the client application must be compiled with
          the same version of Visual Studio used to compile the C client
          library (which is Visual Studio 2015 for the static C client
          library built by Oracle).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The <a class="ulink" href="https://dev.mysql.com/doc/connector-c/en/" target="_top">MySQL Connector/C</a> is
            a standalone, drop-in replacement of the MySQL C client
            libraries that come with the MySQL server distribution. The
            Oracle-built <a class="ulink" href="https://dev.mysql.com/doc/connector-c/en/" target="_top">MySQL
            Connector/C</a> contains currently two versions of the
            static client library, one built with Visual Studio 2013 and
            the other one with Visual Studio 2015; use the one that
            matches the Visual Studio version you use to compile your
            application.
</p>
</div>
<p>
          When using the Oracle-built MySQL C client library (or MySQL Connector/C),
          following these rules when it comes to linking the C runtime
          for your client application:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              For the Community version of the MySQL C client library
              (or the Community version of MySQL Connector/C):

</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                    <span class="emphasis"><em>For version 8.0.0</em></span> (or MySQL Connector/C
                    Community 6.1.9 and before):

</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                          If linking to the static C client library,
                          link statically to the C runtime (use the
                          <code class="literal">/MT</code> compiler option).
                        </p></li><li class="listitem"><p>
                          If linking to the dynamic C client library,
                          link either statically or dynamically to the C
                          runtime (use either <code class="literal">/MT</code> or
                          <code class="literal">/MD</code> compiler option).
</p></li></ul>
</div>
<p>
                  </p></li><li class="listitem"><p>
                    <span class="emphasis"><em>For version 8.0.1 and later</em></span> (or
                    MySQL Connector/C Community 6.1.10 and later): Always link
                    dynamically to the C runtime (use the
                    <code class="literal">/MD</code> compiler option), whether you
                    are linking to the static or dynamic C client
                    library. Also, target hosts running the client
                    application need to have the
                    <a class="ulink" href="https://www.microsoft.com/en-us/download/details.aspx?id=48145" target="_top">Visual
                    C++ Redistributable for Visual Studio 2015</a>
                    installed.
</p></li></ul>
</div>
<p>
            </p></li><li class="listitem"><p>
              For the Commercial version of the MySQL C client library
              (or the Commercial version of MySQL Connector/C):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  If linking to the static C client library, link
                  statically to the C runtime (use the<code class="literal">
                  /MT</code> compiler option).
                </p></li><li class="listitem"><p>
                  If linking to the dynamic C client library, link
                  either statically or dynamically to the C runtime (use
                  either <code class="literal">/MT</code> or
                  <code class="literal">/MD</code> compiler option).
</p></li></ul>
</div>
</li></ul>
</div>
<p>
          In general, when linking to a static MySQL C client library,
          the client library and the client application must use the
          same compiler option when it comes to linking the C
          runtime—that is, if your C client library is compiled
          with the <code class="literal">/MT</code> option, your client
          application should also be compiled with the
          <code class="literal">/MT</code> option, and so on (see
          <a class="ulink" href="http://msdn.microsoft.com/en-us/library/2kzt1wy3.aspx" target="_top">the
          MSDN page describing the C library linking options</a> for
          more details). Follow this rule when you are building your own
          static MySQL C client library (or MySQL Connector/C) from source and
          linking you client application to it.

</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              <span class="emphasis"><em>Debug Mode:</em></span> Because of the
              above-mentioned rule, you cannot build your application in
              debug mode (with the <code class="literal">/MTd</code> or
              <code class="literal">/MDd</code> compiler option) and link it to
              the static C client library built by Oracle, which is
              <span class="emphasis"><em>not</em></span> built with the debug options;
              instead, you will have to build the static client library
              from source with the debug options.
</p>
</div>
<p>
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="c-api-building-clients-troubleshooting-problems-linking-to-the-mysql-client-library"></a>Troubleshooting Problems Linking to the MySQL Client Library</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552130032"></a><a class="indexterm" name="idm140091552128544"></a><a class="indexterm" name="idm140091552127056"></a><a class="indexterm" name="idm140091552125568"></a><a class="indexterm" name="idm140091552124080"></a><p>
          The MySQL client library includes SSL support built in. It is
          unnecessary to specify either <code class="literal">-lssl</code> or
          <code class="literal">-lcrypto</code> at link time. Doing so may in fact
          result in problems at runtime.
        </p><p>
          If the linker cannot find the MySQL client library, you might
          get undefined-reference errors for symbols that start with
          <code class="literal">mysql_</code>, such as those shown here:
        </p><pre data-lang="none" class="programlisting">/tmp/ccFKsdPa.o: In function `main':<font></font>
/tmp/ccFKsdPa.o(.text+0xb): undefined reference to `mysql_init'<font></font>
/tmp/ccFKsdPa.o(.text+0x31): undefined reference to `mysql_real_connect'<font></font>
/tmp/ccFKsdPa.o(.text+0x69): undefined reference to `mysql_error'<font></font>
/tmp/ccFKsdPa.o(.text+0x9a): undefined reference to `mysql_close'<font></font>
</pre><p>
          You should be able to solve this problem by adding
          <code class="literal">-L<em class="replaceable"><code>dir_path</code></em>
          -lmysqlclient</code> at the end of your link command, where
          <em class="replaceable"><code>dir_path</code></em> represents the path name
          of the directory where the client library is located. To
          determine the correct directory, try this command:
        </p><pre data-lang="bash" class="programlisting">shell&gt; <strong class="userinput"><code>mysql_config --libs</code></strong>
</pre><p>
          The output from <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a> might indicate
          other libraries that should be specified on the link command
          as well. You can include <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a>
          output directly in your compile or link command using
          backticks. For example:
        </p><pre data-lang="bash" class="programlisting">shell&gt; <strong class="userinput"><code>gcc -o progname progname.o `mysql_config --libs`</code></strong>
</pre><p>
          If an error occurs at link time that the
          <code class="literal">floor</code> symbol is undefined, link to the math
          library by adding <code class="option">-lm</code> to the end of the
          compile/link line. Similarly, if you get undefined-reference
          errors for other functions that should exist on your system,
          such as <code class="literal">connect()</code>, check the manual page
          for the function in question to determine which libraries you
          should add to the link command.
        </p><p>
          If you get undefined-reference errors such as the following
          for functions that do not exist on your system, it usually
          means that your MySQL client library was compiled on a system
          that is not 100% compatible with yours:
        </p><pre data-lang="bash" class="programlisting">mf_format.o(.text+0x201): undefined reference to `__lxstat'
</pre><p>
          In this case, you should download the latest MySQL or Connector/C
          source distribution and compile the MySQL client library
          yourself. See <a class="xref" href="installing.html#source-installation" title="2.9&nbsp;Installing MySQL from Source">Section&nbsp;2.9, “Installing MySQL from Source”</a>, and
          <a class="ulink" href="https://dev.mysql.com/doc/connector-c/en/" target="_top">MySQL Connector/C Developer Guide</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-building-clients-pkg-config"></a>28.7.4.2&nbsp;Building C API Client Programs Using pkg-config</h4>

</div>

</div>

</div>
<p>
        MySQL distributions contain a
        <code class="filename">mysqlclient.pc</code> file that provides
        information about MySQL configuration for use by the
        <span class="command"><strong>pkg-config</strong></span> command. This enables
        <span class="command"><strong>pkg-config</strong></span> to be used as an alternative to
        <a class="link" href="programs.html#mysql-config" title="4.7.1&nbsp;mysql_config — Display Options for Compiling Clients"><span class="command"><strong>mysql_config</strong></span></a> for obtaining information such
        as compiler flags or link libraries required to compile MySQL
        applications. For example, the following pairs of commands are
        equivalent:
      </p><pre data-lang="bash" class="programlisting">mysql_config --cflags<font></font>
pkg-config --cflags mysqlclient<font></font>
<font></font>
mysql_config --libs<font></font>
pkg-config --libs mysqlclient<font></font>
</pre><p>
        The last <span class="command"><strong>pkg-config</strong></span> command produces flags
        for dynamic linking. To produce flags for static linking, use
        this command:
      </p><pre data-lang="bash" class="programlisting">pkg-config --static --libs mysqlclient
</pre><p>
        On some platforms, the output with and without
        <code class="option">--static</code> might be the same.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          <a class="indexterm" name="idm140091552092736"></a>

          <a class="indexterm" name="idm140091552091648"></a>

          If <span class="command"><strong>pkg-config</strong></span> does not find MySQL
          information, it might be necessary to set the
          <code class="literal">PKG_CONFIG_PATH</code> environment variable to the
          directory in which the <code class="filename">mysqlclient.pc</code>
          file is located, which by default is usually the
          <code class="filename">pkgconfig</code> directory under the MySQL
          library directory. For example (adjust the location
          appropriately):
        </p><pre data-lang="bash" class="programlisting">export PKG_CONFIG_PATH=/usr/local/mysql/lib/pkgconfig # sh, bash, ...<font></font>
setenv PKG_CONFIG_PATH /usr/local/mysql/lib/pkgconfig # csh, tcsh, ...<font></font>
</pre><p>
          The <code class="filename">mysqlconfig.pc</code> installation location
          can be controlled using the
          <a class="link" href="installing.html#option_cmake_install_pkgconfigdir"><code class="option">INSTALL_PKGCONFIGDIR</code></a>
          <span class="command"><strong>CMake</strong></span> option. See
          <a class="xref" href="installing.html#source-configuration-options" title="2.9.4&nbsp;MySQL Source-Configuration Options">Section&nbsp;2.9.4, “MySQL Source-Configuration Options”</a>.
</p>
</div>
<p>
        The <code class="option">--variable</code> option takes a configuration
        variable name and displays the variable value:
      </p><pre data-lang="bash" class="programlisting">pkg-config --variable=prefix mysqlclient     # installation prefix directory<font></font>
pkg-config --variable=includedir mysqlclient # header file directory<font></font>
pkg-config --variable=libdir mysqlclient     # library directory<font></font>
</pre><p>
        To see which variable values <span class="command"><strong>pkg-config</strong></span> can
        display using the <code class="option">--variable</code> option, use this
        command:
      </p><pre data-lang="bash" class="programlisting">pkg-config --print-variables mysqlclient
</pre><p>
        You can use <span class="command"><strong>pkg-config</strong></span> within a command line
        using backticks to include the output that it produces for
        particular options. For example, to compile and link a MySQL
        client program, use <span class="command"><strong>pkg-config</strong></span> as follows:
      </p><pre data-lang="bash" class="programlisting">gcc -c `pkg-config --cflags mysqlclient` progname.c<font></font>
gcc -o progname progname.o `pkg-config --libs mysqlclient`<font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-threaded-clients"></a>28.7.4.3&nbsp;Writing C API Threaded Client Programs</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091552073024"></a><a class="indexterm" name="idm140091552071568"></a><p>
        The client library is almost thread-safe. The biggest problem is
        that the subroutines in <code class="filename">sql/net_serv.cc</code>
        that read from sockets are not interrupt-safe. This was done
        with the thought that you might want to have your own alarm that
        can break a long read to a server. If you install interrupt
        handlers for the <code class="literal">SIGPIPE</code> interrupt, socket
        handling should be thread-safe.
      </p><p>
        To avoid aborting the program when a connection terminates,
        MySQL blocks <code class="literal">SIGPIPE</code> on the first call to
        <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>,
        <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>, or
        <a class="link" href="connectors-apis.html#mysql-connect" title="28.7.7.7&nbsp;mysql_connect()"><code class="literal">mysql_connect()</code></a>. To use your own
        <code class="literal">SIGPIPE</code> handler, first call
        <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>, then
        install your handler.
      </p><p>
        If <span class="quote">“<span class="quote">undefined symbol</span>”</span> errors occur when linking
        against the <code class="literal">libmysqlclient</code> client library, in
        most cases this is because you have not included the thread
        libraries on the link/compile command.
      </p><p>
        The client library is thread-safe per connection. You can let
        two threads share the same connection with the following
        caveats:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Multiple threads cannot send a query to the MySQL server at
            the same time on the same connection. In particular, you
            must ensure that between calls to
            <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> and
            <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> in one
            thread, no other thread uses the same connection. You must
            have a mutex lock around your pair of
            <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> and
            <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> calls.
            After <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>
            returns, the lock can be released and other threads may
            query the same connection.
          </p><p>
            If you use POSIX threads, you can use
            <code class="literal">pthread_mutex_lock()</code> and
            <code class="literal">pthread_mutex_unlock()</code> to establish and
            release a mutex lock.
          </p></li><li class="listitem"><p>
            Many threads can access different result sets that are
            retrieved with
            <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>.
          </p></li><li class="listitem"><p>
            To use <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>,
            you must ensure that no other thread is using the same
            connection until the result set is closed. However, it
            really is best for threaded clients that share the same
            connection to use
            <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>.
</p></li></ul>
</div>
<p>
        You need to know the following if you have a thread that did not
        create the connection to the MySQL database but is calling MySQL
        functions:
      </p><p>
        When you call <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>,
        MySQL creates a thread-specific variable for the thread that is
        used by the debug library (among other things). If you call a
        MySQL function before the thread has called
        <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>, the thread does
        not have the necessary thread-specific variables in place and
        you are likely to end up with a core dump sooner or later. To
        avoid problems, you must do the following:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            Call <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>
            before any other MySQL functions. It is not thread-safe, so
            call it before threads are created, or protect the call with
            a mutex.
          </p></li><li class="listitem"><p>
            Arrange for
            <a class="link" href="connectors-apis.html#mysql-thread-init" title="28.7.16.2&nbsp;mysql_thread_init()"><code class="literal">mysql_thread_init()</code></a> to be
            called early in the thread handler before calling any MySQL
            function. If you call
            <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>, it will call
            <a class="link" href="connectors-apis.html#mysql-thread-init" title="28.7.16.2&nbsp;mysql_thread_init()"><code class="literal">mysql_thread_init()</code></a> for you.
          </p></li><li class="listitem"><p>
            In the thread, call
            <a class="link" href="connectors-apis.html#mysql-thread-end" title="28.7.16.1&nbsp;mysql_thread_end()"><code class="literal">mysql_thread_end()</code></a> before
            calling <code class="literal">pthread_exit()</code>. This frees the
            memory used by MySQL thread-specific variables.
</p></li></ol>
</div>
<p>
        The preceding notes regarding
        <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a> also apply to
        <a class="link" href="connectors-apis.html#mysql-connect" title="28.7.7.7&nbsp;mysql_connect()"><code class="literal">mysql_connect()</code></a>, which calls
        <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-running-clients"></a>28.7.4.4&nbsp;Running C API Client Programs</h4>

</div>

</div>

</div>
<p>
        If, after an upgrade, you experience problems with compiled
        client programs, such as <code class="literal">Commands out of sync</code>
        or unexpected core dumps, the programs were probably compiled
        using old header or library files. In this case, check the date
        of the <code class="filename">mysql.h</code> file and
        <code class="filename">libmysqlclient.a</code> library used for
        compilation to verify that they are from the new MySQL
        distribution. If not, recompile the programs with the new
        headers and libraries. Recompilation might also be necessary for
        programs compiled against the shared client library if the
        library major version number has changed (for example, from
        <code class="filename">libmysqlclient.so.17</code> to
        <code class="filename">libmysqlclient.so.18</code>).
      </p><p>
        The major client library version determines compatibility. (For
        example, for <code class="literal">libmysqlclient.so.18.1.0</code>, the
        major version is 18.) For this reason, the libraries shipped
        with newer versions of MySQL are drop-in replacements for older
        versions that have the same major number. As long as the major
        library version is the same, you can upgrade the library and old
        applications should continue to work with it.
      </p><p>
        Undefined-reference errors might occur at runtime when you try
        to execute a MySQL program. If these errors specify symbols that
        start with <code class="literal">mysql_</code> or indicate that the
        <code class="literal">libmysqlclient</code> library cannot be found, it
        means that your system cannot find the shared
        <code class="filename">libmysqlclient.so</code> library. The solution to
        this problem is to tell your system to search for shared
        libraries in the directory where that library is located. Use
        whichever of the following methods is appropriate for your
        system:
</p><a class="indexterm" name="idm140091552013776"></a><a class="indexterm" name="idm140091552012688"></a><a class="indexterm" name="idm140091552011200"></a><a class="indexterm" name="idm140091552010112"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Add the path of the directory where
            <code class="filename">libmysqlclient.so</code> is located to the
            <code class="literal">LD_LIBRARY_PATH</code> or
            <code class="literal">LD_LIBRARY</code> environment variable.
          </p></li><li class="listitem"><p>
            On OS X, add the path of the directory where
            <code class="filename">libmysqlclient.dylib</code> is located to the
            <code class="literal">DYLD_LIBRARY_PATH</code> environment variable.
          </p></li><li class="listitem"><p>
            Copy the shared-library files (such as
            <code class="filename">libmysqlclient.so</code>) to some directory
            that is searched by your system, such as
            <code class="filename">/lib</code>, and update the shared library
            information by executing <code class="literal">ldconfig</code>. Be
            sure to copy all related files. A shared library might exist
            under several names, using symlinks to provide the alternate
            names.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-server-client-versions"></a>28.7.4.5&nbsp;C API Server and Client Library Versions</h4>

</div>

</div>

</div>
<p>
        The string and numeric forms of the MySQL server version are
        available at compile time as the values of the
        <code class="literal">MYSQL_SERVER_VERSION</code> and
        <code class="literal">MYSQL_VERSION_ID</code> macros, and at runtime as
        the values of the
        <a class="link" href="connectors-apis.html#mysql-get-server-info" title="28.7.7.32&nbsp;mysql_get_server_info()"><code class="literal">mysql_get_server_info()</code></a> and
        <a class="link" href="connectors-apis.html#mysql-get-server-version" title="28.7.7.33&nbsp;mysql_get_server_version()"><code class="literal">mysql_get_server_version()</code></a>
        functions.
      </p><p>
        The MySQL client library version depends on the type of
        distribution that provides the library:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For MySQL distributions, the client library version is the
            MySQL version. The string and numeric forms of this version
            are available at compile time as the values of the
            <code class="literal">MYSQL_SERVER_VERSION</code> and
            <code class="literal">MYSQL_VERSION_ID</code> macros, and at runtime
            as the values of the
            <a class="link" href="connectors-apis.html#mysql-get-client-info" title="28.7.7.27&nbsp;mysql_get_client_info()"><code class="literal">mysql_get_client_info()</code></a> and
            <a class="link" href="connectors-apis.html#mysql-get-client-version" title="28.7.7.28&nbsp;mysql_get_client_version()"><code class="literal">mysql_get_client_version()</code></a>
            functions.
          </p><p>
            The <code class="literal">LIBMYSQL_VERSION</code> and
            <code class="literal">LIBMYSQL_VERSION_ID</code> macros have the same
            values as <code class="literal">MYSQL_SERVER_VERSION</code> and
            <code class="literal">MYSQL_VERSION_ID</code> and the two sets of
            macros can be used interchangeably.
          </p></li><li class="listitem"><p>
            For Connector/C distributions, the client library version is
            the Connector/C version. The string and numeric forms of
            this version are available at compile time as the values of
            the <code class="literal">LIBMYSQL_VERSION</code> and
            <code class="literal">LIBMYSQL_VERSION_ID</code> macros, and at
            runtime as the values of the
            <a class="link" href="connectors-apis.html#mysql-get-client-info" title="28.7.7.27&nbsp;mysql_get_client_info()"><code class="literal">mysql_get_client_info()</code></a> and
            <a class="link" href="connectors-apis.html#mysql-get-client-version" title="28.7.7.28&nbsp;mysql_get_client_version()"><code class="literal">mysql_get_client_version()</code></a>
            functions.
          </p><p>
            The <code class="literal">MYSQL_SERVER_VERSION</code> and
            <code class="literal">MYSQL_VERSION_ID</code> macros indicate the
            string and numeric forms of the MySQL version on which the
            Connector/C distribution is based.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-data-structures"></a>28.7.5&nbsp;C API Data Structures</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551975552"></a><a class="indexterm" name="idm140091551974064"></a><p>
      This section describes C API data structures other than those used
      for prepared statements, the asychronous interface, or the
      replication stream interface. For information about those, see
      <a class="xref" href="connectors-apis.html#c-api-prepared-statement-data-structures" title="28.7.9&nbsp;C API Prepared Statement Data Structures">Section&nbsp;28.7.9, “C API Prepared Statement Data Structures”</a>,
      <a class="xref" href="connectors-apis.html#c-api-asynchronous-data-structures" title="28.7.13&nbsp;C API Asynchronous Interface Data Structures">Section&nbsp;28.7.13, “C API Asynchronous Interface Data Structures”</a>, and
      <a class="xref" href="connectors-apis.html#c-api-binary-log-data-structures" title="28.7.19&nbsp;C API Binary Log Data Structures">Section&nbsp;28.7.19, “C API Binary Log Data Structures”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="indexterm" name="idm140091551968480"></a>

          <code class="literal">MYSQL</code>
        </p><p>
          This structure represents handler for one database connection.
          It is used for almost all MySQL functions. Do not try to make
          a copy of a <code class="literal">MYSQL</code> structure. There is no
          guarantee that such a copy will be usable.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091551964592"></a>

          <code class="literal">MYSQL_RES</code>
        </p><p>
          This structure represents the result of a query that returns
          rows (<a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a>,
          <a class="link" href="sql-syntax.html#show" title="13.7.6&nbsp;SHOW Syntax"><code class="literal">SHOW</code></a>,
          <a class="link" href="sql-syntax.html#describe" title="13.8.1&nbsp;DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a>,
          <a class="link" href="sql-syntax.html#explain" title="13.8.2&nbsp;EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>). The information
          returned from a query is called the <span class="emphasis"><em>result
          set</em></span> in the remainder of this section.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091551956160"></a>

          <code class="literal">MYSQL_ROW</code>
        </p><p>
          This is a type-safe representation of one row of data. It is
          currently implemented as an array of counted byte strings.
          (You cannot treat these as null-terminated strings if field
          values may contain binary data, because such values may
          contain null bytes internally.) Rows are obtained by calling
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091551951648"></a>

          <code class="literal">MYSQL_FIELD</code>
        </p><p>
          This structure contains metadata: information about a field,
          such as the field's name, type, and size. Its members are
          described in more detail later in this section. You may obtain
          the <code class="literal">MYSQL_FIELD</code> structures for each field
          by calling <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a>
          repeatedly. Field values are not part of this structure; they
          are contained in a <code class="literal">MYSQL_ROW</code> structure.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091551945536"></a>

          <code class="literal">MYSQL_FIELD_OFFSET</code>
        </p><p>
          This is a type-safe representation of an offset into a MySQL
          field list. (Used by
          <a class="link" href="connectors-apis.html#mysql-field-seek" title="28.7.7.23&nbsp;mysql_field_seek()"><code class="literal">mysql_field_seek()</code></a>.) Offsets
          are field numbers within a row, beginning at zero.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091551941008"></a>

          <a class="indexterm" name="idm140091551939936"></a>

          <code class="literal">my_ulonglong</code>
        </p><p>
          The type used for the number of rows and for
          <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a>,
          <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49&nbsp;mysql_num_rows()"><code class="literal">mysql_num_rows()</code></a>, and
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a>. This type
          provides a range of <code class="literal">0</code> to
          <code class="literal">1.84e19</code>.
        </p><p>
          Some functions that return a row count using this type return
          -1 as an unsigned value to indicate an error or exceptional
          condition. You can check for -1 by comparing the return value
          to <code class="literal">(my_ulonglong)-1</code> (or to
          <code class="literal">(my_ulonglong)~0</code>, which is equivalent).
        </p><p>
          On some systems, attempting to print a value of type
          <code class="literal">my_ulonglong</code> does not work. To print such a
          value, convert it to <code class="literal">unsigned long</code> and use
          a <code class="literal">%lu</code> print format. Example:
        </p><pre data-lang="c" class="programlisting">printf ("Number of rows: %lu\n",<font></font>
        (unsigned long) mysql_num_rows(result));<font></font>
</pre></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091551925424"></a>

          <code class="literal">my_bool</code>
        </p><p>
          A boolean type, for values that are true (nonzero) or false
          (zero). The <code class="literal">my_bool</code> type was used before
          MySQL 8.0. As of MySQL 8.0, use the <code class="literal">bool</code> or
          <code class="literal">int</code> C type instead.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The change from <code class="literal">my_bool</code> to
            <code class="literal">bool</code> means that the
            <code class="filename">mysql.h</code> header file requires a C++ or
            C99 compiler to compile.
</p>
</div>
</li></ul>
</div>
<p>
      The <code class="literal">MYSQL_FIELD</code> structure contains the members
      described in the following list. The definitions apply primarily
      for columns of result sets such as those produced by
      <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> statements.
      <code class="literal">MYSQL_FIELD</code> structures are also used to provide
      metadata for <code class="literal">OUT</code> and <code class="literal">INOUT</code>
      parameters returned from stored procedures executed using prepared
      <a class="link" href="sql-syntax.html#call" title="13.2.1&nbsp;CALL Syntax"><code class="literal">CALL</code></a> statements. For such
      parameters, some of the structure members have a meaning different
      from the meaning for column values.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">char * name</code>
        </p><p>
          The name of the field, as a null-terminated string. If the
          field was given an alias with an <code class="literal">AS</code> clause,
          the value of <code class="literal">name</code> is the alias. For a
          procedure parameter, the parameter name.
        </p></li><li class="listitem"><p>
          <code class="literal">char * org_name</code>
        </p><p>
          The name of the field, as a null-terminated string. Aliases
          are ignored. For expressions, the value is an empty string.
          For a procedure parameter, the parameter name.
        </p></li><li class="listitem"><p>
          <code class="literal">char * table</code>
        </p><p>
          The name of the table containing this field, if it is not a
          calculated field. For calculated fields, the
          <code class="literal">table</code> value is an empty string. If the
          column is selected from a view, <code class="literal">table</code> names
          the view. If the table or view was given an alias with an
          <code class="literal">AS</code> clause, the value of
          <code class="literal">table</code> is the alias. For a
          <a class="link" href="sql-syntax.html#union" title="13.2.10.3&nbsp;UNION Syntax"><code class="literal">UNION</code></a>, the value is the empty
          string. For a procedure parameter, the procedure name.
        </p></li><li class="listitem"><p>
          <code class="literal">char * org_table</code>
        </p><p>
          The name of the table, as a null-terminated string. Aliases
          are ignored. If the column is selected from a view,
          <code class="literal">org_table</code> names the view. If the column is
          selected from a derived table, <code class="literal">org_table</code>
          names the base table. If a derived table wraps a view,
          <code class="literal">org_table</code> still names the base table. If
          the column is an expression, <code class="literal">org_table</code> is
          the empty string. For a <a class="link" href="sql-syntax.html#union" title="13.2.10.3&nbsp;UNION Syntax"><code class="literal">UNION</code></a>,
          the value is the empty string. For a procedure parameter, the
          value is the procedure name.
        </p></li><li class="listitem"><p>
          <code class="literal">char * db</code>
        </p><p>
          The name of the database that the field comes from, as a
          null-terminated string. If the field is a calculated field,
          <code class="literal">db</code> is an empty string. For a
          <a class="link" href="sql-syntax.html#union" title="13.2.10.3&nbsp;UNION Syntax"><code class="literal">UNION</code></a>, the value is the empty
          string. For a procedure parameter, the name of the database
          containing the procedure.
        </p></li><li class="listitem"><p>
          <code class="literal">char * catalog</code>
        </p><p>
          The catalog name. This value is always
          <code class="literal">"def"</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">char * def</code>
        </p><p>
          The default value of this field, as a null-terminated string.
          This is set only if you use
          <a class="link" href="connectors-apis.html#mysql-list-fields" title="28.7.7.43&nbsp;mysql_list_fields()"><code class="literal">mysql_list_fields()</code></a>.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned long length</code>
        </p><p>
          The width of the field. This corresponds to the display
          length, in bytes.
        </p><p>
          The server determines the <code class="literal">length</code> value
          before it generates the result set, so this is the minimum
          length required for a data type capable of holding the largest
          possible value from the result column, without knowing in
          advance the actual values that will be produced by the query
          for the result set.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned long max_length</code>
        </p><p>
          The maximum width of the field for the result set (the length
          in bytes of the longest field value for the rows actually in
          the result set). If you use
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-list-fields" title="28.7.7.43&nbsp;mysql_list_fields()"><code class="literal">mysql_list_fields()</code></a>, this
          contains the maximum length for the field. If you use
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>, the value
          of this variable is zero.
        </p><p>
          The value of <code class="literal">max_length</code> is the length of
          the string representation of the values in the result set. For
          example, if you retrieve a
          <a class="link" href="data-types.html#floating-point-types" title="11.2.3&nbsp;Floating-Point Types (Approximate Value) - FLOAT, DOUBLE"><code class="literal">FLOAT</code></a> column and the
          <span class="quote">“<span class="quote">widest</span>”</span> value is <code class="literal">-12.345</code>,
          <code class="literal">max_length</code> is 7 (the length of
          <code class="literal">'-12.345'</code>).
        </p><p>
          If you are using prepared statements,
          <code class="literal">max_length</code> is not set by default because
          for the binary protocol the lengths of the values depend on
          the types of the values in the result set. (See
          <a class="xref" href="connectors-apis.html#c-api-prepared-statement-data-structures" title="28.7.9&nbsp;C API Prepared Statement Data Structures">Section&nbsp;28.7.9, “C API Prepared Statement Data Structures”</a>.)
          If you want the <code class="literal">max_length</code> values anyway,
          enable the <code class="literal">STMT_ATTR_UPDATE_MAX_LENGTH</code>
          option with
          <a class="link" href="connectors-apis.html#mysql-stmt-attr-set" title="28.7.11.3&nbsp;mysql_stmt_attr_set()"><code class="literal">mysql_stmt_attr_set()</code></a> and the
          lengths will be set when you call
          <a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28&nbsp;mysql_stmt_store_result()"><code class="literal">mysql_stmt_store_result()</code></a>.
          (See <a class="xref" href="connectors-apis.html#mysql-stmt-attr-set" title="28.7.11.3&nbsp;mysql_stmt_attr_set()">Section&nbsp;28.7.11.3, “mysql_stmt_attr_set()”</a>, and
          <a class="xref" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28&nbsp;mysql_stmt_store_result()">Section&nbsp;28.7.11.28, “mysql_stmt_store_result()”</a>.)
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned int name_length</code>
        </p><p>
          The length of <code class="literal">name</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned int org_name_length</code>
        </p><p>
          The length of <code class="literal">org_name</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned int table_length</code>
        </p><p>
          The length of <code class="literal">table</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned int org_table_length</code>
        </p><p>
          The length of <code class="literal">org_table</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned int db_length</code>
        </p><p>
          The length of <code class="literal">db</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned int catalog_length</code>
        </p><p>
          The length of <code class="literal">catalog</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned int def_length</code>
        </p><p>
          The length of <code class="literal">def</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned int flags</code>
        </p><p>
          Bit-flags that describe the field. The
          <code class="literal">flags</code> value may have zero or more of the
          bits set that are shown in the following table.
</p>
<div class="informaltable">
<table summary="Bit-flag values and a description of each flag."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
              <th scope="col">Flag Value</th>
              <th scope="col">Flag Description</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">NOT_NULL_FLAG</code></td>
              <td>Field cannot be <code class="literal">NULL</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">PRI_KEY_FLAG</code></td>
              <td>Field is part of a primary key</td>
            </tr><tr>
              <td scope="row"><code class="literal">UNIQUE_KEY_FLAG</code></td>
              <td>Field is part of a unique key</td>
            </tr><tr>
              <td scope="row"><code class="literal">MULTIPLE_KEY_FLAG</code></td>
              <td>Field is part of a nonunique key</td>
            </tr><tr>
              <td scope="row"><code class="literal">UNSIGNED_FLAG</code></td>
              <td>Field has the <code class="literal">UNSIGNED</code> attribute</td>
            </tr><tr>
              <td scope="row"><code class="literal">ZEROFILL_FLAG</code></td>
              <td>Field has the <code class="literal">ZEROFILL</code> attribute</td>
            </tr><tr>
              <td scope="row"><code class="literal">BINARY_FLAG</code></td>
              <td>Field has the <code class="literal">BINARY</code> attribute</td>
            </tr><tr>
              <td scope="row"><code class="literal">AUTO_INCREMENT_FLAG</code></td>
              <td>Field has the <code class="literal">AUTO_INCREMENT</code> attribute</td>
            </tr><tr>
              <td scope="row"><code class="literal">ENUM_FLAG</code></td>
              <td>Field is an <a class="link" href="data-types.html#enum" title="11.4.4&nbsp;The ENUM Type"><code class="literal">ENUM</code></a></td>
            </tr><tr>
              <td scope="row"><code class="literal">SET_FLAG</code></td>
              <td>Field is a <a class="link" href="data-types.html#set" title="11.4.5&nbsp;The SET Type"><code class="literal">SET</code></a></td>
            </tr><tr>
              <td scope="row"><code class="literal">BLOB_FLAG</code></td>
              <td>Field is a <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">BLOB</code></a> or
                <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">TEXT</code></a> (deprecated)</td>
            </tr><tr>
              <td scope="row"><code class="literal">TIMESTAMP_FLAG</code></td>
              <td>Field is a <a class="link" href="data-types.html#datetime" title="11.3.1&nbsp;The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> (deprecated)</td>
            </tr><tr>
              <td scope="row"><code class="literal">NUM_FLAG</code></td>
              <td>Field is numeric; see additional notes following table</td>
            </tr><tr>
              <td scope="row"><code class="literal">NO_DEFAULT_VALUE_FLAG</code></td>
              <td>Field has no default value; see additional notes following table</td>
</tr></tbody></table>
</div>
<p>
          Some of these flags indicate data type information and are
          superseded by or used in conjunction with the
          <code class="literal">MYSQL_TYPE_<em class="replaceable"><code>xxx</code></em></code>
          value in the <code class="literal">field-&gt;type</code> member
          described later:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              To check for <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">BLOB</code></a> or
              <a class="link" href="data-types.html#datetime" title="11.3.1&nbsp;The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> values, check
              whether <code class="literal">type</code> is
              <code class="literal">MYSQL_TYPE_BLOB</code> or
              <code class="literal">MYSQL_TYPE_TIMESTAMP</code>. (The
              <code class="literal">BLOB_FLAG</code> and
              <code class="literal">TIMESTAMP_FLAG</code> flags are unneeded.)
            </p></li><li class="listitem"><p>
              <a class="link" href="data-types.html#enum" title="11.4.4&nbsp;The ENUM Type"><code class="literal">ENUM</code></a> and
              <a class="link" href="data-types.html#set" title="11.4.5&nbsp;The SET Type"><code class="literal">SET</code></a> values are returned as
              strings. For these, check that the <code class="literal">type</code>
              value is <code class="literal">MYSQL_TYPE_STRING</code> and that the
              <code class="literal">ENUM_FLAG</code> or
              <code class="literal">SET_FLAG</code> flag is set in the
              <code class="literal">flags</code> value.
</p></li></ul>
</div>
<p>
          <code class="literal">NUM_FLAG</code> indicates that a column is
          numeric. This includes columns with a type of
          <code class="literal">MYSQL_TYPE_DECIMAL</code>,
          <code class="literal">MYSQL_TYPE_NEWDECIMAL</code>,
          <code class="literal">MYSQL_TYPE_TINY</code>,
          <code class="literal">MYSQL_TYPE_SHORT</code>,
          <code class="literal">MYSQL_TYPE_LONG</code>,
          <code class="literal">MYSQL_TYPE_FLOAT</code>,
          <code class="literal">MYSQL_TYPE_DOUBLE</code>,
          <code class="literal">MYSQL_TYPE_NULL</code>,
          <code class="literal">MYSQL_TYPE_LONGLONG</code>,
          <code class="literal">MYSQL_TYPE_INT24</code>, and
          <code class="literal">MYSQL_TYPE_YEAR</code>.
        </p><p>
          <code class="literal">NO_DEFAULT_VALUE_FLAG</code> indicates that a
          column has no <code class="literal">DEFAULT</code> clause in its
          definition. This does not apply to <code class="literal">NULL</code>
          columns (because such columns have a default of
          <code class="literal">NULL</code>), or to
          <code class="literal">AUTO_INCREMENT</code> columns (which have an
          implied default value).
        </p><p>
          The following example illustrates a typical use of the
          <code class="literal">flags</code> value:
        </p><pre data-lang="c" class="programlisting">if (field-&gt;flags &amp; NOT_NULL_FLAG)<font></font>
    printf("Field cannot be null\n");<font></font>
</pre><p>
          You may use the convenience macros shown in the following
          table to determine the boolean status of the
          <code class="literal">flags</code> value.
</p>
<div class="informaltable">
<table summary="Flag status values and a description of each flag."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
              <th scope="col">Flag Status</th>
              <th scope="col">Description</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">IS_NOT_NULL(flags)</code></td>
              <td>True if this field is defined as <code class="literal">NOT NULL</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">IS_PRI_KEY(flags)</code></td>
              <td>True if this field is a primary key</td>
            </tr><tr>
              <td scope="row"><code class="literal">IS_BLOB(flags)</code></td>
              <td>True if this field is a <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">BLOB</code></a> or
                <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">TEXT</code></a> (deprecated; test
                <code class="literal">field-&gt;type</code> instead)</td>
</tr></tbody></table>
</div>
</li><li class="listitem"><p>
          <code class="literal">unsigned int decimals</code>
        </p><p>
          The number of decimals for numeric fields, and the fractional
          seconds precision for temporal fields.
        </p></li><li class="listitem"><p>
          <code class="literal">unsigned int charsetnr</code>
        </p><p>
          An ID number that indicates the character set/collation pair
          for the field.
        </p><p>
          Normally, character values in result sets are converted to the
          character set indicated by the
          <a class="link" href="server-administration.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a> system
          variable. In this case, <code class="literal">charsetnr</code>
          corresponds to the character set indicated by that variable.
          Character set conversion can be suppressed by setting
          <a class="link" href="server-administration.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a> to
          <code class="literal">NULL</code>. In this case,
          <code class="literal">charsetnr</code> corresponds to the character set
          of the original table column or expression. See also
          <a class="xref" href="charset.html#charset-connection" title="10.4&nbsp;Connection Character Sets and Collations">Section&nbsp;10.4, “Connection Character Sets and Collations”</a>.
        </p><p>
          To distinguish between binary and nonbinary data for string
          data types, check whether the <code class="literal">charsetnr</code>
          value is 63. If so, the character set is
          <code class="literal">binary</code>, which indicates binary rather than
          nonbinary data. This enables you to distinguish
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2&nbsp;The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a> from
          <a class="link" href="data-types.html#char" title="11.4.1&nbsp;The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2&nbsp;The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> from
          <a class="link" href="data-types.html#char" title="11.4.1&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and the
          <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">BLOB</code></a> types from the
          <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">TEXT</code></a> types.
        </p><p>
          <code class="literal">charsetnr</code> values are the same as those
          displayed in the <code class="literal">Id</code> column of the
          <a class="link" href="sql-syntax.html#show-collation" title="13.7.6.4&nbsp;SHOW COLLATION Syntax"><code class="literal">SHOW COLLATION</code></a> statement or the
          <code class="literal">ID</code> column of the
          <code class="literal">INFORMATION_SCHEMA</code>
          <a class="link" href="information-schema.html#collations-table" title="25.4&nbsp;The INFORMATION_SCHEMA COLLATIONS Table"><code class="literal">COLLATIONS</code></a> table. You can use
          those information sources to see which character set and
          collation specific <code class="literal">charsetnr</code> values
          indicate:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW COLLATION WHERE Id = 63;</code></strong><font></font>
+-----------+---------+----+---------+----------+---------+<font></font>
| Collation | Charset | Id | Default | Compiled | Sortlen |<font></font>
+-----------+---------+----+---------+----------+---------+<font></font>
| binary    | binary  | 63 | Yes     | Yes      |       1 |<font></font>
+-----------+---------+----+---------+----------+---------+<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT COLLATION_NAME, CHARACTER_SET_NAME</code></strong>
       <strong class="userinput"><code>FROM INFORMATION_SCHEMA.COLLATIONS WHERE ID = 33;</code></strong><font></font>
+-----------------+--------------------+<font></font>
| COLLATION_NAME  | CHARACTER_SET_NAME |<font></font>
+-----------------+--------------------+<font></font>
| utf8_general_ci | utf8               |<font></font>
+-----------------+--------------------+<font></font>
</pre></li><li class="listitem"><p>
          <code class="literal">enum enum_field_types type</code>
        </p><p>
          The type of the field. The <code class="literal">type</code> value may
          be one of the <code class="literal">MYSQL_TYPE_</code> symbols shown in
          the following table.
</p>
<div class="informaltable">
<table summary="MYSQL_TYPE_ values and a description of each type."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col">Type Value</th>
              <th scope="col">Type Description</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TINY</code></td>
              <td><a class="link" href="data-types.html#integer-types" title="11.2.1&nbsp;Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">TINYINT</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_SHORT</code></td>
              <td><a class="link" href="data-types.html#integer-types" title="11.2.1&nbsp;Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">SMALLINT</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_LONG</code></td>
              <td><a class="link" href="data-types.html#integer-types" title="11.2.1&nbsp;Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INTEGER</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_INT24</code></td>
              <td><a class="link" href="data-types.html#integer-types" title="11.2.1&nbsp;Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">MEDIUMINT</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_LONGLONG</code></td>
              <td><a class="link" href="data-types.html#integer-types" title="11.2.1&nbsp;Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">BIGINT</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DECIMAL</code></td>
              <td><a class="link" href="data-types.html#fixed-point-types" title="11.2.2&nbsp;Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL</code></a> or
                <a class="link" href="data-types.html#fixed-point-types" title="11.2.2&nbsp;Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">NUMERIC</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_NEWDECIMAL</code></td>
              <td>Precision math <a class="link" href="data-types.html#fixed-point-types" title="11.2.2&nbsp;Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL</code></a> or
                <a class="link" href="data-types.html#fixed-point-types" title="11.2.2&nbsp;Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">NUMERIC</code></a></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_FLOAT</code></td>
              <td><a class="link" href="data-types.html#floating-point-types" title="11.2.3&nbsp;Floating-Point Types (Approximate Value) - FLOAT, DOUBLE"><code class="literal">FLOAT</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DOUBLE</code></td>
              <td><a class="link" href="data-types.html#floating-point-types" title="11.2.3&nbsp;Floating-Point Types (Approximate Value) - FLOAT, DOUBLE"><code class="literal">DOUBLE</code></a> or
                <a class="link" href="data-types.html#floating-point-types" title="11.2.3&nbsp;Floating-Point Types (Approximate Value) - FLOAT, DOUBLE"><code class="literal">REAL</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_BIT</code></td>
              <td><a class="link" href="data-types.html#bit-type" title="11.2.4&nbsp;Bit-Value Type - BIT"><code class="literal">BIT</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TIMESTAMP</code></td>
              <td><a class="link" href="data-types.html#datetime" title="11.3.1&nbsp;The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DATE</code></td>
              <td><a class="link" href="data-types.html#datetime" title="11.3.1&nbsp;The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATE</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TIME</code></td>
              <td><a class="link" href="data-types.html#time" title="11.3.2&nbsp;The TIME Type"><code class="literal">TIME</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DATETIME</code></td>
              <td><a class="link" href="data-types.html#datetime" title="11.3.1&nbsp;The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_YEAR</code></td>
              <td><a class="link" href="data-types.html#year" title="11.3.3&nbsp;The YEAR Type"><code class="literal">YEAR</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_STRING</code></td>
              <td><a class="link" href="data-types.html#char" title="11.4.1&nbsp;The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a> or
                <a class="link" href="data-types.html#binary-varbinary" title="11.4.2&nbsp;The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_VAR_STRING</code></td>
              <td><a class="link" href="data-types.html#char" title="11.4.1&nbsp;The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> or
                <a class="link" href="data-types.html#binary-varbinary" title="11.4.2&nbsp;The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_BLOB</code></td>
              <td><a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">BLOB</code></a> or
                <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">TEXT</code></a> field (use
                <code class="literal">max_length</code> to determine the maximum
                length)</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_SET</code></td>
              <td><a class="link" href="data-types.html#set" title="11.4.5&nbsp;The SET Type"><code class="literal">SET</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_ENUM</code></td>
              <td><a class="link" href="data-types.html#enum" title="11.4.4&nbsp;The ENUM Type"><code class="literal">ENUM</code></a> field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_GEOMETRY</code></td>
              <td>Spatial field</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_NULL</code></td>
              <td><code class="literal">NULL</code>-type field</td>
</tr></tbody></table>
</div>
<p>
          The <code class="literal">MYSQL_TYPE_TIME2</code>,
          <code class="literal">MYSQL_TYPE_DATETIME2</code>, and
          <code class="literal">MYSQL_TYPE_TIMESTAMP2</code>) type codes are used
          only on the server side. Clients see the
          <code class="literal">MYSQL_TYPE_TIME</code>,
          <code class="literal">MYSQL_TYPE_DATETIME</code>, and
          <code class="literal">MYSQL_TYPE_TIMESTAMP</code> codes.
        </p><p>
          You can use the <code class="literal">IS_NUM()</code> macro to test
          whether a field has a numeric type. Pass the
          <code class="literal">type</code> value to <code class="literal">IS_NUM()</code>
          and it evaluates to TRUE if the field is numeric:
        </p><pre data-lang="c" class="programlisting">if (IS_NUM(field-&gt;type))<font></font>
    printf("Field is numeric\n");<font></font>
</pre><p>
          <a class="link" href="data-types.html#enum" title="11.4.4&nbsp;The ENUM Type"><code class="literal">ENUM</code></a> and
          <a class="link" href="data-types.html#set" title="11.4.5&nbsp;The SET Type"><code class="literal">SET</code></a> values are returned as
          strings. For these, check that the <code class="literal">type</code>
          value is <code class="literal">MYSQL_TYPE_STRING</code> and that the
          <code class="literal">ENUM_FLAG</code> or <code class="literal">SET_FLAG</code>
          flag is set in the <code class="literal">flags</code> value.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-function-overview"></a>28.7.6&nbsp;C API Function Overview</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551585776"></a><a class="indexterm" name="idm140091551584288"></a><p>
      The following list summarizes the functions available in the C
      API. For greater detail, see the descriptions in
      <a class="xref" href="connectors-apis.html#c-api-functions" title="28.7.7&nbsp;C API Function Descriptions">Section&nbsp;28.7.7, “C API Function Descriptions”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/my-init.html" target="_top"><code class="literal">my_init()</code></a>: Initializes global
          variables and the thread handler in thread-safe programs.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a>: Returns
          the number of rows changed/deleted/inserted by the last
          <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a>,
          <a class="link" href="sql-syntax.html#delete" title="13.2.2&nbsp;DELETE Syntax"><code class="literal">DELETE</code></a>, or
          <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a> query.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-autocommit" title="28.7.7.2&nbsp;mysql_autocommit()"><code class="literal">mysql_autocommit()</code></a>: Toggles
          autocommit mode on/off.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-change-user" title="28.7.7.3&nbsp;mysql_change_user()"><code class="literal">mysql_change_user()</code></a>: Changes
          the user and database on an open connection.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-character-set-name" title="28.7.7.4&nbsp;mysql_character_set_name()"><code class="literal">mysql_character_set_name()</code></a>:
          Returns the default character set name for the current
          connection.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-client-find-plugin" title="28.7.17.1&nbsp;mysql_client_find_plugin()"><code class="literal">mysql_client_find_plugin()</code></a>:
          Returns a pointer to a plugin.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-client-register-plugin" title="28.7.17.2&nbsp;mysql_client_register_plugin()"><code class="literal">mysql_client_register_plugin()</code></a>:
          Registers a plugin.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-close" title="28.7.7.5&nbsp;mysql_close()"><code class="literal">mysql_close()</code></a>: Closes a server
          connection.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-commit" title="28.7.7.6&nbsp;mysql_commit()"><code class="literal">mysql_commit()</code></a>: Commits the
          transaction.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-connect" title="28.7.7.7&nbsp;mysql_connect()"><code class="literal">mysql_connect()</code></a>: Connects to a
          MySQL server. This function is deprecated; use
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> instead.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-create-db" title="28.7.7.8&nbsp;mysql_create_db()"><code class="literal">mysql_create_db()</code></a>: Creates a
          database. This function is deprecated; use the SQL statement
          <a class="link" href="sql-syntax.html#create-database" title="13.1.12&nbsp;CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a> instead.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-data-seek" title="28.7.7.9&nbsp;mysql_data_seek()"><code class="literal">mysql_data_seek()</code></a>: Seeks to an
          arbitrary row number in a query result set.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-debug" title="28.7.7.10&nbsp;mysql_debug()"><code class="literal">mysql_debug()</code></a>: Does a
          <code class="literal">DBUG_PUSH</code> with the given string.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-drop-db" title="28.7.7.11&nbsp;mysql_drop_db()"><code class="literal">mysql_drop_db()</code></a>: Drops a
          database. This function is deprecated; use the SQL statement
          <a class="link" href="sql-syntax.html#drop-database" title="13.1.24&nbsp;DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> instead.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-dump-debug-info" title="28.7.7.12&nbsp;mysql_dump_debug_info()"><code class="literal">mysql_dump_debug_info()</code></a>:
          Causes the server to write debug information to the log.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a>: Determines
          whether the last row of a result set has been read. This
          function is deprecated; use
          <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a> instead.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a>: Returns the
          error number for the most recently invoked MySQL function.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a>: Returns the
          error message for the most recently invoked MySQL function.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-escape-string" title="28.7.7.16&nbsp;mysql_escape_string()"><code class="literal">mysql_escape_string()</code></a>: Escapes
          special characters in a string for use in an SQL statement.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a>: Returns
          the type of the next table field.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-fetch-field-direct" title="28.7.7.18&nbsp;mysql_fetch_field_direct()"><code class="literal">mysql_fetch_field_direct()</code></a>:
          Returns the type of a table field, given a field number.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-fetch-fields" title="28.7.7.19&nbsp;mysql_fetch_fields()"><code class="literal">mysql_fetch_fields()</code></a>: Returns
          an array of all field structures.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-fetch-lengths" title="28.7.7.20&nbsp;mysql_fetch_lengths()"><code class="literal">mysql_fetch_lengths()</code></a>: Returns
          the lengths of all columns in the current row.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a>: Fetches the
          next row from the result set.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count()</code></a>: Returns
          the number of result columns for the most recent statement.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-field-seek" title="28.7.7.23&nbsp;mysql_field_seek()"><code class="literal">mysql_field_seek()</code></a>: Puts the
          column cursor on a specified column.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-field-tell" title="28.7.7.24&nbsp;mysql_field_tell()"><code class="literal">mysql_field_tell()</code></a>: Returns
          the position of the field cursor used for the last
          <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a>: Frees
          memory used by a result set.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-get-character-set-info" title="28.7.7.26&nbsp;mysql_get_character_set_info()"><code class="literal">mysql_get_character_set_info()</code></a>:
          Returns information about default character set.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-get-client-info" title="28.7.7.27&nbsp;mysql_get_client_info()"><code class="literal">mysql_get_client_info()</code></a>:
          Returns client version information as a string.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-get-client-version" title="28.7.7.28&nbsp;mysql_get_client_version()"><code class="literal">mysql_get_client_version()</code></a>:
          Returns client version information as an integer.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-get-host-info" title="28.7.7.29&nbsp;mysql_get_host_info()"><code class="literal">mysql_get_host_info()</code></a>: Returns
          a string describing the connection.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-get-option" title="28.7.7.30&nbsp;mysql_get_option()"><code class="literal">mysql_get_option()</code></a>: Returns
          the value of a <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a>
          option.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-get-proto-info" title="28.7.7.31&nbsp;mysql_get_proto_info()"><code class="literal">mysql_get_proto_info()</code></a>:
          Returns the protocol version used by the connection.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-get-server-info" title="28.7.7.32&nbsp;mysql_get_server_info()"><code class="literal">mysql_get_server_info()</code></a>:
          Returns the server version number.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-get-server-version" title="28.7.7.33&nbsp;mysql_get_server_version()"><code class="literal">mysql_get_server_version()</code></a>:
          Returns the server version number as an integer.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-get-ssl-cipher" title="28.7.7.34&nbsp;mysql_get_ssl_cipher()"><code class="literal">mysql_get_ssl_cipher()</code></a>:
          Returns the current SSL cipher.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-hex-string" title="28.7.7.35&nbsp;mysql_hex_string()"><code class="literal">mysql_hex_string()</code></a>: Encodes a
          string in hexadecimal format.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36&nbsp;mysql_info()"><code class="literal">mysql_info()</code></a>: Returns
          information about the most recently executed query.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>: Gets or
          initializes a <code class="literal">MYSQL</code> structure.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a>: Returns the
          ID generated for an <code class="literal">AUTO_INCREMENT</code> column
          by the previous query.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-kill" title="28.7.7.39&nbsp;mysql_kill()"><code class="literal">mysql_kill()</code></a>: Kills a given
          thread.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-library-end" title="28.7.7.40&nbsp;mysql_library_end()"><code class="literal">mysql_library_end()</code></a>: Finalizes
          the MySQL C API library.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>:
          Initializes the MySQL C API library.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-list-dbs" title="28.7.7.42&nbsp;mysql_list_dbs()"><code class="literal">mysql_list_dbs()</code></a>: Returns
          database names matching a simple regular expression.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-list-fields" title="28.7.7.43&nbsp;mysql_list_fields()"><code class="literal">mysql_list_fields()</code></a>: Returns
          field names matching a simple regular expression.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-list-processes" title="28.7.7.44&nbsp;mysql_list_processes()"><code class="literal">mysql_list_processes()</code></a>:
          Returns a list of the current server threads.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-list-tables" title="28.7.7.45&nbsp;mysql_list_tables()"><code class="literal">mysql_list_tables()</code></a>: Returns
          table names matching a simple regular expression.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-load-plugin" title="28.7.17.3&nbsp;mysql_load_plugin()"><code class="literal">mysql_load_plugin()</code></a>: Loads a
          plugin.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-load-plugin-v" title="28.7.17.4&nbsp;mysql_load_plugin_v()"><code class="literal">mysql_load_plugin_v()</code></a>: Loads a
          plugin.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-more-results" title="28.7.7.46&nbsp;mysql_more_results()"><code class="literal">mysql_more_results()</code></a>: Checks
          whether any more results exist.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a>:
          Returns/initiates the next result in multiple-result
          executions.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-num-fields" title="28.7.7.48&nbsp;mysql_num_fields()"><code class="literal">mysql_num_fields()</code></a>: Returns
          the number of columns in a result set.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49&nbsp;mysql_num_rows()"><code class="literal">mysql_num_rows()</code></a>: Returns the
          number of rows in a result set.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a>: Sets connect
          options for
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-options4" title="28.7.7.51&nbsp;mysql_options4()"><code class="literal">mysql_options4()</code></a>: Sets connect
          options for
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52&nbsp;mysql_ping()"><code class="literal">mysql_ping()</code></a>: Checks whether
          the connection to the server is working, reconnecting as
          necessary.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-plugin-options" title="28.7.17.5&nbsp;mysql_plugin_options()"><code class="literal">mysql_plugin_options()</code></a>: Sets a
          plugin option.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a>: Executes an SQL
          query specified as a null-terminated string.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>: Connects
          to a MySQL server.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-real-escape-string" title="28.7.7.55&nbsp;mysql_real_escape_string()"><code class="literal">mysql_real_escape_string()</code></a>:
          Escapes special characters in a string for use in an SQL
          statement, taking into account the current character set of
          the connection.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56&nbsp;mysql_real_escape_string_quote()"><code class="literal">mysql_real_escape_string_quote()</code></a>:
          Escapes special characters in a string for use in an SQL
          statement, taking into account the current character set of
          the connection and the quoting context.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57&nbsp;mysql_real_query()"><code class="literal">mysql_real_query()</code></a>: Executes
          an SQL query specified as a counted string.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-refresh" title="28.7.7.58&nbsp;mysql_refresh()"><code class="literal">mysql_refresh()</code></a>: Flushes or
          resets tables and caches.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-reload" title="28.7.7.59&nbsp;mysql_reload()"><code class="literal">mysql_reload()</code></a>: Tells the
          server to reload the grant tables.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-reset-connection" title="28.7.7.60&nbsp;mysql_reset_connection()"><code class="literal">mysql_reset_connection()</code></a>:
          Resets the connection to clear session state.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-reset-server-public-key" title="28.7.7.61&nbsp;mysql_reset_server_public_key()"><code class="literal">mysql_reset_server_public_key()</code></a>:
          Clears a cached RSA public key from the client library.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62&nbsp;mysql_result_metadata()"><code class="literal">mysql_result_metadata()</code></a>:
          Whether a result set has metadata.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-rollback" title="28.7.7.63&nbsp;mysql_rollback()"><code class="literal">mysql_rollback()</code></a>: Rolls back
          the transaction.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-row-seek" title="28.7.7.64&nbsp;mysql_row_seek()"><code class="literal">mysql_row_seek()</code></a>: Seeks to a
          row offset in a result set, using value returned from
          <a class="link" href="connectors-apis.html#mysql-row-tell" title="28.7.7.65&nbsp;mysql_row_tell()"><code class="literal">mysql_row_tell()</code></a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-row-tell" title="28.7.7.65&nbsp;mysql_row_tell()"><code class="literal">mysql_row_tell()</code></a>: Returns the
          row cursor position.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-select-db" title="28.7.7.66&nbsp;mysql_select_db()"><code class="literal">mysql_select_db()</code></a>: Selects a
          database.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-server-end" title="28.7.7.67&nbsp;mysql_server_end()"><code class="literal">mysql_server_end()</code></a>: Finalizes
          the MySQL C API library.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-server-init" title="28.7.7.68&nbsp;mysql_server_init()"><code class="literal">mysql_server_init()</code></a>:
          Initializes the MySQL C API library.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69&nbsp;mysql_session_track_get_first()"><code class="literal">mysql_session_track_get_first()</code></a>:
          Gets the first part of session state-change information.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-session-track-get-next" title="28.7.7.70&nbsp;mysql_session_track_get_next()"><code class="literal">mysql_session_track_get_next()</code></a>:
          Gets the next part of session state-change information.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-set-character-set" title="28.7.7.71&nbsp;mysql_set_character_set()"><code class="literal">mysql_set_character_set()</code></a>:
          Sets the default character set for the current connection.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-set-local-infile-default" title="28.7.7.72&nbsp;mysql_set_local_infile_default()"><code class="literal">mysql_set_local_infile_default()</code></a>:
          Sets the <a class="link" href="sql-syntax.html#load-data" title="13.2.7&nbsp;LOAD DATA Syntax"><code class="literal">LOAD DATA
          LOCAL</code></a> handler callbacks to their default values.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-set-local-infile-handler" title="28.7.7.73&nbsp;mysql_set_local_infile_handler()"><code class="literal">mysql_set_local_infile_handler()</code></a>:
          Installs application-specific
          <a class="link" href="sql-syntax.html#load-data" title="13.2.7&nbsp;LOAD DATA Syntax"><code class="literal">LOAD DATA
          LOCAL</code></a> handler callbacks.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-set-server-option" title="28.7.7.74&nbsp;mysql_set_server_option()"><code class="literal">mysql_set_server_option()</code></a>:
          Sets an option for the connection (like
          <code class="literal">multi-statements</code>).
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76&nbsp;mysql_sqlstate()"><code class="literal">mysql_sqlstate()</code></a>: Returns the
          SQLSTATE error code for the last error.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-shutdown" title="28.7.7.75&nbsp;mysql_shutdown()"><code class="literal">mysql_shutdown()</code></a>: Shuts down
          the database server.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77&nbsp;mysql_ssl_set()"><code class="literal">mysql_ssl_set()</code></a>: Prepares to
          establish an SSL connection to the server.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stat" title="28.7.7.78&nbsp;mysql_stat()"><code class="literal">mysql_stat()</code></a>: Returns the
          server status as a string.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>:
          Retrieves a complete result set to the client.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-thread-end" title="28.7.16.1&nbsp;mysql_thread_end()"><code class="literal">mysql_thread_end()</code></a>: Finalizes
          a thread handler.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-thread-id" title="28.7.7.80&nbsp;mysql_thread_id()"><code class="literal">mysql_thread_id()</code></a>: Returns the
          current thread ID.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-thread-init" title="28.7.16.2&nbsp;mysql_thread_init()"><code class="literal">mysql_thread_init()</code></a>:
          Initializes a thread handler.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-thread-safe" title="28.7.16.3&nbsp;mysql_thread_safe()"><code class="literal">mysql_thread_safe()</code></a>: Returns 1
          if the clients are compiled as thread-safe.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>: Initiates
          a row-by-row result set retrieval.
        </p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-warning-count" title="28.7.7.82&nbsp;mysql_warning_count()"><code class="literal">mysql_warning_count()</code></a>: Returns
          the warning count for the previous SQL statement.
</p></li></ul>
</div>
<p>
      Application programs should use this general outline for
      interacting with MySQL:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Initialize the MySQL client library by calling
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>.
        </p></li><li class="listitem"><p>
          Initialize a connection handler by calling
          <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a> and connect to
          the server by calling
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>.
        </p></li><li class="listitem"><p>
          Issue SQL statements and process their results. (The following
          discussion provides more information about how to do this.)
        </p></li><li class="listitem"><p>
          Close the connection to the MySQL server by calling
          <a class="link" href="connectors-apis.html#mysql-close" title="28.7.7.5&nbsp;mysql_close()"><code class="literal">mysql_close()</code></a>.
        </p></li><li class="listitem"><p>
          End use of the MySQL client library by calling
          <a class="link" href="connectors-apis.html#mysql-library-end" title="28.7.7.40&nbsp;mysql_library_end()"><code class="literal">mysql_library_end()</code></a>.
</p></li></ol>
</div>
<p>
      The purpose of calling
      <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> and
      <a class="link" href="connectors-apis.html#mysql-library-end" title="28.7.7.40&nbsp;mysql_library_end()"><code class="literal">mysql_library_end()</code></a> is to provide
      proper initialization and finalization of the MySQL client
      library. For applications that are linked with the client library,
      they provide improved memory management. If you do not call
      <a class="link" href="connectors-apis.html#mysql-library-end" title="28.7.7.40&nbsp;mysql_library_end()"><code class="literal">mysql_library_end()</code></a>, a block of
      memory remains allocated. (This does not increase the amount of
      memory used by the application, but some memory leak detectors
      will complain about it.)
    </p><p>
      In a nonmultithreaded environment, the call to
      <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> may be
      omitted, because <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a> will
      invoke it automatically as necessary. However,
      <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> is not
      thread-safe in a multithreaded environment, and thus neither is
      <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>, which calls
      <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>. You must
      either call <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>
      prior to spawning any threads, or else use a mutex to protect the
      call, whether you invoke
      <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> or indirectly
      through <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>. This should
      be done prior to any other client library call.
    </p><p>
      To connect to the server, call
      <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a> to initialize a
      connection handler, then call
      <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> with that
      handler (along with other information such as the host name, user
      name, and password). Upon connection,
      <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> sets the
      <code class="literal">reconnect</code> flag (part of the
      <code class="literal">MYSQL</code> structure) to a value of
      <code class="literal">1</code> in versions of the API older than 5.0.3, or
      <code class="literal">0</code> in newer versions. A value of
      <code class="literal">1</code> for this flag indicates that if a statement
      cannot be performed because of a lost connection, to try
      reconnecting to the server before giving up. You can use the
      <code class="literal">MYSQL_OPT_RECONNECT</code> option to
      <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a> to control
      reconnection behavior. When you are done with the connection, call
      <a class="link" href="connectors-apis.html#mysql-close" title="28.7.7.5&nbsp;mysql_close()"><code class="literal">mysql_close()</code></a> to terminate it. Do
      not use the handler after it has been closed.
    </p><p>
      While a connection is active, the client may send SQL statements
      to the server using <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a>
      or <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57&nbsp;mysql_real_query()"><code class="literal">mysql_real_query()</code></a>. The
      difference between the two is that
      <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> expects the query to
      be specified as a null-terminated string whereas
      <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57&nbsp;mysql_real_query()"><code class="literal">mysql_real_query()</code></a> expects a
      counted string. If the string contains binary data (which may
      include null bytes), you must use
      <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57&nbsp;mysql_real_query()"><code class="literal">mysql_real_query()</code></a>.
    </p><p>
      For each non-<a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> query (for
      example, <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a>,
      <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a>,
      <a class="link" href="sql-syntax.html#delete" title="13.2.2&nbsp;DELETE Syntax"><code class="literal">DELETE</code></a>), you can find out how many
      rows were changed (affected) by calling
      <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a>.
    </p><p>
      For <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> queries, you retrieve
      the selected rows as a result set. (Note that some statements are
      <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a>-like in that they return
      rows. These include <a class="link" href="sql-syntax.html#show" title="13.7.6&nbsp;SHOW Syntax"><code class="literal">SHOW</code></a>,
      <a class="link" href="sql-syntax.html#describe" title="13.8.1&nbsp;DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a>, and
      <a class="link" href="sql-syntax.html#explain" title="13.8.2&nbsp;EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>. Treat these statements the
      same way as <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> statements.)
    </p><p>
      There are two ways for a client to process result sets. One way is
      to retrieve the entire result set all at once by calling
      <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>. This
      function acquires from the server all the rows returned by the
      query and stores them in the client. The second way is for the
      client to initiate a row-by-row result set retrieval by calling
      <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>. This function
      initializes the retrieval, but does not actually get any rows from
      the server.
    </p><p>
      In both cases, you access rows by calling
      <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a>. With
      <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>,
      <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> accesses rows
      that have previously been fetched from the server. With
      <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>,
      <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> actually
      retrieves the row from the server. Information about the size of
      the data in each row is available by calling
      <a class="link" href="connectors-apis.html#mysql-fetch-lengths" title="28.7.7.20&nbsp;mysql_fetch_lengths()"><code class="literal">mysql_fetch_lengths()</code></a>.
    </p><p>
      After you are done with a result set, call
      <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a> to free the
      memory used for it.
    </p><p>
      The two retrieval mechanisms are complementary. Choose the
      approach that is most appropriate for each client application. In
      practice, clients tend to use
      <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> more
      commonly.
    </p><p>
      An advantage of
      <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> is that
      because the rows have all been fetched to the client, you not only
      can access rows sequentially, you can move back and forth in the
      result set using <a class="link" href="connectors-apis.html#mysql-data-seek" title="28.7.7.9&nbsp;mysql_data_seek()"><code class="literal">mysql_data_seek()</code></a>
      or <a class="link" href="connectors-apis.html#mysql-row-seek" title="28.7.7.64&nbsp;mysql_row_seek()"><code class="literal">mysql_row_seek()</code></a> to change the
      current row position within the result set. You can also find out
      how many rows there are by calling
      <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49&nbsp;mysql_num_rows()"><code class="literal">mysql_num_rows()</code></a>. On the other
      hand, the memory requirements for
      <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> may be very
      high for large result sets and you are more likely to encounter
      out-of-memory conditions.
    </p><p>
      An advantage of <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>
      is that the client requires less memory for the result set because
      it maintains only one row at a time (and because there is less
      allocation overhead,
      <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a> can be faster).
      Disadvantages are that you must process each row quickly to avoid
      tying up the server, you do not have random access to rows within
      the result set (you can only access rows sequentially), and the
      number of rows in the result set is unknown until you have
      retrieved them all. Furthermore, you <span class="emphasis"><em>must</em></span>
      retrieve all the rows even if you determine in mid-retrieval that
      you've found the information you were looking for.
    </p><p>
      The API makes it possible for clients to respond appropriately to
      statements (retrieving rows only as necessary) without knowing
      whether the statement is a <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a>.
      You can do this by calling
      <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> after each
      <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> (or
      <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57&nbsp;mysql_real_query()"><code class="literal">mysql_real_query()</code></a>). If the result
      set call succeeds, the statement was a
      <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> and you can read the rows.
      If the result set call fails, call
      <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count()</code></a> to determine
      whether a result was actually to be expected. If
      <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count()</code></a> returns zero,
      the statement returned no data (indicating that it was an
      <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a>,
      <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a>,
      <a class="link" href="sql-syntax.html#delete" title="13.2.2&nbsp;DELETE Syntax"><code class="literal">DELETE</code></a>, and so forth), and was not
      expected to return rows. If
      <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count()</code></a> is nonzero,
      the statement should have returned rows, but did not. This
      indicates that the statement was a
      <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> that failed. See the
      description for
      <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count()</code></a> for an example
      of how this can be done.
    </p><p>
      Both <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> and
      <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a> enable you to
      obtain information about the fields that make up the result set
      (the number of fields, their names and types, and so forth). You
      can access field information sequentially within the row by
      calling <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a>
      repeatedly, or by field number within the row by calling
      <a class="link" href="connectors-apis.html#mysql-fetch-field-direct" title="28.7.7.18&nbsp;mysql_fetch_field_direct()"><code class="literal">mysql_fetch_field_direct()</code></a>. The
      current field cursor position may be changed by calling
      <a class="link" href="connectors-apis.html#mysql-field-seek" title="28.7.7.23&nbsp;mysql_field_seek()"><code class="literal">mysql_field_seek()</code></a>. Setting the
      field cursor affects subsequent calls to
      <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a>. You can also
      get information for fields all at once by calling
      <a class="link" href="connectors-apis.html#mysql-fetch-fields" title="28.7.7.19&nbsp;mysql_fetch_fields()"><code class="literal">mysql_fetch_fields()</code></a>.
    </p><p>
      For detecting and reporting errors, MySQL provides access to error
      information by means of the
      <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> and
      <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a> functions. These
      return the error code or error message for the most recently
      invoked function that can succeed or fail, enabling you to
      determine when an error occurred and what it was.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-functions"></a>28.7.7&nbsp;C API Function Descriptions</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#mysql-affected-rows">28.7.7.1 mysql_affected_rows()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-autocommit">28.7.7.2 mysql_autocommit()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-change-user">28.7.7.3 mysql_change_user()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-character-set-name">28.7.7.4 mysql_character_set_name()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-close">28.7.7.5 mysql_close()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-commit">28.7.7.6 mysql_commit()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-connect">28.7.7.7 mysql_connect()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-create-db">28.7.7.8 mysql_create_db()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-data-seek">28.7.7.9 mysql_data_seek()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-debug">28.7.7.10 mysql_debug()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-drop-db">28.7.7.11 mysql_drop_db()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-dump-debug-info">28.7.7.12 mysql_dump_debug_info()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-eof">28.7.7.13 mysql_eof()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-errno">28.7.7.14 mysql_errno()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-error">28.7.7.15 mysql_error()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-escape-string">28.7.7.16 mysql_escape_string()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-fetch-field">28.7.7.17 mysql_fetch_field()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-fetch-field-direct">28.7.7.18 mysql_fetch_field_direct()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-fetch-fields">28.7.7.19 mysql_fetch_fields()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-fetch-lengths">28.7.7.20 mysql_fetch_lengths()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-fetch-row">28.7.7.21 mysql_fetch_row()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-field-count">28.7.7.22 mysql_field_count()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-field-seek">28.7.7.23 mysql_field_seek()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-field-tell">28.7.7.24 mysql_field_tell()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-free-result">28.7.7.25 mysql_free_result()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-get-character-set-info">28.7.7.26 mysql_get_character_set_info()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-get-client-info">28.7.7.27 mysql_get_client_info()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-get-client-version">28.7.7.28 mysql_get_client_version()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-get-host-info">28.7.7.29 mysql_get_host_info()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-get-option">28.7.7.30 mysql_get_option()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-get-proto-info">28.7.7.31 mysql_get_proto_info()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-get-server-info">28.7.7.32 mysql_get_server_info()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-get-server-version">28.7.7.33 mysql_get_server_version()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-get-ssl-cipher">28.7.7.34 mysql_get_ssl_cipher()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-hex-string">28.7.7.35 mysql_hex_string()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-info">28.7.7.36 mysql_info()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-init">28.7.7.37 mysql_init()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-insert-id">28.7.7.38 mysql_insert_id()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-kill">28.7.7.39 mysql_kill()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-library-end">28.7.7.40 mysql_library_end()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-library-init">28.7.7.41 mysql_library_init()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-list-dbs">28.7.7.42 mysql_list_dbs()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-list-fields">28.7.7.43 mysql_list_fields()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-list-processes">28.7.7.44 mysql_list_processes()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-list-tables">28.7.7.45 mysql_list_tables()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-more-results">28.7.7.46 mysql_more_results()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-next-result">28.7.7.47 mysql_next_result()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-num-fields">28.7.7.48 mysql_num_fields()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-num-rows">28.7.7.49 mysql_num_rows()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-options">28.7.7.50 mysql_options()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-options4">28.7.7.51 mysql_options4()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-ping">28.7.7.52 mysql_ping()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-query">28.7.7.53 mysql_query()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-real-connect">28.7.7.54 mysql_real_connect()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-real-escape-string">28.7.7.55 mysql_real_escape_string()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-real-escape-string-quote">28.7.7.56 mysql_real_escape_string_quote()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-real-query">28.7.7.57 mysql_real_query()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-refresh">28.7.7.58 mysql_refresh()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-reload">28.7.7.59 mysql_reload()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-reset-connection">28.7.7.60 mysql_reset_connection()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-reset-server-public-key">28.7.7.61 mysql_reset_server_public_key()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-result-metadata">28.7.7.62 mysql_result_metadata()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-rollback">28.7.7.63 mysql_rollback()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-row-seek">28.7.7.64 mysql_row_seek()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-row-tell">28.7.7.65 mysql_row_tell()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-select-db">28.7.7.66 mysql_select_db()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-server-end">28.7.7.67 mysql_server_end()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-server-init">28.7.7.68 mysql_server_init()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-session-track-get-first">28.7.7.69 mysql_session_track_get_first()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-session-track-get-next">28.7.7.70 mysql_session_track_get_next()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-set-character-set">28.7.7.71 mysql_set_character_set()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-set-local-infile-default">28.7.7.72 mysql_set_local_infile_default()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-set-local-infile-handler">28.7.7.73 mysql_set_local_infile_handler()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-set-server-option">28.7.7.74 mysql_set_server_option()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-shutdown">28.7.7.75 mysql_shutdown()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-sqlstate">28.7.7.76 mysql_sqlstate()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-ssl-set">28.7.7.77 mysql_ssl_set()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stat">28.7.7.78 mysql_stat()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-store-result">28.7.7.79 mysql_store_result()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-thread-id">28.7.7.80 mysql_thread_id()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-use-result">28.7.7.81 mysql_use_result()</a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-warning-count">28.7.7.82 mysql_warning_count()</a></span></dt></dl>
</div>
<p>
      This section describes C API functions other than those used for
      prepared statements, the asychronous interface, or the replication
      stream interface. For information about those, see
      <a class="xref" href="connectors-apis.html#c-api-prepared-statement-functions" title="28.7.11&nbsp;C API Prepared Statement Function Descriptions">Section&nbsp;28.7.11, “C API Prepared Statement Function Descriptions”</a>,
      <a class="xref" href="connectors-apis.html#c-api-asynchronous-functions" title="28.7.15&nbsp;C API Asynchronous Function Descriptions">Section&nbsp;28.7.15, “C API Asynchronous Function Descriptions”</a>, and
      <a class="xref" href="connectors-apis.html#c-api-binary-log-functions" title="28.7.21&nbsp;C API Binary Log Function Descriptions">Section&nbsp;28.7.21, “C API Binary Log Function Descriptions”</a>.
    </p><p>
      In the descriptions here, a parameter or return value of
      <code class="literal">NULL</code> means <code class="literal">NULL</code> in the sense
      of the C programming language, not a MySQL <code class="literal">NULL</code>
      value.
    </p><p>
      Functions that return a value generally return a pointer or an
      integer. Unless specified otherwise, functions returning a pointer
      return a non-<code class="literal">NULL</code> value to indicate success or
      a <code class="literal">NULL</code> value to indicate an error, and
      functions returning an integer return zero to indicate success or
      nonzero to indicate an error. Note that <span class="quote">“<span class="quote">nonzero</span>”</span>
      means just that. Unless the function description says otherwise,
      do not test against a value other than zero:
    </p><pre data-lang="c" class="programlisting">if (result)                   /* correct */<font></font>
    ... error ...<font></font>
<font></font>
if (result &lt; 0)               /* incorrect */<font></font>
    ... error ...<font></font>
<font></font>
if (result == -1)             /* incorrect */<font></font>
    ... error ...<font></font>
</pre><p>
      When a function returns an error, the
      <span class="bold"><strong>Errors</strong></span> subsection of the function
      description lists the possible types of errors. You can find out
      which of these occurred by calling
      <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a>. A string
      representation of the error may be obtained by calling
      <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-affected-rows"></a>28.7.7.1&nbsp;mysql_affected_rows()</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091551231344"></a><p>
        <code class="literal">my_ulonglong mysql_affected_rows(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-affected-rows-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> may be
          called immediately after executing a statement with
          <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57&nbsp;mysql_real_query()"><code class="literal">mysql_real_query()</code></a>. It returns
          the number of rows changed, deleted, or inserted by the last
          statement if it was an <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a>,
          <a class="link" href="sql-syntax.html#delete" title="13.2.2&nbsp;DELETE Syntax"><code class="literal">DELETE</code></a>, or
          <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a>. For
          <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> statements,
          <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> works
          like <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49&nbsp;mysql_num_rows()"><code class="literal">mysql_num_rows()</code></a>.
        </p><p>
          For <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a> statements, the
          affected-rows value by default is the number of rows actually
          changed. If you specify the
          <code class="literal">CLIENT_FOUND_ROWS</code> flag to
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> when
          connecting to <a class="link" href="programs.html#mysqld" title="4.3.1&nbsp;mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>, the affected-rows
          value is the number of rows <span class="quote">“<span class="quote">found</span>”</span>; that is,
          matched by the <code class="literal">WHERE</code> clause.
        </p><p>
          For <a class="link" href="sql-syntax.html#replace" title="13.2.9&nbsp;REPLACE Syntax"><code class="literal">REPLACE</code></a> statements, the
          affected-rows value is 2 if the new row replaced an old row,
          because in this case, one row was inserted after the duplicate
          was deleted.
        </p><p>
          For
          <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2&nbsp;INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT
          ... ON DUPLICATE KEY UPDATE</code></a> statements, the
          affected-rows value per row is 1 if the row is inserted as a
          new row, 2 if an existing row is updated, and 0 if an existing
          row is set to its current values. If you specify the
          <code class="literal">CLIENT_FOUND_ROWS</code> flag, the affected-rows
          value is 1 (not 0) if an existing row is set to its current
          values.
        </p><p>
          Following a <a class="link" href="sql-syntax.html#call" title="13.2.1&nbsp;CALL Syntax"><code class="literal">CALL</code></a> statement for
          a stored procedure,
          <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> returns
          the value that it would return for the last statement executed
          within the procedure, or <code class="literal">0</code> if that
          statement would return <code class="literal">-1</code>. Within the
          procedure, you can use
          <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> at the SQL level to
          obtain the affected-rows value for individual statements.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> returns
          a meaningful value for a wide range of statements. For
          details, see the description for
          <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> in
          <a class="xref" href="functions.html#information-functions" title="12.15&nbsp;Information Functions">Section&nbsp;12.15, “Information Functions”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-affected-rows-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An integer greater than zero indicates the number of rows
          affected or retrieved. Zero indicates that no records were
          updated for an <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a>
          statement, no rows matched the <code class="literal">WHERE</code> clause
          in the query or that no query has yet been executed. -1
          indicates that the query returned an error or that, for a
          <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> query,
          <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> was
          called prior to calling
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>.
        </p><p>
          Because <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a>
          returns an unsigned value, you can check for -1 by comparing
          the return value to <code class="literal">(my_ulonglong)-1</code> (or to
          <code class="literal">(my_ulonglong)~0</code>, which is equivalent).
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-affected-rows-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-affected-rows-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">char *stmt = "UPDATE products SET cost=cost*1.25<font></font>
              WHERE group=10";<font></font>
mysql_query(&amp;mysql,stmt);<font></font>
printf("%ld products updated",<font></font>
       (long) mysql_affected_rows(&amp;mysql));<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-autocommit"></a>28.7.7.2&nbsp;mysql_autocommit()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551179168"></a><p>
        <code class="literal">bool mysql_autocommit(MYSQL *mysql, bool
        mode)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-autocommit-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Sets autocommit mode on if <code class="literal">mode</code> is 1, off
          if <code class="literal">mode</code> is 0.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-autocommit-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-autocommit-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-change-user"></a>28.7.7.3&nbsp;mysql_change_user()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551169296"></a><p>
        <code class="literal">bool mysql_change_user(MYSQL *mysql, const char *user,
        const char *password, const char *db)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-change-user-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Changes the user and causes the database specified by
          <code class="literal">db</code> to become the default (current) database
          on the connection specified by <code class="literal">mysql</code>. In
          subsequent queries, this database is the default for table
          references that include no explicit database specifier.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-change-user" title="28.7.7.3&nbsp;mysql_change_user()"><code class="literal">mysql_change_user()</code></a> fails if
          the connected user cannot be authenticated or does not have
          permission to use the database. In this case, the user and
          database are not changed.
        </p><p>
          Pass a <code class="literal">db</code> parameter of
          <code class="literal">NULL</code> if you do not want to have a default
          database.
        </p><p>
          This function resets the session state as if one had done a
          new connect and reauthenticated. (See
          <a class="xref" href="connectors-apis.html#c-api-auto-reconnect" title="28.7.28&nbsp;C API Automatic Reconnection Control">Section&nbsp;28.7.28, “C API Automatic Reconnection Control”</a>.) It always performs a
          <a class="link" href="sql-syntax.html#commit" title="13.3.1&nbsp;START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a> of
          any active transactions, closes and drops all temporary
          tables, and unlocks all locked tables. Session system
          variables are reset to the values of the corresponding global
          system variables. Prepared statements are released and
          <a class="link" href="sql-syntax.html#handler" title="13.2.4&nbsp;HANDLER Syntax"><code class="literal">HANDLER</code></a> variables are closed.
          Locks acquired with <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a>
          are released. These effects occur even if the user did not
          change.
        </p><p>
          To reset the connection state in a more lightweight manner
          without changing the user, use
          <a class="link" href="connectors-apis.html#mysql-reset-connection" title="28.7.7.60&nbsp;mysql_reset_connection()"><code class="literal">mysql_reset_connection()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-change-user-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-change-user-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          The same that you can get from
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>, plus:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_er_unknown_com_error"><code class="literal">ER_UNKNOWN_COM_ERROR</code></a>
            </p><p>
              The MySQL server does not implement this command (probably
              an old server).
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_er_access_denied_error"><code class="literal">ER_ACCESS_DENIED_ERROR</code></a>
            </p><p>
              The user or password was wrong.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_er_bad_db_error"><code class="literal">ER_BAD_DB_ERROR</code></a>
            </p><p>
              The database did not exist.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_er_dbaccess_denied_error"><code class="literal">ER_DBACCESS_DENIED_ERROR</code></a>
            </p><p>
              The user did not have access rights to the database.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_er_wrong_db_name"><code class="literal">ER_WRONG_DB_NAME</code></a>
            </p><p>
              The database name was too long.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-change-user-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">if (mysql_change_user(&amp;mysql, "user", "<em class="replaceable"><code>password</code></em>", "new_database"))<font></font>
{<font></font>
   fprintf(stderr, "Failed to change user.  Error: %s\n",<font></font>
           mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-character-set-name"></a>28.7.7.4&nbsp;mysql_character_set_name()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551120048"></a><p>
        <code class="literal">const char *mysql_character_set_name(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-character-set-name-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the default character set name for the current
          connection.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-character-set-name-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          The default character set name
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-character-set-name-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-close"></a>28.7.7.5&nbsp;mysql_close()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551111488"></a><p>
        <code class="literal">void mysql_close(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-close-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Closes a previously opened connection.
          <a class="link" href="connectors-apis.html#mysql-close" title="28.7.7.5&nbsp;mysql_close()"><code class="literal">mysql_close()</code></a> also deallocates
          the connection handler pointed to by <code class="literal">mysql</code>
          if the handler was allocated automatically by
          <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-connect" title="28.7.7.7&nbsp;mysql_connect()"><code class="literal">mysql_connect()</code></a>. Do not use
          the handler after it has been closed.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-close-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-close-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-commit"></a>28.7.7.6&nbsp;mysql_commit()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551098464"></a><p>
        <code class="literal">bool mysql_commit(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-commit-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Commits the current transaction.
        </p><p>
          The action of this function is subject to the value of the
          <a class="link" href="server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a> system
          variable. In particular, if the value of
          <a class="link" href="server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a> is
          <code class="literal">RELEASE</code> (or 2), the server performs a
          release after terminating a transaction and closes the client
          connection. Call <a class="link" href="connectors-apis.html#mysql-close" title="28.7.7.5&nbsp;mysql_close()"><code class="literal">mysql_close()</code></a>
          from the client program to close the connection from the
          client side.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-commit-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-commit-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-connect"></a>28.7.7.7&nbsp;mysql_connect()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551084880"></a><p>
        <code class="literal">MYSQL *mysql_connect(MYSQL *mysql, const char *host,
        const char *user, const char *passwd)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-connect-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          This function is deprecated. Use
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> instead.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-connect" title="28.7.7.7&nbsp;mysql_connect()"><code class="literal">mysql_connect()</code></a> attempts to
          establish a connection to a MySQL database engine running on
          <code class="literal">host</code>.
          <a class="link" href="connectors-apis.html#mysql-connect" title="28.7.7.7&nbsp;mysql_connect()"><code class="literal">mysql_connect()</code></a> must complete
          successfully before you can execute any of the other API
          functions, with the exception of
          <a class="link" href="connectors-apis.html#mysql-get-client-info" title="28.7.7.27&nbsp;mysql_get_client_info()"><code class="literal">mysql_get_client_info()</code></a>.
        </p><p>
          The meanings of the parameters are the same as for the
          corresponding parameters for
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> with the
          difference that the connection parameter may be
          <code class="literal">NULL</code>. In this case, the C API allocates
          memory for the connection structure automatically and frees it
          when you call <a class="link" href="connectors-apis.html#mysql-close" title="28.7.7.5&nbsp;mysql_close()"><code class="literal">mysql_close()</code></a>.
          The disadvantage of this approach is that you cannot retrieve
          an error message if the connection fails. (To get error
          information from <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a>
          or <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a>, you must
          provide a valid <code class="literal">MYSQL</code> pointer.)
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-connect-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Same as for
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-connect-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          Same as for
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-create-db"></a>28.7.7.8&nbsp;mysql_create_db()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551059712"></a><p>
        <code class="literal">int mysql_create_db(MYSQL *mysql, const char
        *db)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-create-db-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Creates the database named by the <code class="literal">db</code>
          parameter.
        </p><p>
          This function is deprecated. Use
          <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> to issue an SQL
          <a class="link" href="sql-syntax.html#create-database" title="13.1.12&nbsp;CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a> statement
          instead.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-create-db-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-create-db-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-create-db-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">if(mysql_create_db(&amp;mysql, "my_database"))<font></font>
{<font></font>
   fprintf(stderr, "Failed to create new database.  Error: %s\n",<font></font>
           mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-data-seek"></a>28.7.7.9&nbsp;mysql_data_seek()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551034656"></a><p>
        <code class="literal">void mysql_data_seek(MYSQL_RES *result, my_ulonglong
        offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-data-seek-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Seeks to an arbitrary row in a query result set. The
          <code class="literal">offset</code> value is a row number. Specify a
          value in the range from <code class="literal">0</code> to
          <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49&nbsp;mysql_num_rows()"><code class="literal">mysql_num_rows(result)-1</code></a>.
        </p><p>
          This function requires that the result set structure contains
          the entire result of the query, so
          <a class="link" href="connectors-apis.html#mysql-data-seek" title="28.7.7.9&nbsp;mysql_data_seek()"><code class="literal">mysql_data_seek()</code></a> may be used
          only in conjunction with
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>, not with
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-data-seek-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-data-seek-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-debug"></a>28.7.7.10&nbsp;mysql_debug()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551019248"></a><p>
        <code class="literal">void mysql_debug(const char *debug)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-debug-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Does a <code class="literal">DBUG_PUSH</code> with the given string.
          <a class="link" href="connectors-apis.html#mysql-debug" title="28.7.7.10&nbsp;mysql_debug()"><code class="literal">mysql_debug()</code></a> uses the Fred
          Fish debug library. To use this function, you must compile the
          client library to support debugging. See
          <a class="xref" href="extending-mysql.html#dbug-package" title="29.5.4&nbsp;The DBUG Package">Section&nbsp;29.5.4, “The DBUG Package”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-debug-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-debug-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-debug-example"></a>Example</h5>

</div>

</div>

</div>
<p>
          The call shown here causes the client library to generate a
          trace file in <code class="filename">/tmp/client.trace</code> on the
          client machine:
        </p><pre data-lang="c" class="programlisting">mysql_debug("d:t:O,/tmp/client.trace");
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-drop-db"></a>28.7.7.11&nbsp;mysql_drop_db()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091551004816"></a><p>
        <code class="literal">int mysql_drop_db(MYSQL *mysql, const char
        *db)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-drop-db-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Drops the database named by the <code class="literal">db</code>
          parameter.
        </p><p>
          This function is deprecated. Use
          <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> to issue an SQL
          <a class="link" href="sql-syntax.html#drop-database" title="13.1.24&nbsp;DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> statement
          instead.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-drop-db-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-drop-db-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-drop-db-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">if(mysql_drop_db(&amp;mysql, "my_database"))<font></font>
  fprintf(stderr, "Failed to drop the database: Error: %s\n",<font></font>
          mysql_error(&amp;mysql));<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-dump-debug-info"></a>28.7.7.12&nbsp;mysql_dump_debug_info()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550979680"></a><p>
        <code class="literal">int mysql_dump_debug_info(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-dump-debug-info-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Instructs the server to write debugging information to the
          error log. The connected user must have the
          <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-dump-debug-info-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-dump-debug-info-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-eof"></a>28.7.7.13&nbsp;mysql_eof()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550959216"></a><p>
        <code class="literal">bool mysql_eof(MYSQL_RES *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-eof-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          This function is deprecated.
          <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a> may be used
          instead.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a> determines whether
          the last row of a result set has been read.
        </p><p>
          If you acquire a result set from a successful call to
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>, the
          client receives the entire set in one operation. In this case,
          a <code class="literal">NULL</code> return from
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> always means
          the end of the result set has been reached and it is
          unnecessary to call
          <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a>. When used with
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>,
          <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a> always returns
          true.
        </p><p>
          On the other hand, if you use
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a> to initiate
          a result set retrieval, the rows of the set are obtained from
          the server one by one as you call
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> repeatedly.
          Because an error may occur on the connection during this
          process, a <code class="literal">NULL</code> return value from
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> does not
          necessarily mean the end of the result set was reached
          normally. In this case, you can use
          <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a> to determine what
          happened. <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a> returns
          a nonzero value if the end of the result set was reached and
          zero if an error occurred.
        </p><p>
          Historically, <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a>
          predates the standard MySQL error functions
          <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> and
          <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a>. Because those
          error functions provide the same information, their use is
          preferred over <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a>,
          which is deprecated. (In fact, they provide more information,
          because <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a> returns
          only a boolean value whereas the error functions indicate a
          reason for the error when one occurs.)
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-eof-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if the end of the result set has
          been reached.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-eof-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-eof-example"></a>Example</h5>

</div>

</div>

</div>
<p>
          The following example shows how you might use
          <a class="link" href="connectors-apis.html#mysql-eof" title="28.7.7.13&nbsp;mysql_eof()"><code class="literal">mysql_eof()</code></a>:
        </p><pre data-lang="c" class="programlisting">mysql_query(&amp;mysql,"SELECT * FROM some_table");<font></font>
result = mysql_use_result(&amp;mysql);<font></font>
while((row = mysql_fetch_row(result)))<font></font>
{<font></font>
    // do something with data<font></font>
}<font></font>
if(!mysql_eof(result))  // mysql_fetch_row() failed due to an error<font></font>
{<font></font>
    fprintf(stderr, "Error: %s\n", mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre><p>
          However, you can achieve the same effect with the standard
          MySQL error functions:
        </p><pre data-lang="c" class="programlisting">mysql_query(&amp;mysql,"SELECT * FROM some_table");<font></font>
result = mysql_use_result(&amp;mysql);<font></font>
while((row = mysql_fetch_row(result)))<font></font>
{<font></font>
    // do something with data<font></font>
}<font></font>
if(mysql_errno(&amp;mysql))  // mysql_fetch_row() failed due to an error<font></font>
{<font></font>
    fprintf(stderr, "Error: %s\n", mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-errno"></a>28.7.7.14&nbsp;mysql_errno()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550916944"></a><p>
        <code class="literal">unsigned int mysql_errno(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-errno-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          For the connection specified by <code class="literal">mysql</code>,
          <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> returns the
          error code for the most recently invoked API function that can
          succeed or fail. A return value of zero means that no error
          occurred. Client error message numbers are listed in the MySQL
          <code class="filename">errmsg.h</code> header file. Server error
          message numbers are listed in
          <code class="filename">mysqld_error.h</code>. Errors also are listed at
          <a class="xref" href="error-handling.html" title="Appendix&nbsp;B&nbsp;Errors, Error Codes, and Common Problems">Appendix&nbsp;B, <i>Errors, Error Codes, and Common Problems</i></a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Some functions such as
            <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> do not set
            <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> if they
            succeed. A rule of thumb is that all functions that have to
            ask the server for information reset
            <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> if they
            succeed.
</p>
</div>
<p>
          MySQL-specific error numbers returned by
          <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> differ from
          SQLSTATE values returned by
          <a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76&nbsp;mysql_sqlstate()"><code class="literal">mysql_sqlstate()</code></a>. For example,
          the <a class="link" href="programs.html#mysql" title="4.5.1&nbsp;mysql — The MySQL Command-Line Client"><span class="command"><strong>mysql</strong></span></a> client program displays errors
          using the following format, where <code class="literal">1146</code> is
          the <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> value and
          <code class="literal">'42S02'</code> is the corresponding
          <a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76&nbsp;mysql_sqlstate()"><code class="literal">mysql_sqlstate()</code></a> value:
        </p><pre data-lang="sql" class="programlisting">shell&gt; <strong class="userinput"><code>SELECT * FROM no_such_table;</code></strong><font></font>
ERROR 1146 (42S02): Table 'test.no_such_table' doesn't exist<font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-errno-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An error code value for the last
          <code class="literal">mysql_<em class="replaceable"><code>xxx</code></em>()</code>
          call, if it failed. zero means no error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-errno-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-error"></a>28.7.7.15&nbsp;mysql_error()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550888336"></a><p>
        <code class="literal">const char *mysql_error(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-error-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          For the connection specified by <code class="literal">mysql</code>,
          <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a> returns a
          null-terminated string containing the error message for the
          most recently invoked API function that failed. If a function
          did not fail, the return value of
          <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a> may be the
          previous error or an empty string to indicate no error.
        </p><p>
          A rule of thumb is that all functions that have to ask the
          server for information reset
          <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a> if they succeed.
        </p><p>
          For functions that reset
          <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a>, either of these
          two tests can be used to check for an error:
        </p><pre data-lang="c" class="programlisting">if(*mysql_error(&amp;mysql))<font></font>
{<font></font>
  // an error occurred<font></font>
}<font></font>
<font></font>
if(mysql_error(&amp;mysql)[0])<font></font>
{<font></font>
  // an error occurred<font></font>
}<font></font>
</pre><p>
          The language of the client error messages may be changed by
          recompiling the MySQL client library. You can choose error
          messages in several different languages. See
          <a class="xref" href="charset.html#error-message-language" title="10.11&nbsp;Setting the Error Message Language">Section&nbsp;10.11, “Setting the Error Message Language”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-error-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A null-terminated character string that describes the error.
          An empty string if no error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-error-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-escape-string"></a>28.7.7.16&nbsp;mysql_escape_string()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550870544"></a>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Do not use this function.
          <a class="link" href="connectors-apis.html#mysql-escape-string" title="28.7.7.16&nbsp;mysql_escape_string()"><code class="literal">mysql_escape_string()</code></a> does not
          have arguments that enable it to respect the current character
          set or the quoting context. Use
          <a class="link" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56&nbsp;mysql_real_escape_string_quote()"><code class="literal">mysql_real_escape_string_quote()</code></a>
          instead.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-field"></a>28.7.7.17&nbsp;mysql_fetch_field()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550864832"></a><p>
        <code class="literal">MYSQL_FIELD *mysql_fetch_field(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the definition of one column of a result set as a
          <code class="literal">MYSQL_FIELD</code> structure. Call this function
          repeatedly to retrieve information about all columns in the
          result set.
          <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a> returns
          <code class="literal">NULL</code> when no more fields are left.
        </p><p>
          For metadata-optional connections, this function returns
          <code class="literal">NULL</code> when the
          <a class="link" href="server-administration.html#sysvar_resultset_metadata"><code class="literal">resultset_metadata</code></a> system
          variable is set to <code class="literal">NONE</code>. To check whether a
          result set has metadata, use the
          <a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62&nbsp;mysql_result_metadata()"><code class="literal">mysql_result_metadata()</code></a>
          function. For details about managing result set metadata
          transfer, see <a class="xref" href="connectors-apis.html#c-api-optional-metadata" title="28.7.27&nbsp;C API Optional Result Set Metadata">Section&nbsp;28.7.27, “C API Optional Result Set Metadata”</a>.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a> is reset
          to return information about the first field each time you
          execute a new <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> query. The
          field returned by
          <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a> is also
          affected by calls to
          <a class="link" href="connectors-apis.html#mysql-field-seek" title="28.7.7.23&nbsp;mysql_field_seek()"><code class="literal">mysql_field_seek()</code></a>.
        </p><p>
          If you've called <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a>
          to perform a <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> on a table
          but have not called
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>, MySQL
          returns the default blob length (8KB) if you call
          <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a> to ask for
          the length of a <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">BLOB</code></a> field.
          (The 8KB size is chosen because MySQL does not know the
          maximum length for the <a class="link" href="data-types.html#blob" title="11.4.3&nbsp;The BLOB and TEXT Types"><code class="literal">BLOB</code></a>.
          This should be made configurable sometime.) Once you've
          retrieved the result set,
          <code class="literal">field-&gt;max_length</code> contains the length of
          the largest value for this column in the specific query.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          The <code class="literal">MYSQL_FIELD</code> structure for the current
          column. <code class="literal">NULL</code> if no columns are left or the
          result set has no metadata.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">MYSQL_FIELD *field;<font></font>
<font></font>
while((field = mysql_fetch_field(result)))<font></font>
{<font></font>
    printf("field name %s\n", field-&gt;name);<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-field-direct"></a>28.7.7.18&nbsp;mysql_fetch_field_direct()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550829776"></a><p>
        <code class="literal">MYSQL_FIELD *mysql_fetch_field_direct(MYSQL_RES
        *result, unsigned int fieldnr)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-direct-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Given a field number <code class="literal">fieldnr</code> for a column
          within a result set, returns that column's field definition as
          a <code class="literal">MYSQL_FIELD</code> structure. Use this function
          to retrieve the definition for an arbitrary column. Specify a
          value for <code class="literal">fieldnr</code> in the range from 0 to
          <a class="link" href="connectors-apis.html#mysql-num-fields" title="28.7.7.48&nbsp;mysql_num_fields()"><code class="literal">mysql_num_fields(result)-1</code></a>.
        </p><p>
          For metadata-optional connections, this function returns
          <code class="literal">NULL</code> when the
          <a class="link" href="server-administration.html#sysvar_resultset_metadata"><code class="literal">resultset_metadata</code></a> system
          variable is set to <code class="literal">NONE</code>. To check whether a
          result set has metadata, use the
          <a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62&nbsp;mysql_result_metadata()"><code class="literal">mysql_result_metadata()</code></a>
          function. For details about managing result set metadata
          transfer, see <a class="xref" href="connectors-apis.html#c-api-optional-metadata" title="28.7.27&nbsp;C API Optional Result Set Metadata">Section&nbsp;28.7.27, “C API Optional Result Set Metadata”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-direct-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          The <code class="literal">MYSQL_FIELD</code> structure for the specified
          column. <code class="literal">NULL</code> if the result set has no
          metadata.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-direct-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-direct-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">unsigned int num_fields;<font></font>
unsigned int i;<font></font>
MYSQL_FIELD *field;<font></font>
<font></font>
num_fields = mysql_num_fields(result);<font></font>
for(i = 0; i &lt; num_fields; i++)<font></font>
{<font></font>
    field = mysql_fetch_field_direct(result, i);<font></font>
    printf("Field %u is %s\n", i, field-&gt;name);<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-fields"></a>28.7.7.19&nbsp;mysql_fetch_fields()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550808176"></a><p>
        <code class="literal">MYSQL_FIELD *mysql_fetch_fields(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-fields-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns an array of all <code class="literal">MYSQL_FIELD</code>
          structures for a result set. Each structure provides the field
          definition for one column of the result set.
        </p><p>
          For metadata-optional connections, this function returns
          <code class="literal">NULL</code> when the
          <a class="link" href="server-administration.html#sysvar_resultset_metadata"><code class="literal">resultset_metadata</code></a> system
          variable is set to <code class="literal">NONE</code>. To check whether a
          result set has metadata, use the
          <a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62&nbsp;mysql_result_metadata()"><code class="literal">mysql_result_metadata()</code></a>
          function. For details about managing result set metadata
          transfer, see <a class="xref" href="connectors-apis.html#c-api-optional-metadata" title="28.7.27&nbsp;C API Optional Result Set Metadata">Section&nbsp;28.7.27, “C API Optional Result Set Metadata”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-fields-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An array of <code class="literal">MYSQL_FIELD</code> structures for all
          columns of a result set. <code class="literal">NULL</code> if the result
          set has no metadata.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-fields-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-fields-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">unsigned int num_fields;<font></font>
unsigned int i;<font></font>
MYSQL_FIELD *fields;<font></font>
<font></font>
num_fields = mysql_num_fields(result);<font></font>
fields = mysql_fetch_fields(result);<font></font>
for(i = 0; i &lt; num_fields; i++)<font></font>
{<font></font>
   printf("Field %u is %s\n", i, fields[i].name);<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-lengths"></a>28.7.7.20&nbsp;mysql_fetch_lengths()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550789584"></a><p>
        <code class="literal">unsigned long *mysql_fetch_lengths(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-lengths-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the lengths of the columns of the current row within a
          result set. If you plan to copy field values, this length
          information is also useful for optimization, because you can
          avoid calling <code class="literal">strlen()</code>. In addition, if the
          result set contains binary data, you
          <span class="bold"><strong>must</strong></span> use this function to
          determine the size of the data, because
          <code class="literal">strlen()</code> returns incorrect results for any
          field containing null characters.
        </p><p>
          The length for empty columns and for columns containing
          <code class="literal">NULL</code> values is zero. To see how to
          distinguish these two cases, see the description for
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-lengths-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An array of unsigned long integers representing the size of
          each column (not including any terminating null bytes).
          <code class="literal">NULL</code> if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-lengths-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-fetch-lengths" title="28.7.7.20&nbsp;mysql_fetch_lengths()"><code class="literal">mysql_fetch_lengths()</code></a> is valid
          only for the current row of the result set. It returns
          <code class="literal">NULL</code> if you call it before calling
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> or after
          retrieving all rows in the result.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-lengths-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">MYSQL_ROW row;<font></font>
unsigned long *lengths;<font></font>
unsigned int num_fields;<font></font>
unsigned int i;<font></font>
<font></font>
row = mysql_fetch_row(result);<font></font>
if (row)<font></font>
{<font></font>
    num_fields = mysql_num_fields(result);<font></font>
    lengths = mysql_fetch_lengths(result);<font></font>
    for(i = 0; i &lt; num_fields; i++)<font></font>
    {<font></font>
         printf("Column %u is %lu bytes in length.\n",<font></font>
                i, lengths[i]);<font></font>
    }<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-row"></a>28.7.7.21&nbsp;mysql_fetch_row()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550769344"></a><p>
        <code class="literal">MYSQL_ROW mysql_fetch_row(MYSQL_RES *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-description"></a>Description</h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> is a
            synchronous function. Its asynchronous counterpart is
            <a class="link" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1&nbsp;mysql_fetch_row_nonblocking()"><code class="literal">mysql_fetch_row_nonblocking()</code></a>,
            for use by applications that require asynchronous
            communication with the server. See
            <a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12&nbsp;C API Asynchronous Interface">Section&nbsp;28.7.12, “C API Asynchronous Interface”</a>.
</p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> retrieves
          the next row of a result set:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              When used after
              <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> or
              <a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6&nbsp;mysql_store_result_nonblocking()"><code class="literal">mysql_store_result_nonblocking()</code></a>,
              <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> returns
              <code class="literal">NULL</code> if there are no more rows to
              retrieve.
            </p></li><li class="listitem"><p></p><p>
              When used after
              <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>,
              <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> returns
              <code class="literal">NULL</code> if there are no more rows to
              retrieve or an error occurred.
</p></li></ul>
</div>
<p>
          The number of values in the row is given by
          <a class="link" href="connectors-apis.html#mysql-num-fields" title="28.7.7.48&nbsp;mysql_num_fields()"><code class="literal">mysql_num_fields(result)</code></a>. If
          <code class="literal">row</code> holds the return value from a call to
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a>, pointers to
          the values are accessed as <code class="literal">row[0]</code> to
          <code class="literal">row[mysql_num_fields(result)-1]</code>.
          <code class="literal">NULL</code> values in the row are indicated by
          <code class="literal">NULL</code> pointers.
        </p><p>
          The lengths of the field values in the row may be obtained by
          calling <a class="link" href="connectors-apis.html#mysql-fetch-lengths" title="28.7.7.20&nbsp;mysql_fetch_lengths()"><code class="literal">mysql_fetch_lengths()</code></a>.
          Empty fields and fields containing <code class="literal">NULL</code>
          both have length 0; you can distinguish these by checking the
          pointer for the field value. If the pointer is
          <code class="literal">NULL</code>, the field is <code class="literal">NULL</code>;
          otherwise, the field is empty.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A <code class="literal">MYSQL_ROW</code> structure for the next row, or
          <code class="literal">NULL</code>. The meaning of a
          <code class="literal">NULL</code> return depends on which function was
          called preceding
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              When used after
              <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> or
              <a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6&nbsp;mysql_store_result_nonblocking()"><code class="literal">mysql_store_result_nonblocking()</code></a>,
              <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> returns
              <code class="literal">NULL</code> if there are no more rows to
              retrieve.
            </p></li><li class="listitem"><p></p><p>
              When used after
              <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>,
              <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a> returns
              <code class="literal">NULL</code> if there are no more rows to
              retrieve or an error occurred. To determine whether an
              error occurred, check whether
              <a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15&nbsp;mysql_error()"><code class="literal">mysql_error()</code></a> returns a
              nonempty string or
              <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno()</code></a> returns
              nonzero.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          Errors are not reset between calls to
          <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21&nbsp;mysql_fetch_row()"><code class="literal">mysql_fetch_row()</code></a>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">MYSQL_ROW row;<font></font>
unsigned int num_fields;<font></font>
unsigned int i;<font></font>
<font></font>
num_fields = mysql_num_fields(result);<font></font>
while ((row = mysql_fetch_row(result)))<font></font>
{<font></font>
   unsigned long *lengths;<font></font>
   lengths = mysql_fetch_lengths(result);<font></font>
   for(i = 0; i &lt; num_fields; i++)<font></font>
   {<font></font>
       printf("[%.*s] ", (int) lengths[i],<font></font>
              row[i] ? row[i] : "NULL");<font></font>
   }<font></font>
   printf("\n");<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-field-count"></a>28.7.7.22&nbsp;mysql_field_count()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550709216"></a><p>
        <code class="literal">unsigned int mysql_field_count(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-field-count-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the number of columns for the most recent query on the
          connection.
        </p><p>
          The normal use of this function is when
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> returned
          <code class="literal">NULL</code> (and thus you have no result set
          pointer). In this case, you can call
          <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count()</code></a> to
          determine whether
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> should
          have produced a nonempty result. This enables the client
          program to take proper action without knowing whether the
          query was a <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> (or
          <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a>-like) statement. The
          example shown here illustrates how this may be done.
        </p><p>
          See <a class="xref" href="connectors-apis.html#null-mysql-store-result" title="28.7.29.1&nbsp;Why mysql_store_result() Sometimes Returns NULL After mysql_query() Returns Success">Section&nbsp;28.7.29.1, “Why mysql_store_result() Sometimes Returns NULL After mysql_query()
        Returns Success”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-count-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An unsigned integer representing the number of columns in a
          result set.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-count-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-count-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">MYSQL_RES *result;<font></font>
unsigned int num_fields;<font></font>
unsigned int num_rows;<font></font>
<font></font>
if (mysql_query(&amp;mysql,query_string))<font></font>
{<font></font>
    // error<font></font>
}<font></font>
else // query succeeded, process any data returned by it<font></font>
{<font></font>
    result = mysql_store_result(&amp;mysql);<font></font>
    if (result)  // there are rows<font></font>
    {<font></font>
        num_fields = mysql_num_fields(result);<font></font>
        // retrieve rows, then call mysql_free_result(result)<font></font>
    }<font></font>
    else  // mysql_store_result() returned nothing; should it have?<font></font>
    {<font></font>
        if(mysql_field_count(&amp;mysql) == 0)<font></font>
        {<font></font>
            // query does not return data<font></font>
            // (it was not a SELECT)<font></font>
            num_rows = mysql_affected_rows(&amp;mysql);<font></font>
        }<font></font>
        else // mysql_store_result() should have returned data<font></font>
        {<font></font>
            fprintf(stderr, "Error: %s\n", mysql_error(&amp;mysql));<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</pre><p>
          An alternative is to replace the
          <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count(&amp;mysql)</code></a>
          call with
          <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno(&amp;mysql)</code></a>. In
          this case, you are checking directly for an error from
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> rather
          than inferring from the value of
          <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count()</code></a> whether
          the statement was a <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-field-seek"></a>28.7.7.23&nbsp;mysql_field_seek()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550681232"></a><p>
        <code class="literal">MYSQL_FIELD_OFFSET mysql_field_seek(MYSQL_RES *result,
        MYSQL_FIELD_OFFSET offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-field-seek-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Sets the field cursor to the given offset. The next call to
          <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a> retrieves
          the field definition of the column associated with that
          offset.
        </p><p>
          To seek to the beginning of a row, pass an
          <code class="literal">offset</code> value of zero.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-seek-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          The previous value of the field cursor.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-seek-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-field-tell"></a>28.7.7.24&nbsp;mysql_field_tell()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550670048"></a><p>
        <code class="literal">MYSQL_FIELD_OFFSET mysql_field_tell(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-field-tell-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the position of the field cursor used for the last
          <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17&nbsp;mysql_fetch_field()"><code class="literal">mysql_fetch_field()</code></a>. This
          value can be used as an argument to
          <a class="link" href="connectors-apis.html#mysql-field-seek" title="28.7.7.23&nbsp;mysql_field_seek()"><code class="literal">mysql_field_seek()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-tell-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          The current offset of the field cursor.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-tell-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-free-result"></a>28.7.7.25&nbsp;mysql_free_result()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550659088"></a><p>
        <code class="literal">void mysql_free_result(MYSQL_RES *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-free-result-description"></a>Description</h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a> is a
            synchronous function. Its asynchronous counterpart is
            <a class="link" href="connectors-apis.html#mysql-free-result-nonblocking" title="28.7.15.2&nbsp;mysql_free_result_nonblocking()"><code class="literal">mysql_free_result_nonblocking()</code></a>,
            for use by applications that require asynchronous
            communication with the server. See
            <a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12&nbsp;C API Asynchronous Interface">Section&nbsp;28.7.12, “C API Asynchronous Interface”</a>.
</p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a> frees the
          memory allocated for a result set by
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>,
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>,
          <a class="link" href="connectors-apis.html#mysql-list-dbs" title="28.7.7.42&nbsp;mysql_list_dbs()"><code class="literal">mysql_list_dbs()</code></a>, and so
          forth. When you are done with a result set, you must free the
          memory it uses by calling
          <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a>.
        </p><p>
          Do not attempt to access a result set after freeing it.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-free-result-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-free-result-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-character-set-info"></a>28.7.7.26&nbsp;mysql_get_character_set_info()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550639440"></a><p>
        <code class="literal">void mysql_get_character_set_info(MYSQL *mysql,
        MY_CHARSET_INFO *cs)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-character-set-info-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          This function provides information about the default client
          character set. The default character set may be changed with
          the <a class="link" href="connectors-apis.html#mysql-set-character-set" title="28.7.7.71&nbsp;mysql_set_character_set()"><code class="literal">mysql_set_character_set()</code></a>
          function.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-character-set-info-example"></a>Example</h5>

</div>

</div>

</div>
<p>
          This example shows the fields that are available in the
          <code class="literal">MY_CHARSET_INFO</code> structure:
        </p><pre data-lang="c" class="programlisting">if (!mysql_set_character_set(&amp;mysql, "utf8"))<font></font>
{<font></font>
    MY_CHARSET_INFO cs;<font></font>
    mysql_get_character_set_info(&amp;mysql, &amp;cs);<font></font>
    printf("character set information:\n");<font></font>
    printf("character set+collation number: %d\n", cs.number);<font></font>
    printf("character set name: %s\n", cs.name);<font></font>
    printf("collation name: %s\n", cs.csname);<font></font>
    printf("comment: %s\n", cs.comment);<font></font>
    printf("directory: %s\n", cs.dir);<font></font>
    printf("multi byte character min. length: %d\n", cs.mbminlen);<font></font>
    printf("multi byte character max. length: %d\n", cs.mbmaxlen);<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-client-info"></a>28.7.7.27&nbsp;mysql_get_client_info()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550628032"></a><p>
        <code class="literal">const char *mysql_get_client_info(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-client-info-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns a string that represents the MySQL client library
          version (for example, <code class="literal">"8.0.18"</code>).
        </p><p>
          The function value is the version of MySQL or Connector/C that
          provides the client library. For more information, see
          <a class="xref" href="connectors-apis.html#c-api-server-client-versions" title="28.7.4.5&nbsp;C API Server and Client Library Versions">Section&nbsp;28.7.4.5, “C API Server and Client Library Versions”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-client-info-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A character string that represents the MySQL client library
          version.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-client-info-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-client-version"></a>28.7.7.28&nbsp;mysql_get_client_version()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550617264"></a><p>
        <code class="literal">unsigned long mysql_get_client_version(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-client-version-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns an integer that represents the MySQL client library
          version. The value has the format <code class="literal">XYYZZ</code>
          where <code class="literal">X</code> is the major version,
          <code class="literal">YY</code> is the release level (or minor version),
          and <code class="literal">ZZ</code> is the sub-version within the
          release level:
        </p><pre data-lang="simple" class="programlisting">major_version*10000 + release_level*100 + sub_version
</pre><p>
          For example, <code class="literal">"8.0.18"</code> is
          returned as <code class="literal">80018</code>.
        </p><p>
          The function value is the version of MySQL or Connector/C that
          provides the client library. For more information, see
          <a class="xref" href="connectors-apis.html#c-api-server-client-versions" title="28.7.4.5&nbsp;C API Server and Client Library Versions">Section&nbsp;28.7.4.5, “C API Server and Client Library Versions”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-client-version-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An integer that represents the MySQL client library version.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-client-version-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-host-info"></a>28.7.7.29&nbsp;mysql_get_host_info()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550601488"></a><p>
        <code class="literal">const char *mysql_get_host_info(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-host-info-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns a string describing the type of connection in use,
          including the server host name.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-host-info-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A character string representing the server host name and the
          connection type.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-host-info-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-option"></a>28.7.7.30&nbsp;mysql_get_option()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550592800"></a><p>
        <code class="literal">int mysql_get_option(MYSQL *mysql, enum mysql_option
        option, const void *arg)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-option-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the current value of an option settable using
          <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a>. The value
          should be treated as read only.
        </p><p>
          The <code class="literal">option</code> argument is the option for which
          you want its value. The <code class="literal">arg</code> argument is a
          pointer to a variable in which to store the option value.
          <code class="literal">arg</code> must be a pointer to a variable of the
          type appropriate for the <code class="literal">option</code> argument.
          The following table shows which variable type to use for each
          <code class="literal">option</code> value.
</p>
<div class="informaltable">
<table summary="Options for mysql_get_option()."><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr>
              <th scope="col"><code class="literal">arg</code> Type</th>
              <th scope="col">Applicable <code class="literal">option</code> Values</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">unsigned int</code></td>
              <td><code class="literal">MYSQL_OPT_CONNECT_TIMEOUT</code>,
                <code class="literal">MYSQL_OPT_PROTOCOL</code>,
                <code class="literal">MYSQL_OPT_READ_TIMEOUT</code>,
                <code class="literal">MYSQL_OPT_RETRY_COUNT</code>,
                <code class="literal">MYSQL_OPT_SSL_FIPS_MODE</code>,
                <code class="literal">MYSQL_OPT_SSL_MODE</code>,
                <code class="literal">MYSQL_OPT_WRITE_TIMEOUT</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned long</code></td>
              <td><code class="literal">MYSQL_OPT_MAX_ALLOWED_PACKET</code>,
                <code class="literal">MYSQL_OPT_NET_BUFFER_LENGTH</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">bool</code></td>
              <td><code class="literal">MYSQL_ENABLE_CLEARTEXT_PLUGIN</code>,
                <code class="literal">MYSQL_OPT_CAN_HANDLE_EXPIRED_PASSWORDS</code>,
                <code class="literal">MYSQL_OPT_GET_SERVER_PUBLIC_KEY</code>,
                <code class="literal">MYSQL_OPT_LOCAL_INFILE</code>,
                <code class="literal">MYSQL_OPT_OPTIONAL_RESULTSET_METADATA</code>,
                <code class="literal">MYSQL_OPT_RECONNECT</code>,
                <code class="literal">MYSQL_REPORT_DATA_TRUNCATION</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">const char *</code></td>
              <td><code class="literal">MYSQL_DEFAULT_AUTH</code>,
                <code class="literal">MYSQL_OPT_BIND</code>,
                <code class="literal">MYSQL_OPT_SSL_CA</code>,
                <code class="literal">MYSQL_OPT_SSL_CAPATH</code>,
                <code class="literal">MYSQL_OPT_SSL_CERT</code>,
                <code class="literal">MYSQL_OPT_SSL_CIPHER</code>,
                <code class="literal">MYSQL_OPT_SSL_CRL</code>,
                <code class="literal">MYSQL_OPT_SSL_CRLPATH</code>,
                <code class="literal">MYSQL_OPT_SSL_KEY</code>,
                <code class="literal">MYSQL_OPT_TLS_CIPHERSUITES</code>,
                <code class="literal">MYSQL_OPT_TLS_VERSION</code>,
                <code class="literal">MYSQL_PLUGIN_DIR</code>,
                <code class="literal">MYSQL_READ_DEFAULT_FILE</code>,
                <code class="literal">MYSQL_READ_DEFAULT_GROUP</code>,
                <code class="literal">MYSQL_SERVER_PUBLIC_KEY</code>,
                <code class="literal">MYSQL_SET_CHARSET_DIR</code>,
                <code class="literal">MYSQL_SET_CHARSET_NAME</code>,
                <code class="literal">MYSQL_SHARED_MEMORY_BASE_NAME</code></td>
            </tr><tr>
              <td scope="row">argument not used</td>
              <td><code class="literal">MYSQL_OPT_COMPRESS</code></td>
            </tr><tr>
              <td scope="row">cannot be queried (error is returned)</td>
              <td><code class="literal">MYSQL_INIT_COMMAND</code>,
                <code class="literal">MYSQL_OPT_CONNECT_ATTR_DELETE</code>,
                <code class="literal">MYSQL_OPT_CONNECT_ATTR_RESET</code>,
                <code class="literal">MYSQL_OPT_NAMED_PIPE</code></td>
</tr></tbody></table>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-option-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred; this occurs
          for <code class="literal">option</code> values that cannot be queried.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-option-example"></a>Example</h5>

</div>

</div>

</div>
<p>
          The following call tests the
          <code class="literal">MYSQL_OPT_RECONNECT</code> option. After the call
          returns successfully, the value of
          <code class="literal">reconnect</code> is true or false to indicate
          whether automatic reconnection is enabled.
        </p><pre data-lang="c" class="programlisting">bool reconnect;<font></font>
<font></font>
if (mysql_get_option(mysql, MYSQL_OPT_RECONNECT, &amp;reconnect))<font></font>
  fprintf(stderr, "mysql_get_options() failed\n");<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-proto-info"></a>28.7.7.31&nbsp;mysql_get_proto_info()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550526032"></a><p>
        <code class="literal">unsigned int mysql_get_proto_info(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-proto-info-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the protocol version used by current connection.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-proto-info-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An unsigned integer representing the protocol version used by
          the current connection.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-proto-info-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-server-info"></a>28.7.7.32&nbsp;mysql_get_server_info()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550517568"></a><p>
        <code class="literal">const char *mysql_get_server_info(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-server-info-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns a string that represents the MySQL server version (for
          example, <code class="literal">"8.0.18"</code>).
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-server-info-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A character string that represents the MySQL server version.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-server-info-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-server-version"></a>28.7.7.33&nbsp;mysql_get_server_version()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550508048"></a><p>
        <code class="literal">unsigned long mysql_get_server_version(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-server-version-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns an integer that represents the MySQL server version.
          The value has the format <code class="literal">XYYZZ</code> where
          <code class="literal">X</code> is the major version,
          <code class="literal">YY</code> is the release level (or minor version),
          and <code class="literal">ZZ</code> is the sub-version within the
          release level:
        </p><pre data-lang="simple" class="programlisting">major_version*10000 + release_level*100 + sub_version
</pre><p>
          For example, <code class="literal">"8.0.18"</code> is
          returned as <code class="literal">80018</code>.
        </p><p>
          This function is useful in client programs for determining
          whether some version-specific server capability exists.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-server-version-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An integer that represents the MySQL server version.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-server-version-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-ssl-cipher"></a>28.7.7.34&nbsp;mysql_get_ssl_cipher()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550493104"></a><p>
        <code class="literal">const char *mysql_get_ssl_cipher(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-ssl-cipher-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-get-ssl-cipher" title="28.7.7.34&nbsp;mysql_get_ssl_cipher()"><code class="literal">mysql_get_ssl_cipher()</code></a> returns
          the encryption cipher used for the given connection to the
          server. <code class="literal">mysql</code> is the connection handler
          returned from <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-ssl-cipher-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A string naming the encryption cipher used for the connection,
          or <code class="literal">NULL</code> if the connection is not encrypted.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-hex-string"></a>28.7.7.35&nbsp;mysql_hex_string()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550482240"></a><p>
        <code class="literal">unsigned long mysql_hex_string(char *to, const char
        *from, unsigned long length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-hex-string-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          This function creates a legal SQL string for use in an SQL
          statement. See <a class="xref" href="language-structure.html#string-literals" title="9.1.1&nbsp;String Literals">Section&nbsp;9.1.1, “String Literals”</a>.
        </p><p>
          The string in the <code class="literal">from</code> argument is encoded
          in hexadecimal format, with each character encoded as two
          hexadecimal digits. The result is placed in the
          <code class="literal">to</code> argument, followed by a terminating null
          byte.
        </p><p>
          The string pointed to by <code class="literal">from</code> must be
          <code class="literal">length</code> bytes long. You must allocate the
          <code class="literal">to</code> buffer to be at least
          <code class="literal">length*2+1</code> bytes long. When
          <a class="link" href="connectors-apis.html#mysql-hex-string" title="28.7.7.35&nbsp;mysql_hex_string()"><code class="literal">mysql_hex_string()</code></a> returns,
          the contents of <code class="literal">to</code> is a null-terminated
          string. The return value is the length of the encoded string,
          not including the terminating null byte.
        </p><p>
          The return value can be placed into an SQL statement using
          either <code class="literal">X'<em class="replaceable"><code>value</code></em>'</code>
          or <code class="literal">0x<em class="replaceable"><code>value</code></em></code>
          format. However, the return value does not include the
          <code class="literal">X'...'</code> or <code class="literal">0x</code>. The caller
          must supply whichever of those is desired.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-hex-string-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">char query[1000],*end;<font></font>
<font></font>
end = strmov(query,"INSERT INTO test_table values(");<font></font>
end = strmov(end,"X'");<font></font>
end += mysql_hex_string(end,"What is this",12);<font></font>
end = strmov(end,"',X'");<font></font>
end += mysql_hex_string(end,"binary data: \0\r\n",16);<font></font>
end = strmov(end,"')");<font></font>
<font></font>
if (mysql_real_query(&amp;mysql,query,(unsigned int) (end - query)))<font></font>
{<font></font>
   fprintf(stderr, "Failed to insert row, Error: %s\n",<font></font>
           mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre><p>
          The <code class="literal">strmov()</code> function used in the example
          is included in the <code class="literal">libmysqlclient</code> library
          and works like <code class="literal">strcpy()</code> but returns a
          pointer to the terminating null of the first parameter.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-hex-string-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          The length of the encoded string that is placed into
          <code class="literal">to</code>, not including the terminating null
          character.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-hex-string-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-info"></a>28.7.7.36&nbsp;mysql_info()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550455248"></a><p>
        <code class="literal">const char *mysql_info(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-info-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Retrieves a string providing information about the most
          recently executed statement, but only for the statements
          listed here. For other statements,
          <a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36&nbsp;mysql_info()"><code class="literal">mysql_info()</code></a> returns
          <code class="literal">NULL</code>. The format of the string varies
          depending on the type of statement, as described here. The
          numbers are illustrative only; the string contains values
          appropriate for the statement.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1&nbsp;INSERT ... SELECT Syntax"><code class="literal">INSERT INTO
              ... SELECT ...</code></a>
            </p><p>
              String format: <code class="literal">Records: 100 Duplicates: 0
              Warnings: 0</code>
            </p></li><li class="listitem"><p>
              <code class="literal">INSERT INTO ... VALUES
              (...),(...),(...)...</code>
            </p><p>
              String format: <code class="literal">Records: 3 Duplicates: 0 Warnings:
              0</code>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#load-data" title="13.2.7&nbsp;LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>
            </p><p>
              String format: <code class="literal">Records: 1 Deleted: 0 Skipped: 0
              Warnings: 0</code>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#alter-table" title="13.1.9&nbsp;ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
            </p><p>
              String format: <code class="literal">Records: 3 Duplicates: 0 Warnings:
              0</code>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a>
            </p><p>
              String format: <code class="literal">Rows matched: 40 Changed: 40
              Warnings: 0</code>
</p></li></ul>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36&nbsp;mysql_info()"><code class="literal">mysql_info()</code></a> returns a
          non-<code class="literal">NULL</code> value for
          <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT ...
          VALUES</code></a> only for the multiple-row form of the
          statement (that is, only if multiple value lists are
          specified).
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-info-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A character string representing additional information about
          the most recently executed statement. <code class="literal">NULL</code>
          if no information is available for the statement.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-info-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-init"></a>28.7.7.37&nbsp;mysql_init()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550424352"></a><p>
        <code class="literal">MYSQL *mysql_init(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-init-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Allocates or initializes a <code class="literal">MYSQL</code> object
          suitable for
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>. If
          <code class="literal">mysql</code> is a <code class="literal">NULL</code> pointer,
          the function allocates, initializes, and returns a new object.
          Otherwise, the object is initialized and the address of the
          object is returned. If
          <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a> allocates a new
          object, it is freed when
          <a class="link" href="connectors-apis.html#mysql-close" title="28.7.7.5&nbsp;mysql_close()"><code class="literal">mysql_close()</code></a> is called to
          close the connection.
        </p><p>
          In a nonmultithreaded environment,
          <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a> invokes
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>
          automatically as necessary. However,
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> is not
          thread-safe in a multithreaded environment, and thus neither
          is <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>. Before
          calling <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>, either
          call <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>
          prior to spawning any threads, or use a mutex to protect the
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> call.
          This should be done prior to any other client library call.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-init-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An initialized <code class="literal">MYSQL*</code> handler.
          <code class="literal">NULL</code> if there was insufficient memory to
          allocate a new object.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-init-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          In case of insufficient memory, <code class="literal">NULL</code> is
          returned.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-insert-id"></a>28.7.7.38&nbsp;mysql_insert_id()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550398208"></a><p>
        <code class="literal">my_ulonglong mysql_insert_id(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-insert-id-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the value generated for an
          <code class="literal">AUTO_INCREMENT</code> column by the previous
          <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a> or
          <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a> statement. Use this
          function after you have performed an
          <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a> statement into a table
          that contains an <code class="literal">AUTO_INCREMENT</code> field, or
          have used <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a> or
          <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a> to set a column value
          with
          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a>.
        </p><p>
          The return value of
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> is always
          zero unless explicitly updated under one of the following
          conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a> statements that
              store a value into an <code class="literal">AUTO_INCREMENT</code>
              column. This is true whether the value is automatically
              generated by storing the special values
              <code class="literal">NULL</code> or <code class="literal">0</code> into the
              column, or is an explicit nonspecial value.
            </p></li><li class="listitem"><p>
              In the case of a multiple-row
              <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a> statement,
              <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> returns
              the first automatically generated
              <code class="literal">AUTO_INCREMENT</code> value that was
              successfully inserted.
            </p><p>
              If no rows are successfully inserted,
              <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> returns
              0.
            </p></li><li class="listitem"><p>
              If an
              <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1&nbsp;INSERT ... SELECT Syntax"><code class="literal">INSERT ...
              SELECT</code></a> statement is executed, and no
              automatically generated value is successfully inserted,
              <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> returns
              the ID of the last inserted row.
            </p></li><li class="listitem"><p>
              If an
              <a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1&nbsp;INSERT ... SELECT Syntax"><code class="literal">INSERT ...
              SELECT</code></a> statement uses
              <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a>,
              <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> returns
              <em class="replaceable"><code>expr</code></em>.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a> statements that
              generate an <code class="literal">AUTO_INCREMENT</code> value by
              inserting
              <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a>
              into any column or by updating any column to
              <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a>.
            </p></li><li class="listitem"><p>
              If the previous statement returned an error, the value of
              <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> is
              undefined.
</p></li></ul>
</div>
<p>
          The return value of
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> can be
          simplified to the following sequence:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
              If there is an <code class="literal">AUTO_INCREMENT</code> column,
              and an automatically generated value was successfully
              inserted, return the first such value.
            </p></li><li class="listitem"><p>
              If
              <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a>
              occurred in the statement, return
              <em class="replaceable"><code>expr</code></em>, even if there was an
              <code class="literal">AUTO_INCREMENT</code> column in the affected
              table.
            </p></li><li class="listitem"><p>
              The return value varies depending on the statement used.
              When called after an <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a>
              statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                  If there is an <code class="literal">AUTO_INCREMENT</code>
                  column in the table, and there were some explicit
                  values for this column that were successfully inserted
                  into the table, return the last of the explicit
                  values.
</p></li></ul>
</div>
<p>
              When called after an
              <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2&nbsp;INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT
              ... ON DUPLICATE KEY UPDATE</code></a> statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                  If there is an <code class="literal">AUTO_INCREMENT</code>
                  column in the table and there were some explicit
                  successfully inserted values or some updated values,
                  return the last of the inserted or updated values.
</p></li></ul>
</div>
</li></ol>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> returns
          <code class="literal">0</code> if the previous statement does not use an
          <code class="literal">AUTO_INCREMENT</code> value. If you need to save
          the value for later, be sure to call
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> immediately
          after the statement that generates the value.
        </p><p>
          The value of <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a>
          is affected only by statements issued within the current
          client connection. It is not affected by statements issued by
          other clients.
        </p><p>
          The <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> SQL
          function will contain the value of the first automatically
          generated value that was successfully inserted.
          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> is not reset
          between statements because the value of that function is
          maintained in the server. Another difference from
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> is that
          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> is not updated
          if you set an <code class="literal">AUTO_INCREMENT</code> column to a
          specific nonspecial value. See
          <a class="xref" href="functions.html#information-functions" title="12.15&nbsp;Information Functions">Section&nbsp;12.15, “Information Functions”</a>.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> returns
          <code class="literal">0</code> following a
          <a class="link" href="sql-syntax.html#call" title="13.2.1&nbsp;CALL Syntax"><code class="literal">CALL</code></a> statement for a stored
          procedure that generates an <code class="literal">AUTO_INCREMENT</code>
          value because in this case
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> applies to
          <a class="link" href="sql-syntax.html#call" title="13.2.1&nbsp;CALL Syntax"><code class="literal">CALL</code></a> and not the statement
          within the procedure. Within the procedure, you can use
          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> at the SQL
          level to obtain the <code class="literal">AUTO_INCREMENT</code> value.
        </p><p>
          The reason for the differences between
          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> and
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> is that
          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> is made easy
          to use in scripts while
          <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> tries to
          provide more exact information about what happens to the
          <code class="literal">AUTO_INCREMENT</code> column.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The OK packet used in the client/server protocol holds
            information such as is used for session state tracking. When
            clients read the OK packet to know whether there is a
            session state change, this resets values such as the last
            insert ID and the number of affected rows. Such changes
            cause <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38&nbsp;mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> to
            return 0 after execution of commands including but not
            necessarily limited to <code class="literal">COM_PING</code>,
            <code class="literal">COM_REFRESH</code>, and
            <code class="literal">COM_INIT_DB</code>.
</p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-insert-id-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Described in the preceding discussion.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-insert-id-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_er_auto_increment_conflict"><code class="literal">ER_AUTO_INCREMENT_CONFLICT</code></a>
            </p><p>
              A user-specified <code class="literal">AUTO_INCREMENT</code> value
              in a multi <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a> statement
              falls within the range between the current
              <code class="literal">AUTO_INCREMENT</code> value and the sum of the
              current and number of rows affected values.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-kill"></a>28.7.7.39&nbsp;mysql_kill()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550296096"></a><p>
        <code class="literal">int mysql_kill(MYSQL *mysql, unsigned long
        pid)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-kill-description"></a>Description</h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <code class="literal">mysql_kill()</code> is deprecated and will be
            removed in a future version of MySQL. Instead, use
            <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> to execute a
            <a class="link" href="sql-syntax.html#kill" title="13.7.7.4&nbsp;KILL Syntax"><code class="literal">KILL</code></a> statement.
</p>
</div>
<p>
          Asks the server to kill the thread specified by
          <code class="literal">pid</code>.
        </p><p>
          This function is deprecated. Use
          <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> to issue an SQL
          <a class="link" href="sql-syntax.html#kill" title="13.7.7.4&nbsp;KILL Syntax"><code class="literal">KILL</code></a> statement instead.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-kill" title="28.7.7.39&nbsp;mysql_kill()"><code class="literal">mysql_kill()</code></a> cannot handle
          values larger than 32 bits, but to guard against killing the
          wrong thread returns an error in these cases:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              If given an ID larger than 32 bits,
              <a class="link" href="connectors-apis.html#mysql-kill" title="28.7.7.39&nbsp;mysql_kill()"><code class="literal">mysql_kill()</code></a> returns a
              <a class="link" href="error-handling.html#error_cr_invalid_conn_handle"><code class="literal">CR_INVALID_CONN_HANDLE</code></a>
              error.
            </p></li><li class="listitem"><p>
              After the server's internal thread ID counter reaches a
              value larger than 32 bits, it returns an
              <a class="link" href="error-handling.html#error_er_data_out_of_range"><code class="literal">ER_DATA_OUT_OF_RANGE</code></a> error
              for any <a class="link" href="connectors-apis.html#mysql-kill" title="28.7.7.39&nbsp;mysql_kill()"><code class="literal">mysql_kill()</code></a>
              invocation and
              <a class="link" href="connectors-apis.html#mysql-kill" title="28.7.7.39&nbsp;mysql_kill()"><code class="literal">mysql_kill()</code></a> fails.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-kill-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-kill-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_invalid_conn_handle"><code class="literal">CR_INVALID_CONN_HANDLE</code></a>
            </p><p>
              The <code class="literal">pid</code> was larger than 32 bits.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_er_data_out_of_range"><code class="literal">ER_DATA_OUT_OF_RANGE</code></a>
            </p><p>
              The server's internal thread ID counter has reached a
              value larger than 32 bits, at which point it rejects all
              <a class="link" href="connectors-apis.html#mysql-kill" title="28.7.7.39&nbsp;mysql_kill()"><code class="literal">mysql_kill()</code></a> invocations.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-library-end"></a>28.7.7.40&nbsp;mysql_library_end()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550252832"></a><p>
        <code class="literal">void mysql_library_end(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-library-end-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          This function finalizes the MySQL client library. Call it when
          you are done using the library (for example, after
          disconnecting from the server).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            To avoid memory leaks after the application is done using
            the library (for example, after closing the connection to
            the server), be sure to call
            <a class="link" href="connectors-apis.html#mysql-library-end" title="28.7.7.40&nbsp;mysql_library_end()"><code class="literal">mysql_library_end()</code></a>
            explicitly. This enables memory managment to be performed to
            clean up and free resources used by the library.
</p>
</div>
<p>
          For usage information, see
          <a class="xref" href="connectors-apis.html#c-api-function-overview" title="28.7.6&nbsp;C API Function Overview">Section&nbsp;28.7.6, “C API Function Overview”</a>, and
          <a class="xref" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()">Section&nbsp;28.7.7.41, “mysql_library_init()”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-library-init"></a>28.7.7.41&nbsp;mysql_library_init()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550243280"></a><p>
        <code class="literal">int mysql_library_init(int argc, char **argv, char
        **groups)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-library-init-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Call this function to initialize the MySQL client library
          before you call any other MySQL function.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            To avoid memory leaks after the application is done using
            the library (for example, after closing the connection to
            the server), be sure to call
            <a class="link" href="connectors-apis.html#mysql-library-end" title="28.7.7.40&nbsp;mysql_library_end()"><code class="literal">mysql_library_end()</code></a>
            explicitly. This enables memory managment to be performed to
            clean up and free resources used by the library. See
            <a class="xref" href="connectors-apis.html#mysql-library-end" title="28.7.7.40&nbsp;mysql_library_end()">Section&nbsp;28.7.7.40, “mysql_library_end()”</a>.
</p>
</div>
<p>
          In a nonmultithreaded environment, the call to
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> may be
          omitted, because <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>
          will invoke it automatically as necessary. However,
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> is not
          thread-safe in a multithreaded environment, and thus neither
          is <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>, which calls
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a>. You must
          either call
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> prior to
          spawning any threads, or else use a mutex to protect the call,
          whether you invoke
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init()</code></a> or
          indirectly through
          <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a>. Do this prior to
          any other client library call.
        </p><p>
          The <code class="literal">argc</code>, <code class="literal">argv</code>, and
          <code class="literal">groups</code> arguments are unused. In older MySQL
          versions, they were used for applications linked against the
          embedded server, which is no longer supported. The call now
          should be written as
          <a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41&nbsp;mysql_library_init()"><code class="literal">mysql_library_init(0, NULL,
          NULL)</code></a>.
        </p><pre data-lang="c" class="programlisting">#include &lt;mysql.h&gt;<font></font>
#include &lt;stdlib.h&gt;<font></font>
<font></font>
int main(void) {<font></font>
  if (mysql_library_init(0, NULL, NULL)) {<font></font>
    fprintf(stderr, "could not initialize MySQL client library\n");<font></font>
    exit(1);<font></font>
  }<font></font>
<font></font>
  /* Use any MySQL API functions here */<font></font>
<font></font>
  mysql_library_end();<font></font>
<font></font>
  return EXIT_SUCCESS;<font></font>
}<font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-library-init-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-list-dbs"></a>28.7.7.42&nbsp;mysql_list_dbs()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550217056"></a><p>
        <code class="literal">MYSQL_RES *mysql_list_dbs(MYSQL *mysql, const char
        *wild)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-list-dbs-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns a result set consisting of database names on the
          server that match the simple regular expression specified by
          the <code class="literal">wild</code> parameter. <code class="literal">wild</code>
          may contain the wildcard characters <code class="literal">%</code> or
          <code class="literal">_</code>, or may be a <code class="literal">NULL</code>
          pointer to match all databases. Calling
          <a class="link" href="connectors-apis.html#mysql-list-dbs" title="28.7.7.42&nbsp;mysql_list_dbs()"><code class="literal">mysql_list_dbs()</code></a> is similar to
          executing the query <code class="literal">SHOW DATABASES [LIKE
          <em class="replaceable"><code>wild</code></em>]</code>.
        </p><p>
          You must free the result set with
          <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-dbs-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A <code class="literal">MYSQL_RES</code> result set for success.
          <code class="literal">NULL</code> if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-dbs-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p>
              Out of memory.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-list-fields"></a>28.7.7.43&nbsp;mysql_list_fields()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550186960"></a><p>
        <code class="literal">MYSQL_RES *mysql_list_fields(MYSQL *mysql, const char
        *table, const char *wild)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-list-fields-description"></a>Description</h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <code class="literal">mysql_list_fields()</code> is deprecated and
            will be removed in a future version of MySQL. Instead, use
            <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> to execute a
            <a class="link" href="sql-syntax.html#show-columns" title="13.7.6.5&nbsp;SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a> statement.
</p>
</div>
<p>
          Returns an empty result set for which the metadata provides
          information about the columns in the given table that match
          the simple regular expression specified by the
          <code class="literal">wild</code> parameter. <code class="literal">wild</code> may
          contain the wildcard characters <code class="literal">%</code> or
          <code class="literal">_</code>, or may be a <code class="literal">NULL</code>
          pointer to match all fields. Calling
          <a class="link" href="connectors-apis.html#mysql-list-fields" title="28.7.7.43&nbsp;mysql_list_fields()"><code class="literal">mysql_list_fields()</code></a> is similar
          to executing the query <code class="literal">SHOW COLUMNS FROM
          <em class="replaceable"><code>tbl_name</code></em> [LIKE
          <em class="replaceable"><code>wild</code></em>]</code>.
        </p><p>
          It is preferable to use <code class="literal">SHOW COLUMNS FROM
          <em class="replaceable"><code>tbl_name</code></em></code> instead of
          <a class="link" href="connectors-apis.html#mysql-list-fields" title="28.7.7.43&nbsp;mysql_list_fields()"><code class="literal">mysql_list_fields()</code></a>.
        </p><p>
          You must free the result set with
          <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-fields-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A <code class="literal">MYSQL_RES</code> result set for success.
          <code class="literal">NULL</code> if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-fields-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-fields-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">int i;<font></font>
MYSQL_RES *tbl_cols = mysql_list_fields(mysql, "mytbl", "f%");<font></font>
<font></font>
unsigned int field_cnt = mysql_num_fields(tbl_cols);<font></font>
printf("Number of columns: %d\n", field_cnt);<font></font>
<font></font>
for (i=0; i &lt; field_cnt; ++i)<font></font>
{<font></font>
  /* col describes i-th column of the table */<font></font>
  MYSQL_FIELD *col = mysql_fetch_field_direct(tbl_cols, i);<font></font>
  printf ("Column %d: %s\n", i, col-&gt;name);<font></font>
}<font></font>
mysql_free_result(tbl_cols);<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-list-processes"></a>28.7.7.44&nbsp;mysql_list_processes()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550149104"></a><p>
        <code class="literal">MYSQL_RES *mysql_list_processes(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-list-processes-description"></a>Description</h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <code class="literal">mysql_list_processes()</code> is deprecated and
            will be removed in a future version of MySQL. Instead, use
            <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> to execute a
            <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29&nbsp;SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> statement.
</p>
</div>
<p>
          Returns a result set describing the current server threads.
          This is the same kind of information as that reported by
          <a class="link" href="programs.html#mysqladmin" title="4.5.2&nbsp;mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin processlist</strong></span></a> or a
          <a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29&nbsp;SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> query.
        </p><p>
          You must free the result set with
          <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-processes-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A <code class="literal">MYSQL_RES</code> result set for success.
          <code class="literal">NULL</code> if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-processes-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-list-tables"></a>28.7.7.45&nbsp;mysql_list_tables()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550121184"></a><p>
        <code class="literal">MYSQL_RES *mysql_list_tables(MYSQL *mysql, const char
        *wild)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-list-tables-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns a result set consisting of table names in the current
          database that match the simple regular expression specified by
          the <code class="literal">wild</code> parameter. <code class="literal">wild</code>
          may contain the wildcard characters <code class="literal">%</code> or
          <code class="literal">_</code>, or may be a <code class="literal">NULL</code>
          pointer to match all tables. Calling
          <a class="link" href="connectors-apis.html#mysql-list-tables" title="28.7.7.45&nbsp;mysql_list_tables()"><code class="literal">mysql_list_tables()</code></a> is similar
          to executing the query <code class="literal">SHOW TABLES [LIKE
          <em class="replaceable"><code>wild</code></em>]</code>.
        </p><p>
          You must free the result set with
          <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-tables-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A <code class="literal">MYSQL_RES</code> result set for success.
          <code class="literal">NULL</code> if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-tables-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-more-results"></a>28.7.7.46&nbsp;mysql_more_results()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550093600"></a><p>
        <code class="literal">bool mysql_more_results(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-more-results-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          This function is used when you execute multiple statements
          specified as a single statement string, or when you execute
          <a class="link" href="sql-syntax.html#call" title="13.2.1&nbsp;CALL Syntax"><code class="literal">CALL</code></a> statements, which can
          return multiple result sets.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-more-results" title="28.7.7.46&nbsp;mysql_more_results()"><code class="literal">mysql_more_results()</code></a> true if
          more results exist from the currently executed statement, in
          which case the application must call
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a> to fetch
          the results.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-more-results-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          <code class="literal">TRUE</code> (1) if more results exist.
          <code class="literal">FALSE</code> (0) if no more results exist.
        </p><p>
          In most cases, you can call
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a> instead to
          test whether more results exist and initiate retrieval if so.
        </p><p>
          See <a class="xref" href="connectors-apis.html#c-api-multiple-queries" title="28.7.23&nbsp;C API Multiple Statement Execution Support">Section&nbsp;28.7.23, “C API Multiple Statement Execution Support”</a>, and
          <a class="xref" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()">Section&nbsp;28.7.7.47, “mysql_next_result()”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-more-results-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-next-result"></a>28.7.7.47&nbsp;mysql_next_result()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550075872"></a><p>
        <code class="literal">int mysql_next_result(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-next-result-description"></a>Description</h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a> is a
            synchronous function. Its asynchronous counterpart is
            <a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3&nbsp;mysql_next_result_nonblocking()"><code class="literal">mysql_next_result_nonblocking()</code></a>,
            for use by applications that require asynchronous
            communication with the server. See
            <a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12&nbsp;C API Asynchronous Interface">Section&nbsp;28.7.12, “C API Asynchronous Interface”</a>.
</p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a> is used
          when you execute multiple statements specified as a single
          statement string, or when you use
          <a class="link" href="sql-syntax.html#call" title="13.2.1&nbsp;CALL Syntax"><code class="literal">CALL</code></a> statements to execute
          stored procedures, which can return multiple result sets.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a> reads the
          next statement result and returns a status to indicate whether
          more results exist. If
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a> returns an
          error, there are no more results.
        </p><p>
          Before each call to
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a>, you must
          call <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25&nbsp;mysql_free_result()"><code class="literal">mysql_free_result()</code></a> for
          the current statement if it is a statement that returned a
          result set (rather than just a result status).
        </p><p>
          After calling
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a> the state
          of the connection is as if you had called
          <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57&nbsp;mysql_real_query()"><code class="literal">mysql_real_query()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> for the next
          statement. This means that you can call
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>,
          <a class="link" href="connectors-apis.html#mysql-warning-count" title="28.7.7.82&nbsp;mysql_warning_count()"><code class="literal">mysql_warning_count()</code></a>,
          <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a>, and so
          forth.
        </p><p>
          If your program uses <a class="link" href="sql-syntax.html#call" title="13.2.1&nbsp;CALL Syntax"><code class="literal">CALL</code></a>
          statements to execute stored procedures, the
          <code class="literal">CLIENT_MULTI_RESULTS</code> flag must be enabled.
          This is because each <a class="link" href="sql-syntax.html#call" title="13.2.1&nbsp;CALL Syntax"><code class="literal">CALL</code></a>
          returns a result to indicate the call status, in addition to
          any result sets that might be returned by statements executed
          within the procedure. Because
          <a class="link" href="sql-syntax.html#call" title="13.2.1&nbsp;CALL Syntax"><code class="literal">CALL</code></a> can return multiple
          results, process them using a loop that calls
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a> to
          determine whether there are more results.
        </p><p>
          <code class="literal">CLIENT_MULTI_RESULTS</code> can be enabled when
          you call <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>,
          either explicitly by passing the
          <code class="literal">CLIENT_MULTI_RESULTS</code> flag itself, or
          implicitly by passing
          <code class="literal">CLIENT_MULTI_STATEMENTS</code> (which also enables
          <code class="literal">CLIENT_MULTI_RESULTS</code>).
          <code class="literal">CLIENT_MULTI_RESULTS</code> is enabled by default.
        </p><p>
          It is also possible to test whether there are more results by
          calling <a class="link" href="connectors-apis.html#mysql-more-results" title="28.7.7.46&nbsp;mysql_more_results()"><code class="literal">mysql_more_results()</code></a>.
          However, this function does not change the connection state,
          so if it returns true, you must still call
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a> to advance
          to the next result.
        </p><p>
          For an example that shows how to use
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47&nbsp;mysql_next_result()"><code class="literal">mysql_next_result()</code></a>, see
          <a class="xref" href="connectors-apis.html#c-api-multiple-queries" title="28.7.23&nbsp;C API Multiple Statement Execution Support">Section&nbsp;28.7.23, “C API Multiple Statement Execution Support”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-next-result-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<div class="informaltable">
<table summary="mysql_next_result() return values and a description of each value."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col">Return Value</th>
              <th scope="col">Description</th>
            </tr></thead><tbody><tr>
              <td scope="row">0</td>
              <td>Successful and there are more results</td>
            </tr><tr>
              <td scope="row">-1</td>
              <td>Successful and there are no more results</td>
            </tr><tr>
              <td scope="row">&gt;0</td>
              <td>An error occurred</td>
</tr></tbody></table>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-next-result-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order. For example,
              if you did not call
              <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a> for a
              previous result set.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-num-fields"></a>28.7.7.48&nbsp;mysql_num_fields()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091550005568"></a><a class="indexterm" name="idm140091550004496"></a><p>
        <code class="literal">unsigned int mysql_num_fields(MYSQL_RES
        *result)</code>
      </p><p>
        To pass a <code class="literal">MYSQL*</code> argument instead, use
        <code class="literal">unsigned int mysql_field_count(MYSQL *mysql)</code>.
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-num-fields-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the number of columns in a result set.
        </p><p>
          You can get the number of columns either from a pointer to a
          result set or to a connection handler. You would use the
          connection handler if
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a> returned
          <code class="literal">NULL</code> (and thus you have no result set
          pointer). In this case, you can call
          <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count()</code></a> to
          determine whether
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> should
          have produced a nonempty result. This enables the client
          program to take proper action without knowing whether the
          query was a <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a> (or
          <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a>-like) statement. The
          example shown here illustrates how this may be done.
        </p><p>
          See <a class="xref" href="connectors-apis.html#null-mysql-store-result" title="28.7.29.1&nbsp;Why mysql_store_result() Sometimes Returns NULL After mysql_query() Returns Success">Section&nbsp;28.7.29.1, “Why mysql_store_result() Sometimes Returns NULL After mysql_query()
        Returns Success”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-fields-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          An unsigned integer representing the number of columns in a
          result set.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-fields-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-fields-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">MYSQL_RES *result;<font></font>
unsigned int num_fields;<font></font>
unsigned int num_rows;<font></font>
<font></font>
if (mysql_query(&amp;mysql,query_string))<font></font>
{<font></font>
    // error<font></font>
}<font></font>
else // query succeeded, process any data returned by it<font></font>
{<font></font>
    result = mysql_store_result(&amp;mysql);<font></font>
    if (result)  // there are rows<font></font>
    {<font></font>
        num_fields = mysql_num_fields(result);<font></font>
        // retrieve rows, then call mysql_free_result(result)<font></font>
    }<font></font>
    else  // mysql_store_result() returned nothing; should it have?<font></font>
    {<font></font>
        if (mysql_errno(&amp;mysql))<font></font>
        {<font></font>
           fprintf(stderr, "Error: %s\n", mysql_error(&amp;mysql));<font></font>
        }<font></font>
        else if (mysql_field_count(&amp;mysql) == 0)<font></font>
        {<font></font>
            // query does not return data<font></font>
            // (it was not a SELECT)<font></font>
            num_rows = mysql_affected_rows(&amp;mysql);<font></font>
        }<font></font>
    }<font></font>
}<font></font>
</pre><p>
          An alternative (if you know that your query should have
          returned a result set) is to replace the
          <a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14&nbsp;mysql_errno()"><code class="literal">mysql_errno(&amp;mysql)</code></a> call
          with a check whether
          <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count(&amp;mysql)</code></a>
          returns 0. This happens only if something went wrong.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-num-rows"></a>28.7.7.49&nbsp;mysql_num_rows()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549977360"></a><p>
        <code class="literal">my_ulonglong mysql_num_rows(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-num-rows-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Returns the number of rows in the result set.
        </p><p>
          The use of <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49&nbsp;mysql_num_rows()"><code class="literal">mysql_num_rows()</code></a>
          depends on whether you use
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a> to return
          the result set. If you use
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79&nbsp;mysql_store_result()"><code class="literal">mysql_store_result()</code></a>,
          <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49&nbsp;mysql_num_rows()"><code class="literal">mysql_num_rows()</code></a> may be called
          immediately. If you use
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81&nbsp;mysql_use_result()"><code class="literal">mysql_use_result()</code></a>,
          <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49&nbsp;mysql_num_rows()"><code class="literal">mysql_num_rows()</code></a> does not
          return the correct value until all the rows in the result set
          have been retrieved.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49&nbsp;mysql_num_rows()"><code class="literal">mysql_num_rows()</code></a> is intended
          for use with statements that return a result set, such as
          <a class="link" href="sql-syntax.html#select" title="13.2.10&nbsp;SELECT Syntax"><code class="literal">SELECT</code></a>. For statements such as
          <a class="link" href="sql-syntax.html#insert" title="13.2.6&nbsp;INSERT Syntax"><code class="literal">INSERT</code></a>,
          <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a>, or
          <a class="link" href="sql-syntax.html#delete" title="13.2.2&nbsp;DELETE Syntax"><code class="literal">DELETE</code></a>, the number of affected
          rows can be obtained with
          <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1&nbsp;mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-rows-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          The number of rows in the result set.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-rows-errors"></a>Errors</h5>

</div>

</div>

</div>
<p>
          None.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-options"></a>28.7.7.50&nbsp;mysql_options()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549951600"></a><p>
        <code class="literal">int mysql_options(MYSQL *mysql, enum mysql_option
        option, const void *arg)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-options-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Can be used to set extra connect options and affect behavior
          for a connection. This function may be called multiple times
          to set several options. To retrieve option values, use
          <a class="link" href="connectors-apis.html#mysql-get-option" title="28.7.7.30&nbsp;mysql_get_option()"><code class="literal">mysql_get_option()</code></a>.
        </p><p>
          Call <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a> after
          <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a> and before
          <a class="link" href="connectors-apis.html#mysql-connect" title="28.7.7.7&nbsp;mysql_connect()"><code class="literal">mysql_connect()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>.
        </p><p>
          The <code class="literal">option</code> argument is the option that you
          want to set; the <code class="literal">arg</code> argument is the value
          for the option. If the option is an integer, specify a pointer
          to the value of the integer as the <code class="literal">arg</code>
          argument.
        </p><p>
          Options for information such as SSL certificate and key files
          are used to establish an encrypted connection if such
          connections are available, but do not enforce any requirement
          that the connection obtained be encrypted. To require an
          encrypted connection, use the technique described in
          <a class="xref" href="connectors-apis.html#c-api-encrypted-connections" title="28.7.22&nbsp;C API Encrypted Connection Support">Section&nbsp;28.7.22, “C API Encrypted Connection Support”</a>.
        </p><p>
          The following list describes the possible options, their
          effect, and how <code class="literal">arg</code> is used for each
          option. For option descriptions that indicate
          <code class="literal">arg</code> is unused, its value is irrelevant; it
          is conventional to pass 0.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">MYSQL_DEFAULT_AUTH</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The name of the authentication plugin to use.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_ENABLE_CLEARTEXT_PLUGIN</code> (argument
              type: <code class="literal">bool *</code>)
            </p><p>
              Enable the <code class="literal">mysql_clear_password</code>
              cleartext authentication plugin. See
              <a class="xref" href="security.html#cleartext-pluggable-authentication" title="6.4.1.4&nbsp;Client-Side Cleartext Pluggable Authentication">Section&nbsp;6.4.1.4, “Client-Side Cleartext Pluggable Authentication”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_INIT_COMMAND</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              SQL statement to execute when connecting to the MySQL
              server. Automatically re-executed if reconnection occurs.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_BIND</code> (argument: <code class="literal">char
              *</code>)
            </p><p>
              The network interface from which to connect to the server.
              This is used when the client host has multiple network
              interfaces. The argument is a host name or IP address
              (specified as a string).
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CAN_HANDLE_EXPIRED_PASSWORDS</code>
              (argument type: <code class="literal">bool *</code>)
            </p><p>
              Indicate whether the client can handle expired passwords.
              See <a class="xref" href="security.html#expired-password-handling" title="6.2.16&nbsp;Server Handling of Expired Passwords">Section&nbsp;6.2.16, “Server Handling of Expired Passwords”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_COMPRESS</code> (argument: not used)
            </p><p>
              Compress all information sent between the client and the
              server if possible. See
              <a class="xref" href="programs.html#connection-compression-control" title="4.2.5&nbsp;Connection Compression Control">Section&nbsp;4.2.5, “Connection Compression Control”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_DELETE</code> (argument
              type: <code class="literal">char *</code>)
            </p><p>
              Given a key name, this option deletes a key-value pair
              from the current set of connection attributes to pass to
              the server at connect time. The argument is a pointer to a
              null-terminated string naming the key. Comparison of the
              key name with existing keys is case-sensitive.
            </p><p>
              See also the description for the
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_RESET</code> option, as
              well as the description for the
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_ADD</code> option in
              the description of the
              <a class="link" href="connectors-apis.html#mysql-options4" title="28.7.7.51&nbsp;mysql_options4()"><code class="literal">mysql_options4()</code></a> function.
              That function description also includes a usage example.
            </p><p>
              The Performance Schema exposes connection attributes
              through the
              <a class="link" href="performance-schema.html#session-connect-attrs-table" title="26.12.9.2&nbsp;The session_connect_attrs Table"><code class="literal">session_connect_attrs</code></a> and
              <a class="link" href="performance-schema.html#session-account-connect-attrs-table" title="26.12.9.1&nbsp;The session_account_connect_attrs Table"><code class="literal">session_account_connect_attrs</code></a>
              tables. See
              <a class="xref" href="performance-schema.html#performance-schema-connection-attribute-tables" title="26.12.9&nbsp;Performance Schema Connection Attribute Tables">Section&nbsp;26.12.9, “Performance Schema Connection Attribute Tables”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_RESET</code> (argument
              not used)
            </p><p>
              This option resets (clears) the current set of connection
              attributes to pass to the server at connect time.
            </p><p>
              See also the description for the
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_DELETE</code> option,
              as well as the description for the
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_ADD</code> option in
              the description of the
              <a class="link" href="connectors-apis.html#mysql-options4" title="28.7.7.51&nbsp;mysql_options4()"><code class="literal">mysql_options4()</code></a> function.
              That function description also includes a usage example.
            </p><p>
              The Performance Schema exposes connection attributes
              through the
              <a class="link" href="performance-schema.html#session-connect-attrs-table" title="26.12.9.2&nbsp;The session_connect_attrs Table"><code class="literal">session_connect_attrs</code></a> and
              <a class="link" href="performance-schema.html#session-account-connect-attrs-table" title="26.12.9.1&nbsp;The session_account_connect_attrs Table"><code class="literal">session_account_connect_attrs</code></a>
              tables. See
              <a class="xref" href="performance-schema.html#performance-schema-connection-attribute-tables" title="26.12.9&nbsp;Performance Schema Connection Attribute Tables">Section&nbsp;26.12.9, “Performance Schema Connection Attribute Tables”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CONNECT_TIMEOUT</code> (argument
              type: <code class="literal">unsigned int *</code>)
            </p><p>
              The connect timeout in seconds.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_GET_SERVER_PUBLIC_KEY</code>
              (argument type: <code class="literal">bool *</code>)
            </p><p>
              Enables the client to request from the server the public
              key required for RSA key pair-based password exchange.
              This option applies to clients that authenticate with the
              <code class="literal">caching_sha2_password</code> authentication
              plugin. For that plugin, the server does not send the
              public key unless requested. This option is ignored for
              accounts that do not authenticate with that plugin. It is
              also ignored if RSA-based password exchange is not used,
              as is the case when the client connects to the server
              using a secure connection.
            </p><p>
              If <code class="literal">MYSQL_SERVER_PUBLIC_KEY</code> is given and
              specifies a valid public key file, it takes precedence
              over <code class="literal">MYSQL_OPT_GET_SERVER_PUBLIC_KEY</code>.
            </p><p>
              For information about the
              <code class="literal">caching_sha2_password</code> plugin, see
              <a class="xref" href="security.html#caching-sha2-pluggable-authentication" title="6.4.1.3&nbsp;Caching SHA-2 Pluggable Authentication">Section&nbsp;6.4.1.3, “Caching SHA-2 Pluggable Authentication”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_LOCAL_INFILE</code> (argument type:
              optional pointer to <code class="literal">unsigned int</code>)
            </p><p>
              This option affects client-side <code class="literal">LOCAL</code>
              capability for <a class="link" href="sql-syntax.html#load-data" title="13.2.7&nbsp;LOAD DATA Syntax"><code class="literal">LOAD DATA</code></a>
              operations. By default, <code class="literal">LOCAL</code>
              capability is determined by the default compiled into the
              MySQL client library (see <a class="xref" href="sql-syntax.html#load-data" title="13.2.7&nbsp;LOAD DATA Syntax">Section&nbsp;13.2.7, “LOAD DATA Syntax”</a>). To
              control this capability explicitly, invoke
              <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a> to set the
              <code class="literal">MYSQL_OPT_LOCAL_INFILE</code> option:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">LOCAL</code> is disabled if the pointer
                  points to an <code class="literal">unsigned int</code> that has
                  a zero value.
                </p></li><li class="listitem"><p>
                  <code class="literal">LOCAL</code> is enabled if no pointer is
                  given or if the pointer points to an <code class="literal">unsigned
                  int</code> that has a nonzero value.
</p></li></ul>
</div>
<p>
              Successful use of a <code class="literal">LOCAL</code> load
              operation by a client also requires that the server
              permits it.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_MAX_ALLOWED_PACKET</code> (argument:
              <code class="literal">unsigned long *</code>)
            </p><p>
              This option sets the
              <a class="link" href="server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a> system
              variable. If the <code class="literal">mysql</code> argument is
              non-<code class="literal">NULL</code>, the call sets the session
              system variable value for that session. If
              <code class="literal">mysql</code> is <code class="literal">NULL</code>, the
              call sets the global system variable value.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_NAMED_PIPE</code> (argument: not
              used)
            </p><p>
              Use a named pipe to connect to the MySQL server on
              Windows, if the server permits named-pipe connections.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_NET_BUFFER_LENGTH</code> (argument:
              <code class="literal">unsigned long *</code>)
            </p><p>
              This option sets the
              <a class="link" href="server-administration.html#sysvar_net_buffer_length"><code class="literal">net_buffer_length</code></a> system
              variable. If the <code class="literal">mysql</code> argument is
              non-<code class="literal">NULL</code>, the call sets the session
              system variable value for that session. If
              <code class="literal">mysql</code> is <code class="literal">NULL</code>, the
              call sets the global system variable value.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_OPTIONAL_RESULTSET_METADATA</code>
              (argument type: <code class="literal">bool *</code>)
            </p><p>
              This flag makes result set metadata optional. It is an
              alternative way of setting the
              <code class="literal">CLIENT_OPTIONAL_RESULTSET_METADATA</code>
              connection flag for the
              <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>
              function. For details about managing result set metadata
              transfer, see <a class="xref" href="connectors-apis.html#c-api-optional-metadata" title="28.7.27&nbsp;C API Optional Result Set Metadata">Section&nbsp;28.7.27, “C API Optional Result Set Metadata”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_PROTOCOL</code> (argument type:
              <code class="literal">unsigned int *</code>)
            </p><p>
              Type of protocol to use. Specify one of the enum values of
              <code class="literal">mysql_protocol_type</code> defined in
              <code class="filename">mysql.h</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_READ_TIMEOUT</code> (argument type:
              <code class="literal">unsigned int *</code>)
            </p><p>
              The timeout in seconds for each attempt to read from the
              server. There are retries if necessary, so the total
              effective timeout value is three times the option value.
              You can set the value so that a lost connection can be
              detected earlier than the TCP/IP
              <code class="literal">Close_Wait_Timeout</code> value of 10 minutes.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_RECONNECT</code> (argument type:
              <code class="literal">bool *</code>)
            </p><p>
              Enable or disable automatic reconnection to the server if
              the connection is found to have been lost. Reconnect is
              off by default; this option provides a way to set
              reconnection behavior explicitly. See
              <a class="xref" href="connectors-apis.html#c-api-auto-reconnect" title="28.7.28&nbsp;C API Automatic Reconnection Control">Section&nbsp;28.7.28, “C API Automatic Reconnection Control”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_RETRY_COUNT</code> (argument type:
              <code class="literal">unsigned int *</code>)
            </p><p>
              The retry count for I/O-related system calls that are
              interrupted while connecting to the server or
              communicating with it. If this option is not specified,
              the default value is 1 (1 retry if the initial call is
              interrupted for 2 tries total).
            </p><p>
              This option can be used only by clients that link against
              a C client library compiled with NDB Cluster support.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CA</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The path name of the Certificate Authority (CA)
              certificate file. This option, if used, must specify the
              same certificate used by the server.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CAPATH</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The path name of the directory that contains trusted SSL
              CA certificate files.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CERT</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The path name of the client public key certificate file.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CIPHER</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The list of permitted ciphers for SSL encryption.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CRL</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The path name of the file containing certificate
              revocation lists.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CRLPATH</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The path name of the directory that contains files
              containing certificate revocation lists.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_FIPS_MODE</code> (argument type:
              <code class="literal">unsigned int *</code>)
            </p><p>
              Controls whether to enable FIPS mode on the client side.
              The <code class="literal">MYSQL_OPT_SSL_FIPS_MODE</code> option
              differs from other
              <code class="literal">MYSQL_OPT_SSL_<em class="replaceable"><code>xxx</code></em></code>
              options in that it is not used to establish encrypted
              connections, but rather to affect which cryptographic
              operations are permitted. See <a class="xref" href="security.html#fips-mode" title="6.5&nbsp;FIPS Support">Section&nbsp;6.5, “FIPS Support”</a>.
            </p><p>
              Permitted option values are
              <code class="literal">SSL_FIPS_MODE_OFF</code>,
              <code class="literal">SSL_FIPS_MODE_ON</code>, and
              <code class="literal">SSL_FIPS_MODE_STRICT</code>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
                If the OpenSSL FIPS Object Module is not available, the
                only permitted value for
                <code class="literal">MYSQL_OPT_SSL_FIPS_MODE</code> is
                <code class="literal">SSL_FIPS_MODE_OFF</code>. In this case,
                setting <code class="literal">MYSQL_OPT_SSL_FIPS_MODE</code> to
                <code class="literal">SSL_FIPS_MODE_ON</code> or
                <code class="literal">SSL_FIPS_MODE_STRICT</code> causes the
                client to produce a warning at startup and to operate in
                non-FIPS mode.
</p>
</div>
</li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_KEY</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The path name of the client private key file.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_MODE</code> (argument type:
              <code class="literal">unsigned int *</code>)
            </p><p>
              The security state to use for the connection to the
              server: <code class="literal">SSL_MODE_DISABLED</code>,
              <code class="literal">SSL_MODE_PREFERRED</code>,
              <code class="literal">SSL_MODE_REQUIRED</code>,
              <code class="literal">SSL_MODE_VERIFY_CA</code>,
              <code class="literal">SSL_MODE_VERIFY_IDENTITY</code>. If this
              option is not specified, the default is
              <code class="literal">SSL_MODE_PREFERRED</code>. These modes are the
              permitted values of the <code class="literal">mysql_ssl_mode</code>
              enumeration defined in <code class="filename">mysql.h</code>. For
              more information about the security states, see the
              description of <a class="link" href="security.html#option_general_ssl-mode"><code class="option">--ssl-mode</code></a>
              in <a class="xref" href="security.html#encrypted-connection-options" title="6.3.2&nbsp;Command Options for Encrypted Connections">Section&nbsp;6.3.2, “Command Options for Encrypted Connections”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_TLS_CIPHERSUITES</code> (argument
              type: <code class="literal">char *</code>)
            </p><p>
              Which TLSv1.3 ciphersuites the client permits for
              encrypted connections. The value is a list of one or more
              colon-separated ciphersuite names. The ciphersuites that
              can be named for this option depend on the SSL library
              used to compile MySQL. For details, see
              <a class="xref" href="security.html#encrypted-connection-protocols-ciphers" title="6.3.6&nbsp;Encrypted Connection Protocols and Ciphers">Section&nbsp;6.3.6, “Encrypted Connection Protocols and Ciphers”</a>.
            </p><p>
              This option was added in MySQL 8.0.16.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_TLS_VERSION</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              Which protocols the client permits for encrypted
              connections. The value is a list of one or more
              comma-separated protocol names. The protocols that can be
              named for this option depend on the SSL library used to
              compile MySQL. For details, see
              <a class="xref" href="security.html#encrypted-connection-protocols-ciphers" title="6.3.6&nbsp;Encrypted Connection Protocols and Ciphers">Section&nbsp;6.3.6, “Encrypted Connection Protocols and Ciphers”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_USE_RESULT</code> (argument: not
              used)
            </p><p>
              This option is unused.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_WRITE_TIMEOUT</code> (argument type:
              <code class="literal">unsigned int *</code>)
            </p><p>
              The timeout in seconds for each attempt to write to the
              server. There is a retry if necessary, so the total
              effective timeout value is two times the option value.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_PLUGIN_DIR</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The directory in which to look for client plugins.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_READ_DEFAULT_FILE</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              Read options from the named option file instead of from
              <code class="filename">my.cnf</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_READ_DEFAULT_GROUP</code> (argument
              type: <code class="literal">char *</code>)
            </p><p>
              Read options from the named group from
              <code class="filename">my.cnf</code> or the file specified with
              <code class="literal">MYSQL_READ_DEFAULT_FILE</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_REPORT_DATA_TRUNCATION</code> (argument
              type: <code class="literal">bool *</code>)
            </p><p>
              Enable or disable reporting of data truncation errors for
              prepared statements using the <code class="literal">error</code>
              member of <code class="literal">MYSQL_BIND</code> structures.
              (Default: enabled.)
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SERVER_PUBLIC_KEY</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The path name of the file containing a client-side copy of
              the public key required by the server for RSA key
              pair-based password exchange. The file must be in PEM
              format. This option applies to clients that authenticate
              with the <code class="literal">sha256_password</code> or
              <code class="literal">caching_sha2_password</code> authentication
              plugin. This option is ignored for accounts that do not
              authenticate with one of those plugins. It is also ignored
              if RSA-based password exchange is not used, as is the case
              when the client connects to the server using a secure
              connection.
            </p><p>
              If <code class="literal">MYSQL_SERVER_PUBLIC_KEY</code> is given and
              specifies a valid public key file, it takes precedence
              over <code class="literal">MYSQL_OPT_GET_SERVER_PUBLIC_KEY</code>.
            </p><p>
              For information about the
              <code class="literal">sha256_password</code> and
              <code class="literal">caching_sha2_password</code> plugins, see
              <a class="xref" href="security.html#sha256-pluggable-authentication" title="6.4.1.2&nbsp;SHA-256 Pluggable Authentication">Section&nbsp;6.4.1.2, “SHA-256 Pluggable Authentication”</a>, and
              <a class="xref" href="security.html#caching-sha2-pluggable-authentication" title="6.4.1.3&nbsp;Caching SHA-2 Pluggable Authentication">Section&nbsp;6.4.1.3, “Caching SHA-2 Pluggable Authentication”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SET_CHARSET_DIR</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The path name of the directory that contains character set
              definition files.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SET_CHARSET_NAME</code> (argument type:
              <code class="literal">char *</code>)
            </p><p>
              The name of the character set to use as the default
              character set. The argument can be
              <code class="literal">MYSQL_AUTODETECT_CHARSET_NAME</code> to cause
              the character set to be autodetected based on the
              operating system setting (see
              <a class="xref" href="charset.html#charset-connection" title="10.4&nbsp;Connection Character Sets and Collations">Section&nbsp;10.4, “Connection Character Sets and Collations”</a>).
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SHARED_MEMORY_BASE_NAME</code> (argument
              type: <code class="literal">char *</code>)
            </p><p>
              The name of the shared-memory object for communication to
              the server on Windows, if the server supports
              shared-memory connections. Specify the same value as the
              <a class="link" href="server-administration.html#option_mysqld_shared-memory-base-name"><code class="option">--shared-memory-base-name</code></a>
              option used for the <a class="link" href="programs.html#mysqld" title="4.3.1&nbsp;mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> server you
              want to connect to.
</p></li></ul>
</div>
<p>
          The <code class="literal">client</code> group is always read if you use
          <code class="literal">MYSQL_READ_DEFAULT_FILE</code> or
          <code class="literal">MYSQL_READ_DEFAULT_GROUP</code>.
        </p><p>
          The specified group in the option file may contain the
          following options.
</p>
<div class="informaltable">
<table summary="Options that may appear in the option file and a description of each option."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col">Option</th>
              <th scope="col">Description</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">character-sets-dir=<em class="replaceable"><code>dir_name</code></em></code></td>
              <td>The directory where character sets are installed.</td>
            </tr><tr>
              <td scope="row"><code class="literal">compress</code></td>
              <td>Use the compressed client/server protocol.</td>
            </tr><tr>
              <td scope="row"><code class="literal">connect-timeout=<em class="replaceable"><code>seconds</code></em></code></td>
              <td>The connect timeout in seconds. On Linux this timeout is also used for
                waiting for the first answer from the server.</td>
            </tr><tr>
              <td scope="row"><code class="literal">database=<em class="replaceable"><code>db_name</code></em></code></td>
              <td>Connect to this database if no database was specified in the connect
                command.</td>
            </tr><tr>
              <td scope="row"><code class="literal">debug</code></td>
              <td>Debug options.</td>
            </tr><tr>
              <td scope="row"><code class="literal">default-character-set=<em class="replaceable"><code>charset_name</code></em></code></td>
              <td>The default character set to use.</td>
            </tr><tr>
              <td scope="row"><code class="literal">disable-local-infile</code></td>
              <td>Disable use of <a class="link" href="sql-syntax.html#load-data" title="13.2.7&nbsp;LOAD DATA Syntax"><code class="literal">LOAD DATA
                LOCAL</code></a>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">enable-cleartext-plugin</code></td>
              <td>Enable the <code class="literal">mysql_clear_password</code> cleartext
                authentication plugin.</td>
            </tr><tr>
              <td scope="row"><code class="literal">host=<em class="replaceable"><code>host_name</code></em></code></td>
              <td>Default host name.</td>
            </tr><tr>
              <td scope="row"><code class="literal">init-command=<em class="replaceable"><code>stmt</code></em></code></td>
              <td>Statement to execute when connecting to MySQL server. Automatically
                re-executed if reconnection occurs.</td>
            </tr><tr>
              <td scope="row"><code class="literal">interactive-timeout=<em class="replaceable"><code>seconds</code></em></code></td>
              <td>Same as specifying <code class="literal">CLIENT_INTERACTIVE</code> to
                <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>.
                See <a class="xref" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()">Section&nbsp;28.7.7.54, “mysql_real_connect()”</a>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">local-infile[={0|1}]</code></td>
              <td>If no argument or nonzero argument, enable use of
                <a class="link" href="sql-syntax.html#load-data" title="13.2.7&nbsp;LOAD DATA Syntax"><code class="literal">LOAD DATA
                LOCAL</code></a>; otherwise disable.</td>
            </tr><tr>
              <td scope="row"><code class="literal">max_allowed_packet=<em class="replaceable"><code>bytes</code></em></code></td>
              <td>Maximum size of packet that client can read from server.</td>
            </tr><tr>
              <td scope="row"><code class="literal">multi-queries</code>, <code class="literal">multi-results</code></td>
              <td>Enable multiple result sets from multiple-statement executions or stored
                procedures.</td>
            </tr><tr>
              <td scope="row"><code class="literal">multi-statements</code></td>
              <td>Enable the client to send multiple statements in a single string
                (separated by <code class="literal">;</code> characters).</td>
            </tr><tr>
              <td scope="row"><code class="literal">password=<em class="replaceable"><code>password</code></em></code></td>
              <td>Default password.</td>
            </tr><tr>
              <td scope="row"><code class="literal">pipe</code></td>
              <td>Use named pipes to connect to a MySQL server on Windows.</td>
            </tr><tr>
              <td scope="row"><code class="literal">port=<em class="replaceable"><code>port_num</code></em></code></td>
              <td>Default port number.</td>
            </tr><tr>
              <td scope="row"><code class="literal">protocol={TCP|SOCKET|PIPE|MEMORY}</code></td>
              <td>The protocol to use when connecting to the server.</td>
            </tr><tr>
              <td scope="row"><code class="literal">return-found-rows</code></td>
              <td>Tell <a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36&nbsp;mysql_info()"><code class="literal">mysql_info()</code></a> to return found rows
                instead of updated rows when using
                <a class="link" href="sql-syntax.html#update" title="13.2.12&nbsp;UPDATE Syntax"><code class="literal">UPDATE</code></a>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">shared-memory-base-name=<em class="replaceable"><code>name</code></em></code></td>
              <td>Shared-memory name to use to connect to server.</td>
            </tr><tr>
              <td scope="row"><code class="literal">socket={<em class="replaceable"><code>file_name</code></em>|<em class="replaceable"><code>pipe_name</code></em>}</code></td>
              <td>Default socket file.</td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-ca=<em class="replaceable"><code>file_name</code></em></code></td>
              <td>Certificate Authority file.</td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-capath=<em class="replaceable"><code>dir_name</code></em></code></td>
              <td>Certificate Authority directory.</td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-cert=<em class="replaceable"><code>file_name</code></em></code></td>
              <td>Certificate file.</td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-cipher=<em class="replaceable"><code>cipher_list</code></em></code></td>
              <td>Permissible SSL ciphers.</td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-key=<em class="replaceable"><code>file_name</code></em></code></td>
              <td>Key file.</td>
            </tr><tr>
              <td scope="row"><code class="literal">timeout=<em class="replaceable"><code>seconds</code></em></code></td>
              <td>Like <code class="literal">connect-timeout</code>.</td>
            </tr><tr>
              <td scope="row"><code class="literal">user</code></td>
              <td>Default user.</td>
</tr></tbody></table>
</div>
<p>
          <code class="literal">timeout</code> has been replaced by
          <code class="literal">connect-timeout</code>, but
          <code class="literal">timeout</code> is still supported for backward
          compatibility.
        </p><p>
          For more information about option files used by MySQL
          programs, see <a class="xref" href="programs.html#option-files" title="4.2.2.2&nbsp;Using Option Files">Section&nbsp;4.2.2.2, “Using Option Files”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if you specify an unknown option.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options-example"></a>Example</h5>

</div>

</div>

</div>
<p>
          The following <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a>
          calls request the use of compression in the client/server
          protocol, cause options to be read from the
          <code class="literal">[odbc]</code> group in option files, and disable
          transaction autocommit mode:
        </p><pre data-lang="c" class="programlisting">MYSQL mysql;<font></font>
<font></font>
mysql_init(&amp;mysql);<font></font>
mysql_options(&amp;mysql,MYSQL_OPT_COMPRESS,0);<font></font>
mysql_options(&amp;mysql,MYSQL_READ_DEFAULT_GROUP,"odbc");<font></font>
mysql_options(&amp;mysql,MYSQL_INIT_COMMAND,"SET autocommit=0");<font></font>
if (!mysql_real_connect(&amp;mysql,"host","user","passwd","database",0,NULL,0))<font></font>
{<font></font>
    fprintf(stderr, "Failed to connect to database: Error: %s\n",<font></font>
          mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-options4"></a>28.7.7.51&nbsp;mysql_options4()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549624064"></a><p>
        <code class="literal">int mysql_options4(MYSQL *mysql, enum mysql_option
        option, const void *arg1, const void *arg2)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-options4-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-options4" title="28.7.7.51&nbsp;mysql_options4()"><code class="literal">mysql_options4()</code></a> is similar to
          <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a> but has an
          extra fourth argument so that two values can be passed for the
          option specified in the second argument.
        </p><p>
          The following list describes the permitted options, their
          effect, and how <code class="literal">arg1</code> and
          <code class="literal">arg2</code> are used.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_ADD</code> (argument
              types: <code class="literal">char *, char *</code>)
            </p><p>
              This option adds an attribute key-value pair to the
              current set of connection attributes to pass to the server
              at connect time. Both arguments are pointers to
              null-terminated strings. The first and second strings
              indicate the key and value, respectively. If the key is
              empty or already exists in the current set of connection
              attributes, an error occurs. Comparison of the key name
              with existing keys is case-sensitive.
            </p><p>
              Key names that begin with an underscore
              (<code class="literal">_</code>) are reserved for internal use and
              should not be created by application programs. This
              convention permits new attributes to be introduced by
              MySQL without colliding with application attributes.
            </p><p>
              <a class="link" href="connectors-apis.html#mysql-options4" title="28.7.7.51&nbsp;mysql_options4()"><code class="literal">mysql_options4()</code></a> imposes a
              limit of 64KB on the aggregate size of connection
              attribute data it will accept. For calls that cause this
              limit to be exceeded, a
              <a class="link" href="error-handling.html#error_cr_invalid_parameter_no"><code class="literal">CR_INVALID_PARAMETER_NO</code></a>
              error occurs. Attribute size-limit checks also occur on
              the server side. For details, see
              <a class="xref" href="performance-schema.html#performance-schema-connection-attribute-tables" title="26.12.9&nbsp;Performance Schema Connection Attribute Tables">Section&nbsp;26.12.9, “Performance Schema Connection Attribute Tables”</a>,
              which also describes how the Performance Schema exposes
              connection attributes through the
              <a class="link" href="performance-schema.html#session-connect-attrs-table" title="26.12.9.2&nbsp;The session_connect_attrs Table"><code class="literal">session_connect_attrs</code></a> and
              <a class="link" href="performance-schema.html#session-account-connect-attrs-table" title="26.12.9.1&nbsp;The session_account_connect_attrs Table"><code class="literal">session_account_connect_attrs</code></a>
              tables.
            </p><p>
              See also the descriptions for the
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_RESET</code> and
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_DELETE</code> options
              in the description of the
              <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a> function.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options4-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if you specify an unknown option.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options4-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_duplicate_connection_attr"><code class="literal">CR_DUPLICATE_CONNECTION_ATTR</code></a>
            </p><p>
              A duplicate attribute name was specified.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_invalid_parameter_no"><code class="literal">CR_INVALID_PARAMETER_NO</code></a>
            </p><p>
              A key name was empty or the amount of key-value connection
              attribute data exceeds 64KB limit.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p>
              Out of memory.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options4-example"></a>Example</h5>

</div>

</div>

</div>
<p>
          This example demonstrates the calls that specify connection
          attributes:
        </p><pre data-lang="c" class="programlisting">MYSQL mysql;<font></font>
<font></font>
mysql_init(&amp;mysql);<font></font>
mysql_options(&amp;mysql,MYSQL_OPT_CONNECT_ATTR_RESET, 0);<font></font>
mysql_options4(&amp;mysql,MYSQL_OPT_CONNECT_ATTR_ADD, "key1", "value1");<font></font>
mysql_options4(&amp;mysql,MYSQL_OPT_CONNECT_ATTR_ADD, "key2", "value2");<font></font>
mysql_options4(&amp;mysql,MYSQL_OPT_CONNECT_ATTR_ADD, "key3", "value3");<font></font>
mysql_options(&amp;mysql,MYSQL_OPT_CONNECT_ATTR_DELETE, "key1");<font></font>
if (!mysql_real_connect(&amp;mysql,"host","user","passwd","database",0,NULL,0))<font></font>
{<font></font>
    fprintf(stderr, "Failed to connect to database: Error: %s\n",<font></font>
        mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-ping"></a>28.7.7.52&nbsp;mysql_ping()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549585552"></a><p>
        <code class="literal">int mysql_ping(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-ping-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Checks whether the connection to the server is working. If the
          connection has gone down and auto-reconnect is enabled an
          attempt to reconnect is made. If the connection is down and
          auto-reconnect is disabled,
          <a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52&nbsp;mysql_ping()"><code class="literal">mysql_ping()</code></a> returns an error.
        </p><p>
          Auto-reconnect is disabled by default. To enable it, call
          <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a> with the
          <code class="literal">MYSQL_OPT_RECONNECT</code> option. For details,
          see <a class="xref" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()">Section&nbsp;28.7.7.50, “mysql_options()”</a>.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52&nbsp;mysql_ping()"><code class="literal">mysql_ping()</code></a> can be used by
          clients that remain idle for a long while, to check whether
          the server has closed the connection and reconnect if
          necessary.
        </p><p>
          If <a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52&nbsp;mysql_ping()"><code class="literal">mysql_ping()</code></a>) does cause a
          reconnect, there is no explicit indication of it. To determine
          whether a reconnect occurs, call
          <a class="link" href="connectors-apis.html#mysql-thread-id" title="28.7.7.80&nbsp;mysql_thread_id()"><code class="literal">mysql_thread_id()</code></a> to get the
          original connection identifier before calling
          <a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52&nbsp;mysql_ping()"><code class="literal">mysql_ping()</code></a>, then call
          <a class="link" href="connectors-apis.html#mysql-thread-id" title="28.7.7.80&nbsp;mysql_thread_id()"><code class="literal">mysql_thread_id()</code></a> again to see
          whether the identifier has changed.
        </p><p>
          If reconnect occurs, some characteristics of the connection
          will have been reset. For details about these characteristics,
          see <a class="xref" href="connectors-apis.html#c-api-auto-reconnect" title="28.7.28&nbsp;C API Automatic Reconnection Control">Section&nbsp;28.7.28, “C API Automatic Reconnection Control”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-ping-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero if the connection to the server is active. Nonzero if an
          error occurred. A nonzero return does not indicate whether the
          MySQL server itself is down; the connection might be broken
          for other reasons such as network problems.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-ping-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-query"></a>28.7.7.53&nbsp;mysql_query()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549556512"></a><p>
        <code class="literal">int mysql_query(MYSQL *mysql, const char
        *stmt_str)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-query-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          Executes the SQL statement pointed to by the null-terminated
          string <code class="literal">stmt_str</code>. Normally, the string must
          consist of a single SQL statement without a terminating
          semicolon (<code class="literal">;</code>) or <code class="literal">\g</code>. If
          multiple-statement execution has been enabled, the string can
          contain several statements separated by semicolons. See
          <a class="xref" href="connectors-apis.html#c-api-multiple-queries" title="28.7.23&nbsp;C API Multiple Statement Execution Support">Section&nbsp;28.7.23, “C API Multiple Statement Execution Support”</a>.
        </p><p>
          <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> cannot be used
          for statements that contain binary data; you must use
          <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57&nbsp;mysql_real_query()"><code class="literal">mysql_real_query()</code></a> instead.
          (Binary data may contain the <code class="literal">\0</code> character,
          which <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53&nbsp;mysql_query()"><code class="literal">mysql_query()</code></a> interprets
          as the end of the statement string.)
        </p><p>
          If you want to know whether the statement returns a result
          set, you can use
          <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()"><code class="literal">mysql_field_count()</code></a> to check
          for this. See <a class="xref" href="connectors-apis.html#mysql-field-count" title="28.7.7.22&nbsp;mysql_field_count()">Section&nbsp;28.7.7.22, “mysql_field_count()”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-query-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          Zero for success. Nonzero if an error occurred.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-query-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p>
              Commands were executed in an improper order.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p>
              The MySQL server has gone away.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              The connection to the server was lost during the query.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p>
              An unknown error occurred.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-connect"></a>28.7.7.54&nbsp;mysql_real_connect()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549527808"></a><p>
        <code class="literal">MYSQL *mysql_real_connect(MYSQL *mysql, const char
        *host, const char *user, const char *passwd, const char *db,
        unsigned int port, const char *unix_socket, unsigned long
        client_flag)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-connect-description"></a>Description</h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> is a
            synchronous function. Its asynchronous counterpart is
            <a class="link" href="connectors-apis.html#mysql-real-connect-nonblocking" title="28.7.15.4&nbsp;mysql_real_connect_nonblocking()"><code class="literal">mysql_real_connect_nonblocking()</code></a>,
            for use by applications that require asynchronous
            communication with the server. See
            <a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12&nbsp;C API Asynchronous Interface">Section&nbsp;28.7.12, “C API Asynchronous Interface”</a>.
</p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> attempts
          to establish a connection to a MySQL database engine running
          on <code class="literal">host</code>.
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> must
          complete successfully before you can execute any other API
          functions that require a valid <code class="literal">MYSQL</code>
          connection handler structure.
        </p><p>
          The parameters are specified as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              For the first parameter, specify the address of an
              existing <code class="literal">MYSQL</code> structure. Before
              calling
              <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>, call
              <a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37&nbsp;mysql_init()"><code class="literal">mysql_init()</code></a> to initialize
              the <code class="literal">MYSQL</code> structure. You can change a
              lot of connect options with the
              <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a> call. See
              <a class="xref" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()">Section&nbsp;28.7.7.50, “mysql_options()”</a>.
            </p></li><li class="listitem"><p>
              The value of <code class="literal">host</code> may be either a host
              name or an IP address. The client attempts to connect as
              follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  If <code class="literal">host</code> is <code class="literal">NULL</code>
                  or the string <code class="literal">"localhost"</code>, a
                  connection to the local host is assumed:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      On Windows, the client connects using a
                      shared-memory connection, if the server has
                      shared-memory connections enabled.
                    </p></li><li class="listitem"><p>
                      On Unix, the client connects using a Unix socket
                      file. The <code class="literal">unix_socket</code> parameter
                      or the <code class="literal">MYSQL_UNIX_PORT</code>
                      environment variable may be used to specify the
                      socket name.
</p></li></ul>
</div>
</li><li class="listitem"><p>
                  On Windows, if <code class="literal">host</code> is
                  <code class="literal">"."</code>, or TCP/IP is not enabled and
                  no <code class="literal">unix_socket</code> is specified or the
                  host is empty, the client connects using a named pipe,
                  if the server has named-pipe connections enabled. If
                  named-pipe connections are not enabled, an error
                  occurs.
                </p></li><li class="listitem"><p>
                  Otherwise, TCP/IP is used.
</p></li></ul>
</div>
<p>
              You can also influence the type of connection to use with
              the <code class="literal">MYSQL_OPT_PROTOCOL</code> or
              <code class="literal">MYSQL_OPT_NAMED_PIPE</code> options to
              <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a>. The type
              of connection must be supported by the server.
            </p></li><li class="listitem"><p>
              The <code class="literal">user</code> parameter contains the user's
              MySQL login ID. If <code class="literal">user</code> is
              <code class="literal">NULL</code> or the empty string
              <code class="literal">""</code>, the current user is assumed. Under
              Unix, this is the current login name. Under Windows ODBC,
              the current user name must be specified explicitly. See
              the Connector/ODBC section of
              <a class="xref" href="connectors-apis.html" title="Chapter&nbsp;28&nbsp;Connectors and APIs">Chapter&nbsp;28, <i>Connectors and APIs</i></a>.
            </p></li><li class="listitem"><p>
              The <code class="literal">passwd</code> parameter contains the
              password for <code class="literal">user</code>. If
              <code class="literal">passwd</code> is <code class="literal">NULL</code>, only
              entries in the <code class="literal">user</code> table for the user
              that have a blank (empty) password field are checked for a
              match. This enables the database administrator to set up
              the MySQL privilege system in such a way that users get
              different privileges depending on whether they have
              specified a password.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
                Do not attempt to encrypt the password before calling
                <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54&nbsp;mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>;
                password encryption is handled automatically by the
                client API.
</p>
</div>
</li><li class="listitem"><p>
              The <code class="literal">user</code> and <code class="literal">passwd</code>
              parameters use whatever character set has been configured
              for the <code class="literal">MYSQL</code> object. By default, this
              is <code class="literal">utf8mb4</code>, but can be changed by
              calling <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options(mysql,
              MYSQL_SET_CHARSET_NAME,
              "<em class="replaceable"><code>charset_name</code></em>")</code></a> prior
              to connecting.
            </p></li><li class="listitem"><p>
              <code class="literal">db</code> is the database name. If
              <code class="literal">db</code> is not <code class="literal">NULL</code>, the
              connection sets the default database to this value.
            </p></li><li class="listitem"><p>
              If <code class="literal">port</code> is not 0, the value is used as
              the port number for the TCP/IP connection. Note that the
              <code class="literal">host</code> parameter determines the type of
              the connection.
            </p></li><li class="listitem"><p>
              If <code class="literal">unix_socket</code> is not
              <code class="literal">NULL</code>, the string specifies the socket
              or named pipe to use. Note that the
              <code class="literal">host</code> parameter determines the type of
              the connection.
            </p></li><li class="listitem"><p>
              The value of <code class="literal">client_flag</code> is usually 0,
              but can be set to a combination of the following flags to
              enable certain features:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">CAN_HANDLE_EXPIRED_PASSWORDS</code>: The
                  client can handle expired passwords. For more
                  information, see
                  <a class="xref" href="security.html#expired-password-handling" title="6.2.16&nbsp;Server Handling of Expired Passwords">Section&nbsp;6.2.16, “Server Handling of Expired Passwords”</a>.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_COMPRESS</code>: Use compression in
                  the client/server protocol.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_FOUND_ROWS</code>: Return the
                  number of found (matched) rows, not the number of
                  changed rows.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_IGNORE_SIGPIPE</code>: Prevents the
                  client library from installing a
                  <code class="literal">SIGPIPE</code> signal handler. This can be
                  used to avoid conflicts with a handler that the
                  application has already installed.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_IGNORE_SPACE</code>: Permit spaces
                  after function names. Makes all functions names
                  reserved words.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_INTERACTIVE</code>: Permit
                  <a class="link" href="server-administration.html#sysvar_interactive_timeout"><code class="literal">interactive_timeout</code></a>
                  seconds of inactivity (rather than
                  <a class="link" href="server-administration.html#sysvar_wait_timeout"><code class="literal">wait_timeout</code></a> seconds)
                  before closing the connection. The client's session
                  <a class="link" href="server-administration.html#sysvar_wait_timeout"><code class="literal">wait_timeout</code></a> variable
                  is set to the value of the session
                  <a class="link" href="server-administration.html#sysvar_interactive_timeout"><code class="literal">interactive_timeout</code></a>
                  variable.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_LOCAL_FILES</code>: Enable
                  <a class="link" href="sql-syntax.html#load-data" title="13.2.7&nbsp;LOAD DATA Syntax"><code class="literal">LOAD DATA
                  LOCAL</code></a> handling.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_MULTI_RESULTS</code>: Tell the
                  server that the client can handle multiple result sets
                  from multiple-statement executions or stored
                  procedures. This flag is automatically enabled if
                  <code class="literal">CLIENT_MULTI_STATEMENTS</code> is enabled.
                  See the note following this table for more information
                  about this flag.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_MULTI_STATEMENTS</code>: Tell the
                  server that the client may send multiple statements in
                  a single string (separated by <code class="literal">;</code>
                  characters). If this flag is not set,
                  multiple-statement execution is disabled. See the note
                  following this table for more information about this
                  flag.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_NO_SCHEMA</code> Do not permit
                  <em class="replaceable"><code>db_name.tbl_name.col_name</code></em>
                  syntax. This is for ODBC. It causes the parser to
                  generate an error if you use that syntax, which is
                  useful for trapping bugs in some ODBC programs.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_ODBC</code>: Unused.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_OPTIONAL_RESULTSET_METADATA</code>:
                  This flag makes result set metadata optional.
                  Suppression of metadata transfer can improve
                  performance, particularly for sessions that execute
                  many queries that return few rows each. For details
                  about managing result set metadata transfer, see
                  <a class="xref" href="connectors-apis.html#c-api-optional-metadata" title="28.7.27&nbsp;C API Optional Result Set Metadata">Section&nbsp;28.7.27, “C API Optional Result Set Metadata”</a>.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_SSL</code>: Use SSL (encrypted
                  protocol). Do not set this option within an
                  application program; it is set internally in the
                  client library. Instead, use
                  <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50&nbsp;mysql_options()"><code class="literal">mysql_options()</code></a> or
                  <a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a> before
                  calling
                  <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a>.
                </p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_REMEMBER_OPTIONS</code> Remember
                  options specified by calls to
                  <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a>.
                  Without this option, if
                  <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a>
                  fails, you must repeat the
                  <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a> calls
                  before trying to connect again. With this option, the
                  <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a> calls
                  need not be repeated.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
          If your program uses <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a>
          statements to execute stored procedures, the
          <code class="literal">CLIENT_MULTI_RESULTS</code> flag must be enabled.
          This is because each <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a>
          returns a result to indicate the call status, in addition to
          any result sets that might be returned by statements executed
          within the procedure. Because
          <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a> can return multiple
          results, process them using a loop that calls
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a> to
          determine whether there are more results.
        </p><p>
          <code class="literal">CLIENT_MULTI_RESULTS</code> can be enabled when
          you call <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a>,
          either explicitly by passing the
          <code class="literal">CLIENT_MULTI_RESULTS</code> flag itself, or
          implicitly by passing
          <code class="literal">CLIENT_MULTI_STATEMENTS</code> (which also enables
          <code class="literal">CLIENT_MULTI_RESULTS</code>).
          <code class="literal">CLIENT_MULTI_RESULTS</code> is enabled by default.
        </p><p>
          If you enable <code class="literal">CLIENT_MULTI_STATEMENTS</code> or
          <code class="literal">CLIENT_MULTI_RESULTS</code>, process the result
          for every call to
          <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a> or
          <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a> by using a
          loop that calls
          <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a> to
          determine whether there are more results. For an example, see
          <a class="xref" href="connectors-apis.html#c-api-multiple-queries" title="28.7.23 C API多语句执行支持">Section&nbsp;28.7.23, “C API Multiple Statement Execution Support”</a>.
        </p><p>
          For some parameters, it is possible to have the value taken
          from an option file rather than from an explicit value in the
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a> call. To
          do this, call <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a>
          with the <code class="literal">MYSQL_READ_DEFAULT_FILE</code> or
          <code class="literal">MYSQL_READ_DEFAULT_GROUP</code> option before
          calling <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a>.
          Then, in the
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a> call,
          specify the <span class="quote">“<span class="quote">no-value</span>”</span> value for each parameter
          to be read from an option file:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              For <code class="literal">host</code>, specify a value of
              <code class="literal">NULL</code> or the empty string
              (<code class="literal">""</code>).
            </p></li><li class="listitem"><p>
              For <code class="literal">user</code>, specify a value of
              <code class="literal">NULL</code> or the empty string.
            </p></li><li class="listitem"><p>
              For <code class="literal">passwd</code>, specify a value of
              <code class="literal">NULL</code>. (For the password, a value of the
              empty string in the
              <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a> call
              cannot be overridden in an option file, because the empty
              string indicates explicitly that the MySQL account must
              have an empty password.)
            </p></li><li class="listitem"><p>
              For <code class="literal">db</code>, specify a value of
              <code class="literal">NULL</code> or the empty string.
            </p></li><li class="listitem"><p>
              For <code class="literal">port</code>, specify a value of 0.
            </p></li><li class="listitem"><p>
              For <code class="literal">unix_socket</code>, specify a value of
              <code class="literal">NULL</code>.
</p></li></ul>
</div>
<p>
          If no value is found in an option file for a parameter, its
          default value is used as indicated in the descriptions given
          earlier in this section.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-connect-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          A <code class="literal">MYSQL*</code> connection handler if the
          connection was successful, <code class="literal">NULL</code> if the
          connection was unsuccessful. For a successful connection, the
          return value is the same as the value of the first parameter.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-connect-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_conn_host_error"><code class="literal">CR_CONN_HOST_ERROR</code></a>
            </p><p>
              Failed to connect to the MySQL server.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_connection_error"><code class="literal">CR_CONNECTION_ERROR</code></a>
            </p><p>
              Failed to connect to the local MySQL server.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_ipsock_error"><code class="literal">CR_IPSOCK_ERROR</code></a>
            </p><p>
              Failed to create an IP socket.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p>
              Out of memory.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_socket_create_error"><code class="literal">CR_SOCKET_CREATE_ERROR</code></a>
            </p><p>
              Failed to create a Unix socket.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_host"><code class="literal">CR_UNKNOWN_HOST</code></a>
            </p><p>
              Failed to find the IP address for the host name.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_version_error"><code class="literal">CR_VERSION_ERROR</code></a>
            </p><p>
              A protocol mismatch resulted from attempting to connect to
              a server with a client library that uses a different
              protocol version.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_namedpipeopen_error"><code class="literal">CR_NAMEDPIPEOPEN_ERROR</code></a>
            </p><p>
              Failed to create a named pipe on Windows.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_namedpipewait_error"><code class="literal">CR_NAMEDPIPEWAIT_ERROR</code></a>
            </p><p>
              Failed to wait for a named pipe on Windows.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_namedpipesetstate_error"><code class="literal">CR_NAMEDPIPESETSTATE_ERROR</code></a>
            </p><p>
              Failed to get a pipe handler on Windows.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p>
              If <a class="link" href="server-administration.html#sysvar_connect_timeout"><code class="literal">connect_timeout</code></a> &gt; 0
              and it took longer than
              <a class="link" href="server-administration.html#sysvar_connect_timeout"><code class="literal">connect_timeout</code></a> seconds
              to connect to the server or if the server died while
              executing the <code class="literal">init-command</code>.
            </p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_already_connected"><code class="literal">CR_ALREADY_CONNECTED</code></a>
            </p><p>
              The <code class="literal">MYSQL</code> connection handler is already
              connected.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-connect-example"></a>Example</h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting">MYSQL mysql;<font></font>
<font></font>
mysql_init(&amp;mysql);<font></font>
mysql_options(&amp;mysql,MYSQL_READ_DEFAULT_GROUP,"your_prog_name");<font></font>
if (!mysql_real_connect(&amp;mysql,"host","user","passwd","database",0,NULL,0))<font></font>
{<font></font>
    fprintf(stderr, "Failed to connect to database: Error: %s\n",<font></font>
          mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre><p>
          By using <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a> the
          MySQL client library reads the <code class="literal">[client]</code> and
          <code class="literal">[your_prog_name]</code> sections in the
          <code class="filename">my.cnf</code> file which ensures that your
          program works, even if someone has set up MySQL in some
          nonstandard way.
        </p><p>
          Upon connection,
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a> sets the
          <code class="literal">reconnect</code> flag (part of the
          <code class="literal">MYSQL</code> structure) to a value of
          <code class="literal">1</code> in versions of the API older than 5.0.3,
          or <code class="literal">0</code> in newer versions. A value of
          <code class="literal">1</code> for this flag indicates that if a
          statement cannot be performed because of a lost connection, to
          try reconnecting to the server before giving up. You can use
          the <code class="literal">MYSQL_OPT_RECONNECT</code> option to
          <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a> to control
          reconnection behavior.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-escape-string"></a>28.7.7.55&nbsp;mysql_real_escape_string()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549323872"></a><p>
        <code class="literal">unsigned long mysql_real_escape_string(MYSQL *mysql,
        char *to, const char *from, unsigned long length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          This function creates a legal SQL string for use in an SQL
          statement. See <a class="xref" href="language-structure.html#string-literals" title="9.1.1字符串文字">Section&nbsp;9.1.1, “String Literals”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <a class="link" href="connectors-apis.html#mysql-real-escape-string" title="28.7.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a>
            fails and produces an
            <a class="link" href="error-handling.html#error_cr_insecure_api_err"><code class="literal">CR_INSECURE_API_ERR</code></a> error if
            the <a class="link" href="server-administration.html#sqlmode_no_backslash_escapes"><code class="literal">NO_BACKSLASH_ESCAPES</code></a>
            SQL mode is enabled. In this case, the function cannot
            escape quote characters except by doubling them, and to do
            this properly, it must know more information about the
            quoting context than is available. Instead, use
            <a class="link" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a>,
            which takes an extra argument for specifying the quoting
            context.
</p>
</div>
<p>
          The <code class="literal">mysql</code> argument must be a valid, open
          connection because character escaping depends on the character
          set in use by the server.
        </p><a class="indexterm" name="idm140091549311648"></a><p>
          The string in the <code class="literal">from</code> argument is encoded
          to produce an escaped SQL string, taking into account the
          current character set of the connection. The result is placed
          in the <code class="literal">to</code> argument, followed by a
          terminating null byte.
        </p><p>
          Characters encoded are <code class="literal">\</code>,
          <code class="literal">'</code>, <code class="literal">"</code>,
          <code class="literal">NUL</code> (ASCII 0), <code class="literal">\n</code>,
          <code class="literal">\r</code>, and Control+Z. Strictly speaking, MySQL
          requires only that backslash and the quote character used to
          quote the string in the query be escaped.
          <a class="link" href="connectors-apis.html#mysql-real-escape-string" title="28.7.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a>
          quotes the other characters to make them easier to read in log
          files. For comparison, see the quoting rules for literal
          strings and the <a class="link" href="functions.html#function_quote"><code class="literal">QUOTE()</code></a> SQL
          function in <a class="xref" href="language-structure.html#string-literals" title="9.1.1字符串文字">Section&nbsp;9.1.1, “String Literals”</a>, and
          <a class="xref" href="functions.html#string-functions" title="12.5字符串函数">Section&nbsp;12.5, “String Functions”</a>.
        </p><p>
          The string pointed to by <code class="literal">from</code> must be
          <code class="literal">length</code> bytes long. You must allocate the
          <code class="literal">to</code> buffer to be at least
          <code class="literal">length*2+1</code> bytes long. (In the worst case,
          each character may need to be encoded as using two bytes, and
          there must be room for the terminating null byte.) When
          <a class="link" href="connectors-apis.html#mysql-real-escape-string" title="28.7.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a>
          returns, the contents of <code class="literal">to</code> is a
          null-terminated string. The return value is the length of the
          encoded string, not including the terminating null byte.
        </p><p>
          If you must change the character set of the connection, use
          the <a class="link" href="connectors-apis.html#mysql-set-character-set" title="28.7.7.71 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a>
          function rather than executing a <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET
          NAMES</code></a> (or <a class="link" href="sql-syntax.html#set-character-set" title="13.7.5.2 SET CHARACTER SET语法"><code class="literal">SET CHARACTER
          SET</code></a>) statement.
          <a class="link" href="connectors-apis.html#mysql-set-character-set" title="28.7.7.71 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a>
          works like <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET NAMES</code></a> but also
          affects the character set used by
          <a class="link" href="connectors-apis.html#mysql-real-escape-string" title="28.7.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a>,
          which <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET NAMES</code></a> does not.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-example"></a>Example</h5>

</div>

</div>

</div>
<p>
          The following example inserts two escaped strings into an
          <code class="literal">INSERT</code> statement, each within single quote
          characters:
        </p><pre data-lang="c" class="programlisting">char query[1000],*end;<font></font>
<font></font>
end = my_stpcpy(query,"INSERT INTO test_table VALUES('");<font></font>
end += mysql_real_escape_string(&amp;mysql,end,"What is this",12);<font></font>
end = my_stpcpy(end,"','");<font></font>
end += mysql_real_escape_string(&amp;mysql,end,"binary data: \0\r\n",16);<font></font>
end = my_stpcpy(end,"')");<font></font>
<font></font>
if (mysql_real_query(&amp;mysql,query,(unsigned int) (end - query)))<font></font>
{<font></font>
   fprintf(stderr, "Failed to insert row, Error: %s\n",<font></font>
           mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre><p>
          The <code class="literal">my_stpcpy()</code> function used in the
          example is included in the <code class="literal">libmysqlclient</code>
          library and works like <code class="literal">strcpy()</code> but returns
          a pointer to the terminating null of the first parameter.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p>
          The length of the encoded string that is placed into the
          <code class="literal">to</code> argument, not including the terminating
          null byte, or -1 if an error occurs.
        </p><p>
          Because
          <a class="link" href="connectors-apis.html#mysql-real-escape-string" title="28.7.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a>
          returns an unsigned value, you can check for -1 by comparing
          the return value to <code class="literal">(unsigned long)-1</code> (or
          to <code class="literal">(unsigned long)~0</code>, which is equivalent).
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-errors"></a>Errors</h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_insecure_api_err"><code class="literal">CR_INSECURE_API_ERR</code></a>
            </p><p>
              This error occurs if the
              <a class="link" href="server-administration.html#sqlmode_no_backslash_escapes"><code class="literal">NO_BACKSLASH_ESCAPES</code></a> SQL
              mode is enabled because, in that case,
              <a class="link" href="connectors-apis.html#mysql-real-escape-string" title="28.7.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a>
              cannot be guaranteed to produce a properly encoded result.
              To avoid this error, use
              <a class="link" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a>
              instead.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-escape-string-quote"></a>28.7.7.56&nbsp;mysql_real_escape_string_quote()</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549262896"></a><p>
        <code class="literal">unsigned long mysql_real_escape_string_quote(MYSQL
        *mysql, char *to, const char *from, unsigned long length, char
        quote)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-quote-description"></a>Description</h5>
</div>
</div>
</div>
<p>
          This function creates a legal SQL string for use in an SQL
          statement. See <a class="xref" href="language-structure.html#string-literals" title="9.1.1字符串文字">Section&nbsp;9.1.1, “String Literals”</a>.
        </p><p>
          The <code class="literal">mysql</code> argument must be a valid, open
          connection because character escaping depends on the character
          set in use by the server.
        </p><a class="indexterm" name="idm140091549256960"></a><p>
          The string in the <code class="literal">from</code> argument is encoded
          to produce an escaped SQL string, taking into account the
          current character set of the connection. The result is placed
          in the <code class="literal">to</code> argument, followed by a
          terminating null byte.
        </p><p>
          Characters encoded are <code class="literal">\</code>,
          <code class="literal">'</code>, <code class="literal">"</code>,
          <code class="literal">NUL</code> (ASCII 0), <code class="literal">\n</code>,
          <code class="literal">\r</code>, Control+Z, and <code class="literal">`</code>.
          Strictly speaking, MySQL requires only that backslash and the
          quote character used to quote the string in the query be
          escaped.
          <a class="link" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a>
          quotes the other characters to make them easier to read in log
          files. For comparison, see the quoting rules for literal
          strings and the <a class="link" href="functions.html#function_quote"><code class="literal">QUOTE()</code></a> SQL
          function in <a class="xref" href="language-structure.html#string-literals" title="9.1.1字符串文字">Section&nbsp;9.1.1, “String Literals”</a>, and
          <a class="xref" href="functions.html#string-functions" title="12.5字符串函数">Section&nbsp;12.5, “String Functions”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            If the <a class="link" href="server-administration.html#sqlmode_ansi_quotes"><code class="literal">ANSI_QUOTES</code></a> SQL
            mode is enabled,
            <a class="link" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a>
            cannot be used to escape double quote characters for use
            within double-quoted identifiers. (The function cannot tell
            whether the mode is enabled to determine the proper escaping
            character.)
</p>
</div>
<p>
          The string pointed to by <code class="literal">from</code> must be
          <code class="literal">length</code> bytes long. You must allocate the
          <code class="literal">to</code> buffer to be at least
          <code class="literal">length*2+1</code> bytes long. (In the worst case,
          each character may need to be encoded as using two bytes, and
          there must be room for the terminating null byte.) When
          <a class="link" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a>
          returns, the contents of <code class="literal">to</code> is a
          null-terminated string. The return value is the length of the
          encoded string, not including the terminating null byte.
        </p><p>
          The <code class="literal">quote</code> argument indicates the context in
          which the escaped string is to be placed. Suppose that you
          intend to escape the <code class="literal">from</code> argument and
          insert the escaped string (designated here by
          <em class="replaceable"><code>str</code></em>) into one of the following
          statements:
        </p><pre data-lang="sql" class="programlisting">1) SELECT * FROM table WHERE name = '<em class="replaceable"><code>str</code></em>'<font></font>
2) SELECT * FROM table WHERE name = "<em class="replaceable"><code>str</code></em>"<font></font>
3) SELECT * FROM `<em class="replaceable"><code>str</code></em>` WHERE id = 103
</pre><p>
          To perform escaping properly for each statement, call
          <a class="link" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a>
          as follows, where the final argument indicates the quoting
          context:
        </p><pre data-lang="c" class="programlisting">1) len = mysql_real_escape_string_quote(&amp;mysql,to,from,from_len,'\'');<font></font>
2) len = mysql_real_escape_string_quote(&amp;mysql,to,from,from_len,'"');<font></font>
3) len = mysql_real_escape_string_quote(&amp;mysql,to,from,from_len,'`');<font></font>
</pre><p>
          If you must change the character set of the connection, use
          the <a class="link" href="connectors-apis.html#mysql-set-character-set" title="28.7.7.71 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a>
          function rather than executing a <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET
          NAMES</code></a> (or <a class="link" href="sql-syntax.html#set-character-set" title="13.7.5.2 SET CHARACTER SET语法"><code class="literal">SET CHARACTER
          SET</code></a>) statement.
          <a class="link" href="connectors-apis.html#mysql-set-character-set" title="28.7.7.71 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a>
          works like <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET NAMES</code></a> but also
          affects the character set used by
          <a class="link" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a>,
          which <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET NAMES</code></a> does not.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-quote-example"></a>Example</h5>

</div>

</div>

</div>
<p>
          The following example inserts two escaped strings into an
          <code class="literal">INSERT</code> statement, each within single quote
          characters:
        </p><pre data-lang="c" class="programlisting">char query[1000],*end;<font></font>
<font></font>
end = my_stpcpy(query,"INSERT INTO test_table VALUES('");<font></font>
end += mysql_real_escape_string_quote(&amp;mysql,end,"What is this",12,'\'');<font></font>
end = my_stpcpy(end,"','");<font></font>
end += mysql_real_escape_string_quote(&amp;mysql,end,"binary data: \0\r\n",16,'\'');<font></font>
end = my_stpcpy(end,"')");<font></font>
<font></font>
if (mysql_real_query(&amp;mysql,query,(unsigned int) (end - query)))<font></font>
{<font></font>
   fprintf(stderr, "Failed to insert row, Error: %s\n",<font></font>
           mysql_error(&amp;mysql));<font></font>
}<font></font>
</pre><p>
          The <code class="literal">my_stpcpy()</code> function used in the
          example is included in the <code class="literal">libmysqlclient</code>
          library and works like <code class="literal">strcpy()</code> but returns
          a pointer to the terminating null of the first parameter.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-quote-return-values"></a>Return Values</h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          放入</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">的编码字符串的长度
           </font><font style="vertical-align: inherit;">，不包括终止空字节。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-quote-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-query"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.57 mysql_real_query（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549205984"></a><p>
        <code class="literal">int mysql_real_query(MYSQL *mysql, const char
        *stmt_str, unsigned long length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-query-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个同步功能。</font><font style="vertical-align: inherit;">它的异步对应物是
             </font></font><a class="link" href="connectors-apis.html#mysql-real-query-nonblocking" title="28.7.15.5 mysql_real_query_nonblocking（）"><code class="literal">mysql_real_query_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">供需要与服务器进行异步通信的应用程序使用的。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行指向的SQL语句</font></font><code class="literal">stmt_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，字符串</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节长。</font><font style="vertical-align: inherit;">通常，字符串必须由单个SQL语句组成，而不包含终止分号（</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或
           </font></font><code class="literal">\g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果已启用多语句执行，则该字符串可以包含由分号分隔的多个语句。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-multiple-queries" title="28.7.23 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.23节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能用于包含二进制数据的语句; </font><font style="vertical-align: inherit;">你必须
           </font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改用。</font><font style="vertical-align: inherit;">（二进制数据可能包含</font></font><code class="literal">\0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符，它</font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解释为语句字符串的结尾。）另外，
           </font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比</font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它不会调用</font></font><code class="literal">strlen()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句字符串</font><font style="vertical-align: inherit;">更快</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您想知道语句是否返回结果集，可以使用它
           </font></font><a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来检查。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.22节“mysql_field_count（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-query-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-query-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-refresh"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.58 mysql_refresh（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549167872"></a><p>
        <code class="literal">int mysql_refresh(MYSQL *mysql, unsigned int
        options)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-refresh-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <code class="literal">mysql_refresh()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已弃用，将在未来的MySQL版本中删除。</font><font style="vertical-align: inherit;">相反，用于
             </font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行
             </font></font><a class="link" href="sql-syntax.html#flush" title="13.7.7.3 FLUSH语法"><code class="literal">FLUSH</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数刷新表或高速缓存，或重置复制服务器信息。</font><font style="vertical-align: inherit;">已连接的用户必须具有该
           </font></font><a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所述</font></font><code class="literal">options</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是一个从下面的值的任意组合组成的位掩码。</font><font style="vertical-align: inherit;">可以将多个值一起“或”运算，以通过一次调用执行多个操作。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">REFRESH_GRANT</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              刷新授权表，例如</font></font><a class="link" href="sql-syntax.html#flush-privileges"><code class="literal">FLUSH
              PRIVILEGES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_LOG</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              刷日志，比如</font></font><a class="link" href="sql-syntax.html#flush-logs"><code class="literal">FLUSH
              LOGS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_TABLES</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              刷新表缓存，就像</font></font><a class="link" href="sql-syntax.html#flush-tables"><code class="literal">FLUSH
              TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_HOSTS</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              刷新主机缓存，就像</font></font><a class="link" href="sql-syntax.html#flush-hosts"><code class="literal">FLUSH
              HOSTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_STATUS</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              重置状态变量，如</font></font><a class="link" href="sql-syntax.html#flush-status"><code class="literal">FLUSH
              STATUS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_THREADS</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              刷新线程缓存。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_SLAVE</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在从属复制服务器上，重置主服务器信息并重新启动从属服务器，如
               </font></font><a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE语法"><code class="literal">RESET SLAVE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_MASTER</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在主复制服务器上，删除二进制日志索引中列出的二进制日志文件并截断​​索引文件，如</font></font><a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER语法"><code class="literal">RESET
              MASTER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-refresh-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-refresh-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-reload"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.59 mysql_reload（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549118448"></a><p>
        <code class="literal">int mysql_reload(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-reload-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要求MySQL服务器重新加载授权表。</font><font style="vertical-align: inherit;">已连接的用户必须具有该
           </font></font><a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不推荐使用此功能。</font><font style="vertical-align: inherit;">使用
           </font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来发出SQL
           </font></font><a class="link" href="sql-syntax.html#flush-privileges"><code class="literal">FLUSH PRIVILEGES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-reload-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-reload-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-reset-connection"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.60 mysql_reset_connection（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549095216"></a><p>
        <code class="literal">int mysql_reset_connection(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-reset-connection-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          重置连接以清除会话状态。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-reset-connection" title="28.7.7.60 mysql_reset_connection（）"><code class="literal">mysql_reset_connection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有类似于</font></font><a class="link" href="connectors-apis.html#mysql-change-user" title="28.7.7.3 mysql_change_user（）"><code class="literal">mysql_change_user()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或自动重新连接的</font><font style="vertical-align: inherit;">效果
           </font><font style="vertical-align: inherit;">，但连接未关闭并重新打开，并且未执行重新认证。</font><font style="vertical-align: inherit;">写入会话历史记录被重置。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-change-user" title="28.7.7.3 mysql_change_user（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.3节“mysql_change_user（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）并参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-auto-reconnect" title="28.7.28 C API自动重新连接控制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.28节“C API自动重新连接控制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与连接相关的状态受影响如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              回滚任何活动事务并重置自动提交模式。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              所有表锁都被释放。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              所有</font></font><code class="literal">TEMPORARY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表都关闭（并删除）。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              会话系统变量被重新初始化为相应的全局系统变量的值，包括由诸如的语句隐式设置的系统变量</font></font><a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用户变量设置丢失。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              准备好的声明已经发布。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER语法"><code class="literal">HANDLER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 变量已关闭。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              值
               </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重置为0。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              获得的锁
               </font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被释放。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-reset-connection-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-reset-server-public-key"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.61 mysql_reset_server_public_key（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549068832"></a><p>
        <code class="literal">void mysql_reset_server_public_key(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-reset-server-public-key-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从客户端库中清除服务器为基于RSA密钥对的密码交换所需的公钥的任何缓存副本。</font><font style="vertical-align: inherit;">在客户端程序</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code class="literal">MYSQL_SERVER_PUBLIC_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定RSA公钥</font><font style="vertical-align: inherit;">的
           </font><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">调用后，使用不同的RSA密钥对重新启动服务器时，可能需要执行此操作
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，由于密钥不匹配可能会发生连接故障。</font><font style="vertical-align: inherit;">要解决此问题，客户端可以使用以下任一方法：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              客户端可以调用
               </font></font><a class="link" href="connectors-apis.html#mysql-reset-server-public-key" title="28.7.7.61 mysql_reset_server_public_key（）"><code class="literal">mysql_reset_server_public_key()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              清除缓存的密钥，并在客户端的公钥文件替换为包含新公钥的文件后再次尝试。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              客户端可以调用
               </font></font><a class="link" href="connectors-apis.html#mysql-reset-server-public-key" title="28.7.7.61 mysql_reset_server_public_key（）"><code class="literal">mysql_reset_server_public_key()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              清除缓存的密钥，然后</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用
               </font></font><code class="literal">MYSQL_OPT_GET_SERVER_PUBLIC_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项（而不是</font></font><code class="literal">MYSQL_SERVER_PUBLIC_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）从服务器请求所需的公钥来</font><font style="vertical-align: inherit;">调用
               </font><font style="vertical-align: inherit;">不要同时使用两者</font></font><code class="literal">MYSQL_OPT_GET_SERVER_PUBLIC_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              ，</font></font><code class="literal">MYSQL_SERVER_PUBLIC_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为在这种情况下，</font></font><code class="literal">MYSQL_SERVER_PUBLIC_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              优先级。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-reset-server-public-key-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-reset-server-public-key-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-result-metadata"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.62 mysql_result_metadata（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549047984"></a><p>
        <code class="literal">enum enum_resultset_metadata
        mysql_result_metadata(MYSQL_RES *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-result-metadata-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62 mysql_result_metadata（）"><code class="literal">mysql_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个值，指示结果集是否具有元数据。</font><font style="vertical-align: inherit;">当客户端事先不知道特定结果集是否具有元数据时，它对于元数据可选连接可能是有用的。</font><font style="vertical-align: inherit;">例如，如果客户端执行返回多个结果集并可能更改</font></font><a class="link" href="server-administration.html#sysvar_resultset_metadata"><code class="literal">resultset_metadata</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          系统变量</font><font style="vertical-align: inherit;">的存储过程</font><font style="vertical-align: inherit;">，则客户端可以</font></font><a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62 mysql_result_metadata（）"><code class="literal">mysql_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为每个结果集</font><font style="vertical-align: inherit;">调用
           </font><font style="vertical-align: inherit;">以确定它是否具有元数据。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关管理结果集元数据传输的详细信息，请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-optional-metadata" title="28.7.27 C API可选结果集元数据"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.27节“C API可选结果集元数据”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-result-metadata-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62 mysql_result_metadata（）"><code class="literal">mysql_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回以下值之一：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enum enum_resultset_metadata {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 RESULTSET_METADATA_NONE = 0，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 RESULTSET_METADATA_FULL = 1</font></font><font></font>
};<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-rollback"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.63 mysql_rollback（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549033712"></a><p>
        <code class="literal">bool mysql_rollback(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-rollback-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          回滚当前交易。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数的操作取决于</font></font><a class="link" href="server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">的值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">特别地，如果值
           </font></font><a class="link" href="server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
           </font></font><code class="literal">RELEASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或2）时，服务器结束交易之后执行释放和关闭客户端连接。</font></font><a class="link" href="connectors-apis.html#mysql-close" title="28.7.7.5 mysql_close（）"><code class="literal">mysql_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从客户端程序</font><font style="vertical-align: inherit;">调用以</font><font style="vertical-align: inherit;">从客户端关闭连接。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-rollback-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-rollback-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-row-seek"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.64 mysql_row_seek（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549020192"></a><p>
        <code class="literal">MYSQL_ROW_OFFSET mysql_row_seek(MYSQL_RES *result,
        MYSQL_ROW_OFFSET offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-row-seek-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将行光标设置为查询结果集中的任意行。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是行偏移量，通常是从</font></font><a class="link" href="connectors-apis.html#mysql-row-tell" title="28.7.7.65 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或从中
           </font><font style="vertical-align: inherit;">返回的值
           </font></font><a class="link" href="connectors-apis.html#mysql-row-seek" title="28.7.7.64 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值不是行号; </font><font style="vertical-align: inherit;">要在数字结果集中寻找一行，请</font></font><a class="link" href="connectors-apis.html#mysql-data-seek" title="28.7.7.9 mysql_data_seek（）"><code class="literal">mysql_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          改用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数要求结果集结构包含查询的整个结果，因此
           </font></font><a class="link" href="connectors-apis.html#mysql-row-seek" title="28.7.7.64 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只能与结合使用</font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不能与</font><font style="vertical-align: inherit;">结合
           </font><font style="vertical-align: inherit;">使用
           </font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-row-seek-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行光标的前一个值。</font><font style="vertical-align: inherit;">该值可以传递给后续的调用
           </font></font><a class="link" href="connectors-apis.html#mysql-row-seek" title="28.7.7.64 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-row-seek-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-row-tell"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.65 mysql_row_tell（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091549001504"></a><p>
        <code class="literal">MYSQL_ROW_OFFSET mysql_row_tell(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-row-tell-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回最后一行的行光标的当前位置
           </font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值可以用作参数
           </font></font><a class="link" href="connectors-apis.html#mysql-row-seek" title="28.7.7.64 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用</font></font><a class="link" href="connectors-apis.html#mysql-row-tell" title="28.7.7.65 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后，才</font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不是之后</font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-row-tell-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行光标的当前偏移量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-row-tell-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-select-db"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.66 mysql_select_db（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548986304"></a><p>
        <code class="literal">int mysql_select_db(MYSQL *mysql, const char
        *db)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-select-db-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使指定的数据库</font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成为指定连接上的默认（当前）数据库</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在后续查询中，此数据库是不包含显式数据库说明符的表引用的缺省值。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-select-db" title="28.7.7.66 mysql_select_db（）"><code class="literal">mysql_select_db()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 除非可以将连接的用户身份验证为具有使用数据库的权限，否则将失败。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-select-db-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-select-db-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-server-end"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.67 mysql_server_end（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548964768"></a><p>
        <code class="literal">void mysql_server_end(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-server-end-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数最终确定MySQL客户端库，应在使用库时完成。</font><font style="vertical-align: inherit;">但是，
           </font></font><a class="link" href="connectors-apis.html#mysql-server-end" title="28.7.7.67 mysql_server_end（）"><code class="literal">mysql_server_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已弃用，
           </font></font><a class="link" href="connectors-apis.html#mysql-library-end" title="28.7.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应改为使用。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="connectors-apis.html#mysql-library-end" title="28.7.7.40 mysql_library_end（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.40节“mysql_library_end（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            为避免在使用库完成应用程序后出现内存泄漏（例如，在关闭与服务器的连接后），请务必</font><font style="vertical-align: inherit;">明确</font><font style="vertical-align: inherit;">调用
             </font></font><a class="link" href="connectors-apis.html#mysql-server-end" title="28.7.7.67 mysql_server_end（）"><code class="literal">mysql_server_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
             </font></font><a class="link" href="connectors-apis.html#mysql-library-end" title="28.7.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">这使得能够执行内存管理以清理和释放库使用的资源。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-server-end-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-server-init"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.68 mysql_server_init（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548951232"></a><p>
        <code class="literal">int mysql_server_init(int argc, char **argv, char
        **groups)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-server-init-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数初始化MySQL客户端库，必须在调用任何其他MySQL函数之前完成。</font><font style="vertical-align: inherit;">但是，
           </font></font><a class="link" href="connectors-apis.html#mysql-server-init" title="28.7.7.68 mysql_server_init（）"><code class="literal">mysql_server_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已弃用，您应该拨打电话
           </font></font><a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="connectors-apis.html#mysql-library-init" title="28.7.7.41 mysql_library_init（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.41节“mysql_library_init（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            为避免在使用库完成应用程序后出现内存泄漏（例如，在关闭与服务器的连接后），请务必</font><font style="vertical-align: inherit;">明确</font><font style="vertical-align: inherit;">调用
             </font></font><a class="link" href="connectors-apis.html#mysql-server-end" title="28.7.7.67 mysql_server_end（）"><code class="literal">mysql_server_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
             </font></font><a class="link" href="connectors-apis.html#mysql-library-end" title="28.7.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">这使得能够执行内存管理以清理和释放库使用的资源。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="connectors-apis.html#mysql-library-end" title="28.7.7.40 mysql_library_end（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.40节“mysql_library_end（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-server-init-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-session-track-get-first"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.69 mysql_session_track_get_first（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548936784"></a><a class="indexterm" name="idm140091548935696"></a><p>
        <code class="literal">int mysql_session_track_get_first(MYSQL *mysql, enum
        enum_session_state_type type, const char **data, size_t
        *length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-first-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL实现了一个会话跟踪器机制，服务器通过该机制向客户端返回有关会话状态更改的信 </font><font style="vertical-align: inherit;">为了控制该通知的服务器提供关于状态改变时，客户端应用程序设置具有以下形式的名的系统变量
           </font><font style="vertical-align: inherit;">，如
           </font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">，和
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font><a class="xref" href="server-administration.html#session-state-tracking" title="5.1.15客户端会话状态更改的服务器跟踪"><font style="vertical-align: inherit;">第5.1.15节“客户端会话状态更改的服务器跟踪”</font></a><font style="vertical-align: inherit;">。
        </font></font><code class="literal">session_track_<em class="replaceable"><code>xxx</code></em></code><font style="vertical-align: inherit;"></font><a class="link" href="server-administration.html#sysvar_session_track_state_change"><code class="literal">session_track_state_change</code></a><font style="vertical-align: inherit;"></font><a class="link" href="server-administration.html#sysvar_session_track_schema"><code class="literal">session_track_schema</code></a><font style="vertical-align: inherit;"></font><a class="link" href="server-administration.html#sysvar_session_track_system_variables"><code class="literal">session_track_system_variables</code></a><font style="vertical-align: inherit;"></font><a class="xref" href="server-administration.html#session-state-tracking" title="5.1.15客户端会话状态更改的服务器跟踪"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          更改通知发生在MySQL客户端/服务器协议中，其中包括OK数据包中的跟踪器信息，以便可以检测会话状态更改。</font><font style="vertical-align: inherit;">为了使客户端应用程序能够从OK数据包中提取状态更改信息，MySQL C API提供了一对功能：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              获取从服务器接收的状态更改信息的第一部分。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-session-track-get-next" title="28.7.7.70 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              获取从服务器接收的任何剩余状态更改信息。</font><font style="vertical-align: inherit;">成功调用后
               </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，只要返回成功，就会重复调用此函数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该
           </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数被用作如下所述。</font><font style="vertical-align: inherit;">这些描述也适用于
           </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-next" title="28.7.7.70 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它采用相同的参数。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：连接处理程序。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：跟踪器类型，指示要检索的信息类型。</font><font style="vertical-align: inherit;">允许的跟踪器值是在以下位置</font></font><code class="literal">enum_session_state_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">枚举</font><font style="vertical-align: inherit;">的成员
               </font></font><code class="filename">mysql_com.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
            </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举enum_session_state_type</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_SYSTEM_VARIABLES，/ *会话系统变量* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_SCHEMA，/ *当前架构* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_STATE_CHANGE，/ *会话状态更改* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_GTIDS，/ * GTIDs * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_TRANSACTION_CHARACTERISTICS，/ *交易特征* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_TRANSACTION_STATE / *交易状态* /</font></font><font></font>
};<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              随着MySQL实现其他会话信息跟踪器，该枚举的成员可能会随着时间的推移而发生变化。</font><font style="vertical-align: inherit;">为了使应用程序能够轻松遍历所有可能的跟踪器类型而不管成员的数量，将
               </font></font><code class="literal">SESSION_TRACK_BEGIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">SESSION_TRACK_END</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">符号定义为等于</font></font><code class="literal">enum_session_state_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举</font><font style="vertical-align: inherit;">的第一个和最后一个成员
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">本节后面显示的示例代码演示了此技术。</font><font style="vertical-align: inherit;">（当然，如果枚举成员发生更改，则必须重新编译应用程序以使其能够考虑新的跟踪器。）
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code class="literal">const
              char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">的地址</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">成功调用后，此变量指向返回的数据，应将其视为只读。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code class="literal">size_t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">的地址
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">成功调用后，此变量包含</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">指向的数据长度</font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下讨论描述了如何</font><font style="vertical-align: inherit;">根据</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">解释
           </font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font><code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它还指示哪个系统变量为每个跟踪器类型启用通知。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_SCHEMA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：此跟踪器类型表示已设置默认架构。
              </font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是包含新的默认架构名称的字符串。</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是字符串长度。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              要为此跟踪器类型启用通知，请启用
               </font></font><a class="link" href="server-administration.html#sysvar_session_track_schema"><code class="literal">session_track_schema</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              系统变量。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_SYSTEM_VARIABLES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：此跟踪器类型表示已为一个或多个跟踪的会话系统变量分配了值。</font><font style="vertical-align: inherit;">分配会话系统变量时，将返回每个变量的两个值（在单独的调用中）。</font><font style="vertical-align: inherit;">对于第一次调用，</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个包含变量名称</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的字符串</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">是字符串长度。</font><font style="vertical-align: inherit;">对于第二个调用，</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个包含变量值</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的字符串</font><font style="vertical-align: inherit;">，
               </font><font style="vertical-align: inherit;">是字符串长度。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              默认情况下，通知的启用
               </font></font><a class="link" href="server-administration.html#sysvar_time_zone"><code class="literal">time_zone</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="server-administration.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
               </font></font><a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要更改此跟踪器类型的默认通知，请将</font></font><a class="link" href="server-administration.html#sysvar_session_track_schema"><code class="literal">session_track_schema</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              系统变量</font><font style="vertical-align: inherit;">设置
               </font><font style="vertical-align: inherit;">为要跟踪更改的逗号分隔变量列表，或</font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跟踪所有变量的更改。</font><font style="vertical-align: inherit;">要禁用会话变量分配的通知，请设置
               </font></font><a class="link" href="server-administration.html#sysvar_session_track_system_variables"><code class="literal">session_track_system_variables</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为空字符串。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_STATE_CHANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：此跟踪器类型表示会话状态的某些跟踪属性的更改。</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个包含布尔标志的字节，指示是否发生了会话状态更改。</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该是1.标志表示为ASCII值，而不是二进制（例如</font></font><code class="literal">'1'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，不是
               </font></font><code class="literal">0x01</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              要为此跟踪器类型启用通知，请启用
               </font></font><a class="link" href="server-administration.html#sysvar_session_track_state_change"><code class="literal">session_track_state_change</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              系统变量。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此跟踪器报告会话状态的这些属性的更改：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  默认架构（数据库）。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  系统变量的特定于会话的值。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  用户定义的变量。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  临时表。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  准备好的陈述。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_GTIDS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：此跟踪器类型表示GTIDS可用。
              </font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含编码的GTID数据，
               </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示数据长度。</font><font style="vertical-align: inherit;">一旦</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提取</font><font style="vertical-align: inherit;">了</font><font style="vertical-align: inherit;">值，就必须将其进一步解释为三个部分：编码规范，GTIDs字符串的长度，GTIDs字符串。</font><font style="vertical-align: inherit;">目前，只有一个编码规范，因此它应该始终为0. GTIDs字符串是用于指定一组GTID值的标准格式; </font><font style="vertical-align: inherit;">见
               </font></font><a class="xref" href="replication.html#replication-gtids-concepts-gtid-sets" title="GTID集"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GTID集</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              要为此跟踪器类型启用通知，请设置
               </font></font><a class="link" href="server-administration.html#sysvar_session_track_gtids"><code class="literal">session_track_gtids</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              系统变量。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_TRANSACTION_CHARACTERISTICS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：此跟踪器类型表示事务特征可用。</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是包含特征数据的字符串。
              </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是字符串长度。</font><font style="vertical-align: inherit;">特征跟踪器数据字符串可能为空，或者它可能包含一个或多个SQL语句，每个语句以分号结束：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果没有适用的特征，则字符串为空。</font><font style="vertical-align: inherit;">会话默认值适用。</font><font style="vertical-align: inherit;">（对于隔离级别和访问模式，这些默认值由</font></font><a class="link" href="server-administration.html#sysvar_transaction_isolation"><code class="literal">transaction_isolation</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  和
                   </font></font><a class="link" href="server-administration.html#sysvar_transaction_read_only"><code class="literal">transaction_read_only</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  系统变量</font><font style="vertical-align: inherit;">的会话值给出
                   </font><font style="vertical-align: inherit;">。）
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果显式启动了事务，则该字符串包含重新启动具有相同特征的事务所需的语句。</font><font style="vertical-align: inherit;">作为一般规则，这是一个
                   </font></font><a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION，COMMIT和ROLLBACK语法"><code class="literal">START
                  TRANSACTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明（可能有一个或多个</font></font><code class="literal">READ ONLY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">READ
                  WRITE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">WITH CONSISTENT
                  SNAPSHOT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">如果应用了任何无法传递的特征
                   </font></font><a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION，COMMIT和ROLLBACK语法"><code class="literal">START
                  TRANSACTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，例如</font></font><code class="literal">ISOLATION
                  LEVEL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION语法"><code class="literal">SET
                  TRANSACTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会添加</font><font style="vertical-align: inherit;">一个合适的</font><font style="vertical-align: inherit;">语句（例如</font></font><code class="literal">SET TRANSACTION ISOLATION LEVEL
                  SERIALIZABLE; START TRANSACTION READ
                  WRITE;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果未明确启动事务，但设置了仅适用于下一个事务的一次性特征，</font></font><a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION语法"><code class="literal">SET
                  TRANSACTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会生成适合复制该设置</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">语句（例如，
                   </font></font><code class="literal">SET TRANSACTION READ ONLY;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
                </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  可以使用</font></font><a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION语法"><code class="literal">SET TRANSACTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">without any </font></font><code class="literal">GLOBAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                   </font></font><code class="literal">SESSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keyword </font><font style="vertical-align: inherit;">设置next-transaction特性
                   </font><font style="vertical-align: inherit;">，或者</font><font style="vertical-align: inherit;">
                  使用仅适用于下一个事务的语法</font><font style="vertical-align: inherit;">设置
                   </font></font><a class="link" href="server-administration.html#sysvar_transaction_isolation"><code class="literal">transaction_isolation</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  和
                   </font></font><a class="link" href="server-administration.html#sysvar_transaction_read_only"><code class="literal">transaction_read_only</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量：
                </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @@ transaction_isolation = </font></font><em class="replaceable"><code>value</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @@ transaction_read_only = </font></font><em class="replaceable"><code>value</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  有关事务特征范围级别及其设置方式的更多信息，请参阅
                   </font></font><a class="xref" href="sql-syntax.html#set-transaction-scope" title="交易特征范围"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事务特征范围</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              要为此跟踪器类型启用通知，请将</font></font><a class="link" href="server-administration.html#sysvar_session_track_transaction_info"><code class="literal">session_track_transaction_info</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              系统变量</font><font style="vertical-align: inherit;">设置
               </font><font style="vertical-align: inherit;">为</font></font><code class="literal">CHARACTERISTICS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （还启用
               </font></font><code class="literal">SESSION_TRACK_TRANSACTION_STATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跟踪器类型）。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              事务特征跟踪使客户端能够确定如何在另一个会话中重新启动事务，以使其具有与原始会话中相同的特征。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              因为可以在</font></font><a class="link" href="sql-syntax.html#set-transaction" title="13.3.7 SET TRANSACTION语法"><code class="literal">SET TRANSACTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启动事务之前</font><font style="vertical-align: inherit;">使用特性来设置特性
               </font><font style="vertical-align: inherit;">，所以如果没有事务处于活动状态，则客户端认为没有事务特征是不安全的。</font><font style="vertical-align: inherit;">因此，如果没有事务处于活动状态（交易状态跟踪器或传统</font></font><code class="literal">SERVER_STATUS_IN_TRANS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志</font><font style="vertical-align: inherit;">是否检测到这种情况），则不跟踪事务特征并仅切换连接是不安全的
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果客户端</font><font style="vertical-align: inherit;">可能希望在某个时刻将其会话切换到另一个连接并且可以使用事务，则</font><font style="vertical-align: inherit;">客户端
               </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">订阅事务特征跟踪器。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              特征跟踪器跟踪仅适用于下一个事务的一次性特征的变化。</font><font style="vertical-align: inherit;">它不跟踪会话变量的更改。</font><font style="vertical-align: inherit;">因此，客户端还必须跟踪
               </font></font><a class="link" href="server-administration.html#sysvar_transaction_isolation"><code class="literal">transaction_isolation</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><a class="link" href="server-administration.html#sysvar_transaction_read_only"><code class="literal">transaction_read_only</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              系统变量，以正确确定下一个事务特征值为空时应用的会话默认值。</font><font style="vertical-align: inherit;">（要跟踪这些变量，请将它们列在</font></font><a class="link" href="server-administration.html#sysvar_session_track_system_variables"><code class="literal">session_track_system_variables</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              系统变量</font><font style="vertical-align: inherit;">的值中
               </font><font style="vertical-align: inherit;">。）
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_TRANSACTION_STATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：此跟踪器类型指示事务状态信息可用。</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个包含ASCII字符的字符串，每个字符都表示事务状态的某些方面。</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              是字符串长度（总是8）。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              要为此跟踪器类型启用通知，请将</font></font><a class="link" href="server-administration.html#sysvar_session_track_transaction_info"><code class="literal">session_track_transaction_info</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              系统变量</font><font style="vertical-align: inherit;">设置
               </font><font style="vertical-align: inherit;">为</font></font><code class="literal">STATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              事务状态跟踪使客户端能够确定事务是否正在进行以及是否可以将其移动到其他会话而不进行回滚。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              跟踪器项的范围是事务。</font><font style="vertical-align: inherit;">在提交或回滚事务之前，所有状态指示标志都会持续存在。</font><font style="vertical-align: inherit;">当语句被添加到事务中时，可以在连续的跟踪器数据值中设置附加标志。</font><font style="vertical-align: inherit;">但是，在事务结束之前不会清除任何标志。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              事务状态报告为包含ASCII字符序列的字符串。</font><font style="vertical-align: inherit;">每个活动状态都具有分配给它的唯一字符以及序列中的固定位置。</font><font style="vertical-align: inherit;">以下列表描述了序列的位置1到8的允许值：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  位置1：活动交易是否正在进行中。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      <code class="literal">T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：明确启动的事务正在进行中。
                    </font></font></p></li><li class="listitem"><p>
                      <code class="literal">I</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：隐式启动的事务（</font></font><a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit=0</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）正在进行中。
                    </font></font></p></li><li class="listitem"><p>
                      <code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：没有活动交易。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  位置2：是否在当前事务的上下文中读取了非事务表。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      <code class="literal">r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：读取了一个或多个非事务性表。
                    </font></font></p></li><li class="listitem"><p>
                      <code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：到目前为止还没有读过非交易表。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  位置3：是否在当前事务的上下文中读取事务表。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      <code class="literal">R</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：读取了一个或多个事务表。
                    </font></font></p></li><li class="listitem"><p>
                      <code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：到目前为止没有读取任何事务表。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  位置4：是否在当前事务的上下文中执行了不安全写入（写入非事务性表）。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      <code class="literal">w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：编写了一个或多个非事务性表。
                    </font></font></p></li><li class="listitem"><p>
                      <code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：到目前为止还没有写过非交易表。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  位置5：是否在当前事务的上下文中写入了任何事务表。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      <code class="literal">W</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：编写了一个或多个事务表。
                    </font></font></p></li><li class="listitem"><p>
                      <code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：到目前为止没有写入任何事务表。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  位置6：是否在当前事务的上下文中执行了任何不安全的语句。</font><font style="vertical-align: inherit;">包含非确定性结构的语句，例如</font><font style="vertical-align: inherit;">基于语句的复制</font></font><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                   </font></font><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不安全。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      <code class="literal">s</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：执行了一个或多个不安全的语句。
                    </font></font></p></li><li class="listitem"><p>
                      <code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：到目前为止，没有执行不安全的陈述。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  位置7：在当前事务期间是否将结果集发送到客户端。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      <code class="literal">S</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：结果集已发送。
                    </font></font></p></li><li class="listitem"><p>
                      <code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：到目前为止没有发送结果集。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  第8位：</font></font><a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES和UNLOCK TABLES语法"><code class="literal">LOCK
                  TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明是否生效。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                      <code class="literal">L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：显式锁定表</font></font><a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES和UNLOCK TABLES语法"><code class="literal">LOCK TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
                    </font></font></p></li><li class="listitem"><p>
                      <code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><a class="link" href="sql-syntax.html#lock-tables" title="13.3.6 LOCK TABLES和UNLOCK TABLES语法"><code class="literal">LOCK
                      TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在会话中未激活。
</font></font></p></li></ul>
</div>
</li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              考虑一个由以下语句组成的会话，包括一个用于启用事务状态跟踪器的语句：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. SET @@ SESSION.session_track_transaction_info ='STATE';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.开始交易;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3.选择1;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.插入到t1（）VALUES（）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5.插入到t1（）VALUES（1，RAND（））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6.委任;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              启用事务状态跟踪后，</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些语句</font><font style="vertical-align: inherit;">将生成以下
               </font><font style="vertical-align: inherit;">值：
            </font></font></p><pre data-lang="sql" class="programlisting">1. ________<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. T_______</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. T_____S_</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. T___W_S_</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. T___WsS_</font></font><font></font>
6. ________<font></font>
</pre></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-first-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-first-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-first-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例说明如何在</font><font style="vertical-align: inherit;">
          成功执行SQL语句字符串（由表示</font><font style="vertical-align: inherit;">）后</font><font style="vertical-align: inherit;">调用
           </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          和
           </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-next" title="28.7.7.70 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索并显示所有可用的会话状态更改信息</font></font><code class="literal">stmt_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">假设应用程序已设置
           </font><font style="vertical-align: inherit;">
          系统变量，以启用其希望接收的通知。
        </font></font><code class="literal">session_track_<em class="replaceable"><code>xxx</code></em></code><font style="vertical-align: inherit;"></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">printf（“执行：％s \ n”，stmt_str）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_query（mysql，stmt_str）！= 0）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“错误％u：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_errno（mysql），mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  返回;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_RES * result = mysql_store_result（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（result）/ *有一个结果集来获取* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * ...在这里处理行... * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“返回的行数：％lu \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          （unsigned long）mysql_num_rows（result））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  了mysql_free_result（结果）;</font></font><font></font>
}<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
else / *没有结果集* /</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（mysql_field_count（mysql）== 0）</font></font><font></font>
  {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“受影响的行数：％lu \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            （unsigned long）mysql_affected_rows（mysql））;</font></font><font></font>
  }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  else / *发生错误* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误％u：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             mysql_errno（mysql），mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *提取任何可用的会话状态更改信息* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
enum enum_session_state_type类型;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
for（type = SESSION_TRACK_BEGIN; type &lt;= SESSION_TRACK_END; type ++）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  const char * data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  size_t长度;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（mysql_session_track_get_first（mysql，type，＆data，＆length）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *打印信息类型和初始数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“Type =％d：\ n”，类型）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“mysql_session_track_get_first（）：length =％d; data =％*。* s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           （int）length，（int）length，（int）length，data）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *检查更多数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    while（mysql_session_track_get_next（mysql，type，＆data，＆length）== 0）</font></font><font></font>
    {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“mysql_session_track_get_next（）：length =％d; data =％*。* s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             （int）length，（int）length，（int）length，data）;</font></font><font></font>
    }<font></font>
  }<font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-session-track-get-next"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.70 mysql_session_track_get_next（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548749440"></a><a class="indexterm" name="idm140091548748352"></a><p>
        <code class="literal">int mysql_session_track_get_next(MYSQL *mysql, enum
        enum_session_state_type type, const char **data, size_t
        *length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-next-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数获取从服务器接收的其他会话状态更改信息，然后检索该信息
           </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">参数与for
           </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-next" title="28.7.7.70 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          相同
           </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功呼叫后</font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-next" title="28.7.7.70 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          重复</font><font style="vertical-align: inherit;">呼叫
           </font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">直到它返回非零值，表示没有更多信息可用。</font><font style="vertical-align: inherit;">调用顺序
           </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-next" title="28.7.7.70 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          类似于
           </font></font><a class="link" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关更多信息和演示这两个函数的示例，请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-session-track-get-first" title="28.7.7.69 mysql_session_track_get_first（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.69节“mysql_session_track_get_first（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-next-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-next-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-set-character-set"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.71 mysql_set_character_set（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548728896"></a><p>
        <code class="literal">int mysql_set_character_set(MYSQL *mysql, const char
        *csname)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-set-character-set-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数用于设置当前连接的默认字符集。</font><font style="vertical-align: inherit;">该字符串</font></font><code class="literal">csname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定有效的字符集名称。</font><font style="vertical-align: inherit;">连接排序规则成为字符集的默认排序规则。</font><font style="vertical-align: inherit;">此函数的作用类似于</font></font><a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET
          NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，但也设置了值
           </font></font><code class="literal">mysql-&gt;charset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，从而影响了所使用的字符集
          </font></font><a class="link" href="connectors-apis.html#mysql-real-escape-string" title="28.7.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a>
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-character-set-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-character-set-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL mysql;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_init（与MySQL）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（！mysql_real_connect（＆mysql，“host”，“user”，“passwd”，“database”，0，NULL，0））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“无法连接到数据库：错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          mysql_error（与MySQL））;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（！mysql_set_character_set（＆mysql，“utf8”））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“新客户端字符集：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_character_set_name（与MySQL））;</font></font><font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-set-local-infile-default"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.72 mysql_set_local_infile_default（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548714944"></a><a class="indexterm" name="idm140091548713856"></a><p>
        <code class="literal">void mysql_set_local_infile_default(MYSQL
        *mysql);</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-default-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将</font></font><a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA语法"><code class="literal">LOAD DATA
          LOCAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回调函数设置为C客户端库内部使用的默认值。</font><font style="vertical-align: inherit;">如果</font></font><a class="link" href="connectors-apis.html#mysql-set-local-infile-handler" title="28.7.7.73 mysql_set_local_infile_handler（）"><code class="literal">mysql_set_local_infile_handler()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          尚未调用或未为每个回调提供有效函数，</font><font style="vertical-align: inherit;">库将自动调用此函数
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-default-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-default-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-set-local-infile-handler"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.73 mysql_set_local_infile_handler（）</font></font></h4>

</div>

</div>

</div>
<p>
        <code class="literal">void mysql_set_local_infile_handler(MYSQL *mysql, int
        (*local_infile_init)(void **, const char *, void *), int
        (*local_infile_read)(void *, char *, unsigned int), void
        (*local_infile_end)(void *), int (*local_infile_error)(void *,
        char*, unsigned int), void *userdata);</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-handler-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数安装在</font></font><a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA语法"><code class="literal">LOAD
          DATA LOCAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">执行期间使用的回调</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它使应用程序能够对本地（客户端）数据文件读取进行控制。</font><font style="vertical-align: inherit;">参数是连接处理程序，一组指向回调函数的指针，以及指向回调可用于共享信息的数据区域的指针。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要使用
           </font></font><a class="link" href="connectors-apis.html#mysql-set-local-infile-handler" title="28.7.7.73 mysql_set_local_infile_handler（）"><code class="literal">mysql_set_local_infile_handler()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，您必须编写以下回调函数：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INT</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
local_infile_init（void ** ptr，const char * filename，void * userdata）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          初始化功能。</font><font style="vertical-align: inherit;">这被称为一次进行必要的设置，打开数据文件，分配数据结构等等。</font><font style="vertical-align: inherit;">第一个</font></font><code class="literal">void**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是指向指针的指针。</font><font style="vertical-align: inherit;">您可以将指针（即
           </font></font><code class="literal">*ptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）设置为将传递给其他每个回调的值（作为a </font></font><code class="literal">void*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">回调可以使用此指向值来维护状态信息。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">userdata</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是传递到相同的值
           </font></font><a class="link" href="connectors-apis.html#mysql-set-local-infile-handler" title="28.7.7.73 mysql_set_local_infile_handler（）"><code class="literal">mysql_set_local_infile_handler()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使初始化函数返回零表示成功，非零表示错误。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INT</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
local_infile_read（void * ptr，char * buf，unsigned int buf_len）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          数据读取功能。</font><font style="vertical-align: inherit;">重复调用此方法以读取数据文件。</font></font><code class="literal">buf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指向存储读取数据的缓冲区，并且</font></font><code class="literal">buf_len</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          是回调可以读取并存储在缓冲区中的最大字节数。</font><font style="vertical-align: inherit;">（它可以读取更少的字节，但不应该读更多。）
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值是读取的字节数，或者当无法读取更多数据时返回零（这表示EOF）。</font><font style="vertical-align: inherit;">如果发生错误，则返回小于零的值。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空虚</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
local_infile_end（void * ptr）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          终止功能。</font><font style="vertical-align: inherit;">在</font></font><code class="literal">local_infile_read()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回零（EOF）或错误</font><font style="vertical-align: inherit;">后调用一次
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在此函数中，释放所分配的任何内存</font></font><code class="literal">local_infile_init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并执行任何其他必要的清理。</font><font style="vertical-align: inherit;">即使初始化函数返回错误，也会调用它。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INT</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
local_infile_error（void * ptr，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                   char * error_msg，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                   unsigned int error_msg_len）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          错误处理功能。</font><font style="vertical-align: inherit;">如果您的任何其他函数返回错误，则调用此方法以获取文本错误消息以返回给用户。</font></font><code class="literal">error_msg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向写入消息的缓冲区，并且
           </font></font><code class="literal">error_msg_len</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是缓冲区的长度。</font><font style="vertical-align: inherit;">将消息写为以空字符结尾的字符串，最多为
           </font></font><code class="literal">error_msg_len</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-1个字节。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值是错误号。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通常，其他回调将错误消息存储在指向的数据结构中</font></font><code class="literal">ptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以便
           </font></font><code class="literal">local_infile_error()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以将消息从那里复制到</font></font><code class="literal">error_msg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用
           </font></font><a class="link" href="connectors-apis.html#mysql-set-local-infile-handler" title="28.7.7.73 mysql_set_local_infile_handler（）"><code class="literal">mysql_set_local_infile_handler()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          C代码并将指针传递给回调函数之后，您可以发出一个
           </font></font><a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA语法"><code class="literal">LOAD DATA
          LOCAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句（例如，通过使用
           </font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">客户端库会自动调用您的回调。</font><font style="vertical-align: inherit;">指定的文件名将</font></font><a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA语法"><code class="literal">LOAD
          DATA LOCAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为第二个参数传递给</font></font><code class="literal">local_infile_init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回调。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-handler-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-handler-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-set-server-option"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.74 mysql_set_server_option（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548664320"></a><p>
        <code class="literal">int mysql_set_server_option(MYSQL *mysql, enum
        enum_mysql_set_option option)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-set-server-option-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          启用或禁用连接选项。
          </font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以具有以下值之一。
</font></font></p>
<div class="informaltable">
<table summary="Options for mysql_set_server_option() and a description of each option."><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_ON</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用多语句支持</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_OFF</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用多语句支持</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果启用多语句支持，则应该从调用</font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过使用调用的循环</font><font style="vertical-align: inherit;">检索结果
           </font><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以确定是否有更多结果。</font><font style="vertical-align: inherit;">有关示例，请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-multiple-queries" title="28.7.23 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.23节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          能够与多语句支持
           </font></font><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_ON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不具备完全一样的效果通过将使其
           </font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志
           </font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
           </font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还使
           </font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果</font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在程序</font><font style="vertical-align: inherit;">中使用
           </font><font style="vertical-align: inherit;">SQL语句，则必须启用多结果支持; </font><font style="vertical-align: inherit;">这意味着它</font></font><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_ON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本身不足以允许使用
           </font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-server-option-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-server-option-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_er_unknown_com_error"><code class="literal">ER_UNKNOWN_COM_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              服务器不支持
               </font></font><a class="link" href="connectors-apis.html#mysql-set-server-option" title="28.7.7.74 mysql_set_server_option（）"><code class="literal">mysql_set_server_option()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （服务器早于4.1.1的情况）或服务器不支持尝试设置的选项。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-shutdown"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.75 mysql_shutdown（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548619456"></a><p>
        <code class="literal">int mysql_shutdown(MYSQL *mysql, enum
        mysql_enum_shutdown_level shutdown_level)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-shutdown-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <code class="literal">mysql_shutdown()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已弃用，将在未来的MySQL版本中删除。</font><font style="vertical-align: inherit;">相反，用于
             </font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行
             </font></font><a class="link" href="sql-syntax.html#shutdown" title="13.7.7.9 SHUTDOWN语法"><code class="literal">SHUTDOWN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要求数据库服务器关闭。</font><font style="vertical-align: inherit;">已连接的用户必须具有该</font></font><a class="link" href="security.html#priv_shutdown"><code class="literal">SHUTDOWN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限。</font><font style="vertical-align: inherit;">MySQL服务器只支持一种类型的关闭;
          </font></font><code class="literal">shutdown_level</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须等于
           </font></font><code class="literal">SHUTDOWN_DEFAULT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用较旧版本的</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标头和调用
           </font><font style="vertical-align: inherit;">编译的动态链接可执行文件</font></font><a class="link" href="connectors-apis.html#mysql-shutdown" title="28.7.7.75 mysql_shutdown（）"><code class="literal">mysql_shutdown()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要与旧</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态库一起使用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另一种方法
           </font></font><a class="link" href="connectors-apis.html#mysql-shutdown" title="28.7.7.75 mysql_shutdown（）"><code class="literal">mysql_shutdown()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是使用
           </font></font><a class="link" href="sql-syntax.html#shutdown" title="13.7.7.9 SHUTDOWN语法"><code class="literal">SHUTDOWN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL语句。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="xref" href="server-administration.html#server-shutdown" title="5.1.17服务器关闭过程"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.17节“服务器关闭过程”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          介绍了
           </font><a class="xref" href="server-administration.html#server-shutdown" title="5.1.17&nbsp;The Server Shutdown Process"><font style="vertical-align: inherit;">关闭过程</font></a><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-shutdown-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-shutdown-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-sqlstate"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.76 mysql_sqlstate（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548587392"></a><p>
        <code class="literal">const char *mysql_sqlstate(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-sqlstate-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回以null结尾的字符串，其中包含最近执行的SQL语句的SQLSTATE错误代码。</font><font style="vertical-align: inherit;">错误代码由五个字符组成。</font></font><code class="literal">'00000'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          意思是</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有错误。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些值由ANSI SQL和ODBC指定。</font><font style="vertical-align: inherit;">有关可能值的列表，请参阅
           </font></font><a class="xref" href="error-handling.html" title="附录B错误，错误代码和常见问题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录B，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误，错误代码和常见问题</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回的SQLSTATE值与返回
           </font></font><a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的特定于MySQL的错误号不同
           </font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，</font></font><a class="link" href="programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端程序使用以下格式，其中显示错误</font></font><code class="literal">1146</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值和
           </font></font><code class="literal">'42S02'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是对应的
           </font></font><a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>SELECT * FROM no_such_table;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ERROR 1146（42S02）：表'test.no_such_table'不存在</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          并非所有MySQL错误号都映射到SQLSTATE错误代码。</font><font style="vertical-align: inherit;">值</font></font><code class="literal">'HY000'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（一般错误）用于未映射的错误号。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          失败</font><font style="vertical-align: inherit;">后</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">，</font></font><a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能不会返回有用的值。</font><font style="vertical-align: inherit;">例如，如果主机被服务器阻止并且连接关闭而没有将任何SQLSTATE值发送到客户端，则会发生这种情况。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-sqlstate-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          包含SQLSTATE错误代码的以null结尾的字符串。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-sqlstate-see-also"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也可以看看</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.14节“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="xref" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.15节，“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="connectors-apis.html#mysql-stmt-sqlstate" title="28.7.11.27 mysql_stmt_sqlstate（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.27节“mysql_stmt_sqlstate（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-ssl-set"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.77 mysql_ssl_set（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548559088"></a><p>
        <code class="literal">bool mysql_ssl_set(MYSQL *mysql, const char *key, const
        char *cert, const char *ca, const char *capath, const char
        *cipher)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-ssl-set-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于使用SSL建立加密连接。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数必须是一个有效的连接处理程序。</font><font style="vertical-align: inherit;">任何未使用的SSL参数都可以作为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果使用，</font></font><a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须先调用
           </font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非在客户端库中启用SSL支持，否则不执行任何操作。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以选择调用
           </font></font><a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以获取加密连接，因为默认情况下，如果服务器支持加密连接，MySQL程序会尝试使用加密进行连接，如果无法建立加密连接，则会回退到未加密的连接（请参见</font></font><a class="xref" href="security.html#using-encrypted-connections" title="6.3.1配置MySQL使用加密连接"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.3.1节“，配置MySQL使用加密连接“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
          </font></font><a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于必须指定特定证书和密钥文件，加密密码等的应用程序可能很有用。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果此类连接可用，则指定用于建立加密连接的SSL信息（如证书和密钥文件），但不强制要求对所获得的连接进行加密。</font><font style="vertical-align: inherit;">要要求加密连接，请使用</font></font><a class="xref" href="connectors-apis.html#c-api-encrypted-connections" title="28.7.22 C API加密连接支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.22节“C API加密连接支持”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述的技术
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了提供相对于默认加密提供的安全性的额外安全性，客户端可以提供与服务器使用的CA证书匹配的CA证书，并启用主机名身份验证。</font><font style="vertical-align: inherit;">通过这种方式，服务器和客户端将其信任放在相同的CA证书中，并且客户端验证它所连接的主机是否是预期的主机。</font><font style="vertical-align: inherit;">有关详细信息，请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-encrypted-connections" title="28.7.22 C API加密连接支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.22节“C API加密连接支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个便利功能，基本上等同于这组</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_options（mysql，MYSQL_OPT_SSL_KEY，key）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（mysql，MYSQL_OPT_SSL_CERT，cert）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（mysql，MYSQL_OPT_SSL_CA，ca）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（mysql，MYSQL_OPT_SSL_CAPATH，capath）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（mysql，MYSQL_OPT_SSL_CIPHER，cipher）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          正因为如此等价的，应用程序可以，而不是调用</font></font><a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，调用
           </font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接，省略对于其期权价值是这些选项调用
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此外，
           </font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供不可用的加密连接选项
           </font></font><a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，例如
           </font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定连接的安全状态，以及
           </font></font><code class="literal">MYSQL_OPT_TLS_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定客户端允许加密连接的协议。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从中返回的连接处理程序</font></font><a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户端私钥文件的路径名。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">cert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户端公钥证书文件的路径名。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">ca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：证书颁发机构（CA）证书文件的路径名。</font><font style="vertical-align: inherit;">如果使用此选项，则必须指定服务器使用的相同证书。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">capath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含受信任SSL CA证书文件的目录的路径名。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">cipher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：SSL加密的允许密码列表。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-ssl-set-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数始终返回</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果SSL设置不正确，则</font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在您尝试连接时</font><font style="vertical-align: inherit;">，后续
           </font><font style="vertical-align: inherit;">调用将返回错误。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stat"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.78 mysql_stat（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548511488"></a><p>
        <code class="literal">const char *mysql_stat(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stat-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回包含类似于</font></font><a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin  - 管理MySQL服务器的客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqladmin status</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          命令</font><font style="vertical-align: inherit;">提供的信息的字符串</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这包括以秒为单位的正常运行时间以及正在运行的线程，问题，重新加载和打开表的数量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stat-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          描述服务器状态的字符串。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stat-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-store-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.79 mysql_store_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548491104"></a><p>
        <code class="literal">MYSQL_RES *mysql_store_result(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-store-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个同步功能。</font><font style="vertical-align: inherit;">它的异步对应物是
             </font></font><a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">供需要与服务器进行异步通信的应用程序使用的。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          调用之后</font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者</font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，你必须调用</font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者</font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为每个成功产生一个结果集的语句（</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW语法"><code class="literal">SHOW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE语法"><code class="literal">DESCRIBE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#check-table" title="13.7.3.2检查表语法"><code class="literal">CHECK TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等）。</font></font><a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成结果集后，您</font><font style="vertical-align: inherit;">还必须调用
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您无需致电
           </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他声明，但如果您</font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在所有情况下</font><font style="vertical-align: inherit;">都致电，它不会造成任何伤害或导致任何显着的性能下降
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可以通过检查是否</font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非零值</font><font style="vertical-align: inherit;">来检测语句是否具有结果集
           </font><font style="vertical-align: inherit;">（稍后将详细介绍）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果启用多语句支持，则应该从调用</font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过使用调用的循环</font><font style="vertical-align: inherit;">检索结果
           </font><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以确定是否有更多结果。</font><font style="vertical-align: inherit;">有关示例，请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-multiple-queries" title="28.7.23 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.23节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您想知道语句是否应返回结果集，可以使用它
           </font></font><a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来检查。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.22节“mysql_field_count（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将查询的整个结果读取到客户端，分配
           </font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构，并将结果放入此结构中。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果语句没有返回结果集（例如，如果它是一个
           </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句），或发生错误和失败的结果集的阅读。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果没有返回行，则返回空结果集。</font><font style="vertical-align: inherit;">（空结果集与空指针的不同之处在于返回值。）
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用
           </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并返回不是空指针的结果之后，可以调用
           </font></font><a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以查找结果集中有多少行。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          你可以调用</font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从结果集读取行，或者
           </font></font><a class="link" href="connectors-apis.html#mysql-row-seek" title="28.7.7.64 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="connectors-apis.html#mysql-row-tell" title="28.7.7.65 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取或设置结果集中的当前行位置。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#null-mysql-store-result" title="28.7.29.1为什么mysql_store_result（）有时在mysql_query（）返回Success后返回NULL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.29.1节“为什么mysql_store_result（）有时在mysql_query（）返回成功后返回NULL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-store-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向</font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果结果</font><font style="vertical-align: inherit;">的指针</font><font style="vertical-align: inherit;">。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果语句未返回结果集或发生错误。</font><font style="vertical-align: inherit;">要确定是否发生错误，请检查是
           </font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非空字符串，</font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回非零值还是
           </font></font><a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-store-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重置
           </font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果成功。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-thread-id"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.80 mysql_thread_id（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548416256"></a><p>
        <code class="literal">unsigned long mysql_thread_id(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-thread-id-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回当前连接的线程ID。</font><font style="vertical-align: inherit;">此值可用作</font></font><a class="link" href="connectors-apis.html#mysql-kill" title="28.7.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">终止线程</font><font style="vertical-align: inherit;">的参数
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果连接丢失并重新连接
           </font></font><a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则线程ID会更改。</font><font style="vertical-align: inherit;">这意味着您不应该获取线程ID并将其存储以供日后使用。</font><font style="vertical-align: inherit;">你应该在需要时得到它。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果线程ID大于32位，则此功能无法正常工作，这在某些系统上可能会发生。</font><font style="vertical-align: inherit;">为避免出现问题
             </font></font><a class="link" href="connectors-apis.html#mysql-thread-id" title="28.7.7.80 mysql_thread_id（）"><code class="literal">mysql_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请勿使用它。</font><font style="vertical-align: inherit;">要获取连接ID，请执行</font></font><code class="literal">SELECT
            CONNECTION_ID()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询并检索结果。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-id-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当前连接的线程ID。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-id-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-use-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.81 mysql_use_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548401536"></a><p>
        <code class="literal">MYSQL_RES *mysql_use_result(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-use-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          调用之后</font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者</font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，你必须调用</font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者</font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为每个成功产生一个结果集的语句（</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW语法"><code class="literal">SHOW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE语法"><code class="literal">DESCRIBE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#check-table" title="13.7.3.2检查表语法"><code class="literal">CHECK TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等）。</font></font><a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成结果集后，您</font><font style="vertical-align: inherit;">还必须调用
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启动结果集检索，但实际上并没有将结果集读取到客户端
           </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中。</font><font style="vertical-align: inherit;">相反，必须通过调用来单独检索每一行</font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这会直接从服务器读取查询结果，而不会将其存储在临时表或本地缓冲区中，这样会更快并且使用的内存要少得多
           </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">客户端仅为当前行和可能长到</font></font><a class="link" href="server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节</font><font style="vertical-align: inherit;">的通信缓冲区分配内存
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另一方面，</font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果对客户端的每一行进行大量处理，或者输出发送到用户可以键入的屏幕</font></font><code class="literal">^S</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（停止滚动）</font><font style="vertical-align: inherit;">，则不应使用
           </font><font style="vertical-align: inherit;">锁定读取</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这会占用服务器并阻止其他线程更新从中获取数据的任何表。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用时</font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，必须执行
           </font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直到
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值，否则，未提取的行将作为下一个查询的结果集的一部分返回。</font></font><code class="literal">Commands out of
          sync; you can't run this command now</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您忘记这样做</font><font style="vertical-align: inherit;">，C API会给出错误</font><font style="vertical-align: inherit;">！
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您不得使用
           </font></font><a class="link" href="connectors-apis.html#mysql-data-seek" title="28.7.7.9 mysql_data_seek（）"><code class="literal">mysql_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-row-seek" title="28.7.7.64 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-row-tell" title="28.7.7.65 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从返回的结果
           </font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，也不得发出其他查询，直至
           </font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成。</font><font style="vertical-align: inherit;">（但是，在获取所有行之后，</font></font><a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准确地返回</font><font style="vertical-align: inherit;">获取的行
           </font><font style="vertical-align: inherit;">数。）
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成结果集后，</font><font style="vertical-align: inherit;">
          必须调用
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-use-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个</font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果结构。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-use-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重置
           </font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果成功。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-warning-count"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.7.82 mysql_warning_count（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548336256"></a><p>
        <code class="literal">unsigned int mysql_warning_count(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-warning-count-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回在执行上一个SQL语句期间生成的错误，警告和注释的数量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-warning-count-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          警告计数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-warning-count-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statements"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.8 C API准备语句</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548326544"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL客户端/服务器协议提供了预准备语句的使用。</font><font style="vertical-align: inherit;">此功能使用</font><font style="vertical-align: inherit;">初始化函数</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">语句处理程序数据结构
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-init" title="28.7.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">准备执行是多次执行语句的有效方法。</font><font style="vertical-align: inherit;">首先解析该语句以准备执​​行。</font><font style="vertical-align: inherit;">然后，使用初始化函数返回的语句处理程序，稍后执行一次或多次。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      准备执行比直接执行多次执行的语句更快，主要是因为查询只被解析一次。</font><font style="vertical-align: inherit;">在直接执行的情况下，每次执行时都会解析查询。</font><font style="vertical-align: inherit;">准备执行还可以减少网络流量，因为每次执行预准备语句时，只需要发送参数数据。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在某些情况下，准备好的声明可能无法提高性能。</font><font style="vertical-align: inherit;">为了获得最佳结果，请使用准备好的和非准备好的语句测试您的应用程序，并选择最佳性能。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      预处理语句的另一个优点是它使用二进制协议，使客户端和服务器之间的数据传输更加高效。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关可用作预准备语句的SQL语句列表，请参见</font></font><a class="xref" href="sql-syntax.html#sql-syntax-prepared-statements" title="13.5准备好的SQL语句语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.5节“准备</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好的</font><a class="xref" href="sql-syntax.html#sql-syntax-prepared-statements" title="13.5准备好的SQL语句语法"><font style="vertical-align: inherit;">SQL语句语法”</font></a><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      检测到由预准备语句引用的表或视图的元数据更改，并在下次执行时自动对语句进行表示。</font><font style="vertical-align: inherit;">有关更多信息，请参见
       </font></font><a class="xref" href="optimization.html#statement-caching" title="8.10.3准备好的声明和存储程序的缓存"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.10.3节“准备语句和存储程序的缓存”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-data-structures"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.9 C API准备语句数据结构</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-type-codes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.9.1 C API准备语句类型代码</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#c-api-prepared-statement-type-conversions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.9.2 C API准备语句类型转换</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091548316704"></a><a class="indexterm" name="idm140091548315200"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      准备好的语句使用多种数据结构：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要获取语句处理程序，请将</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          连接处理</font><font style="vertical-align: inherit;">程序传递</font><font style="vertical-align: inherit;">给</font></font><a class="link" href="connectors-apis.html#mysql-stmt-init" title="28.7.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该</font><font style="vertical-align: inherit;">处理程序
           </font><font style="vertical-align: inherit;">返回指向</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据结构</font><font style="vertical-align: inherit;">的指针</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此结构用于语句的进一步操作。</font><font style="vertical-align: inherit;">要指定要准备的语句，请将
           </font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针和语句字符串传递给</font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要为预准备语句提供输入参数，请设置
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构并将其传递给
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要接收输出列值，请设置
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构并将其传递给
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构用于在两个方向上传输时间数据。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下讨论详细描述了准备好的语句数据类型。</font><font style="vertical-align: inherit;">有关如何使用它们的示例，请参见
       </font></font><a class="xref" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.10节“mysql_stmt_execute（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="xref" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.11节“mysql_stmt_fetch（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="indexterm" name="idm140091548297520"></a>

          <code class="literal">MYSQL_STMT</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此结构是预准备语句的处理程序。</font><font style="vertical-align: inherit;">通过调用创建一个处理程序
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-init" title="28.7.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它返回一个指向a的指针</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">处理程序用于语句的所有后续操作，直到您关闭它
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，此时处理程序变为无效并且不应再使用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构没有用于应用程序的成员。</font><font style="vertical-align: inherit;">应用程序不应尝试复制</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构。</font><font style="vertical-align: inherit;">无法保证此类副本可用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          多个语句处理程序可以与单个连接相关联。</font><font style="vertical-align: inherit;">处理程序数量的限制取决于可用的系统资源。
        </font></font></p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091548288464"></a>

          <code class="literal">MYSQL_BIND</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此结构用于语句输入（发送到服务器的数据值）和输出（从服务器返回的结果值）：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输入，使用</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将参数数据值绑定到缓冲区以供使用
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出，使用</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              将缓冲区绑定到结果集列，以便用于获取行
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要使用</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构，请将其内容归零以对其进行初始化，然后相应地设置其成员。</font><font style="vertical-align: inherit;">例如，要声明和初始化三个</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的数组
           </font><font style="vertical-align: inherit;">，请使用以下代码：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_BIND绑定[3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
memset（bind，0，sizeof（bind））;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构包含以下成员供应用程序使用。</font><font style="vertical-align: inherit;">对于几个成员，使用方式取决于结构是用于输入还是输出。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">enum enum_field_types buffer_type</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              缓冲区的类型。</font><font style="vertical-align: inherit;">此成员指示绑定到语句参数或结果集列的C语言变量的数据类型。</font><font style="vertical-align: inherit;">对于输入，
               </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示包含要发送到服务器的值的变量的类型。</font><font style="vertical-align: inherit;">对于输出，它指示应存储从服务器接收的值的变量的类型。</font><font style="vertical-align: inherit;">有关允许</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，请参见
               </font></font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-type-codes" title="28.7.9.1 C API准备语句类型代码"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.9.1节“C API准备语句类型代码”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">void *buffer</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指向要用于数据传输的缓冲区的指针。</font><font style="vertical-align: inherit;">这是C语言变量的地址。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输入，</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是指向变量的指针，在该变量中存储语句参数的数据值。</font><font style="vertical-align: inherit;">当您调用时
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL使用存储在变量中的值代替语句中的相应参数标记（</font></font><code class="literal">?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在语句字符串中</font><font style="vertical-align: inherit;">指定</font><font style="vertical-align: inherit;">）。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出，</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个指向变量的指针，在该变量中返回结果集列值。</font><font style="vertical-align: inherit;">当您调用时
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL会在此变量中存储结果集的当前行中的列值。</font><font style="vertical-align: inherit;">您可以在呼叫返回时访问该值。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为了最大限度地减少MySQL在客户端C语言值和服务器端SQL值之间执行类型转换的需要，请使用类型与相应SQL值类似的C变量：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  对于数字数据类型，</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  应指向正确的数字C类型的变量。</font><font style="vertical-align: inherit;">对于整数变量（可以是
                   </font></font><code class="literal">char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单字节值或更大值的整数类型），您还应</font></font><code class="literal">unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过设置</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员来</font><font style="vertical-align: inherit;">指示变量是否具有该</font><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">，稍后</font><font style="vertical-align: inherit;">将
                   </font><font style="vertical-align: inherit;">对此进行说明
                   </font><font style="vertical-align: inherit;">。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  对于字符（非二进制）和二进制字符串数据类型，</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应指向字符缓冲区。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  对于日期和时间数据类型，
                   </font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应指向
                   </font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              有关C类型和SQL类型之间的映射以及有关类型转换的注释的指导，请参见
               </font></font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-type-codes" title="28.7.9.1 C API准备语句类型代码"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.9.1节“C API准备语句类型代码”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-type-conversions" title="28.7.9.2 C API准备语句类型转换"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.9.2节“C API准备语句类型转换”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">unsigned long buffer_length</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              实际大小</font></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以字节</font><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">单位。</font><font style="vertical-align: inherit;">这表示可以存储在缓冲区中的最大数据量。</font><font style="vertical-align: inherit;">对于字符和二进制C数据，该
               </font></font><code class="literal">buffer_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值指定</font></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于</font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定输入值</font><font style="vertical-align: inherit;">的时间长度</font><font style="vertical-align: inherit;">，或者</font><font style="vertical-align: inherit;">与其</font><font style="vertical-align: inherit;">一起使用</font><font style="vertical-align: inherit;">时
               </font><font style="vertical-align: inherit;">可以提取到缓冲区中的最大输出数据字节数
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">unsigned long *length</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指向</font></font><code class="literal">unsigned long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">的指针</font><font style="vertical-align: inherit;">，指示存储在其中的实际数据字节数</font></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用于字符或二进制C数据。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输入参数数据绑定，设置
               </font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为指示存储的参数值的实际长度
               </font></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这是用来的
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出值绑定，MySQL会</font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在您调用时
               </font><font style="vertical-align: inherit;">设置
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值决定如何解释长度：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果返回值为0，则</font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  表示参数值的实际长度。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果返回值为
                   </font></font><code class="literal">MYSQL_DATA_TRUNCATED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则
                   </font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示参数值的非截断长度。</font><font style="vertical-align: inherit;">在这种情况下，最小值</font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><code class="literal">buffer_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示值的实际长度。
</font></font></p></li></ul>
</div>
<p>
              <code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数字和时间数据类型将被忽略，因为该
               </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值确定数据值的长度。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果必须在获取之前确定返回值的长度，请参见
               </font></font><a class="xref" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.11节“mysql_stmt_fetch（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以了解某些策略。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">bool *is_null</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该成员指向一个</font></font><code class="literal">bool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量，如果值为true，则为true，否则为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于input，设置
               </font></font><code class="literal">*is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为true表示您正在将</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值作为语句参数</font><font style="vertical-align: inherit;">传递</font><font style="vertical-align: inherit;">。
            </font></font></p><p>
              <code class="literal">is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指向</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔标量</font><font style="vertical-align: inherit;">的
               </font><span class="emphasis"><em><font style="vertical-align: inherit;">指针</font></em></span><font style="vertical-align: inherit;">，而不是布尔标量，以便为指定</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">提供灵活性
               </font><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果您的数据值始终
                   </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，用
                   </font></font><code class="literal">MYSQL_TYPE_NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为
                   </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在绑定列值。</font><font style="vertical-align: inherit;">其他</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  成员，包括</font></font><code class="literal">is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，无关紧要。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果您的数据值始终</font></font><code class="literal">NOT
                  NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，设置</font></font><code class="literal">is_null = (bool*)
                  0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并为您要绑定的变量适当地设置其他成员。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  在所有其他情况下，适当地设置其他成员并设置</font></font><code class="literal">is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><code class="literal">bool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">的地址</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">设定该变量的值为真或假之间适当地执行，以指示相应的数据值是否是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                   </font></font><code class="literal">NOT NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分别。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出，当您获取一行时，MySQL </font></font><code class="literal">is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据从语句返回的结果集列值是否</font><font style="vertical-align: inherit;">为，</font><font style="vertical-align: inherit;">将</font><font style="vertical-align: inherit;">指向的值设置</font><font style="vertical-align: inherit;">为true或false </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">bool is_unsigned</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此构件适用于与数据类型C变量，可以是</font></font><code class="literal">unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （</font></font><code class="literal">char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">short int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">long long int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果变量指向的</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
               </font></font><code class="literal">unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">则</font><font style="vertical-align: inherit;">设置</font><font style="vertical-align: inherit;">为true，否则</font><font style="vertical-align: inherit;">设置</font><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">false。</font><font style="vertical-align: inherit;">例如，如果将</font></font><code class="literal">signed char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              变量</font><font style="vertical-align: inherit;">绑定</font><font style="vertical-align: inherit;">到</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请指定类型代码</font></font><code class="literal">MYSQL_TYPE_TINY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并设置
               </font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为false。</font><font style="vertical-align: inherit;">如果你绑定了一个
               </font></font><code class="literal">unsigned char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，那么类型代码是相同的，但</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该是真的。</font><font style="vertical-align: inherit;">（因为</font></font><code class="literal">char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，没有定义是签名还是未签名，因此最好通过使用明确签名</font></font><code class="literal">signed
              char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">unsigned char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）
            </font></font></p><p>
              <code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅适用于客户端的C语言变量。</font><font style="vertical-align: inherit;">它没有指出服务器端相应SQL值的签名。</font><font style="vertical-align: inherit;">例如，如果使用
               </font></font><code class="literal">int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量为</font></font><code class="literal">BIGINT UNSIGNED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">提供值
               </font><font style="vertical-align: inherit;">，
               </font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则应为false，因为它
               </font></font><code class="literal">int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是带符号的类型。</font><font style="vertical-align: inherit;">如果使用
               </font></font><code class="literal">unsigned int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量为</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">提供值</font><font style="vertical-align: inherit;">，
               </font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则应为true，因为
               </font></font><code class="literal">unsigned int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它是无符号类型。</font><font style="vertical-align: inherit;">MySQL在两个方向上执行有符号值和无符号值之间的正确转换，但是如果截断结果会发出警告。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">bool *error</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出，将此成员设置为指向
               </font></font><code class="literal">bool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量，以便在行提取操作之后为存储在那里的参数提供截断信息。</font><font style="vertical-align: inherit;">启用截断报告时，
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
               </font></font><code class="literal">MYSQL_DATA_TRUNCATED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
               </font><font style="vertical-align: inherit;">在发生截断的参数</font></font><code class="literal">*error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构中为</font><font style="vertical-align: inherit;">true
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">截断表示丢失符号或有效数字，或者字符串太长而无法放入列中。</font><font style="vertical-align: inherit;">默认情况下启用截断报告，但可以通过</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该
               </font></font><code class="literal">MYSQL_REPORT_DATA_TRUNCATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">进行调用来控制截断报告
               </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p>
          <a class="indexterm" name="idm140091548168752"></a>

          <code class="literal">MYSQL_TIME</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此结构被用于发送和接收
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接数据和从所述服务器。</font><font style="vertical-align: inherit;">设置</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为指向一个部件</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构，并且设置</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个的构件
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构颞类型之一（</font></font><code class="literal">MYSQL_TYPE_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_DATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_DATETIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_TIMESTAMP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构包含下表中列出的成员。
</font></font></p>
<div class="informaltable">
<table summary="Members of the MYSQL_TIME structure and a description of each member."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会员</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">unsigned int year</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">那一年</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int month</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一年中的一个月</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int day</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个月的哪一天</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int hour</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一天的时间</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int minute</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一小时的分钟</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int second</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二分钟</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">bool neg</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个布尔标志，指示时间是否为负数</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned long second_part</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秒的小数部分，以微秒为单位</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          仅</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用适用于给定类型的时间值</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构的</font><font style="vertical-align: inherit;">那些部分</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">的
           </font></font><code class="literal">year</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">month</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">day</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元件用于
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值。</font><font style="vertical-align: inherit;">的
           </font></font><code class="literal">hour</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">minute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">second</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元件用于
           </font></font><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-date-handling" title="28.7.24 C API准备语句处理日期和时间值"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.24节“C API准备语句处理日期和时间值”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-prepared-statement-type-codes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.9.1 C API准备语句类型代码</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091548110960"></a><a class="indexterm" name="idm140091548109456"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        所述</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的部件
         </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构表示绑定到语句参数C语言变量的数据类型或结果集列。</font><font style="vertical-align: inherit;">对于输入，</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        指示包含要发送到服务器的值的变量的类型。</font><font style="vertical-align: inherit;">对于输出，它指示应存储从服务器接收的值的变量的类型。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        下表显示了</font><font style="vertical-align: inherit;">发送到服务器的输入值</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">成员
         </font><font style="vertical-align: inherit;">的允许值
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该表显示了可以使用的C变量类型，相应的类型代码以及可以在不进行转换的情况下使用提供的值的SQL数据类型。</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据要绑定的C语言变量的数据类型</font><font style="vertical-align: inherit;">选择</font><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">对于整数类型，还应设置
         </font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员以指示变量是有符号还是无符号。
</font></font></p>
<div class="informaltable">
<table summary="C type input variables, corresponding buffer_type values, and the SQL data types for which the supplied value can be used without conversion."><colgroup><col width="30%"><col width="35%"><col width="35%"></colgroup><thead><tr>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输入变量C类型</font></font></th>
            <th scope="col"><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 值</font></font></th>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL目标值类型</font></font></th>
          </tr></thead><tbody><tr>
            <td scope="row"><code class="literal">signed char</code></td>
            <td><code class="literal">MYSQL_TYPE_TINY</code></td>
            <td><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">TINYINT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">short int</code></td>
            <td><code class="literal">MYSQL_TYPE_SHORT</code></td>
            <td><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">SMALLINT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">int</code></td>
            <td><code class="literal">MYSQL_TYPE_LONG</code></td>
            <td><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">long long int</code></td>
            <td><code class="literal">MYSQL_TYPE_LONGLONG</code></td>
            <td><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">float</code></td>
            <td><code class="literal">MYSQL_TYPE_FLOAT</code></td>
            <td><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">double</code></td>
            <td><code class="literal">MYSQL_TYPE_DOUBLE</code></td>
            <td><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">MYSQL_TIME</code></td>
            <td><code class="literal">MYSQL_TYPE_TIME</code></td>
            <td><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">MYSQL_TIME</code></td>
            <td><code class="literal">MYSQL_TYPE_DATE</code></td>
            <td><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">MYSQL_TIME</code></td>
            <td><code class="literal">MYSQL_TYPE_DATETIME</code></td>
            <td><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">MYSQL_TIME</code></td>
            <td><code class="literal">MYSQL_TYPE_TIMESTAMP</code></td>
            <td><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">char[]</code></td>
            <td><code class="literal">MYSQL_TYPE_STRING</code></td>
            <td><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a>,
              <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a>,
              <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">char[]</code></td>
            <td><code class="literal">MYSQL_TYPE_BLOB</code></td>
            <td><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
              </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
              </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a></td>
          </tr><tr>
            <td scope="row"></td>
            <td><code class="literal">MYSQL_TYPE_NULL</code></td>
            <td><code class="literal">NULL</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用</font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-data-structures" title="28.7.9 C API准备语句数据结构"><font style="vertical-align: inherit;">第28.7.9节“C API准备语句数据结构”中</font></a><font style="vertical-align: inherit;">成员
         </font></font><code class="literal">MYSQL_TYPE_NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的说明中所示</font><font style="vertical-align: inherit;">。
      </font></font><code class="literal">is_null</code><font style="vertical-align: inherit;"></font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-data-structures" title="28.7.9 C API准备语句数据结构"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于输入字符串数据，请使用</font></font><code class="literal">MYSQL_TYPE_STRING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        或</font></font><code class="literal">MYSQL_TYPE_BLOB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于值是字符（非二进制）还是二进制字符串：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">MYSQL_TYPE_STRING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示字符输入字符串数据。</font><font style="vertical-align: inherit;">假定该值位于</font></font><a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">指示的字符集中
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果服务器将值存储到具有不同字符集的列中，则会将该值转换为该字符集。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_TYPE_BLOB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示二进制输入字符串数据 </font><font style="vertical-align: inherit;">该值被视为具有
             </font></font><code class="literal">binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集。</font><font style="vertical-align: inherit;">也就是说，它被视为字节字符串，不会发生转换。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        下表显示了</font><font style="vertical-align: inherit;">从服务器接收的输出值</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">成员
         </font><font style="vertical-align: inherit;">的允许值
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该表显示了接收值的SQL类型，此类值在结果集元数据中具有的相应类型代码，以及要绑定到</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构以接收SQL值而不进行转换</font><font style="vertical-align: inherit;">的推荐C语言数据类型</font><font style="vertical-align: inherit;">。</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据要绑定的C语言变量的数据类型</font><font style="vertical-align: inherit;">选择
         </font><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">对于整数类型，还应设置</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        成员以指示变量是有符号还是无符号。
</font></font></p>
<div class="informaltable">
<table summary="SQL types of received values, corresponding buffer_type values, and recommended C data type output variables."><colgroup><col width="30%"><col width="35%"><col width="35%"></colgroup><thead><tr>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL接收值的类型</font></font></th>
            <th scope="col"><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 值</font></font></th>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输出变量C类型</font></font></th>
          </tr></thead><tbody><tr>
            <td scope="row"><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">TINYINT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_TINY</code></td>
            <td><code class="literal">signed char</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">SMALLINT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_SHORT</code></td>
            <td><code class="literal">short int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">MEDIUMINT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_INT24</code></td>
            <td><code class="literal">int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_LONG</code></td>
            <td><code class="literal">int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_LONGLONG</code></td>
            <td><code class="literal">long long int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_FLOAT</code></td>
            <td><code class="literal">float</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a></td>
            <td><code class="literal">MYSQL_TYPE_DOUBLE</code></td>
            <td><code class="literal">double</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a></td>
            <td><code class="literal">MYSQL_TYPE_NEWDECIMAL</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#year" title="11.3.3年份类型"><code class="literal">YEAR</code></a></td>
            <td><code class="literal">MYSQL_TYPE_SHORT</code></td>
            <td><code class="literal">short int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a></td>
            <td><code class="literal">MYSQL_TYPE_TIME</code></td>
            <td><code class="literal">MYSQL_TIME</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a></td>
            <td><code class="literal">MYSQL_TYPE_DATE</code></td>
            <td><code class="literal">MYSQL_TIME</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a></td>
            <td><code class="literal">MYSQL_TYPE_DATETIME</code></td>
            <td><code class="literal">MYSQL_TIME</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a></td>
            <td><code class="literal">MYSQL_TYPE_TIMESTAMP</code></td>
            <td><code class="literal">MYSQL_TIME</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a>,
              <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a></td>
            <td><code class="literal">MYSQL_TYPE_STRING</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
              </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a></td>
            <td><code class="literal">MYSQL_TYPE_VAR_STRING</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TINYBLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
              </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TINYTEXT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_TINY_BLOB</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_BLOB</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">MEDIUMBLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
              </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">MEDIUMTEXT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_MEDIUM_BLOB</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">LONGBLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
              </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">LONGTEXT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_LONG_BLOB</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="data-types.html#bit-type" title="11.2.4比特值类型 -  BIT"><code class="literal">BIT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_BIT</code></td>
            <td><code class="literal">char[]</code></td>
</tr></tbody></table>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-prepared-statement-type-conversions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.9.2 C API准备语句类型转换</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547891856"></a><a class="indexterm" name="idm140091547890352"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        准备好的语句使用客户端的C语言变量在客户端和服务器之间传输数据，这些变量对应于服务器端的SQL值。</font><font style="vertical-align: inherit;">如果客户端的C变量类型与服务器端的相应SQL值类型不匹配，MySQL将在两个方向上执行隐式类型转换。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL知道服务器端SQL值的类型代码。</font><font style="vertical-align: inherit;">结构中</font><font style="vertical-align: inherit;">的</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
         </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示保存客户端值的C变量的类型代码。</font><font style="vertical-align: inherit;">这两个代码一起告诉MySQL必须执行哪些转换（如果有的话）。</font><font style="vertical-align: inherit;">这里有些例子：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果使用</font></font><code class="literal">MYSQL_TYPE_LONG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有
             </font></font><code class="literal">int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可变的整数值传递到要被存储到服务器
             </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的列时，MySQL存放前的值以浮点格式转换。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果您获取SQL </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">MEDIUMINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            列值，但指定</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            值</font></font><code class="literal">MYSQL_TYPE_LONGLONG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并使用类型的C变量</font></font><code class="literal">long long int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为目标缓冲区，则MySQL会将该
             </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">MEDIUMINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值（需要少于8个字节）转换为
             </font></font><code class="literal">long long int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（8字节变量）。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果取为255字节的值的数值列到一个
             </font></font><code class="literal">char[4]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符数组和指定
             </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值
             </font></font><code class="literal">MYSQL_TYPE_STRING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该数组中所得到的值是一个4字节串</font></font><code class="literal">'255\0'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            MySQL将</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值作为原始服务器端值的字符串表示形式</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">，这就是相应C类型的原因
             </font></font><code class="literal">char[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，
             </font></font><code class="literal">12.345</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回给客户端
             </font></font><code class="literal">'12.345'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果指定
             </font></font><code class="literal">MYSQL_TYPE_NEWDECIMAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符串缓冲区并将其绑定到</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构，则
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将该值作为字符串存储在缓冲区中而不进行转换。</font><font style="vertical-align: inherit;">如果您指定数字变量并键入代码，
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则将字符串格式</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            值</font><font style="vertical-align: inherit;">转换</font><font style="vertical-align: inherit;">为数字形式。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于</font></font><code class="literal">MYSQL_TYPE_BIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型代码，将
             </font></font><a class="link" href="data-types.html#bit-type" title="11.2.4比特值类型 -  BIT"><code class="literal">BIT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值返回到字符串缓冲区，这就是相应C类型的原因
             </font></font><code class="literal">char[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值表示需要在客户端进行解释的位字符串。</font><font style="vertical-align: inherit;">要将值作为更易于处理的类型返回，可以使用以下任一类型的表达式将值强制转换为整数：
          </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT bit_col + 0 FROM t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT CAST（bit_col AS UNSIGNED）FROM t</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要检索该值，请将足够大的整数变量绑定到该值，并指定相应的相应整数类型代码。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在将变量绑定到</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        用于获取列值</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">之前</font><font style="vertical-align: inherit;">，可以检查结果集的每列的类型代码。</font><font style="vertical-align: inherit;">如果要确定哪种变量类型最适合用于避免类型转换，则可能需要这样做。</font><font style="vertical-align: inherit;">要获取类型代码，请</font></font><a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在执行预准备语句后
         </font><font style="vertical-align: inherit;">调用
         </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">元数据提供对结果集的类型代码的访问，如</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.23节“mysql_stmt_result_metadata（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="xref" href="connectors-apis.html#c-api-data-structures" title="28.7.5 C API数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.5节“C API数据结构”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要确定从服务器返回的结果集中的输出字符串值是否包含二进制或非二进制数据，请检查</font></font><code class="literal">charsetnr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集元数据</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">是否</font><font style="vertical-align: inherit;">为63（请参见</font></font><a class="xref" href="connectors-apis.html#c-api-data-structures" title="28.7.5 C API数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.5节“C API数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">如果是，则字符集是</font></font><code class="literal">binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，表示二进制而不</font><font style="vertical-align: inherit;">是非</font><font style="vertical-align: inherit;">二进制数据。</font><font style="vertical-align: inherit;">这使您能够区分</font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从
         </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从
         </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从类型
         </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果您</font><font style="vertical-align: inherit;">设置列元数据结构</font><font style="vertical-align: inherit;">的</font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员
         </font></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（通过调用
         </font></font><a class="link" href="connectors-apis.html#mysql-stmt-attr-set" title="28.7.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），请注意</font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值指示结果值的最长字符串表示的长度，而不是二进制表示的长度。</font><font style="vertical-align: inherit;">也就是说，</font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不一定对应于使用用于预准备语句的二进制协议获取值所需的缓冲区的大小。</font><font style="vertical-align: inherit;">根据获取值的变量类型选择缓冲区的大小。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">TINYINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含值-128 </font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">列可能具有</font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值4.但是任何的二进制表示形式</font></font><code class="literal">TINYINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值只需要1个字节进行存储，因此您可以提供一个</font></font><code class="literal">signed char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储值</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">变量，并设置该值</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以指示值已签名。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        检测到由预准备语句引用的表或视图的元数据更改，并在下次执行时自动对语句进行表示。</font><font style="vertical-align: inherit;">有关更多信息，请参见
         </font></font><a class="xref" href="optimization.html#statement-caching" title="8.10.3准备好的声明和存储程序的缓存"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.10.3节“准备语句和存储程序的缓存”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-function-overview"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.10 C API准备语句功能概述</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547829056"></a><a class="indexterm" name="idm140091547827552"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下列表总结了可用于预处理语句处理的函数。</font><font style="vertical-align: inherit;">有关更多详细信息，请参见
       </font></font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-functions" title="28.7.11 C API准备语句功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11节“C API准备语句函数说明”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-affected-rows" title="28.7.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回更改，删除或插入的编写行数</font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-attr-get" title="28.7.11.2 mysql_stmt_attr_get（）"><code class="literal">mysql_stmt_attr_get()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：获取预准备语句的属性值。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-attr-set" title="28.7.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：设置预准备语句的属性。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将应用程序数据缓冲区与准备好的SQL语句中的参数标记相关联。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将应用程序数据缓冲区与结果集中的列关联。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：释放预准备语句使用的内存。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-data-seek" title="28.7.11.7 mysql_stmt_data_seek（）"><code class="literal">mysql_stmt_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：在语句结果集中寻找任意行号。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-errno" title="28.7.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回最后一个语句执行的错误号。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-error" title="28.7.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回最后一个语句执行的错误消息。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：执行准备好的声明。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从结果集中获取下一行数据，并返回所有绑定列的数据。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-fetch-column" title="28.7.11.12 mysql_stmt_fetch_column（）"><code class="literal">mysql_stmt_fetch_column()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：获取结果集的当前行的一列的数据。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-field-count" title="28.7.11.13 mysql_stmt_field_count（）"><code class="literal">mysql_stmt_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回最近语句的结果列数。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-free-result" title="28.7.11.14 mysql_stmt_free_result（）"><code class="literal">mysql_stmt_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：释放分配给语句处理程序的资源。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-init" title="28.7.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：为</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">分配内存</font><font style="vertical-align: inherit;">并初始化它。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-insert-id" title="28.7.11.16 mysql_stmt_insert_id（）"><code class="literal">mysql_stmt_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由预准备语句</font><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">生成的ID
           </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回/启动多结果执行中的下一个结果。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-num-rows" title="28.7.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从缓冲的语句结果集中返回行计数。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-param-count" title="28.7.11.19 mysql_stmt_param_count（）"><code class="literal">mysql_stmt_param_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回预准备语句中的参数数量。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-param-metadata" title="28.7.11.20 mysql_stmt_param_metadata（）"><code class="literal">mysql_stmt_param_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以结果集的形式返回参数元数据。</font><font style="vertical-align: inherit;">（这个功能实际上什么也没做。）
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：准备要执行的SQL语句字符串。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-reset" title="28.7.11.22 mysql_stmt_reset（）"><code class="literal">mysql_stmt_reset()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：重置服务器中的语句缓冲区。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以结果集的形式返回预准备语句元数据。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-row-seek" title="28.7.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：使用返回的值在语句结果集中寻找行偏移量
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-row-tell" title="28.7.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-row-tell" title="28.7.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回语句行光标位置。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-send-long-data" title="28.7.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将长数据以块的形式发送到服务器。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-sqlstate" title="28.7.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回上次语句执行的SQLSTATE错误代码。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：检索客户端的完整结果集。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-init" title="28.7.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建语句处理程序，然后
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备语句字符串，
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供参数数据，并
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行语句。</font><font style="vertical-align: inherit;">您可以</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过更改通过提供的相应缓冲区中的参数值
       </font><font style="vertical-align: inherit;">来重复此操作
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您可以使用块将文本或二进制数据以块的形式发送到服务器
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-send-long-data" title="28.7.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="connectors-apis.html#mysql-stmt-send-long-data" title="28.7.11.26 mysql_stmt_send_long_data（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.26节“mysql_stmt_send_long_data（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果该语句是一个</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或产生一个结果集的任何其它陈述，
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还返回在一个形式的结果集的元数据信息
       </font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过设定结果
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您可以使用提供结果缓冲区
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以便</font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      自动将数据返回到这些缓冲区。</font><font style="vertical-align: inherit;">这是逐行提取。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      语句执行完成后，关闭语句处理程序，</font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以便释放与其关联的所有资源。</font><font style="vertical-align: inherit;">此时处理程序变为无效，不应再使用。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通过调用</font><font style="vertical-align: inherit;">获取了</font><font style="vertical-align: inherit;">语句的结果集元数据
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则还应使用释放元数据
       </font></font><a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="c-api-prepared-statement-function-overview-execution-steps"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行步骤</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要准备和执行语句，应用程序遵循以下步骤：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用创建预准备语句处理程序
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-init" title="28.7.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要在服务器上准备语句，请调用
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并传递包含SQL语句的字符串。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果语句将生成结果集，则调用
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            以获取结果集元数据。</font><font style="vertical-align: inherit;">此元数据本身采用结果集的形式，尽管与包含查询返回的行的元数据分开。</font><font style="vertical-align: inherit;">元数据结果集指示结果中有多少列，并包含有关每列的信息。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用设置任何参数的值
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">必须设置所有参数。</font><font style="vertical-align: inherit;">否则，语句执行会返回错误或产生意外结果。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行语句。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果语句生成结果集，请绑定数据缓冲区以用于通过调用检索行值
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            通过</font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            重复</font><font style="vertical-align: inherit;">调用将数据逐行读取到缓冲区中，
             </font><font style="vertical-align: inherit;">直到找不到更多行。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            根据需要重复步骤3到6，方法是更改​​参数值并重新执行语句。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当</font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被调用时，MySQL客户端/服务器协议执行下述动作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            服务器解析该语句，并通过分配语句ID将okay状态发送回客户端。</font><font style="vertical-align: inherit;">如果它是面向结果集的语句，它还会发送参数总数，列数及其元数据。</font><font style="vertical-align: inherit;">在此调用期间，服务器将检查语句的所有语法和语义。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            客户端将此语句ID用于进一步的操作，以便服务器可以从其语句池中识别语句。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被调用时，MySQL客户端/服务器协议执行下述动作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            客户端使用语句处理程序并将参数数据发送到服务器。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            服务器使用客户端提供的ID标识语句，用新提供的数据替换参数标记，并执行语句。</font><font style="vertical-align: inherit;">如果语句生成结果集，则服务器将数据发送回客户端。</font><font style="vertical-align: inherit;">否则，它会发送一个okay状态并更改，删除或插入行数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当</font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被调用时，MySQL客户端/服务器协议执行下述动作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            客户端从结果集的当前行读取数据，并通过执行必要的转换将其放入应用程序数据缓冲区。</font><font style="vertical-align: inherit;">如果应用程序缓冲区类型与从服务器返回的字段类型相同，则转换很简单。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果出现错误，你可以使用得到的语句错误号，错误消息和SQLSTATE代码
         </font></font><a class="link" href="connectors-apis.html#mysql-stmt-errno" title="28.7.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="connectors-apis.html#mysql-stmt-error" title="28.7.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="connectors-apis.html#mysql-stmt-sqlstate" title="28.7.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分别。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-prepared-statement-function-overview-prepared-statement-logging"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备好的报表记录</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于使用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C API函数</font><font style="vertical-align: inherit;">执行的预准备语句，
         </font><font style="vertical-align: inherit;">服务器会写入</font></font><code class="literal">Prepare</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
         </font></font><code class="literal">Execute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">排列到常规查询日志，以便您可以判断何时准备和执行语句。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        假设您准备并执行如下语句：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备语句字符串</font></font><code class="literal">"SELECT ?"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            将值绑定到预</font></font><code class="literal">3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备语句中的参数。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行准备好的语句。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        作为前面调用的结果，服务器将以下行写入常规查询日志：
      </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备[1] SELECT？</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
执行[1] SELECT 3</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        每个</font></font><code class="literal">Prepare</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code class="literal">Execute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在日志中线路标记有
         </font><font style="vertical-align: inherit;">声明的标识符，这样就可以跟踪哪些准备好的语句被记录下来。</font><font style="vertical-align: inherit;">是一个正整数。</font><font style="vertical-align: inherit;">如果同时为客户端激活多个准备好的语句，则
         </font><font style="vertical-align: inherit;">可能大于1.每
         </font><font style="vertical-align: inherit;">行在替换</font><font style="vertical-align: inherit;">
        参数</font><font style="vertical-align: inherit;">的数据值后显示准备好的语句</font><font style="vertical-align: inherit;">。
</font></font><code class="literal">[<em class="replaceable"><code>N</code></em>]</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><code class="literal">Execute</code><font style="vertical-align: inherit;"></font><code class="literal">?</code><font style="vertical-align: inherit;"></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11 C API准备语句功能描述</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-affected-rows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.1 mysql_stmt_affected_rows（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-attr-get"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.2 mysql_stmt_attr_get（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-attr-set"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.3 mysql_stmt_attr_set（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-bind-param"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.4 mysql_stmt_bind_param（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-bind-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.5 mysql_stmt_bind_result（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-close"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.6 mysql_stmt_close（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-data-seek"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.7 mysql_stmt_data_seek（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-errno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.8 mysql_stmt_errno（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-error"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.9 mysql_stmt_error（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-execute"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.10 mysql_stmt_execute（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-fetch"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.11 mysql_stmt_fetch（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-fetch-column"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.12 mysql_stmt_fetch_column（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-field-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.13 mysql_stmt_field_count（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-free-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.14 mysql_stmt_free_result（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-init"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.15 mysql_stmt_init（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-insert-id"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.16 mysql_stmt_insert_id（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-next-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.17 mysql_stmt_next_result（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-num-rows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.18 mysql_stmt_num_rows（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-param-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.19 mysql_stmt_param_count（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-param-metadata"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.20 mysql_stmt_param_metadata（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-prepare"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.21 mysql_stmt_prepare（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-reset"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.22 mysql_stmt_reset（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-result-metadata"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.23 mysql_stmt_result_metadata（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-row-seek"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.24 mysql_stmt_row_seek（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-row-tell"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.25 mysql_stmt_row_tell（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-send-long-data"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.26 mysql_stmt_send_long_data（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-sqlstate"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.27 mysql_stmt_sqlstate（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-stmt-store-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.28 mysql_stmt_store_result（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要准备和执行查询，请使用以下各节中详细介绍的功能。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      所有使用</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      结构</font><font style="vertical-align: inherit;">操作的函数都以</font><font style="vertical-align: inherit;">前缀开头</font></font><code class="literal">mysql_stmt_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要创建</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理程序，请使用该
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-init" title="28.7.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-affected-rows"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.1 mysql_stmt_affected_rows（）</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091547669488"></a><p>
        <code class="literal">my_ulonglong mysql_stmt_affected_rows(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-affected-rows-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-stmt-affected-rows" title="28.7.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在执行语句后立即调用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">就像</font></font><a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备好的陈述一样。</font><font style="vertical-align: inherit;">有关此函数返回的受影响行值的说明，请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1 mysql_affected_rows（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.1节“mysql_affected_rows（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-affected-rows-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-affected-rows-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-attr-get"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.2 mysql_stmt_attr_get（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547655712"></a><p>
        <code class="literal">bool mysql_stmt_attr_get(MYSQL_STMT *stmt, enum
        enum_stmt_attr_type option, void *arg)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-get-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可用于获取语句属性的当前值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">论点是你想要的选择; </font><font style="vertical-align: inherit;">对</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应指向应包含选项值的变量。</font><font style="vertical-align: inherit;">如果该选项是整数，</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则应指向</font><font style="vertical-align: inherit;">整数</font><font style="vertical-align: inherit;">的值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关</font><font style="vertical-align: inherit;">选项和选项类型的列表，</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-attr-set" title="28.7.11.3 mysql_stmt_attr_set（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.3节“mysql_stmt_attr_set（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-get-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">非零如果</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未知。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-get-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-attr-set"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.3 mysql_stmt_attr_set（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547642560"></a><p>
        <code class="literal">bool mysql_stmt_attr_set(MYSQL_STMT *stmt, enum
        enum_stmt_attr_type option, const void *arg)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-set-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可用于影响预准备语句的行为。</font><font style="vertical-align: inherit;">可以多次调用此函数以设置多个选项。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是你想要设置的选项。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是选项的值。</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该指向一个设置为所需属性值的变量。</font><font style="vertical-align: inherit;">变量类型如下表所示。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下表显示了可能的
           </font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
</font></font></p>
<div class="informaltable">
<table summary="Lists mysql_stmt_attr_set() option values and the argument type and function of each option."><colgroup><col width="42%"><col width="20%"><col width="38%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数类型</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">STMT_ATTR_UPDATE_MAX_LENGTH</code></td>
              <td><code class="literal">bool *</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果设置为1，则导致
                 </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                更新元数据
                 </font></font><code class="literal">MYSQL_FIELD-&gt;max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">STMT_ATTR_CURSOR_TYPE</code></td>
              <td><code class="literal">unsigned long *</code></td>
              <td><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">时为语句打开的游标类型
                 </font><font style="vertical-align: inherit;">。</font></font><code class="literal">*arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是
                 </font></font><code class="literal">CURSOR_TYPE_NO_CURSOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（默认）或</font></font><code class="literal">CURSOR_TYPE_READ_ONLY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">STMT_ATTR_PREFETCH_ROWS</code></td>
              <td><code class="literal">unsigned long *</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用游标时从服务器获取的行数。
                </font></font><code class="literal">*arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在1到最大值的范围内</font></font><code class="literal">unsigned long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认值为1。</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果使用</font></font><code class="literal">STMT_ATTR_CURSOR_TYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with选项</font></font><code class="literal">CURSOR_TYPE_READ_ONLY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则在调用时会为语句打开游标
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果前一个</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">已经有一个打开的游标
           </font><font style="vertical-align: inherit;">，它会在打开一个新游标之前关闭游标。
          </font></font><a class="link" href="connectors-apis.html#mysql-stmt-reset" title="28.7.11.22 mysql_stmt_reset（）"><code class="literal">mysql_stmt_reset()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在准备重新执行语句之前，还会关闭所有打开的游标。
          </font></font><a class="link" href="connectors-apis.html#mysql-stmt-free-result" title="28.7.11.14 mysql_stmt_free_result（）"><code class="literal">mysql_stmt_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          关闭任何打开的光标。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果为准备好的语句打开游标，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则不需要，因为该函数会导致结果集在客户端缓冲。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-set-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">非零如果</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未知。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-set-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-set-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例打开预准备语句的游标，并将要一次提取的行数设置为5：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_STMT * stmt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int rc;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无符号长型;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned long prefetch_rows = 5;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
type =（unsigned long）CURSOR_TYPE_READ_ONLY;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rc = mysql_stmt_attr_set（stmt，STMT_ATTR_CURSOR_TYPE，（void *）＆type）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * ...检查返回值... * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rc = mysql_stmt_attr_set（stmt，STMT_ATTR_PREFETCH_ROWS，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                         （void *）＆prefetch_rows）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * ...检查返回值... * /</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-bind-param"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.4 mysql_stmt_bind_param（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547590048"></a><p>
        <code class="literal">bool mysql_stmt_bind_param(MYSQL_STMT *stmt, MYSQL_BIND
        *bind)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-param-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于绑定传递给的SQL语句中的参数标记的输入数据
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它使用
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构来提供数据。
          </font></font><code class="literal">bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">数组的地址
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">客户端库期望该数组包含</font></font><code class="literal">?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询中存在的</font><font style="vertical-align: inherit;">每个</font><font style="vertical-align: inherit;">参数标记的</font><font style="vertical-align: inherit;">一个元素
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          假设您准备以下声明：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插入mytbl VALUES（？，？，？）
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          绑定参数时，</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">数组
           </font><font style="vertical-align: inherit;">必须包含三个元素，并且可以像这样声明：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_BIND绑定[3];
</font></font></pre><p>
          <a class="xref" href="connectors-apis.html#c-api-prepared-statement-data-structures" title="28.7.9 C API准备语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.9节“C API准备语句数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述了每个</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          元素</font><font style="vertical-align: inherit;">的成员</font><font style="vertical-align: inherit;">以及如何设置它们以提供输入值。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-param-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-param-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unsupported_param_type"><code class="literal">CR_UNSUPPORTED_PARAM_TYPE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不支持转换。</font><font style="vertical-align: inherit;">可能该
               </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值无效或不是受支持的类型之一。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-param-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-bind-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.5 mysql_stmt_bind_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547559904"></a><p>
        <code class="literal">bool mysql_stmt_bind_result(MYSQL_STMT *stmt,
        MYSQL_BIND *bind)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于将结果集中的输出列关联（即绑定）到数据缓冲区和长度缓冲区。</font><font style="vertical-align: inherit;">当
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用获取数据时，MySQL客户端/服务器协议将绑定列的数据放入指定的缓冲区。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用之前，所有列都必须绑定到缓冲区
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><code class="literal">bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">数组的地址
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">客户端库期望数组包含结果集的每列的一个元素。</font><font style="vertical-align: inherit;">如果不将列绑定到
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构，则
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只需忽略数据提取。</font><font style="vertical-align: inherit;">缓冲区应足够大以容纳数据值，因为协议不会以块的形式返回数据值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          即使在部分检索结果集之后，也可以随时绑定或反弹列。</font><font style="vertical-align: inherit;">新绑定在下次</font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">时生效
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">假设应用程序绑定结果集中的列并调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">客户端/服务器协议返回绑定缓冲区中的数据。</font><font style="vertical-align: inherit;">然后假设应用程序将列绑定到另一组缓冲区。</font><font style="vertical-align: inherit;">当下一次调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生</font><font style="vertical-align: inherit;">时，协议将数据放入新绑定的缓冲区中
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了绑定列，应用程序调用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并传递应该存储值的输出缓冲区的类型，地址和长度。
          </font></font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-data-structures" title="28.7.9 C API准备语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.9节“C API准备语句数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述了每个</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          元素</font><font style="vertical-align: inherit;">的成员</font><font style="vertical-align: inherit;">以及如何将它们设置为接收输出值。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unsupported_param_type"><code class="literal">CR_UNSUPPORTED_PARAM_TYPE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不支持转换。</font><font style="vertical-align: inherit;">可能该
               </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值无效或不是受支持的类型之一。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-result-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.11节“mysql_stmt_fetch（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-close"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.6 mysql_stmt_close（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547524624"></a><p>
        <code class="literal">bool mysql_stmt_close(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-close-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          关闭准备好的声明。
          </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还释放指向的语句处理程序
           </font></font><code class="literal">stmt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该句点在此时变为无效并且不应再使用。</font><font style="vertical-align: inherit;">对于失败的
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通话，不叫</font></font><a class="link" href="connectors-apis.html#mysql-stmt-error" title="28.7.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者</font></font><a class="link" href="connectors-apis.html#mysql-stmt-errno" title="28.7.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-sqlstate" title="28.7.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获得错误信息，因为
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使语句处理程序无效。</font><font style="vertical-align: inherit;">打电话
           </font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来代替。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果当前语句具有挂起或未读结果，则此函数将取消它们，以便可以执行下一个查询。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-close-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-close-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-close-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-data-seek"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.7 mysql_stmt_data_seek（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547496224"></a><p>
        <code class="literal">void mysql_stmt_data_seek(MYSQL_STMT *stmt,
        my_ulonglong offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-data-seek-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          寻找语句结果集中的任意行。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是行号，应该在</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to
           </font><font style="vertical-align: inherit;">的范围内</font></font><a class="link" href="connectors-apis.html#mysql-stmt-num-rows" title="28.7.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows(stmt)-1</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数要求语句结果集结构包含上次执行的查询的整个结果，因此
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-data-seek" title="28.7.11.7 mysql_stmt_data_seek（）"><code class="literal">mysql_stmt_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只能与之一起使用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-data-seek-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-data-seek-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-errno"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.8 mysql_stmt_errno（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547481968"></a><p>
        <code class="literal">unsigned int mysql_stmt_errno(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-errno-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于指定的语句</font></font><code class="literal">stmt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-errno" title="28.7.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回可能成功或失败的最近调用的语句API函数的错误代码。</font><font style="vertical-align: inherit;">返回值为零表示未发生错误。</font><font style="vertical-align: inherit;">客户端错误消息编号列在MySQL </font></font><code class="filename">errmsg.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">头文件中。</font><font style="vertical-align: inherit;">服务器错误消息编号列在
           </font></font><code class="filename">mysqld_error.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><a class="xref" href="error-handling.html" title="附录B错误，错误代码和常见问题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录B，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误，错误代码和常见问题</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中也列出了
           </font><a class="xref" href="error-handling.html" title="Appendix&nbsp;B&nbsp;Errors, Error Codes, and Common Problems"><i><font style="vertical-align: inherit;">错误</font></i></a><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果失败的语句API函数是
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请不要调用或</font></font><a class="link" href="connectors-apis.html#mysql-stmt-errno" title="28.7.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取错误信息，因为
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使语句处理程序无效。</font><font style="vertical-align: inherit;">打电话
           </font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-errno-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          错误代码值。</font><font style="vertical-align: inherit;">如果没有错误则归零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-errno-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-error"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.9 mysql_stmt_error（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547463552"></a><p>
        <code class="literal">const char *mysql_stmt_error(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-error-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于指定的语句</font></font><code class="literal">stmt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-error" title="28.7.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回以null结尾的字符串，该字符串包含可能成功或失败的最近调用的语句API函数的错误消息。</font></font><code class="literal">""</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有发生错误，则返回</font><font style="vertical-align: inherit;">空字符串（</font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">这两个测试中的任何一个都可用于检查错误：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果（* mysql_stmt_errno（语句））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  //发生错误</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_error（stmt）[0]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  //发生错误</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果失败的语句API函数是
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请不要调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-error" title="28.7.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以获取错误信息，因为
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使语句处理程序无效。</font><font style="vertical-align: inherit;">打电话
           </font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以通过重新编译MySQL客户端库来更改客户端错误消息的语言。</font><font style="vertical-align: inherit;">您可以选择多种不同语言的错误消息。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-error-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          描述错误的字符串。</font><font style="vertical-align: inherit;">如果没有错误，则为空字符串。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-error-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-execute"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.10 mysql_stmt_execute（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547444992"></a><p>
        <code class="literal">int mysql_stmt_execute(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-execute-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行与语句处理程序关联的准备好的查询。</font><font style="vertical-align: inherit;">在此调用期间，当前绑定的参数标记值将发送到服务器，服务器将使用此新提供的数据替换标记。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下语句处理
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于语句的类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于一个</font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，改变，删除，或插入的行数可以通过调用发现
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-affected-rows" title="28.7.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于诸如</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成结果集</font><font style="vertical-align: inherit;">的语句
               </font><font style="vertical-align: inherit;">，必须</font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在调用导致查询处理的任何其他函数之前</font><font style="vertical-align: inherit;">调用
               </font><font style="vertical-align: inherit;">以获取数据。</font><font style="vertical-align: inherit;">有关如何获取结果的更多信息，请参见
               </font></font><a class="xref" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.11节“mysql_stmt_fetch（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不要</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过调用
               </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font><font style="vertical-align: inherit;">跟随调用
               </font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些函数不用于处理预准备语句的结果。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于生成结果集的语句，您可以</font><font style="vertical-align: inherit;">在执行语句之前</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过调用</font><font style="vertical-align: inherit;">请求</font><font style="vertical-align: inherit;">打开语句的游标
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-attr-set" title="28.7.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果多次执行语句，请</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在打开新游标之前关闭所有打开的游标。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检测到由预准备语句引用的表或视图的元数据更改，并在下次执行时自动对语句进行表示。</font><font style="vertical-align: inherit;">有关更多信息，请参见</font></font><a class="xref" href="optimization.html#statement-caching" title="8.10.3准备好的声明和存储程序的缓存"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.10.3节“准备语句和存储程序的缓存”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-execute-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-execute-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-execute-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下面的示例演示如何创建和使用填充表
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-init" title="28.7.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-param-count" title="28.7.11.19 mysql_stmt_param_count（）"><code class="literal">mysql_stmt_param_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-affected-rows" title="28.7.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假定</font><font style="vertical-align: inherit;">该</font><font style="vertical-align: inherit;">变量是有效的连接处理程序。</font><font style="vertical-align: inherit;">有关如何检索数据的示例，请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.11节“mysql_stmt_fetch（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define STRING_SIZE 50</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#define DROP_SAMPLE_TABLE“DROP TABLE IF EXISTS test_table”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#define CREATE_SAMPLE_TABLE“CREATE TABLE test_table（col1 INT，\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                                 col2 VARCHAR（40），\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                                 col3 SMALLINT，\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                                 col4 TIMESTAMP）“</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#define INSERT_SAMPLE“INSERT INTO \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                       test_table（col1，col2，col3）\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                       VALUES（？，？，？）”</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_STMT * stmt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_BIND绑定[3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
my_ulonglong affected_rows;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int param_count;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
short small_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int int_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
char str_data [STRING_SIZE];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned long str_length;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bool is_null;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_query（mysql，DROP_SAMPLE_TABLE））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“DROP TABLE failed \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_query（mysql，CREATE_SAMPLE_TABLE））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“CREATE TABLE failed \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *使用3个参数准备INSERT查询* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *（TIMESTAMP列未命名;服务器* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *将其设置为当前日期和时间）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（！stmt）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_init（），内存不足\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_prepare（stmt，INSERT_SAMPLE，strlen（INSERT_SAMPLE）））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_prepare（），INSERT failed \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“准备，INSERT成功\ n”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *从语句中获取参数计数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
param_count = mysql_stmt_param_count（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“INSERT中的总参数：％d \ n”，param_count）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（param_count！= 3）/ *验证参数计数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL返回的无效参数计数\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定所有3个参数的数据* /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
memset（bind，0，sizeof（bind））;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * INTEGER PARAM * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *这是一种数字类型，所以没有必要</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   指定buffer_length * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer =（char *）＆int_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .is_null = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .length = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * STRING PARAM * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer_type = MYSQL_TYPE_STRING;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer =（char *）str_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer_length = STRING_SIZE;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .is_null = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .length =＆str_length;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * SMALLINT PARAM * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .buffer_type = MYSQL_TYPE_SHORT;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .buffer =（char *）＆small_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .is_null =＆is_null;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .length = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_bind_param（stmt，bind））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_bind_param（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *指定第一行的数据值* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data = 10; </font><font style="vertical-align: inherit;">/* 整数 */</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
strncpy（str_data，“MySQL”，STRING_SIZE）; </font><font style="vertical-align: inherit;">/ * string * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
str_length = strlen（str_data）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * INSERT SMALLINT数据为NULL * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
is_null = 1;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *执行INSERT语句 -  1 * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_execute（stmt））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_execute（），1失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *获取受影响的行数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
affected_rows = mysql_stmt_affected_rows（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“受影响的总行数（插入1）：％lu \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                （unsigned long）affected_rows）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（affected_rows！= 1）/ *验证受影响的行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL无效的受影响的行\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *指定第二行的数据值，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   然后重新执行声明* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data = 1000;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
strncpy（str_data，“</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        最受欢迎的开源数据库“，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        STRING_SIZE）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
str_length = strlen（str_data）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
small_data = 1000; </font><font style="vertical-align: inherit;">/ * smallint * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
is_null = 0; </font><font style="vertical-align: inherit;">/* 重启 */</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *执行INSERT语句 -  2 * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_execute（stmt））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_execute，2次失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *获取受影响的总行数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
affected_rows = mysql_stmt_affected_rows（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“受影响的总行数（插入2）：％lu \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                （unsigned long）affected_rows）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（affected_rows！= 1）/ *验证受影响的行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL无效的受影响的行\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *关闭声明* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_close（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * mysql_stmt_close（）使stmt无效，所以调用* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * mysql_error（mysql）而不是mysql_stmt_error（stmt）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“在关闭语句时失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关使用预准备语句函数的完整示例，请参阅该文件
             </font></font><code class="filename">tests/mysql_client_test.c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此文件可以从MySQL源代码发行版或源代码存储库中获取（请参见
             </font></font><a class="xref" href="installing.html#source-installation" title="2.9从源安装MySQL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.9节“从源代码安装MySQL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-fetch"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.11 mysql_stmt_fetch（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547375312"></a><p>
        <code class="literal">int mysql_stmt_fetch(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回结果集中的下一行。</font><font style="vertical-align: inherit;">只有在结果集存在时才能调用它; </font><font style="vertical-align: inherit;">也就是说，在调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">诸如</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成结果集</font><font style="vertical-align: inherit;">的语句</font><font style="vertical-align: inherit;">之后
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用绑定的缓冲区返回行数据
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它返回当前行集中所有列的那些缓冲区中的数据，并将长度返回给
           </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针。</font><font style="vertical-align: inherit;">在调用之前，所有列都必须由应用程序绑定
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常发生在循环中，以确保获取所有结果集行。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INT状态;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
而（1）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  status = mysql_stmt_fetch（stmt）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（status == 1 || status == MYSQL_NO_DATA）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    打破;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *在这里处理当前行* /</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *如果需要，处理状态== 1个案例并在此处显示错误* /</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          默认情况下，从服务器一次一行地取无结果集。</font><font style="vertical-align: inherit;">要缓冲客户端上的整个结果集，请
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在绑定数据缓冲区之后和调用之前调用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果获取的数据值是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，</font></font><code class="literal">*is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则相应</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值
           </font><font style="vertical-align: inherit;">包含TRUE（1）。</font><font style="vertical-align: inherit;">否则，将</font><font style="vertical-align: inherit;">
          根据应用程序指定的缓冲区类型</font><font style="vertical-align: inherit;">在</font></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元素</font><font style="vertical-align: inherit;">中返回数据及其长度
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每种数字和时间类型都有固定长度，如下表所示。</font><font style="vertical-align: inherit;">字符串类型的长度取决于实际数据值的长度，如下所示</font></font><code class="literal">data_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="informaltable">
<table summary="Numeric and temporal MySQL types and the fixed length of each type."><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">长度</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TINY</code></td>
              <td>1</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_SHORT</code></td>
              <td>2</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_LONG</code></td>
              <td>4</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_LONGLONG</code></td>
              <td>8</td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_FLOAT</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DOUBLE</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TIME</code></td>
              <td><code class="literal">sizeof(MYSQL_TIME)</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DATE</code></td>
              <td><code class="literal">sizeof(MYSQL_TIME)</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DATETIME</code></td>
              <td><code class="literal">sizeof(MYSQL_TIME)</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_STRING</code></td>
              <td><code class="literal">data length</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_BLOB</code></td>
              <td><code class="literal">data_length</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在某些情况下，您可能希望在使用之前确定列值的长度
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，值可能是一个长字符串或
           </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，您想知道必须分配多少空间。</font><font style="vertical-align: inherit;">要实现此目的，请使用以下策略之一：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以检索单个行</font><font style="vertical-align: inherit;">之前
               </font><font style="vertical-align: inherit;">，传递
               </font></font><code class="literal">STMT_ATTR_UPDATE_MAX_LENGTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-attr-set" title="28.7.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后调用
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              以缓冲客户端上的整个结果。</font><font style="vertical-align: inherit;">设置</font></font><code class="literal">STMT_ATTR_UPDATE_MAX_LENGTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              属性会导致列值的最大长度由</font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回的结果集元数据</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">成员
               </font><font style="vertical-align: inherit;">指示</font></font><a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              调用所讨论</font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              的列的零长度缓冲区和可以存储实际长度的指针。</font><font style="vertical-align: inherit;">然后使用实际长度
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch-column" title="28.7.11.12 mysql_stmt_fetch_column（）"><code class="literal">mysql_stmt_fetch_column()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_length = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer_length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .length =＆real_length</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_stmt_bind_result（stmt，bind）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
了mysql_stmt_fetch（语句）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（real_length&gt; 0）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  data = malloc（real_length）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .buffer = data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .buffer_length = real_length;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_stmt_fetch_column（stmt，bind，0,0）;</font></font><font></font>
}<font></font>
</pre></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<div class="informaltable">
<table summary="Return values for mysql_stmt_fetch() and a description of each value."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回报价值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row">0</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功后，数据已被提取到应用程序数据缓冲区。</font></font></td>
            </tr><tr>
              <td scope="row">1</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生了错误。</font><font style="vertical-align: inherit;">可以通过调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-errno" title="28.7.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                 </font><font style="vertical-align: inherit;">获取错误代码和消息
                 </font></font><a class="link" href="connectors-apis.html#mysql-stmt-error" title="28.7.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_NO_DATA</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功，不再存在数据</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_DATA_TRUNCATED</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生数据截断</font></font></td>
</tr></tbody></table>
</div>
<p>
          <code class="literal">MYSQL_DATA_TRUNCATED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用截断报告时返回。</font><font style="vertical-align: inherit;">要确定在返回此值时截断哪些列值，请检查</font><font style="vertical-align: inherit;">用于获取值</font></font><code class="literal">error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的
           </font><font style="vertical-align: inherit;">成员
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认情况下启用截断报告，但可以通过</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该
           </font></font><code class="literal">MYSQL_REPORT_DATA_TRUNCATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">进行调用来控制截断报告
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              虽然
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以产生此错误，但</font><font style="vertical-align: inherit;">如果</font><font style="vertical-align: inherit;">没有调用足够的时间来读取整个结果集（即返回的时间足够
               </font><font style="vertical-align: inherit;">多），则更有可能发生
               </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C API调用
               </font><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_NO_DATA</code><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unsupported_param_type"><code class="literal">CR_UNSUPPORTED_PARAM_TYPE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              缓冲型是</font></font><code class="literal">MYSQL_TYPE_DATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">MYSQL_TYPE_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">MYSQL_TYPE_DATETIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
               </font></font><code class="literal">MYSQL_TYPE_TIMESTAMP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是数据类型不是</font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
               </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              从中返回所有其他不受支持的转换错误
               </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下面的例子演示了如何使用获取从表中的数据
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（此示例期望检索由</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所示的示例插入的两行</font><font style="vertical-align: inherit;">。）</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假定</font><font style="vertical-align: inherit;">该
           </font><font style="vertical-align: inherit;">变量是有效的连接处理程序。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define STRING_SIZE 50</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#define SELECT_SAMPLE“SELECT col1，col2，col3，col4 \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                       来自test_table“</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_STMT * stmt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_BIND绑定[4];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_RES * prepare_meta_result;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_TIME ts;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无符号长度[4];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int param_count，column_count，row_count;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
short small_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int int_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
char str_data [STRING_SIZE];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bool is_null [4];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bool错误[4];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *准备SELECT查询以从test_table获取数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（！stmt）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_init（），内存不足\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_prepare（stmt，SELECT_SAMPLE，strlen（SELECT_SAMPLE）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_prepare（），SELECT failed \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“准备，选择成功\ n”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *从语句中获取参数计数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
param_count = mysql_stmt_param_count（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“SELECT中的总参数：％d \ n”，param_count）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（param_count！= 0）/ *验证参数计数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL返回的无效参数计数\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *获取结果集元信息* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
prepare_meta_result = mysql_stmt_result_metadata（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（！prepare_meta_result）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf中（错误，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
         “mysql_stmt_result_metadata（），\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           没有返回元信息\ n“）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *获取查询中的总列数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
column_count = mysql_num_fields（prepare_meta_result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf中（标准输出，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “SELECT语句中的总列数：％d \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        COLUMN_COUNT）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（column_count！= 4）/ *验证列数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL返回的列数无效\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *执行SELECT查询* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_execute（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_execute（），失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *在获取所有4列之前绑定结果缓冲区* /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
memset（bind，0，sizeof（bind））;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * INTEGER COLUMN * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer =（char *）＆int_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .is_null =＆is_null [0];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .length =＆length [0];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .error =＆error [0];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * STRING COLUMN * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer_type = MYSQL_TYPE_STRING;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer =（char *）str_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer_length = STRING_SIZE;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .is_null =＆is_null [1];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .length =＆length [1];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .error =＆error [1];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * SMALLINT COLUMN * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .buffer_type = MYSQL_TYPE_SHORT;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .buffer =（char *）＆small_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .is_null =＆is_null [2];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .length =＆length [2];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .error =＆error [2];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * TIMESTAMP COLUMN * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [3] .buffer_type = MYSQL_TYPE_TIMESTAMP;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [3] .buffer =（char *）＆ts;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [3] .is_null =＆is_null [3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [3] .length =＆length [3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [3] .error =＆error [3];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定结果缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_bind_result（stmt，bind））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_bind_result（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *现在将所有结果缓冲到客户端（可选步骤）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_store_result（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_store_result（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *获取所有行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
row_count = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“获取结果...... \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
while（！mysql_stmt_fetch（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ROW_COUNT ++;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“row％d \ n”，row_count）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *第1列* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“column1（integer）：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（is_null [0]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“NULL \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“％d（％ld）\ n”，int_data，length [0]）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *第2栏* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“column2（string）：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（is_null [1]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“NULL \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“％s（％ld）\ n”，str_data，length [1]）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *第3列* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“column3（smallint）：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（is_null [2]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“NULL \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“％d（％ld）\ n”，small_data，length [2]）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *第4栏* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“column4（timestamp）：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（is_null [3]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“NULL \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“％04d-％02d-％02d％02d：％02d：％02d（％ld）\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     ts.year，ts.month，ts.day，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     ts.hour，ts.minute，ts.second，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     长度[3]）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“\ n”）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *验证提取的行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“获取的总行数：％d \ n”，row_count）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（row_count！= 2）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL无法返回所有行\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *释放准备好的结果元数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
了mysql_free_result（prepare_meta_result）;</font></font><font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *关闭声明* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_close（stmt））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * mysql_stmt_close（）使stmt无效，所以调用* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * mysql_error（mysql）而不是mysql_stmt_error（stmt）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“在关闭语句时失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-fetch-column"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.12 mysql_stmt_fetch_column（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547220448"></a><p>
        <code class="literal">int mysql_stmt_fetch_column(MYSQL_STMT *stmt,
        MYSQL_BIND *bind, unsigned int column, unsigned long
        offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-column-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从当前结果集行中获取一列。
          </font></font><code class="literal">bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供应放置数据的缓冲区。</font><font style="vertical-align: inherit;">它的设置方式应与之相同
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><code class="literal">column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示要获取的列。</font><font style="vertical-align: inherit;">第一列编号为0. </font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是数据值中开始检索数据的偏移量。</font><font style="vertical-align: inherit;">这可以用于获取片段中的数据值。</font><font style="vertical-align: inherit;">值的开头是偏移量0。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-column-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-column-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_invalid_parameter_no"><code class="literal">CR_INVALID_PARAMETER_NO</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              列号无效。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_no_data"><code class="literal">CR_NO_DATA</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              已达到结果集的结尾。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-field-count"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.13 mysql_stmt_field_count（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547202896"></a><p>
        <code class="literal">unsigned int mysql_stmt_field_count(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-field-count-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回语句处理程序的最新语句的列数。</font><font style="vertical-align: inherit;">对于诸如</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不生成结果集的</font><font style="vertical-align: inherit;">语句，此值为零</font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-field-count" title="28.7.11.13 mysql_stmt_field_count（）"><code class="literal">mysql_stmt_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在通过调用准备语句后调用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-field-count-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          无符号整数，表示结果集中的列数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-field-count-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-free-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.14 mysql_stmt_free_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547188720"></a><p>
        <code class="literal">bool mysql_stmt_free_result(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-free-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          释放与执行预准备语句生成的结果集关联的内存。</font><font style="vertical-align: inherit;">如果为该语句打开游标，请将其
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-free-result" title="28.7.11.14 mysql_stmt_free_result（）"><code class="literal">mysql_stmt_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          关闭。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-free-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-init"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.15 mysql_stmt_init（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547180544"></a><p>
        <code class="literal">MYSQL_STMT *mysql_stmt_init(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-init-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          创建并返回一个</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理程序。</font><font style="vertical-align: inherit;">应该释放处理程序
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，此时处理程序变为无效并且不应再使用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关</font><font style="vertical-align: inherit;">更多信息</font></font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-data-structures" title="28.7.9 C API准备语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另请参见
           </font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-data-structures" title="28.7.9 C API准备语句数据结构"><font style="vertical-align: inherit;">第28.7.9节“C API准备语句数据结构”</font></a><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-init-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功时</font><font style="vertical-align: inherit;">
          指向</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针</font><font style="vertical-align: inherit;">。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果内存不足。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-init-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-insert-id"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.16 mysql_stmt_insert_id（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547164976"></a><p>
        <code class="literal">my_ulonglong mysql_stmt_insert_id(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-insert-id-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由prepared </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">列
           </font><font style="vertical-align: inherit;">生成的值
           </font><font style="vertical-align: inherit;">。</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在包含</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font><font style="vertical-align: inherit;">的表上</font><font style="vertical-align: inherit;">执行预准备</font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">后，请使用此函数
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关</font><font style="vertical-align: inherit;">更多信息</font></font><a class="xref" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font><a class="xref" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><font style="vertical-align: inherit;">第28.7.7.38节“mysql_insert_id（）”</font></a><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-insert-id-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对值</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">柱上，自动生成的或明确地准备语句，或通过生成的值的执行过程中设置
           </font><font style="vertical-align: inherit;">
          的功能。</font><font style="vertical-align: inherit;">如果语句未设置</font><font style="vertical-align: inherit;">值，</font><font style="vertical-align: inherit;">则返回值未定义
           </font><font style="vertical-align: inherit;">。
</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a><font style="vertical-align: inherit;"></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-insert-id-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-next-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.17 mysql_stmt_next_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547145824"></a><p>
        <code class="literal">int mysql_stmt_next_result(MYSQL_STMT *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-next-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当您使用预准备</font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句执行存储过程时，可以</font><font style="vertical-align: inherit;">使用此函数
           </font><font style="vertical-align: inherit;">，该存储过程可以返回多个结果集。</font><font style="vertical-align: inherit;">使用调用的循环
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来确定是否有更多结果。</font><font style="vertical-align: inherit;">如果过程具有
           </font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，则它们的值将作为单行结果集返回到任何其他结果集之后。</font><font style="vertical-align: inherit;">值将按过程参数列表中声明的顺序显示。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关未处理条件对过程参数的影响的信息，请参见
           </font></font><a class="xref" href="sql-syntax.html#conditions-and-parameters" title="13.6.7.8条件处理和OUT或INOUT参数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.6.7.8节“条件处理和OUT或INOUT参数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回状态以指示是否存在更多结果。</font><font style="vertical-align: inherit;">如果
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回错误，则不再有结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在每次调用之前
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="link" href="connectors-apis.html#mysql-stmt-free-result" title="28.7.11.14 mysql_stmt_free_result（）"><code class="literal">mysql_stmt_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果它产生结果集（而不仅仅是结果状态）</font><font style="vertical-align: inherit;">，则必须调用
           </font><font style="vertical-align: inherit;">当前结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接状态</font><font style="vertical-align: inherit;">后就
           </font><font style="vertical-align: inherit;">好像你已经调用了一样
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这意味着你可以打电话
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-affected-rows" title="28.7.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等等。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          也可以通过调用来测试是否有更多结果</font></font><a class="link" href="connectors-apis.html#mysql-more-results" title="28.7.7.46 mysql_more_results（）"><code class="literal">mysql_more_results()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，此函数不会更改连接状态，因此如果它返回true，您仍必须调用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前进到下一个结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关如何使用的示例
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-prepared-call-statements" title="28.7.25 C API准备CALL语句支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.25节“C API准备的CALL语句支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-next-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<div class="informaltable">
<table summary="Return values for mysql_stmt_next_result() and a description of each value."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回报价值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row">0</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功并且有更多结果</font></font></td>
            </tr><tr>
              <td scope="row">-1</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功，没有更多的结果</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; 0</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生错误</font></font></td>
</tr></tbody></table>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-next-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-num-rows"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.18 mysql_stmt_num_rows（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547092448"></a><p>
        <code class="literal">my_ulonglong mysql_stmt_num_rows(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-num-rows-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回结果集中的行数。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-num-rows" title="28.7.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于您是否
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">曾在语句处理程序中缓冲整个结果集。</font><font style="vertical-align: inherit;">如果使用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-num-rows" title="28.7.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会立即调用。</font><font style="vertical-align: inherit;">否则，行计数不可用，除非您在获取行时计算行数。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-num-rows" title="28.7.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适用于返回结果集的语句，例如</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于诸如</font><font style="vertical-align: inherit;">，或的
           </font><font style="vertical-align: inherit;">语句</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">可以获得受影响的行数
           </font><font style="vertical-align: inherit;">。
</font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-stmt-affected-rows" title="28.7.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-num-rows-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果集中的行数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-num-rows-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-param-count"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.19 mysql_stmt_param_count（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547070144"></a><p>
        <code class="literal">unsigned long mysql_stmt_param_count(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-param-count-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回预准备语句中存在的参数标记的数量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-param-count-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          无符号长整数，表示语句中的参数数量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-param-count-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-param-count-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-param-metadata"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.20 mysql_stmt_param_metadata（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547059136"></a><p>
        <code class="literal">MYSQL_RES *mysql_stmt_param_metadata(MYSQL_STMT
        *stmt)</code>
      </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        此功能目前无效。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-prepare"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.21 mysql_stmt_prepare（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547055248"></a><p>
        <code class="literal">int mysql_stmt_prepare(MYSQL_STMT *stmt, const char
        *stmt_str, unsigned long length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-prepare-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定返回的语句处理程序
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-init" title="28.7.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，准备字符串指向的SQL语句
           </font></font><code class="literal">stmt_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并返回状态值。</font><font style="vertical-align: inherit;">字符串长度应由</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数</font><font style="vertical-align: inherit;">给出</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该字符串必须由单个SQL语句组成。</font><font style="vertical-align: inherit;">您不应该</font><font style="vertical-align: inherit;">在语句中</font><font style="vertical-align: inherit;">添加终止分号（</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或</font></font><code class="literal">\g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过将问号（</font></font><code class="literal">?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）字符</font><font style="vertical-align: inherit;">嵌入</font><font style="vertical-align: inherit;">到适当位置的SQL字符串中，</font><font style="vertical-align: inherit;">应用程序可以在SQL语句中包含一个或多个参数标记</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          标记仅在SQL语句中的某些位置是合法的。</font><font style="vertical-align: inherit;">例如，允许在
           </font><font style="vertical-align: inherit;">语句</font></font><code class="literal">VALUES()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表中
           </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（指定行的列值），或与</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">的列进行</font><font style="vertical-align: inherit;">比较以指定比较值。</font><font style="vertical-align: inherit;">但是，它们不允许用于标识符（例如表名或列名），也不允许指定二元运算符的两个操作数，例如</font></font><code class="literal">=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等号。</font><font style="vertical-align: inherit;">后一种限制是必要的，因为无法确定参数类型。</font><font style="vertical-align: inherit;">通常，参数仅在数据操作语言（DML）语句中是合法的，而在数据定义语言（DDL）语句中不合法。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在执行语句之前，</font><font style="vertical-align: inherit;">
          必须使用参数标记绑定到应用程序变量</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检测到由预准备语句引用的表或视图的元数据更改，并在下次执行时自动对语句进行表示。</font><font style="vertical-align: inherit;">有关更多信息，请参见</font></font><a class="xref" href="optimization.html#statement-caching" title="8.10.3准备好的声明和存储程序的缓存"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.10.3节“准备语句和存储程序的缓存”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-prepare-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-prepare-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果准备操作不成功（即
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非零），则可以通过调用获取错误消息
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-error" title="28.7.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-prepare-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-reset"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.22 mysql_stmt_reset（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091547015888"></a><p>
        <code class="literal">bool mysql_stmt_reset(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-reset-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在准备好后，将客户端和服务器上的预准备语句重置为状态。</font><font style="vertical-align: inherit;">它重置服务器上的语句，使用的数据
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-send-long-data" title="28.7.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，未缓冲的结果集和当前错误。</font><font style="vertical-align: inherit;">它不会清除绑定或存储的结果集。</font><font style="vertical-align: inherit;">执行准备好的语句（或关闭它）时，将清除存储的结果集。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要使用其他查询重新准备语句，请使用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-reset-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-reset-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-result-metadata"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.23 mysql_stmt_result_metadata（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546994352"></a><p>
        <code class="literal">MYSQL_RES *mysql_stmt_result_metadata(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-result-metadata-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果传递给的语句</font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是生成结果集</font><font style="vertical-align: inherit;">的语句
           </font><font style="vertical-align: inherit;">，则以
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向</font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针的形式返回结果集元数据，该
           </font><font style="vertical-align: inherit;">结构可用于处理元信息，例如字段数和单个字段信息。</font><font style="vertical-align: inherit;">此结果集指针可作为参数传递给任何处理结果集元数据的基于字段的API函数，例如：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-num-fields" title="28.7.7.48 mysql_num_fields（）"><code class="literal">mysql_num_fields()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-fetch-field-direct" title="28.7.7.18 mysql_fetch_field_direct（）"><code class="literal">mysql_fetch_field_direct()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-fetch-fields" title="28.7.7.19 mysql_fetch_fields（）"><code class="literal">mysql_fetch_fields()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-field-seek" title="28.7.7.23 mysql_field_seek（）"><code class="literal">mysql_field_seek()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-field-tell" title="28.7.7.24 mysql_field_tell（）"><code class="literal">mysql_field_tell()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a>
</p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          完成后应该释放结果集结构，您可以通过将其传递给它来完成
           </font></font><a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这类似于释放从调用中获得的结果集的方式</font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回的结果集
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          仅包含元数据。</font><font style="vertical-align: inherit;">它不包含任何行结果。</font><font style="vertical-align: inherit;">通过使用语句处理程序获取行
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-result-metadata-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个</font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果结构。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果准备好的查询不存在元信息。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-result-metadata-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-result-metadata-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.11节“mysql_stmt_fetch（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-row-seek"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.24 mysql_stmt_row_seek（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546951216"></a><p>
        <code class="literal">MYSQL_ROW_OFFSET mysql_stmt_row_seek(MYSQL_STMT *stmt,
        MYSQL_ROW_OFFSET offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-seek-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将行光标设置为语句结果集中的任意行。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是行偏移量，应该是从</font></font><a class="link" href="connectors-apis.html#mysql-stmt-row-tell" title="28.7.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或从中
           </font><font style="vertical-align: inherit;">返回的值
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-row-seek" title="28.7.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值不是行号; </font><font style="vertical-align: inherit;">如果您想在数字的结果集中寻找一行，请
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-data-seek" title="28.7.11.7 mysql_stmt_data_seek（）"><code class="literal">mysql_stmt_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          改用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数要求结果集结构包含查询的整个结果，因此
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-row-seek" title="28.7.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只能与结合使用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-seek-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行光标的前一个值。</font><font style="vertical-align: inherit;">该值可以传递给后续的调用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-row-seek" title="28.7.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-seek-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-row-tell"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.25 mysql_stmt_row_tell（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546933632"></a><p>
        <code class="literal">MYSQL_ROW_OFFSET mysql_stmt_row_tell(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-tell-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回最后一行的行光标的当前位置
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值可以用作参数
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-row-seek" title="28.7.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          你应该</font></font><a class="link" href="connectors-apis.html#mysql-stmt-row-tell" title="28.7.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只在之后
           </font><font style="vertical-align: inherit;">使用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-tell-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行光标的当前偏移量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-tell-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-send-long-data"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.26 mysql_stmt_send_long_data（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546919472"></a><p>
        <code class="literal">bool mysql_stmt_send_long_data(MYSQL_STMT *stmt,
        unsigned int parameter_number, const char *data, unsigned long
        length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-send-long-data-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          允许应用程序将参数数据分段（或</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">发送到服务器</font><font style="vertical-align: inherit;">。</font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">之前和之后</font><font style="vertical-align: inherit;">调用此函数
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">可以多次调用它来发送字符的部分或列的二进制数据值，该列必须是其中一种</font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据类型。
        </font></font></p><p>
          <code class="literal">parameter_number</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示将数据与哪个参数相关联。</font><font style="vertical-align: inherit;">参数从0开始编号。</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指向包含要发送的数据的缓冲区的指针，并</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指示缓冲区中的字节数。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            下一个
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用将忽略</font></font><a class="link" href="connectors-apis.html#mysql-stmt-send-long-data" title="28.7.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            自上次
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或之后
             </font><font style="vertical-align: inherit;">使用的所有参数的绑定缓冲区
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-reset" title="28.7.11.22 mysql_stmt_reset（）"><code class="literal">mysql_stmt_reset()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果要重置/忘记发送的数据，可以使用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-reset" title="28.7.11.22 mysql_stmt_reset（）"><code class="literal">mysql_stmt_reset()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-stmt-reset" title="28.7.11.22 mysql_stmt_reset（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.22节“mysql_stmt_reset（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所述</font></font><a class="link" href="server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量控制可以与发送参数值的最大大小
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-send-long-data" title="28.7.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-send-long-data-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-send-long-data-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_invalid_buffer_use"><code class="literal">CR_INVALID_BUFFER_USE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该参数没有字符串或二进制类型。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_invalid_parameter_no"><code class="literal">CR_INVALID_PARAMETER_NO</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              参数号无效。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-send-long-data-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例演示如何以</font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块的形式</font><font style="vertical-align: inherit;">发送</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的数据
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它将数据值</font></font><code class="literal">'MySQL - The most popular Open
          Source database'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插入
           </font></font><code class="literal">text_column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中。</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假定</font><font style="vertical-align: inherit;">该
           </font><font style="vertical-align: inherit;">变量是有效的连接处理程序。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define INSERT_QUERY“INSERT INTO \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      test_long_data（text_column）VALUES（？）“</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_BIND绑定[1];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
长度长;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（！stmt）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_init（），内存不足\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_prepare（stmt，INSERT_QUERY，strlen（INSERT_QUERY）））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n mysql_stmt_prepare（），INSERT失败”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 memset（bind，0，sizeof（bind））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 bind [0] .buffer_type = MYSQL_TYPE_STRING;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 bind [0] .length =＆length;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 bind [0] .is_null = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_bind_param（stmt，bind））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n param bind failed”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 / *以块的形式向服务器提供数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 if（mysql_stmt_send_long_data（stmt，0，“MySQL”，5））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n send_long_data失败”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 / *提供下一条数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 if（mysql_stmt_send_long_data（stmt，0，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           “ - 最受欢迎的开源数据库”，40））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n send_long_data失败”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 / *现在，执行查询* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 if（mysql_stmt_execute（stmt））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n mysql_stmt_execute失败”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-sqlstate"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.27 mysql_stmt_sqlstate（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546866320"></a><p>
        <code class="literal">const char *mysql_stmt_sqlstate(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-sqlstate-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于指定的语句</font></font><code class="literal">stmt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-sqlstate" title="28.7.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个以null结尾的字符串，该字符串包含可以成功或失败的最近调用的预准备语句API函数的SQLSTATE错误代码。</font><font style="vertical-align: inherit;">错误代码由五个字符组成。</font></font><code class="literal">"00000"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">意思是</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有错误。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些值由ANSI SQL和ODBC指定。</font><font style="vertical-align: inherit;">有关可能值的列表，请参阅
           </font></font><a class="xref" href="error-handling.html" title="附录B错误，错误代码和常见问题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录B，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误，错误代码和常见问题</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          并非所有MySQL错误都映射到SQLSTATE代码。</font><font style="vertical-align: inherit;">值
           </font></font><code class="literal">"HY000"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（一般错误）用于未映射的错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果失败的语句API函数是
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请不要调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-sqlstate" title="28.7.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以获取错误信息，因为
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-close" title="28.7.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使语句处理程序无效。</font><font style="vertical-align: inherit;">打电话
           </font></font><a class="link" href="connectors-apis.html#mysql-sqlstate" title="28.7.7.76 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-sqlstate-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          包含SQLSTATE错误代码的以null结尾的字符串。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-store-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.11.28 mysql_stmt_store_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546848560"></a><p>
        <code class="literal">int mysql_stmt_store_result(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-store-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果集通过调用产生
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于SQL语句如执行准备语句
           </font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#show" title="13.7.6 SHOW语法"><code class="literal">SHOW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE语法"><code class="literal">DESCRIBE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认情况下，成功执行的预准备语句的结果集不会在客户端上缓冲，并
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从服务器一次一个地获取它们。</font><font style="vertical-align: inherit;">要使完整的结果集在客户端上缓冲，请
           </font><font style="vertical-align: inherit;">在调用</font><font style="vertical-align: inherit;">fetch行</font><font style="vertical-align: inherit;">之前和之前调用
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          数据缓冲区
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（有关示例，请参见
           </font><a class="xref" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;">第28.7.11.11节“mysql_stmt_fetch（）”</font></a><font style="vertical-align: inherit;">。）
        </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"></font><a class="xref" href="connectors-apis.html#mysql-stmt-fetch" title="28.7.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是可选的结果集处理，除非你会打电话
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-data-seek" title="28.7.11.7 mysql_stmt_data_seek（）"><code class="literal">mysql_stmt_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-row-seek" title="28.7.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="connectors-apis.html#mysql-stmt-row-tell" title="28.7.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些功能需要可搜索的结果集。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          执行不生成结果集的SQL语句后，</font><font style="vertical-align: inherit;">
          无需调用
           </font><font style="vertical-align: inherit;">，但如果这样做，则不会造成任何明显的性能问题。</font><font style="vertical-align: inherit;">您可以通过检查是否</font></font><a class="link" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font><font style="vertical-align: inherit;">来检测语句是否生成结果集
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关更多信息，请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-result-metadata" title="28.7.11.23 mysql_stmt_result_metadata（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.23节“mysql_stmt_result_metadata（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            默认情况下，MySQL不会
             </font></font><code class="literal">MYSQL_FIELD-&gt;max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为所有列</font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            计算</font><font style="vertical-align: inherit;">，
             </font><font style="vertical-align: inherit;">因为计算它会显着减慢
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-store-result" title="28.7.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            并且大多数应用程序不需要
             </font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果要
             </font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新，可以调用
             </font></font><a class="link" href="connectors-apis.html#mysql-stmt-attr-set" title="28.7.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set(MYSQL_STMT,
            STMT_ATTR_UPDATE_MAX_LENGTH, &amp;flag)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以启用此功能。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="connectors-apis.html#mysql-stmt-attr-set" title="28.7.11.3 mysql_stmt_attr_set（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.11.3节“mysql_stmt_attr_set（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-store-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-store-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失了。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              查询期间丢失了与服务器的连接。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-asynchronous-interface"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.12 C API异步接口</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546797504"></a><a class="indexterm" name="idm140091546796016"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从MySQL 8.0.16开始，C API包含异步函数，可以与MySQL服务器进行非阻塞通信。</font><font style="vertical-align: inherit;">异步函数允许开发与基于同步函数的查询处理模型不同的应用程序，这些函数阻止对服务器连接的读取或写入是否必须等待。</font><font style="vertical-align: inherit;">使用异步功能，应用程序可以检查服务器连接上的工作是否准备好继续。</font><font style="vertical-align: inherit;">如果没有，应用程序可以执行其他工作，然后再次检查。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      例如，应用程序可能会打开与服务器的多个连接，并使用它们提交多个语句以供执行。</font><font style="vertical-align: inherit;">然后，应用程序可以轮询连接以查看其中哪些内容具有要获取的结果，同时执行其他工作。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      异步C API函数涵盖了在读取或写入服务器连接时可能阻塞的操作：初始连接操作，发送查询，读取结果等。</font><font style="vertical-align: inherit;">每个异步函数都与其同步函数具有相同的名称，加上
       </font></font><code class="literal">_nonblocking</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后缀：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1 mysql_fetch_row_nonblocking（）"><code class="literal">mysql_fetch_row_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步从结果集中提取下一行。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-free-result-nonblocking" title="28.7.15.2 mysql_free_result_nonblocking（）"><code class="literal">mysql_free_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步释放结果集使用的内存。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3 mysql_next_result_nonblocking（）"><code class="literal">mysql_next_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步返回/启动多结果执行中的下一个结果。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-real-connect-nonblocking" title="28.7.15.4 mysql_real_connect_nonblocking（）"><code class="literal">mysql_real_connect_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步连接到MySQL服务器。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-real-query-nonblocking" title="28.7.15.5 mysql_real_query_nonblocking（）"><code class="literal">mysql_real_query_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步执行指定为计数字符串的SQL查询。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步检索客户端的完整结果集。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果存在不需要异步完成或不适用异步函数的操作，则应用程序可以混合使用异步和同步函数。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下讨论更详细地描述了如何使用异步C API函数。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface-conventions" title="异步函数调用约定"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异步函数调用约定</font></font></a></p></li><li class="listitem"><p><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface-example" title="示例程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例程序</font></font></a></p></li><li class="listitem"><p><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface-restrictions" title="异步函数限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异步函数限制</font></font></a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="c-api-asynchronous-interface-conventions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异步函数调用约定</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        所有异步C API函数都返回一个</font></font><code class="literal">enum
        net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">返回值可以是以下值之一，以指示操作状态：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">NET_ASYNC_NOT_READY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：该操作仍在进行中，尚未完成。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">NET_ASYNC_COMPLETE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：操作成功完成。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">NET_ASYNC_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：操作错误终止。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">NET_ASYNC_COMPLETE_NO_MORE_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：操作成功完成，没有更多结果可用。</font><font style="vertical-align: inherit;">此状态仅适用于
             </font></font><a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3 mysql_next_result_nonblocking（）"><code class="literal">mysql_next_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        通常，要使用异步函数，请执行以下操作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            重复调用该函数，直到它不再返回状态</font></font><code class="literal">NET_ASYNC_NOT_READY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            检查最终状态是指示成功完成（</font></font><code class="literal">NET_ASYNC_COMPLETE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）还是错误（</font></font><code class="literal">NET_ASYNC_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下示例说明了一些典型的调用模式。
        </font><font style="vertical-align: inherit;">
        表示一个异步函数及其参数列表。
</font></font><code class="literal"><em class="replaceable"><code>function</code></em>(<em class="replaceable"><code>args</code></em>)</code><font style="vertical-align: inherit;"></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果希望在操作过程中执行其他处理：
          </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举net_async_status状态;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = </font></font><em class="replaceable"><code>function</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><em class="replaceable"><code>args</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
while（status == NET_ASYNC_NOT_READY）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *执行其他处理* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  other_processing（）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *再次调用相同的函数和参数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  status = </font></font><em class="replaceable"><code>function</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><em class="replaceable"><code>args</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）;</font></font><font></font>
}<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（status == NET_ASYNC_ERROR）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *呼叫失败; </font><font style="vertical-align: inherit;">处理错误* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} else {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *致电成功; </font><font style="vertical-align: inherit;">处理结果* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果在操作过程中不需要执行其他处理：
          </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举net_async_status状态;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
while（（status = </font></font><em class="replaceable"><code>function</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><em class="replaceable"><code>args</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">））== NET_ASYNC_NOT_READY）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ; </font><font style="vertical-align: inherit;">/ *空循环* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（status == NET_ASYNC_ERROR）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *呼叫失败; </font><font style="vertical-align: inherit;">处理错误* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} else {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *致电成功; </font><font style="vertical-align: inherit;">处理结果* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果功能成功/失败结果无关紧要，并且您只想确保操作已完成：
          </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while（</font></font><em class="replaceable"><code>function</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><em class="replaceable"><code>args</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）！= NET_ASYNC_COMPLETE）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ; </font><font style="vertical-align: inherit;">/ *空循环* /</font></font><font></font>
</pre></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        因为
         </font></font><a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3 mysql_next_result_nonblocking（）"><code class="literal">mysql_next_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，还需要考虑
         </font></font><code class="literal">NET_ASYNC_COMPLETE_NO_MORE_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态，这表明操作已成功完成且没有更多结果可用。</font><font style="vertical-align: inherit;">像这样使用它：
      </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while（（status = mysql_next_result_nonblocking（））！= NET_ASYNC_COMPLETE）{ </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（status == NET_ASYNC_COMPLETE_NO_MORE_RESULTS）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *没有更多结果* /</font></font><font></font>
  }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  else if（status == NET_ASYNC_ERROR）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *通过调用mysql_error（）来处理错误; </font><font style="vertical-align: inherit;">* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    打破;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font>
}<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在大多数情况下，异步函数的参数与相应的同步函数相同。</font><font style="vertical-align: inherit;">异常是
         </font></font><a class="link" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1 mysql_fetch_row_nonblocking（）"><code class="literal">mysql_fetch_row_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        和
         </font></font><a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，与其同步对应物相比，每个都需要额外的参数。</font><font style="vertical-align: inherit;">有关详细信息，请参见
         </font></font><a class="xref" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1 mysql_fetch_row_nonblocking（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.15.1节“mysql_fetch_row_nonblocking（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="xref" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.15.6节“mysql_store_result_nonblocking（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-asynchronous-interface-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例程序</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节显示了一个示例C ++程序，该程序说明了异步C API函数的使用。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要设置程序使用的SQL对象，请执行以下语句。</font><font style="vertical-align: inherit;">根据需要替换不同的数据库或用户; </font><font style="vertical-align: inherit;">在这种情况下，您还需要对程序进行一些调整。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE DATABASE db;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
USE db;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE TABLE test_table（id INT NOT NULL）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INSERT INTO test_table VALUES（10），（20），（30）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建用户'testuser'@'localhost'IDENTIFIED BY'testpass';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT ALL ON db。* TO'testuser'@'localhost';</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        创建一个</font></font><code class="filename">async_app.cc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含以下程序</font><font style="vertical-align: inherit;">的文件</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">根据需要调整连接参数。
      </font></font></p><pre data-lang="clike" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include &lt;stdio.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;string.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;iostream&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;mysql.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;mysqld_error.h&gt;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
using namespace std;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *根据需要更改以下连接参数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
static const char * c_host =“localhost”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
static const char * c_user =“testuser”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
static const char * c_auth =“testpass”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
static int c_port = 3306;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
static const char * c_sock =“/ usr / local / mysql / mysql.sock”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
static const char * c_dbnm =“db”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
void perform_arithmetic（）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  cout &lt;&lt;“虚函数调用\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  for（int i = 0; i &lt;1000; i ++）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    I * I;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int main（int argc，char ** argv）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL * mysql_local;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_RES *结果;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_ROW行;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  net_async_status状态;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  const char * stmt_text;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（！（mysql_local = mysql_init（NULL）））{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“mysql_init（）失败\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font>
  }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  while（（status = mysql_real_connect_nonblocking（mysql_local，c_host，c_user，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                                  c_auth，c_dbnm，c_port，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                                  c_sock，0））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            == NET_ASYNC_NOT_READY）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ; </font><font style="vertical-align: inherit;">/ *空循环* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（status == NET_ASYNC_ERROR）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“mysql_real_connect_nonblocking（）失败\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font>
  }<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *异步运行查询* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  stmt_text =“SELECT * FROM test_table ORDER BY id”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  status = mysql_real_query_nonblocking（mysql_local，stmt_text，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                        （unsigned long）strlen（stmt_text））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *在检查功能结果之前做一些其他任务* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  perform_arithmetic（）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  while（status == NET_ASYNC_NOT_READY）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    status = mysql_real_query_nonblocking（mysql_local，stmt_text，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                          （unsigned long）strlen（stmt_text））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    perform_arithmetic（）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（status == NET_ASYNC_ERROR）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“mysql_real_query_nonblocking（）失败\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font>
  }<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *异步检索查询结果* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  status = mysql_store_result_nonblocking（mysql_local，＆result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *在检查功能结果之前做一些其他任务* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  perform_arithmetic（）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  while（status == NET_ASYNC_NOT_READY）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    status = mysql_store_result_nonblocking（mysql_local，＆result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    perform_arithmetic（）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（status == NET_ASYNC_ERROR）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“mysql_store_result_nonblocking（）失败\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（result == NULL）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“mysql_store_result_nonblocking（）找到0条记录\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *同步获取一行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  row = mysql_fetch_row（result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（row！= NULL &amp;&amp; strcmp（row [0]，“10”）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“ROW：”&lt;&lt; row [0] &lt;&lt;“\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“提取的结果不正确\ n”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *异步获取一行，但没有做其他工作* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  while（mysql_fetch_row_nonblocking（result，＆row）！= NET_ASYNC_COMPLETE）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ; </font><font style="vertical-align: inherit;">/ *空循环* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *获取第二行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（row！= NULL &amp;&amp; strcmp（row [0]，“20”）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“ROW：”&lt;&lt; row [0] &lt;&lt;“\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“提取的结果不正确\ n”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *异步获取一行，在等待时执行其他工作* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  status = mysql_fetch_row_nonblocking（result，＆row）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *在检查功能结果之前做一些其他任务* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  perform_arithmetic（）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  while（status！= NET_ASYNC_COMPLETE）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    status = mysql_fetch_row_nonblocking（result，＆row）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    perform_arithmetic（）;</font></font><font></font>
  }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *获取第3行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（row！= NULL &amp;&amp; strcmp（row [0]，“30”）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“ROW：”&lt;&lt; row [0] &lt;&lt;“\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“提取的结果不正确\ n”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *异步获取一行（不再需要行）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  while（（status = mysql_fetch_row_nonblocking（result，＆row））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           ！= NET_ASYNC_COMPLETE）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ; </font><font style="vertical-align: inherit;">/ *空循环* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（row == NULL）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“不再需要处理的行。\ n”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    cout &lt;&lt;“找到的行数超出预期。\ n”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * free异步结果集内存* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  while（mysql_free_result_nonblocking（result）！= NET_ASYNC_COMPLETE）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ; </font><font style="vertical-align: inherit;">/ *空循环* /</font></font><font></font>
  <font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_close（mysql_local）;</font></font><font></font>
}<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用类似于此的命令编译程序; </font><font style="vertical-align: inherit;">根据需要调整编译器和选项：
      </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc -g async_app.cc -std = c ++ 11 \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  -I / usr / local / mysql / include \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  -o async_app -L / usr / lib64 / -lstdc ++ \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  -L / usr / local / mysql / lib / -lmysqlclient</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        运行程序。</font><font style="vertical-align: inherit;">结果应该类似于您在此处看到的结果，尽管您可能会看到不同数量的</font></font><code class="literal">dummy
        function invoked</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例。
      </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用虚函数</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
调用虚函数</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
行：10</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
行：20</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
调用虚函数</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
行：30</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
没有更多要处理的行。</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要试验该程序，请添加和删除行
         </font></font><code class="literal">test_table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，每次更改后再次运行程序。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-asynchronous-interface-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异步函数限制</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些限制适用于异步C API函数的使用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="connectors-apis.html#mysql-real-connect-nonblocking" title="28.7.15.4 mysql_real_connect_nonblocking（）"><code class="literal">mysql_real_connect_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            ：只能为这些身份验证插件之一验证帐户使用
             </font></font><code class="literal">mysql_native_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><code class="literal">sha256_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><code class="literal">caching_sha2_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <a class="link" href="connectors-apis.html#mysql-real-connect-nonblocking" title="28.7.15.4 mysql_real_connect_nonblocking（）"><code class="literal">mysql_real_connect_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            只能用于建立TCP / IP或Unix套接字文件连接。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            这些语句不受支持，必须使用同步C API函数进行处理：</font></font><a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA语法"><code class="literal">LOAD
            DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="link" href="sql-syntax.html#load-xml" title="13.2.8 LOAD XML语法"><code class="literal">LOAD XML</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            异步C API函数不支持协议压缩。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-asynchronous-data-structures"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.13 C API异步接口数据结构</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546707264"></a><a class="indexterm" name="idm140091546705776"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍特定于异步C API函数的数据结构。</font><font style="vertical-align: inherit;">有关通用C API数据结构的信息，请参见</font></font><a class="xref" href="connectors-apis.html#c-api-data-structures" title="28.7.5 C API数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.5节“C API数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">enum net_async_status</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          枚举类型，用于表示异步C API函数的返回状态。</font><font style="vertical-align: inherit;">下表显示了允许的状态值。
</font></font></p>
<div class="informaltable">
<table summary="enum net_async_status values and a description of each value."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举状态值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">NET_ASYNC_COMPLETE</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异步操作完成</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">NET_ASYNC_NOT_READY</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异步操作仍在进行中</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">NET_ASYNC_ERROR</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异步操作错误终止</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">NET_ASYNC_COMPLETE_NO_MORE_RESULTS</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3 mysql_next_result_nonblocking（）"><code class="literal">mysql_next_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">表示没有更多可用结果</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关更多信息，请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-asynchronous-function-overview"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.14 C API异步功能概述</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546679984"></a><a class="indexterm" name="idm140091546678496"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下列表总结了可用于与MySQL服务器进行异步交互的功能。</font><font style="vertical-align: inherit;">有关更多详细信息，请参见
       </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-functions" title="28.7.15 C API异步功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.15节“C API异步函数描述”中的描述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1 mysql_fetch_row_nonblocking（）"><code class="literal">mysql_fetch_row_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步从结果集中提取下一行。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-free-result-nonblocking" title="28.7.15.2 mysql_free_result_nonblocking（）"><code class="literal">mysql_free_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步释放结果集使用的内存。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3 mysql_next_result_nonblocking（）"><code class="literal">mysql_next_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步返回/启动多结果执行中的下一个结果。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-real-connect-nonblocking" title="28.7.15.4 mysql_real_connect_nonblocking（）"><code class="literal">mysql_real_connect_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步连接到MySQL服务器。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-real-query-nonblocking" title="28.7.15.5 mysql_real_query_nonblocking（）"><code class="literal">mysql_real_query_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步执行指定为计数字符串的SQL查询。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：异步检索客户端的完整结果集。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-asynchronous-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15 C API异步功能描述</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#mysql-fetch-row-nonblocking"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.1 mysql_fetch_row_nonblocking（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-free-result-nonblocking"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.2 mysql_free_result_nonblocking（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-next-result-nonblocking"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.3 mysql_next_result_nonblocking（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-real-connect-nonblocking"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.4 mysql_real_connect_nonblocking（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-real-query-nonblocking"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.5 mysql_real_query_nonblocking（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-store-result-nonblocking"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.6 mysql_store_result_nonblocking（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要与MySQL服务器异步交互，请使用以下各节中描述的功能。</font><font style="vertical-align: inherit;">有关其同步副本的描述，请参见
       </font></font><a class="xref" href="connectors-apis.html#c-api-functions" title="28.7.7 C API函数描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7节“C API函数描述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-row-nonblocking"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.1 mysql_fetch_row_nonblocking（）</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091546659008"></a><p>
        <code class="literal">enum net_async_status
        mysql_fetch_row_nonblocking(MYSQL_RES *result, MYSQL_ROW
        *row)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-nonblocking-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1 mysql_fetch_row_nonblocking（）"><code class="literal">mysql_fetch_row_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            是一个异步函数。</font><font style="vertical-align: inherit;">它是</font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            同步函数</font><font style="vertical-align: inherit;">的对应部分
             </font><font style="vertical-align: inherit;">，供需要与服务器进行异步通信的应用程序使用。</font><font style="vertical-align: inherit;">有关编写异步C API应用程序的一般信息，请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1 mysql_fetch_row_nonblocking（）"><code class="literal">mysql_fetch_row_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          类似地使用
           </font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关后者的详细信息，请参见</font></font><a class="xref" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.21节“mysql_fetch_row（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这两个功能的不同之处如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font><code class="literal">MYSQL_ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含下一行</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值，或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">的含义
               </font><font style="vertical-align: inherit;">取决于之前调用的函数
               </font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  当后使用
                   </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  或者
                   </font></font><a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                   </font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有要检索的行。
                </font></font></p></li><li class="listitem"><p></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果在之后使用
                   </font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则
                   </font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  返回，</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有更多行要检索或发生错误。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1 mysql_fetch_row_nonblocking（）"><code class="literal">mysql_fetch_row_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回一个</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态指示器，并获取第二个</font></font><code class="literal">row</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              参数，该参数提供指向</font></font><code class="literal">MYSQL_ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的指针
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">返回状态为时</font></font><code class="literal">NET_ASYNC_COMPLETE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">row</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是指向</font></font><code class="literal">MYSQL_ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含下一行</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的指针
               </font><font style="vertical-align: inherit;">，或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">意义
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于之前调用的函数
               </font></font><a class="link" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1 mysql_fetch_row_nonblocking（）"><code class="literal">mysql_fetch_row_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  在</font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  or
                   </font><font style="vertical-align: inherit;">之后使用时
                   </font></font><a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">row</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是
                   </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有更多行要检索。
                </font></font></p></li><li class="listitem"><p></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  在之后使用时
                   </font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">row</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是
                   </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有更多行要检索或发生错误。
</font></font></p></li></ul>
</div>
</li></ul>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-fetch-row-nonblocking" title="28.7.15.1 mysql_fetch_row_nonblocking（）"><code class="literal">mysql_fetch_row_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.16中添加了。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-nonblocking-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-data-structures" title="28.7.13 C API异步接口数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.13节“C API异步接口数据结构”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一个
           </font></font><code class="literal">NET_ASYNC_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回状态表示错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-nonblocking-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-free-result-nonblocking"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.2 mysql_free_result_nonblocking（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546603936"></a><p>
        <code class="literal">enum net_async_status
        mysql_free_result_nonblocking(MYSQL_RES *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-free-result-nonblocking-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="connectors-apis.html#mysql-free-result-nonblocking" title="28.7.15.2 mysql_free_result_nonblocking（）"><code class="literal">mysql_free_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            是一个异步函数。</font><font style="vertical-align: inherit;">它是</font></font><a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            同步函数</font><font style="vertical-align: inherit;">的对应部分
             </font><font style="vertical-align: inherit;">，供需要与服务器进行异步通信的应用程序使用。</font><font style="vertical-align: inherit;">有关编写异步C API应用程序的一般信息，请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-free-result-nonblocking" title="28.7.15.2 mysql_free_result_nonblocking（）"><code class="literal">mysql_free_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          类似地使用
           </font></font><a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关后者的详细信息，请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.25节“mysql_free_result（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这两个功能的不同之处如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-free-result" title="28.7.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 不返回值。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-free-result-nonblocking" title="28.7.15.2 mysql_free_result_nonblocking（）"><code class="literal">mysql_free_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态指示器。
</font></font></p></li></ul>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-free-result-nonblocking" title="28.7.15.2 mysql_free_result_nonblocking（）"><code class="literal">mysql_free_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.16中添加了。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-free-result-nonblocking-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-data-structures" title="28.7.13 C API异步接口数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.13节“C API异步接口数据结构”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一个
           </font></font><code class="literal">NET_ASYNC_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回状态表示错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-free-result-nonblocking-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-next-result-nonblocking"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.3 mysql_next_result_nonblocking（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546578000"></a><p>
        <code class="literal">enum net_async_status
        mysql_next_result_nonblocking(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-next-result-nonblocking-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3 mysql_next_result_nonblocking（）"><code class="literal">mysql_next_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            是一个异步函数。</font><font style="vertical-align: inherit;">它是</font></font><a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            同步函数</font><font style="vertical-align: inherit;">的对应部分
             </font><font style="vertical-align: inherit;">，供需要与服务器进行异步通信的应用程序使用。</font><font style="vertical-align: inherit;">有关编写异步C API应用程序的一般信息，请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3 mysql_next_result_nonblocking（）"><code class="literal">mysql_next_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          类似地使用
           </font></font><a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关后者的详细信息，请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.47节“mysql_next_result（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这两个功能的不同之处如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回整数状态指示器。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3 mysql_next_result_nonblocking（）"><code class="literal">mysql_next_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态指示器。
</font></font></p></li></ul>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-next-result-nonblocking" title="28.7.15.3 mysql_next_result_nonblocking（）"><code class="literal">mysql_next_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.16中添加了。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-next-result-nonblocking-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-data-structures" title="28.7.13 C API异步接口数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.13节“C API异步接口数据结构”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一个
           </font></font><code class="literal">NET_ASYNC_COMPLETE_NO_MORE_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回状态表示没有可用的更多结果。</font><font style="vertical-align: inherit;">一个
           </font></font><code class="literal">NET_ASYNC_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回状态表示错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-next-result-nonblocking-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-connect-nonblocking"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.4 mysql_real_connect_nonblocking（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546551232"></a><p>
        <code class="literal">enum net_async_status
        mysql_real_connect_nonblocking(MYSQL *mysql, const char *host,
        const char *user, const char *passwd, const char *db, unsigned
        int port, const char *unix_socket, unsigned long
        client_flag)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-connect-nonblocking-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="connectors-apis.html#mysql-real-connect-nonblocking" title="28.7.15.4 mysql_real_connect_nonblocking（）"><code class="literal">mysql_real_connect_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            是一个异步函数。</font><font style="vertical-align: inherit;">它是</font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            同步函数</font><font style="vertical-align: inherit;">的对应部分
             </font><font style="vertical-align: inherit;">，供需要与服务器进行异步通信的应用程序使用。</font><font style="vertical-align: inherit;">有关编写异步C API应用程序的一般信息，请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-real-connect-nonblocking" title="28.7.15.4 mysql_real_connect_nonblocking（）"><code class="literal">mysql_real_connect_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          类似地使用
           </font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关后者的详细信息，请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.54节“mysql_real_connect（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这两个功能的不同之处如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回连接处理程序或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-real-connect-nonblocking" title="28.7.15.4 mysql_real_connect_nonblocking（）"><code class="literal">mysql_real_connect_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态指示器。
</font></font></p></li></ul>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-real-connect-nonblocking" title="28.7.15.4 mysql_real_connect_nonblocking（）"><code class="literal">mysql_real_connect_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.16中添加了。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-connect-nonblocking-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-data-structures" title="28.7.13 C API异步接口数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.13节“C API异步接口数据结构”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一个
           </font></font><code class="literal">NET_ASYNC_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回状态表示错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-connect-nonblocking-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-query-nonblocking"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.5 mysql_real_query_nonblocking（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546524288"></a><p>
        <code class="literal">enum net_async_status
        mysql_real_query_nonblocking(MYSQL *mysql, const char *stmt_str,
        unsigned long length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-query-nonblocking-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="connectors-apis.html#mysql-real-query-nonblocking" title="28.7.15.5 mysql_real_query_nonblocking（）"><code class="literal">mysql_real_query_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            是一个异步函数。</font><font style="vertical-align: inherit;">它是</font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            同步函数</font><font style="vertical-align: inherit;">的对应部分
             </font><font style="vertical-align: inherit;">，供需要与服务器进行异步通信的应用程序使用。</font><font style="vertical-align: inherit;">有关编写异步C API应用程序的一般信息，请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-real-query-nonblocking" title="28.7.15.5 mysql_real_query_nonblocking（）"><code class="literal">mysql_real_query_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          类似地使用
           </font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关后者的详细信息，请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.57节“mysql_real_query（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这两个功能的不同之处如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 返回整数状态指示器。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-real-query-nonblocking" title="28.7.15.5 mysql_real_query_nonblocking（）"><code class="literal">mysql_real_query_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态指示器。
</font></font></p></li></ul>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-real-query-nonblocking" title="28.7.15.5 mysql_real_query_nonblocking（）"><code class="literal">mysql_real_query_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.16中添加了。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-query-nonblocking-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-data-structures" title="28.7.13 C API异步接口数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.13节“C API异步接口数据结构”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一个
           </font></font><code class="literal">NET_ASYNC_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回状态表示错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-query-nonblocking-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-store-result-nonblocking"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.15.6 mysql_store_result_nonblocking（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546498352"></a><p>
        <code class="literal">enum net_async_status
        mysql_store_result_nonblocking(MYSQL *mysql, MYSQL_RES **result
        )</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-store-result-nonblocking-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            是一个异步函数。</font><font style="vertical-align: inherit;">它是</font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            同步函数</font><font style="vertical-align: inherit;">的对应部分
             </font><font style="vertical-align: inherit;">，供需要与服务器进行异步通信的应用程序使用。</font><font style="vertical-align: inherit;">有关编写异步C API应用程序的一般信息，请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          类似地使用
           </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关后者的详细信息，请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.79节“mysql_store_result（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这两个功能的不同之处如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回指向</font></font><code class="literal">MYSQL_RESULT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              包含结果集</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的指针</font><font style="vertical-align: inherit;">，或者
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有结果集或发生错误。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回一个</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态指示器，并获取第二个</font></font><code class="literal">result</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              参数，该参数是指向</font></font><code class="literal">MYSQL_RESULT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储结果集</font><font style="vertical-align: inherit;">的指针的地址
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">返回状态为时
               </font></font><code class="literal">NET_ASYNC_COMPLETE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">result</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为没有结果集或发生错误。
</font></font></p></li></ul>
</div>
<p>
          <a class="link" href="connectors-apis.html#mysql-store-result-nonblocking" title="28.7.15.6 mysql_store_result_nonblocking（）"><code class="literal">mysql_store_result_nonblocking()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.16中添加了。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-store-result-nonblocking-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个</font></font><code class="literal">enum net_async_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-data-structures" title="28.7.13 C API异步接口数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.13节“C API异步接口数据结构”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一个
           </font></font><code class="literal">NET_ASYNC_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回状态表示错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回状态为时
           </font></font><code class="literal">NET_ASYNC_COMPLETE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">result</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为没有结果集或发生错误。</font><font style="vertical-align: inherit;">要确定是否发生错误，请检查是
           </font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非空字符串，</font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回非零值还是
           </font></font><a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-store-result-nonblocking-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#c-api-asynchronous-interface" title="28.7.12 C API异步接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.12节“C API异步接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-thread-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.16 C API螺纹功能描述</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#mysql-thread-end"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.16.1 mysql_thread_end（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-thread-init"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.16.2 mysql_thread_init（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-thread-safe"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.16.3 mysql_thread_safe（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要创建线程客户端，请使用以下部分中描述的功能。</font><font style="vertical-align: inherit;">另请参见
       </font></font><a class="xref" href="connectors-apis.html#c-api-threaded-clients" title="28.7.4.3编写C API线程客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.4.3节“编写C API线程客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-thread-end"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.16.1 mysql_thread_end（）</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091546458128"></a><p>
        <code class="literal">void mysql_thread_end(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-thread-end-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用</font></font><code class="literal">pthread_exit()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分配的空闲内存
           </font><font style="vertical-align: inherit;">之前调用此函数
           </font></font><a class="link" href="connectors-apis.html#mysql-thread-init" title="28.7.16.2 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="connectors-apis.html#mysql-thread-end" title="28.7.16.1 mysql_thread_end（）"><code class="literal">mysql_thread_end()</code></a>
          <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端库不会自动调用</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于未启用调试支持的发布/生产版本，
               </font></font><a class="link" href="connectors-apis.html#mysql-thread-end" title="28.7.16.1 mysql_thread_end（）"><code class="literal">mysql_thread_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无需调用。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于调试版本，
               </font></font><a class="link" href="connectors-apis.html#mysql-thread-init" title="28.7.16.2 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              请为DBUG包分配调试信息（请参见
               </font></font><a class="xref" href="extending-mysql.html#dbug-package" title="29.5.4 DBUG包"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第29.5.4节“DBUG包”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
              </font></font><a class="link" href="connectors-apis.html#mysql-thread-end" title="28.7.16.1 mysql_thread_end（）"><code class="literal">mysql_thread_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须为每次
               </font></font><a class="link" href="connectors-apis.html#mysql-thread-init" title="28.7.16.2 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用调用以避免内存泄漏。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-end-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-thread-init"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.16.2 mysql_thread_init（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546439360"></a><p>
        <code class="literal">bool mysql_thread_init(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-thread-init-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          必须在每个创建的线程中尽早调用此函数以初始化特定于线程的变量。</font><font style="vertical-align: inherit;">但是，您可能并不一定需要明确地调用它：呼叫
           </font></font><a class="link" href="connectors-apis.html#mysql-thread-init" title="28.7.16.2 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被自动处理
           </font></font><a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="connectors-apis.html#mysql-server-init" title="28.7.7.68 mysql_server_init（）"><code class="literal">mysql_server_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="connectors-apis.html#mysql-connect" title="28.7.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果您调用任何这些功能，
           </font></font><a class="link" href="connectors-apis.html#mysql-thread-init" title="28.7.16.2 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会为您调用。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-init-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-thread-safe"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.16.3 mysql_thread_safe（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546424928"></a><p>
        <code class="literal">unsigned int mysql_thread_safe(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-thread-safe-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数指示客户端库是否编译为线程安全。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-safe-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果客户端库是线程安全的，则为1，否则为0。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-plugin-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17 C API客户端插件函数</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#mysql-client-find-plugin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.1 mysql_client_find_plugin（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-client-register-plugin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.2 mysql_client_register_plugin（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-load-plugin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.3 mysql_load_plugin（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-load-plugin-v"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.4 mysql_load_plugin_v（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-plugin-options"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.5 mysql_plugin_options（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍用于客户端插件API的函数。</font><font style="vertical-align: inherit;">它们可以管理客户端插件。</font><font style="vertical-align: inherit;">有关</font></font><code class="literal">st_mysql_client_plugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些函数使用</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的描述</font><font style="vertical-align: inherit;">，请参见</font></font><a class="xref" href="extending-mysql.html#client-plugin-descriptors" title="29.2.4.2.3客户端插件描述符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第29.2.4.2.3节“客户端插件描述符”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      客户端程序不太可能需要调用本节中的函数。</font><font style="vertical-align: inherit;">例如，支持使用身份验证插件的客户端通常会通过调用</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来设置
       </font></font><code class="literal">MYSQL_DEFAULT_AUTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><code class="literal">MYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">来加载插件</font><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char * plugin_dir =“ </font></font><em class="replaceable"><code>path_to_plugin_dir</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
char * default_auth =“ </font></font><em class="replaceable"><code>plugin_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * ...进程命令行选项... * /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（＆mysql，MYSQL_PLUGIN_DIR，plugin_dir）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（＆mysql，MYSQL_DEFAULT_AUTH，default_auth）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通常，程序还会接受
       </font></font><code class="option">--plugin-dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="option">--default-auth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      允许用户覆盖默认值的选项。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-client-find-plugin"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.1 mysql_client_find_plugin（）</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091546407776"></a><p>
        <code class="literal">struct st_mysql_client_plugin
        *mysql_client_find_plugin(MYSQL *mysql, const char *name, int
        type)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-client-find-plugin-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回指向已加载插件的指针，必要时首先加载插件。</font><font style="vertical-align: inherit;">如果类型无效或无法找到或加载插件，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">插件API不需要连接到MySQL服务器，但必须正确初始化此结构。</font><font style="vertical-align: inherit;">该结构用于获取与连接相关的信息。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：插件名称。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：插件类型。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-find-plugin-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向成功插件的指针。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-find-plugin-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要检查错误，请调用
           </font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.15节“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.14节“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-find-plugin-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL mysql;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
struct st_mysql_client_plugin * p;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（（p = mysql_client_find_plugin（＆mysql，“myplugin”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                  MYSQL_CLIENT_AUTHENTICATION_PLUGIN，0）））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“插件版本：％d。％d。％d \ n”，p-&gt;版本[0]，p-&gt;版本[1]，p-&gt;版本[2]）;</font></font><font></font>
}<font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-client-register-plugin"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.2 mysql_client_register_plugin（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546385248"></a><p>
        <code class="literal">struct st_mysql_client_plugin
        *mysql_client_register_plugin(MYSQL *mysql, struct
        st_mysql_client_plugin *plugin)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-client-register-plugin-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将插件结构添加到加载的插件列表中。</font><font style="vertical-align: inherit;">如果插件已加载，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">插件API不需要连接到MySQL服务器，但必须正确初始化此结构。</font><font style="vertical-align: inherit;">该结构用于获取与连接相关的信息。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">plugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向插件结构的指针。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-register-plugin-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向成功插件的指针。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-register-plugin-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要检查错误，请调用
           </font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.15节“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.14节“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-load-plugin"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.3 mysql_load_plugin（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546367120"></a><p>
        <code class="literal">struct st_mysql_client_plugin *mysql_load_plugin(MYSQL
        *mysql, const char *name, int type, int argc, ...)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          加载由客户端名称和类型指定的MySQL客户端插件。</font><font style="vertical-align: inherit;">如果类型无效或无法加载插件，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          无法加载多个相同类型的插件。</font><font style="vertical-align: inherit;">如果您尝试加载已加载的类型的插件，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">插件API不需要连接到MySQL服务器，但必须正确初始化此结构。</font><font style="vertical-align: inherit;">该结构用于获取与连接相关的信息。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：要加载的插件的名称。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：要加载的插件类型，或-1以禁用类型检查。</font><font style="vertical-align: inherit;">如果type不是-1，则只考虑与该类型匹配的插件进行加载。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">argc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以下参数的数量（如果没有，则为0）。</font><font style="vertical-align: inherit;">解释任何后续参数取决于插件类型。
</font></font></p></li></ul>
</div>
<a class="indexterm" name="idm140091546354304"></a><a class="indexterm" name="idm140091546353216"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          导致加载插件的另一种方法是将</font></font><code class="literal">LIBMYSQL_PLUGINS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量</font><font style="vertical-align: inherit;">设置为
           </font><font style="vertical-align: inherit;">以分号分隔的插件名称列表。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shell&gt; export LIBMYSQL_PLUGINS =“myplugin1; myplugin2”
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          命名的插件</font></font><code class="literal">LIBMYSQL_PLUGINS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在客户端程序调用时加载
           </font></font><a class="link" href="connectors-apis.html#mysql-library-init" title="28.7.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果加载这些插件时出现问题，则不会报告错误。
        </font></font></p><a class="indexterm" name="idm140091546346880"></a><a class="indexterm" name="idm140091546345776"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">LIBMYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量可以设置的目录中查找客户端插件的路径名。</font><font style="vertical-align: inherit;">此变量以两种方式使用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在客户端插件预加载期间，该</font></font><code class="option">--plugin-dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">的值
               </font><font style="vertical-align: inherit;">不可用，因此客户端插件加载失败，除非插件位于硬连线默认目录中。</font><font style="vertical-align: inherit;">如果插件位于其他位置，则</font></font><code class="literal">LIBMYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              可以将环境变量设置为正确的目录，以使插件预加载成功。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于显式客户端插件加载，
               </font></font><a class="link" href="connectors-apis.html#mysql-load-plugin" title="28.7.17.3 mysql_load_plugin（）"><code class="literal">mysql_load_plugin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><a class="link" href="connectors-apis.html#mysql-load-plugin-v" title="28.7.17.4 mysql_load_plugin_v（）"><code class="literal">mysql_load_plugin_v()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C API函数使用该
               </font></font><code class="literal">LIBMYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值（如果存在</font></font><code class="option">--plugin-dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">且未给出选项）。</font><font style="vertical-align: inherit;">如果</font></font><code class="option">--plugin-dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给定，
               </font></font><a class="link" href="connectors-apis.html#mysql-load-plugin" title="28.7.17.3 mysql_load_plugin（）"><code class="literal">mysql_load_plugin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而
               </font></font><a class="link" href="connectors-apis.html#mysql-load-plugin-v" title="28.7.17.4 mysql_load_plugin_v（）"><code class="literal">mysql_load_plugin_v()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              忽略</font></font><code class="literal">LIBMYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果插件成功加载，则指向该插件。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要检查错误，请调用
           </font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.15节“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.14节“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL mysql;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（！mysql_load_plugin（＆mysql，“myplugin”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      MYSQL_CLIENT_AUTHENTICATION_PLUGIN，0））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误：％s \ n”，mysql_error（＆mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（-1）;</font></font><font></font>
}<font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-see-also"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也可以看看</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另请参见</font></font><a class="xref" href="connectors-apis.html#mysql-load-plugin" title="28.7.17.3 mysql_load_plugin（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.17.3节“mysql_load_plugin（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="xref" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.15节，“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="xref" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.14节，“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-load-plugin-v"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.4 mysql_load_plugin_v（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546316544"></a><p>
        <code class="literal">struct st_mysql_client_plugin
        *mysql_load_plugin_v(MYSQL *mysql, const char *name, int type,
        int argc, va_list args)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-v-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数等效于
           </font></font><a class="link" href="connectors-apis.html#mysql-load-plugin" title="28.7.17.3 mysql_load_plugin（）"><code class="literal">mysql_load_plugin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但它接受</font></font><code class="literal">va_list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是变量参数列表。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-v-see-also"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也可以看看</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另请参见</font></font><a class="xref" href="connectors-apis.html#mysql-load-plugin" title="28.7.17.3 mysql_load_plugin（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.17.3节“mysql_load_plugin（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-plugin-options"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.17.5 mysql_plugin_options（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546306944"></a><p>
        <code class="literal">int mysql_plugin_options(struct st_mysql_client_plugin
        *plugin, const char *option, const void *value)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-plugin-options-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将选项类型和值传递给插件。</font><font style="vertical-align: inherit;">可以多次调用此函数来设置多个选项。</font><font style="vertical-align: inherit;">如果插件没有选项处理程序，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">plugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向插件结构的指针。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：要设置的选项。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向选项值的指针。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-plugin-options-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功为零，如果发生错误则为1。</font><font style="vertical-align: inherit;">如果插件有一个选项处理程序，那么该处理程序也应该为成功返回零，如果发生错误则返回1。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-binary-log-interface"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.18 C API二进制日志接口</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546294160"></a><a class="indexterm" name="idm140091546292672"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL客户端/服务器协议包括一个客户端接口，用于从MySQL服务器二进制日志中读取复制事件流。</font><font style="vertical-align: inherit;">此功能使用</font></font><code class="literal">MYSQL_RPL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据结构和一小组函数来管理客户端程序与要从中读取二进制日志的服务器之间的通信。</font><font style="vertical-align: inherit;">以下部分更详细地描述了此接口的各个方面。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-binary-log-data-structures"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.19 C API二进制日志数据结构</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546288432"></a><a class="indexterm" name="idm140091546286944"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      用于处理来自服务器的复制事件流的C API函数需要连接处理程序（</font></font><code class="literal">MYSQL *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      指针）和指向</font></font><code class="literal">MYSQL_RPL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针，该</font><font style="vertical-align: inherit;">结构描述从服务器二进制日志中读取的复制事件的流。</font><font style="vertical-align: inherit;">例如：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL * mysql = mysql_real_connect（...）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_RPL rpl;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃...初始化MYSQL_RPL成员......</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int result = mysql_binlog_open（mysql，＆rpl）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍</font></font><code class="literal">MYSQL_RPL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构成员。</font></font><a class="xref" href="connectors-apis.html#c-api-data-structures" title="28.7.5 C API数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.5节“C API数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中介绍了连接处理程序
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      适用的</font></font><code class="literal">MYSQL_RPL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员依赖于要执行的二进制日志操作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          拨打电话之前
           </font></font><a class="link" href="connectors-apis.html#mysql-binlog-open" title="28.7.21.3 mysql_binlog_open（）"><code class="literal">mysql_binlog_open()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，调用者必须设置</font></font><code class="literal">MYSQL_RPL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的成员
           </font></font><code class="literal">file_name_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过
           </font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此外，如果
           </font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有
           </font></font><code class="literal">MYSQL_RPL_GTID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志设置，调用者必须从集中的成员</font></font><code class="literal">gtid_set_encoded_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过</font></font><code class="literal">gtid_set_arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-binlog-fetch" title="28.7.21.2 mysql_binlog_fetch（）"><code class="literal">mysql_binlog_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼叫</font><font style="vertical-align: inherit;">
          成功后
           </font><font style="vertical-align: inherit;">，呼叫者会检查</font></font><code class="literal">size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员。
</font></font></p></li></ul>
</div>
<p>
      <code class="literal">MYSQL_RPL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 结构成员说明：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">file_name_length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要读取的二进制日志文件的名称长度。</font><font style="vertical-align: inherit;">该成员与
           </font></font><code class="literal">file_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">看到
           </font></font><code class="literal">file_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">file_name</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要读取的二进制日志文件的名称：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><code class="literal">file_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则客户端库将其设置为空字符串并设置</font></font><code class="literal">file_name_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为0。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><code class="literal">file_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则
               </font></font><code class="literal">file_name_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是名称的长度或0.如果
               </font></font><code class="literal">file_name_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为0，则客户端库将其设置为名称的长度，在这种情况下，
               </font></font><code class="literal">file_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须以空终止字符串的形式给出。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要从二进制日志的开头读取而不必知道最旧的二进制日志文件的名称，请设置
           </font></font><code class="filename">file_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空字符串，并设置</font></font><code class="literal">start_position</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为4。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">start_position</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          开始读取二进制日志的位置。</font><font style="vertical-align: inherit;">任何给定二进制日志文件中第一个事件的位置是4。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">server_id</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          用于标识从中读取二进制日志的服务器的服务器标识。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">flags</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          影响二进制日志读取的标志的并集，如果没有设置标志，则为0。</font><font style="vertical-align: inherit;">允许使用这些标志值：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">MYSQL_RPL_SKIP_HEARTBEAT</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置此标志以导致
               </font></font><a class="link" href="connectors-apis.html#mysql-binlog-fetch" title="28.7.21.2 mysql_binlog_fetch（）"><code class="literal">mysql_binlog_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跳过心跳事件。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_RPL_GTID</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置此标志以读取GTID（全局事务ID）数据。</font><font style="vertical-align: inherit;">如果设置，您必须初始化
               </font></font><code class="literal">MYSQL_RPL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从结构GTID相关的成员</font></font><code class="literal">gtid_set_encoded_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来
               </font></font><code class="literal">gtid_set_arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用之前
               </font></font><a class="link" href="connectors-apis.html#mysql-binlog-open" title="28.7.21.3 mysql_binlog_open（）"><code class="literal">mysql_binlog_open()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              详细描述客户端程序如何使用这些与GTID相关的成员超出了本文档的范围。</font><font style="vertical-align: inherit;">有关更多信息，请检查
               </font></font><code class="filename">mysqlbinlog.cc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">源文件。</font><font style="vertical-align: inherit;">有关基于GTID的复制的信息，请参见
               </font></font><a class="xref" href="replication.html#replication-gtids" title="17.1.3使用全局事务标识符进行复制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.1.3节“使用全局事务标识符进行复制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">gtid_set_encoded_size</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          GTID设置数据的大小，或0。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">fix_gtid_set</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          回调函数的地址，用于
           </font></font><a class="link" href="connectors-apis.html#mysql-binlog-open" title="28.7.21.3 mysql_binlog_open（）"><code class="literal">mysql_binlog_open()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用填充命令包GTID设置，或者</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果没有这样的功能。</font><font style="vertical-align: inherit;">回调函数（如果使用）应具有此调用签名：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">void </font></font><em class="replaceable"><code>my_callback</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（MYSQL_RPL * rpl，unsigned char * packet_gtid_set）;
</font></font></pre></li><li class="listitem"><p>
          <code class="literal">gtid_set_arg</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向GTID设置数据的指针（如果
           </font></font><code class="literal">fix_gtid_set</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），或指向要在回调函数中使用的值的指针（如果</font></font><code class="literal">fix_gtid_set</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><code class="literal">gtid_set_arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          是一个通用指针，因此它可以指向任何类型的值（例如，字符串，结构或函数）。</font><font style="vertical-align: inherit;">它在回调中的解释取决于回调打算如何使用它。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">size</code>
        </p><p><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-binlog-fetch" title="28.7.21.2 mysql_binlog_fetch（）"><code class="literal">mysql_binlog_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">
          成功后
           </font><font style="vertical-align: inherit;">，返回二进制日志事件的大小。</font><font style="vertical-align: inherit;">对于EOF事件，该值为0，对于非EOF事件，该值大于0。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">buffer</code>
        </p><p><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-binlog-fetch" title="28.7.21.2 mysql_binlog_fetch（）"><code class="literal">mysql_binlog_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">
          成功后
           </font><font style="vertical-align: inherit;">，指向二进制日志事件内容的指针。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-binary-log-function-overview"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.20 C API二进制日志功能概述</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546212224"></a><a class="indexterm" name="idm140091546210736"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下列表总结了可用于从二进制日志中读取复制事件流的功能。</font><font style="vertical-align: inherit;">有关更多详细信息，请参见
       </font></font><a class="xref" href="connectors-apis.html#c-api-binary-log-functions" title="28.7.21 C API二进制日志功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.21节“C API二进制日志函数说明”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-binlog-close" title="28.7.21.1 mysql_binlog_close（）"><code class="literal">mysql_binlog_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：关闭复制事件流。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-binlog-fetch" title="28.7.21.2 mysql_binlog_fetch（）"><code class="literal">mysql_binlog_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从复制事件流中读取事件。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="connectors-apis.html#mysql-binlog-open" title="28.7.21.3 mysql_binlog_open（）"><code class="literal">mysql_binlog_open()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：打开复制事件流。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-binary-log-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.21 C API二进制日志功能描述</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#mysql-binlog-close"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.21.1 mysql_binlog_close（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-binlog-fetch"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.21.2 mysql_binlog_fetch（）</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#mysql-binlog-open"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.21.3 mysql_binlog_open（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下部分提供了有关从MySQL服务器二进制日志中读取复制事件流的功能的详细说明。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下简单示例程序演示了二进制日志C API函数。</font><font style="vertical-align: inherit;">计划说明：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 假定是一个有效的连接处理程序。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          初始
           </font></font><a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          语句设置</font></font><code class="literal">@master_binlog_checksum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          服务器采用</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">用户定义变量，以指示客户端是校验和感知的。</font><font style="vertical-align: inherit;">此客户端不对校验和执行任何操作，但如果没有此语句，则包含二进制日志事件中的校验和的服务器将在第一次尝试读取包含校验和的事件时返回错误。</font><font style="vertical-align: inherit;">赋给变量的值并不重要; </font><font style="vertical-align: inherit;">重要的是变量存在。</font><font style="vertical-align: inherit;">存在。
</font></font></p><a class="indexterm" name="idm140091546194080"></a><a class="indexterm" name="idm140091546192976"></a></li></ul>
</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if（mysql_query（mysql，“SET @ master_binlog_checksum ='ALL'”））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_query（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“错误％u：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_errno（mysql），mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（1）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_RPL rpl;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rpl.file_name_length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rpl.file_name = NULL;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rpl.start_position = 4;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rpl.server_id = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rpl.flags = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_binlog_open（mysql，＆rpl））</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_binlog_open（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“错误％u：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_errno（mysql），mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
for（;;）/ *读取事件直到错误或EOF * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（mysql_binlog_fetch（mysql，＆rpl））</font></font><font></font>
  {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“mysql_binlog_fetch（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误％u：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             mysql_errno（mysql），mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    打破;</font></font><font></font>
  }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（rpl.size == 0）/ * EOF * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“收到的EOF事件\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    打破;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“收到的事件大小为％lu。\ n”，rpl.size）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_binlog_close（mysql，＆rpl）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关如何使用这些函数的其他示例，请查看这些源文件的MySQL源代码分发：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="filename">mysqlbinlog.cc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在
           </font></font><code class="filename">client</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录中
        </font></font></p></li><li class="listitem"><p>
          <code class="filename">mysql_client_test.c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在
           </font></font><code class="filename">testclients</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录中
</font></font></p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-binlog-close"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.21.1 mysql_binlog_close（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546181872"></a><p>
        <code class="literal">void mysql_binlog_close(MYSQL *mysql, MYSQL_RPL
        *rpl)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-binlog-close-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          关闭复制事件流。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从中返回的连接处理程序</font></font><a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><a class="link" href="connectors-apis.html#mysql-binlog-close" title="28.7.21.1 mysql_binlog_close（）"><code class="literal">mysql_binlog_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼叫</font><font style="vertical-align: inherit;">后处理程序保持打开状态
               </font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">rpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：复制流结构。</font><font style="vertical-align: inherit;">调用之后</font></font><a class="link" href="connectors-apis.html#mysql-binlog-close" title="28.7.21.1 mysql_binlog_close（）"><code class="literal">mysql_binlog_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果不重新初始化并</font></font><a class="link" href="connectors-apis.html#mysql-binlog-open" title="28.7.21.3 mysql_binlog_open（）"><code class="literal">mysql_binlog_open()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再次</font><font style="vertical-align: inherit;">调用
               </font><font style="vertical-align: inherit;">，则不应进一步使用此结构
               </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-binlog-close-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-binlog-close-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#c-api-binary-log-functions" title="28.7.21 C API二进制日志功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.21节“C API二进制日志功能描述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-binlog-fetch"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.21.2 mysql_binlog_fetch（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546163664"></a><p>
        <code class="literal">int mysql_binlog_fetch(MYSQL *mysql, MYSQL_RPL
        *rpl)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-binlog-fetch-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从复制事件流中获取一个事件。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从中返回的连接处理程序</font></font><a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">rpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：复制流结构。</font><font style="vertical-align: inherit;">成功呼叫后，</font></font><code class="literal">size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              成员会指示事件大小，即EOF事件为0。</font><font style="vertical-align: inherit;">对于非EOF事件，</font></font><code class="literal">size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大于0且</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员指向事件内容。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-binlog-fetch-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-binlog-fetch-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-binlog-fetch-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#c-api-binary-log-functions" title="28.7.21 C API二进制日志功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.21节“C API二进制日志功能描述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-binlog-open"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.21.3 mysql_binlog_open（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091546144336"></a><p>
        <code class="literal">int mysql_binlog_open(MYSQL *mysql, MYSQL_RPL
        *rpl)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-binlog-open-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          打开一个新的复制事件流，以读取MySQL服务器二进制日志。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从中返回的连接处理程序</font></font><a class="link" href="connectors-apis.html#mysql-init" title="28.7.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">rpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code class="literal">MYSQL_RPL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              已初始化以指示复制事件流源的结构。</font><font style="vertical-align: inherit;">有关结构成员的说明以及如何初始化它们，请参见
               </font></font><a class="xref" href="connectors-apis.html#c-api-binary-log-data-structures" title="28.7.19 C API二进制日志数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.19节“C API二进制日志数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-binlog-open-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功归零。</font><font style="vertical-align: inherit;">如果发生错误，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-binlog-open-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_file_name_too_long"><code class="literal">CR_FILE_NAME_TOO_LONG</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指定的二进制日志文件名太长。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-binlog-open-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="connectors-apis.html#c-api-binary-log-functions" title="28.7.21 C API二进制日志功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.21节“C API二进制日志功能描述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-encrypted-connections"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.22 C API加密连接支持</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍C应用程序如何将C API功能用于加密连接。</font><font style="vertical-align: inherit;">默认情况下，如果服务器支持加密连接，MySQL程序将尝试使用加密进行连接，如果无法建立加密连接，则会回退到未加密的连接（请参见
       </font></font><a class="xref" href="security.html#using-encrypted-connections" title="6.3.1配置MySQL使用加密连接"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.3.1节“配置MySQL以使用加密连接”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">对于需要超出默认行为控制而不是建立加密连接的应用程序，C API提供以下功能：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能使应用程序可以在调用之前设置适当的SSL / TLS选项
           </font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，要要求使用加密连接，请参阅
           </font></font><a class="xref" href="connectors-apis.html#c-api-enforcing-encrypted-connection" title="执行加密连接"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">强制执行加密连接</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="connectors-apis.html#mysql-get-ssl-cipher" title="28.7.7.34 mysql_get_ssl_cipher（）"><code class="literal">mysql_get_ssl_cipher()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          功能使应用程序能够在建立连接后确定连接是否使用加密。</font><font style="vertical-align: inherit;">一个</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值表示不使用加密。</font><font style="vertical-align: inherit;">非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值表示加密连接并命名加密密码。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="connectors-apis.html#mysql-get-ssl-cipher" title="28.7.7.34 mysql_get_ssl_cipher（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.34节“mysql_get_ssl_cipher（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="connectors-apis.html#c-api-encrypted-connection-options" title="加密连接的C API选项"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加密连接的C API选项</font></font></a></p></li><li class="listitem"><p><a class="xref" href="connectors-apis.html#c-api-enforcing-encrypted-connection" title="执行加密连接"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行加密连接</font></font></a></p></li><li class="listitem"><p><a class="xref" href="connectors-apis.html#c-api-secure-encrypted-connection" title="提高加密连接的安全性"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提高加密连接的安全性</font></font></a></p></li></ul>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-encrypted-connection-options"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加密连接的C API选项</font></font></h4>

</div>

</div>

</div>
<p>
        <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供以下选项来控制加密连接的使用。</font><font style="vertical-align: inherit;">有关选项的详细信息，请参见</font></font><a class="xref" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.50节“mysql_options（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：证书颁发机构（CA）证书文件的路径名。</font><font style="vertical-align: inherit;">如果使用此选项，则必须指定服务器使用的相同证书。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CAPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含受信任SSL CA证书文件的目录的路径名。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户端公钥证书文件的路径名。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CIPHER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：SSL加密的允许密码列表。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CRL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含证书吊销列表的文件的路径名。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CRLPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含证书吊销列表文件的目录的路径名。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户端私钥文件的路径名。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：连接安全状态。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_TLS_CIPHERSUITES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户允许的TLSv1.3密码套件。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_TLS_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户端允许的加密协议。
</font></font></p></li></ul>
</div>
<p>
        <a class="link" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以用作便捷例程，它相当于一组</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定证书和密钥文件，加密密码等</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">调用。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="connectors-apis.html#mysql-ssl-set" title="28.7.7.77 mysql_ssl_set（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.77节“mysql_ssl_set（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-enforcing-encrypted-connection"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行加密连接</font></font></h4>

</div>

</div>

</div>
<p>
        <a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL证书和密钥文件等信息的选项用于建立加密连接（如果此类连接可用），但不强制要求加密连接。</font><font style="vertical-align: inherit;">要要求加密连接，请使用以下技术：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要时</font><font style="vertical-align: inherit;">
            调用</font><font style="vertical-align: inherit;">提供适当的SSL参数（证书和密钥文件，加密密码等）。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以</font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用值</font></font><code class="literal">SSL_MODE_REQUIRED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或其中一个限制性更强的选项值</font><font style="vertical-align: inherit;">传递</font><font style="vertical-align: inherit;">选项。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            呼叫</font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接到服务器。</font><font style="vertical-align: inherit;">如果无法获得加密连接，则呼叫失败; </font><font style="vertical-align: inherit;">退出并出错。
</font></font></p></li></ol>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-secure-encrypted-connection"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提高加密连接的安全性</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        为了提供相对于默认加密提供的安全性的额外安全性，客户端可以提供与服务器使用的CA证书匹配的CA证书，并启用主机名身份验证。</font><font style="vertical-align: inherit;">通过这种方式，服务器和客户端将信任放在同一个CA证书中，并且客户端会验证它所连接的主机是否为预期的主机：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要指定CA证书，请调用
             </font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以传递
             </font></font><code class="literal">MYSQL_OPT_SSL_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
             </font></font><code class="literal">MYSQL_OPT_SSL_CAPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）选项，并调用
             </font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以传递</font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值为</font><font style="vertical-align: inherit;">的
             </font><font style="vertical-align: inherit;">选项
             </font></font><code class="literal">SSL_MODE_VERIFY_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要同时启用主机名身份验证，请调用
             </font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以</font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用值</font></font><code class="literal">SSL_MODE_VERIFY_IDENTITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是
             </font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">传递
             </font><font style="vertical-align: inherit;">选项
             </font></font><code class="literal">SSL_MODE_VERIFY_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          主机名身份验证</font></font><code class="literal">SSL_MODE_VERIFY_IDENTITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不适用于服务器自动创建的自签名证书</font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">也不能使用</font></font><a class="link" href="programs.html#mysql-ssl-rsa-setup" title="4.4.3 mysql_ssl_rsa_setup  - 创建SSL / RSA文件"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_ssl_rsa_setup</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手动使用</font><font style="vertical-align: inherit;">（请参见
           </font></font><a class="xref" href="security.html#creating-ssl-rsa-files-using-mysql" title="6.3.3.1使用MySQL创建SSL和RSA证书和密钥"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.3.3.1节“使用MySQL创建SSL和RSA证书和密钥”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">此类自签名证书不包含服务器名称作为Common Name值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          主机名身份验证也不适用于使用通配符指定公用名的证书，因为该名称将逐字比较到服务器名称。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-multiple-queries"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.23 C API多语句执行支持</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      默认情况下，</font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
       </font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解释他们的声明中字符串参数作为一个单独的语句来执行，您可以根据语句是否生成结果集的处理结果（一组行，作为
       </font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或受影响的行数（为</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等等）。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL还支持执行包含由semicolon（</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）字符</font><font style="vertical-align: inherit;">分隔的多个语句的字符串</font><font style="vertical-align: inherit;">。</font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过调用</font><font style="vertical-align: inherit;">连接到服务器时</font><font style="vertical-align: inherit;">或在通过调用连接后
       </font><font style="vertical-align: inherit;">指定的特殊选项启用此功能
       </font></font><a class="link" href="connectors-apis.html#mysql-set-server-option" title="28.7.7.74 mysql_set_server_option（）"><code class="literal">mysql_set_server_option()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      执行多语句字符串可以生成多个结果集或行计数指示符。</font><font style="vertical-align: inherit;">处理这些结果涉及与单语句情况不同的方法：在处理第一个语句的结果后，有必要检查是否存在更多结果并依次处理它们。</font><font style="vertical-align: inherit;">为了支持多结果处理，C API包括
       </font></font><a class="link" href="connectors-apis.html#mysql-more-results" title="28.7.7.46 mysql_more_results（）"><code class="literal">mysql_more_results()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。</font><font style="vertical-align: inherit;">只要有更多结果可用，这些函数就会在循环结束时使用。</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无法以这种方式处理结果可能会导致与服务器的连接断开。</font></font></em></span>
    </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果执行</font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储过程的语句，</font><font style="vertical-align: inherit;">则还需要多结果处理
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">存储过程的结果具有以下特征：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          过程中的语句可能会生成结果集（例如，如果它执行</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          语句）。</font><font style="vertical-align: inherit;">这些结果集按过程执行时生成的顺序返回。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通常，调用者无法知道过程将返回多少结果集。</font><font style="vertical-align: inherit;">过程执行可能依赖于循环或条件语句，这些循环或条件语句导致执行路径从一个调用到下一个调用不同。</font><font style="vertical-align: inherit;">因此，您必须准备好检索多个结果。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该过程的最终结果是状态结果，其中不包括结果集。</font><font style="vertical-align: inherit;">状态指示过程是成功还是发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      多语句和结果功能只能与</font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font><font style="vertical-align: inherit;">一起使用</font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它们不能与预准备语句接口一起使用。</font><font style="vertical-align: inherit;">准备好的语句处理程序被定义为仅适用于包含单个语句的字符串。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="connectors-apis.html#c-api-prepared-statements" title="28.7.8 C API准备语句"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.8节“C API准备语句”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要启用多语句执行和结果处理，可以使用以下选项：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数有一个</font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，其中两个选项值是相关的：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使客户端程序能够处理多个结果。</font><font style="vertical-align: inherit;">如果</font><font style="vertical-align: inherit;">为生成结果集的存储过程</font><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">语句，</font><font style="vertical-align: inherit;">则</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用
               </font><font style="vertical-align: inherit;">此选项
               </font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，此类过程会导致错误</font><font style="vertical-align: inherit;">。
              </font><font style="vertical-align: inherit;">默认情况下启用。
            </font></font><code class="literal">Error 1312 (0A000):
              PROCEDURE <em class="replaceable"><code>proc_name</code></em> can't
              return a result set in the given context</code><font style="vertical-align: inherit;"></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
              <code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用
               </font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
               </font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行包含由分号分隔的多个语句的语句字符串。</font><font style="vertical-align: inherit;">此选项也可启用
               </font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含蓄，所以
               </font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数
               </font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以
               </font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相当于一个参数
               </font></font><code class="literal">CLIENT_MULTI_STATEMENTS |
              CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">也就是说，
               </font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">足以启用多语句执行和所有多结果处理。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在建立与服务器的连接之后，您可以使用该
           </font></font><a class="link" href="connectors-apis.html#mysql-set-server-option" title="28.7.7.74 mysql_set_server_option（）"><code class="literal">mysql_set_server_option()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数通过传递参数</font></font><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_ON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or
           </font><font style="vertical-align: inherit;">来启用或禁用多语句执行
           </font></font><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_OFF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使多语句执行与该功能还允许的处理</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简单</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为其中每个语句产生一个结果，但是多语句字符串结果</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">足以允许产生结果集的存储过程的处理。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下过程概述了处理多个语句的建议策略：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          传递</font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给
           </font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，完全启用多语句执行和多结果处理。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用</font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="connectors-apis.html#mysql-real-query" title="28.7.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">验证它成功后，输入一个循环来处理语句结果。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于循环的每次迭代，处理当前语句结果，检索结果集或受影响的行计数。</font><font style="vertical-align: inherit;">如果发生错误，请退出循环。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在循环结束时，调用
           </font></font><a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以检查是否存在另一个结果并启动检索（如果存在）。</font><font style="vertical-align: inherit;">如果没有更多结果可用，请退出循环。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下示出了前述策略的一种可能的实现方式。</font><font style="vertical-align: inherit;">循环的最后一部分可以简化为是否</font></font><a class="link" href="connectors-apis.html#mysql-next-result" title="28.7.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非零</font><font style="vertical-align: inherit;">的简单测试
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">所写的代码区分不再有结果和错误，这使得能够为后一种情况打印消息。
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ *使用CLIENT_MULTI_STATEMENTS选项连接到服务器* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_real_connect（mysql，host_name，user_name，password，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    db_name，port_num，socket_name，CLIENT_MULTI_STATEMENTS）== NULL）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“mysql_real_connect（）failed \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_close（MySQL的）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（1）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *执行多个语句* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_query（mysql，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     “DROP TABLE IF EXISTS test_table; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      CREATE TABLE test_table（id INT）; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      INSERT INTO test_table VALUES（10）; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      UPDATE test_table SET id = 20 WHERE id = 10; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      SELECT * FROM test_table; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      DROP TABLE test_table“）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（状态）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“无法执行语句”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_close（MySQL的）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *处理每个语句结果* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
做{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *当前语句返回数据吗？</font><font style="vertical-align: inherit;">* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  result = mysql_store_result（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（结果）</font></font><font></font>
  {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *是; </font><font style="vertical-align: inherit;">处理行并释放结果集* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    process_result_set（mysql，result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    了mysql_free_result（结果）;</font></font><font></font>
  }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  else / *没有结果集或错误* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if（mysql_field_count（mysql）== 0）</font></font><font></font>
    {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“％lld行受影响\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            mysql_affected_rows（MySQL的））;</font></font><font></font>
    }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    else / *发生了一些错误* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“无法检索结果集\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      打破;</font></font><font></font>
    }<font></font>
  }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  /* 更多结果？</font><font style="vertical-align: inherit;">-1 =否，&gt; 0 =错误，0 =是（保持循环）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（（status = mysql_next_result（mysql））&gt; 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“无法执行语句\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} while（status == 0）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_close（MySQL的）;</font></font><font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-date-handling"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.24 C API准备语句处理日期和时间值</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      二进制（预处理语句）协议使您能够发送和接收日期和时间值（</font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），使用
       </font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构。</font></font><a class="xref" href="connectors-apis.html#c-api-prepared-statement-data-structures" title="28.7.9 C API准备语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.9节“C API准备语句数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中介绍了此结构的成员
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要发送时态数据值，请使用创建预准备语句
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="28.7.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后，在调用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行语句之前，使用以下过程设置每个时态参数：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与数据值关联</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构中，将</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员</font><font style="vertical-align: inherit;">设置为</font><font style="vertical-align: inherit;">指示您要发送的时间值类型的类型。</font><font style="vertical-align: inherit;">为</font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值，设定
           </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到
           </font></font><code class="literal">MYSQL_TYPE_DATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_DATETIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><code class="literal">MYSQL_TYPE_TIMESTAMP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，分别。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员</font><font style="vertical-align: inherit;">设置为</font><font style="vertical-align: inherit;">传递时间值</font><font style="vertical-align: inherit;">的
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构的地址
           </font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          填写</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          适合要传递的时间值类型</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">成员</font><font style="vertical-align: inherit;">。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用</font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-param" title="28.7.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数数据绑定到语句。</font><font style="vertical-align: inherit;">然后你可以打电话
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要检索时间值，过程类似，只是您将</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员</font><font style="vertical-align: inherit;">设置为</font><font style="vertical-align: inherit;">您希望接收的值的类型，并将</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      成员设置为</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应将返回值放入其中的结构</font><font style="vertical-align: inherit;">的地址</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">用于
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-bind-result" title="28.7.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在调用之后</font></font><a class="link" href="connectors-apis.html#mysql-stmt-execute" title="28.7.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和获取结果之前</font><font style="vertical-align: inherit;">将缓冲区绑定到语句
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      下面是插入一个简单的例子
       </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据。</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假定</font><font style="vertical-align: inherit;">该
       </font><font style="vertical-align: inherit;">变量是有效的连接处理程序。
    </font></font></p><pre data-lang="c" class="programlisting"><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_TIME ts;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_BIND绑定[3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_STMT * stmt;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  strmov（查询，“INSERT INTO test_table（date_field，time_field，\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                               timestamp_field）VALUES（？，？，？“）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（！stmt）</font></font><font></font>
  {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“mysql_stmt_init（），内存不足\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（0）;</font></font><font></font>
  }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（mysql_stmt_prepare（mysql，query，strlen（query）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“\ n mysql_stmt_prepare（），INSERT失败”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *为所有3个参数设置输入缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .buffer_type = MYSQL_TYPE_DATE;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .buffer =（char *）＆ts;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .is_null = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ...</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [1] = bind [2] = bind [0];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_stmt_bind_param（stmt，bind）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *提供要在ts结构中发送的数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.year = 2002;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.month = 02;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.day = 03;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.hour = 10;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.minute = 45;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.second = 20;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  在mysql_stmt_execute（语句）;</font></font><font></font>
  ..<font></font>
<font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-call-statements"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.25 C API准备CALL语句支持</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节描述了C API中对使用</font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">执行的存储过程的预备语句支持
       </font><font style="vertical-align: inherit;">：
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用预准备</font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">执行的存储过程
       </font><font style="vertical-align: inherit;">可以通过以下方式使用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          存储过程可以生成任意数量的结果集。</font><font style="vertical-align: inherit;">对于所有结果集，列的数量和列的数据类型不必相同。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在过程返回后，调用应用程序可以使用</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">
          的最终值</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些参数作为过程本身生成的任何结果集之后的额外单行结果集返回。</font><font style="vertical-align: inherit;">该行包含</font><font style="vertical-align: inherit;">在过程参数列表中声明它们的顺序</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">的值</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关未处理条件对过程参数的影响的信息，请参见
           </font></font><a class="xref" href="sql-syntax.html#conditions-and-parameters" title="13.6.7.8条件处理和OUT或INOUT参数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.6.7.8节“条件处理和OUT或INOUT参数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下讨论显示了如何通过C API为预准备语句使用这些功能。</font><font style="vertical-align: inherit;">要</font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过</font></font><a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE语法"><code class="literal">PREPARE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE语法"><code class="literal">EXECUTE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">使用预准备
       </font><font style="vertical-align: inherit;">语句
       </font><font style="vertical-align: inherit;">，请参见
       </font></font><a class="xref" href="sql-syntax.html#call" title="13.2.1 CALL语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.2.1节“CALL语法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      执行预准备</font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">的应用程序
       </font><font style="vertical-align: inherit;">应使用获取结果的循环，然后调用
       </font></font><a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="28.7.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以确定是否有更多结果。</font><font style="vertical-align: inherit;">结果包含存储过程生成的任何结果集，后跟最终状态值，指示过程是否成功终止。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果过程具有</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，则最终状态值之前的结果集包含其值。</font><font style="vertical-align: inherit;">要确定结果集是否包含参数值，请测试该
       </font></font><code class="literal">SERVER_PS_OUT_PARAMS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位是否在</font><font style="vertical-align: inherit;">连接处理程序</font><font style="vertical-align: inherit;">的</font></font><code class="literal">server_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员中
       </font><font style="vertical-align: inherit;">设置
       </font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-&gt; server_status＆SERVER_PS_OUT_PARAMS
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下示例使用预准备
       </font></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句来执行存储过程，该存储过程生成多个结果集，并通过</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">将参数值提供给调用方
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该过程采用所有三种类型的参数（</font></font><code class="literal">IN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），显示它们的初始值，分配新的值，显示该更新的值，并返回。</font><font style="vertical-align: inherit;">因此，程序的预期返回信息包含多个结果集和最终状态：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个结果从设置</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          显示的初始参数值：
           </font></font><code class="literal">10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">30</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用者为参数分配了一个值，但预期此分配无效：</font><font style="vertical-align: inherit;">在过程中</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分配值之前，</font><font style="vertical-align: inherit;">参数将被视为</font><font style="vertical-align: inherit;">过程。）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个结果从设置</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          显示所述修改后的参数值：
           </font></font><code class="literal">100</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">200</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">300</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个包含final </font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数值的</font><font style="vertical-align: inherit;">结果集</font><font style="vertical-align: inherit;">：
           </font></font><code class="literal">200</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">300</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          最终状态包。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      执行过程的代码：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_STMT * stmt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_BIND ps_params [3]; </font><font style="vertical-align: inherit;">/ *输入参数缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int int_data [3]; </font><font style="vertical-align: inherit;">/ *输入/输出值* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bool is_null [3]; </font><font style="vertical-align: inherit;">/ *输出值为空性* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INT状态;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *设置存储过程* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_query（mysql，“DROP PROCEDURE IF EXISTS p1”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_error（mysql，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_query（mysql，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “创建程序p1（”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “IN p_in INT，”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “OUT p_out INT，”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “INOUT p_inout INT”“</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “开始 ”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “SELECT p_in，p_out，p_inout;”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “SET p_in = 100，p_out = 200，p_inout = 300;”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “SELECT p_in，p_out，p_inout;”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “结束”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_error（mysql，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *用参数占位符初始化和准备CALL语句* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（！stmt）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“无法初始化语句\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（1）;</font></font><font></font>
}<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_stmt_prepare（stmt，“CALL p1（？，？，？）”，16）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_stmt_error（stmt，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *初始化参数：p_in，p_out，p_inout（所有INT）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
memset（ps_params，0，sizeof（ps_params））;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [0] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [0] .buffer =（char *）＆int_data [0];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [0] .length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [0] .is_null = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [1] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [1] .buffer =（char *）＆int_data [1];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [1] .length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [1] .is_null = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [2] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [2] .buffer =（char *）＆int_data [2];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [2] .length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [2] .is_null = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定参数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_stmt_bind_param（stmt，ps_params）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_stmt_error（stmt，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *为参数赋值和执行语句* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data [0] = 10; </font><font style="vertical-align: inherit;">/ * p_in * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data [1] = 20; </font><font style="vertical-align: inherit;">/ * p_out * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data [2] = 30; </font><font style="vertical-align: inherit;">/ * p_inout * /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_stmt_execute（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_stmt_error（stmt，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *处理结果，直到没有更多* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
做{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  int i;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  int num_fields; </font><font style="vertical-align: inherit;">/ *结果中的列数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_FIELD *字段; </font><font style="vertical-align: inherit;">/ *表示结果集元数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_BIND * rs_bind; </font><font style="vertical-align: inherit;">/ *表示输出缓冲区* /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *如果有结果集，则列数&gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * 0如果结果只是最终状态包* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  num_fields = mysql_stmt_field_count（stmt）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（num_fields&gt; 0）</font></font><font></font>
  {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *有一个结果集来获取* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“结果中的列数：％d \ n”，（int）num_fields）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *这是什么样的结果集？</font><font style="vertical-align: inherit;">* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“数据：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if（mysql-&gt; server_status＆SERVER_PS_OUT_PARAMS）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“此结果集包含OUT / INOUT参数\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“此结果集由过程生成\ n”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MYSQL_RES * rs_metadata = mysql_stmt_result_metadata（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    test_stmt_error（stmt，rs_metadata == NULL）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fields = mysql_fetch_fields（rs_metadata）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    rs_bind =（MYSQL_BIND *）malloc（sizeof（MYSQL_BIND）* num_fields）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if（！rs_bind）</font></font><font></font>
    {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“无法分配输出缓冲区\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      出口（1）;</font></font><font></font>
    }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    memset（rs_bind，0，sizeof（MYSQL_BIND）* num_fields）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *设置并绑定结果集输出缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for（i = 0; i &lt;num_fields; ++ i）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      rs_bind [i] .buffer_type = fields [i] .type;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      rs_bind [i] .is_null =＆is_null [i];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      switch（fields [i] .type）</font></font><font></font>
      {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        case MYSQL_TYPE_LONG：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          rs_bind [i] .buffer =（char *）＆（int_data [i]）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          rs_bind [i] .buffer_length = sizeof（int_data）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          打破;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        默认：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          fprintf（stderr，“错误：意外类型：％d。\ n”，fields [i] .type）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          出口（1）;</font></font><font></font>
      }<font></font>
    }<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    status = mysql_stmt_bind_result（stmt，rs_bind）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    test_stmt_error（stmt，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *获取并显示结果集行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    而（1）</font></font><font></font>
    {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      status = mysql_stmt_fetch（stmt）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      if（status == 1 || status == MYSQL_NO_DATA）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        打破;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      for（i = 0; i &lt;num_fields; ++ i）</font></font><font></font>
      {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        开关（rs_bind [i] .buffer_type）</font></font><font></font>
        {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          case MYSQL_TYPE_LONG：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if（* rs_bind [i] .is_null）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              printf（“val [％d] = NULL;”，i）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              printf（“val [％d] =％ld;”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     我，（长）*（（int *）rs_bind [i] .buffer））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            打破;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          默认：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            printf（“意外类型（％d）\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              rs_bind [I] .buffer_type）;</font></font><font></font>
        }<font></font>
      }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      的printf（ “\ n”）;</font></font><font></font>
    }<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    了mysql_free_result（rs_metadata）; </font><font style="vertical-align: inherit;">/ *免费元数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    自由（rs_bind）; </font><font style="vertical-align: inherit;">/ *免费输出缓冲区* /</font></font><font></font>
  }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font>
  {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / * no columns =最终状态包* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“程序结束输出\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  /* 更多结果？</font><font style="vertical-align: inherit;">-1 =不，&gt; 0 =错误，0 =是（继续寻找）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  status = mysql_stmt_next_result（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（status&gt; 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    test_stmt_error（stmt，status）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} while（status == 0）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_stmt_close（语句）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      执行该程序应产生以下输出：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果中的列数：3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数据：此结果集由过程生成</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 val [0] = 10; </font><font style="vertical-align: inherit;">choice [1] = NULL; </font><font style="vertical-align: inherit;">val [2] = 30;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果中的列数：3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数据：此结果集由过程生成</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 val [0] = 100; </font><font style="vertical-align: inherit;">val [1] = 200; </font><font style="vertical-align: inherit;">val [2] = 300;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果中的列数：2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数据：此结果集包含OUT / INOUT参数</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 val [0] = 200; </font><font style="vertical-align: inherit;">val [1] = 300;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
程序结束输出</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该代码使用两个实用程序例程，
       </font></font><code class="literal">test_error()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
       </font></font><code class="literal">test_stmt_error()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查错误并在发生错误时打印诊断信息后终止：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">static void test_error（MYSQL * mysql，int status）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（状态）</font></font><font></font>
  {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误：％s（错误号：％d）\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            mysql_error（mysql），mysql_errno（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font>
  }<font></font>
}<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
static void test_stmt_error（MYSQL_STMT * stmt，int status）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（状态）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误：％s（错误号：％d）\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            mysql_stmt_error（stmt），mysql_stmt_errno（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-problems"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.26 C API准备语句问题</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      下面列出了已准备好的语句当前已知的问题：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持秒的部分（例如，来自
           </font></font><a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091545876304"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

          将整数转换为字符串时，</font></font><code class="literal">ZEROFILL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在MySQL服务器不打印前导零的某些情况下</font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">会使用预准备语句。</font><font style="vertical-align: inherit;">（例如，
           </font><font style="vertical-align: inherit;">）。
        </font></font><a class="link" href="functions.html#function_min"><code class="literal">MIN(<em class="replaceable"><code>number-with-zerofill</code></em>)</code></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将浮点数转换为客户端中的字符串时，转换后的值的最右侧数字可能与原始值的数字略有不同。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          Prepared语句不支持多语句（即，由</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符</font><font style="vertical-align: inherit;">分隔的单个字符串中的多个语句
           </font><font style="vertical-align: inherit;">）。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><a class="xref" href="connectors-apis.html#c-api-prepared-call-statements" title="28.7.25 C API准备CALL语句支持"><font style="vertical-align: inherit;">第28.7.25节“C API准备的CALL语句支持”</font></a></font><a class="link" href="sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中描述了</font></font><a class="xref" href="connectors-apis.html#c-api-prepared-call-statements" title="28.7.25 C API准备CALL语句支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          准备</font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">的功能
           </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-optional-metadata"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.27 C API可选结果集元数据</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091545865648"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      当客户端执行生成结果集的语句时，默认情况下，MySQL既提供结果集包含的数据，也提供结果集元数据，提供有关结果集数据的信息。</font><font style="vertical-align: inherit;">元数据被包含在所述
       </font></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构（见
       </font></font><a class="xref" href="connectors-apis.html#c-api-data-structures" title="28.7.5 C API数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">章节28.7.5，“C API数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），这是由返回的
       </font></font><a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="connectors-apis.html#mysql-fetch-field-direct" title="28.7.7.18 mysql_fetch_field_direct（）"><code class="literal">mysql_fetch_field_direct()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="connectors-apis.html#mysql-fetch-fields" title="28.7.7.19 mysql_fetch_fields（）"><code class="literal">mysql_fetch_fields()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      客户端可以基于每个连接指示结果集元数据是可选的，并且客户端将向服务器指示是否返回它。</font><font style="vertical-align: inherit;">抑制元数据传输可以提高性能，特别是对于执行许多查询的会话，每个查询返回几行。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有两种方法可以指示结果集元数据对于连接是可选的。</font><font style="vertical-align: inherit;">它们是等价的，所以任何一个都足够了：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在连接时，启用</font><font style="vertical-align: inherit;">参数
           </font><font style="vertical-align: inherit;">的
           </font></font><code class="literal">CLIENT_OPTIONAL_RESULTSET_METADATA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志</font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">client_flag</code><font style="vertical-align: inherit;"></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在连接时间之前，启用
           </font></font><code class="literal">MYSQL_OPT_OPTIONAL_RESULTSET_METADATA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          选项</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于元数据可选连接，客户端设置
       </font></font><a class="link" href="server-administration.html#sysvar_resultset_metadata"><code class="literal">resultset_metadata</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量以控制服务器是否返回结果集元数据。</font><font style="vertical-align: inherit;">允许的值是</font></font><code class="literal">FULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（返回所有元数据;这是默认值）和</font></font><code class="literal">NONE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（不返回元数据）。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于元数据的可选连接，
       </font></font><a class="link" href="connectors-apis.html#mysql-fetch-field" title="28.7.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="connectors-apis.html#mysql-fetch-field-direct" title="28.7.7.18 mysql_fetch_field_direct（）"><code class="literal">mysql_fetch_field_direct()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
       </font></font><a class="link" href="connectors-apis.html#mysql-fetch-fields" title="28.7.7.19 mysql_fetch_fields（）"><code class="literal">mysql_fetch_fields()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时的
       </font></font><a class="link" href="server-administration.html#sysvar_resultset_metadata"><code class="literal">resultset_metadata</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量被设置为</font></font><code class="literal">NONE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要检查结果集是否包含元数据，请使用该
       </font></font><a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62 mysql_result_metadata（）"><code class="literal">mysql_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能。</font><font style="vertical-align: inherit;">此函数返回</font></font><code class="literal">RESULTSET_METADATA_FULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      或</font></font><code class="literal">RESULTSET_METADATA_NONE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示结果集分别具有完整元数据或没有元数据。
    </font></font></p><p>
      <a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62 mysql_result_metadata（）"><code class="literal">mysql_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果客户端事先不知道结果集是否具有元数据，则可能很有用。</font><font style="vertical-align: inherit;">例如，如果客户端执行返回多个结果集并可能更改</font></font><a class="link" href="server-administration.html#sysvar_resultset_metadata"><code class="literal">resultset_metadata</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">的存储过程
       </font><font style="vertical-align: inherit;">，则客户端可以</font></font><a class="link" href="connectors-apis.html#mysql-result-metadata" title="28.7.7.62 mysql_result_metadata（）"><code class="literal">mysql_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为每个结果集</font><font style="vertical-align: inherit;">调用
       </font><font style="vertical-align: inherit;">以确定它是否具有元数据。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于非元数据可选的连接，设置
       </font></font><a class="link" href="server-administration.html#sysvar_resultset_metadata"><code class="literal">resultset_metadata</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为
       </font></font><code class="literal">NONE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">产生错误。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-auto-reconnect"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.28 C API自动重新连接控制</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091545828752"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果MySQL客户端库在您尝试将语句发送到要执行的服务器时发现连接已关闭，则可以执行自动重新连接到服务器。</font><font style="vertical-align: inherit;">如果启用了自动重新连接，则库会尝试重新连接到服务器并再次发送语句。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      默认情况下禁用自动重新连接。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果您的应用程序知道连接已被删除（以便它可以退出或采取措施来调整状态信息的丢失），那么请确保禁用自动重新连接。</font><font style="vertical-align: inherit;">要确保这一点，请</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用以下
       </font></font><code class="literal">MYSQL_OPT_RECONNECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">调用
       </font><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bool reconnect = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（＆mysql，MYSQL_OPT_RECONNECT，＆reconnect）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果连接断开，则效果
       </font></font><a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于自动重新连接状态。</font><font style="vertical-align: inherit;">如果启用了自动重新连接，请
       </font></font><a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行重新连接。</font><font style="vertical-align: inherit;">否则，它会返回错误。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      某些客户端程序可能提供控制自动重新连接的功能。</font><font style="vertical-align: inherit;">例如，</font></font><a class="link" href="programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
      默认重新连接，但该
       </font></font><a class="link" href="programs.html#option_mysql_reconnect"><code class="option">--skip-reconnect</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      选项可用于抑制此行为。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果确实发生了自动重新连接（例如，作为调用的结果</font></font><a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），则没有明确的指示。</font><font style="vertical-align: inherit;">要检查重新连接，请
       </font></font><a class="link" href="connectors-apis.html#mysql-thread-id" title="28.7.7.80 mysql_thread_id（）"><code class="literal">mysql_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在呼叫前调用以获取原始连接标识符
       </font></font><a class="link" href="connectors-apis.html#mysql-ping" title="28.7.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后</font></font><a class="link" href="connectors-apis.html#mysql-thread-id" title="28.7.7.80 mysql_thread_id（）"><code class="literal">mysql_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再次</font><font style="vertical-align: inherit;">调用
       </font><font style="vertical-align: inherit;">以查看标识符是否已更改。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      自动重新连接可能很方便，因为您无需实现自己的重新连接代码，但如果确实发生了重新连接，则会在服务器端重置连接状态的多个方面，并且不会通知您的应用程序。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      与连接相关的状态受影响如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          回滚任何活动事务并重置自动提交模式。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所有表锁都被释放。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所有</font></font><code class="literal">TEMPORARY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表都关闭（并删除）。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          会话系统变量被重新初始化为相应的全局系统变量的值，包括由诸如的语句隐式设置的系统变量
           </font></font><a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          用户变量设置丢失。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          准备好的声明已经发布。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER语法"><code class="literal">HANDLER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 变量已关闭。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          重置为0。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          获得的锁</font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          被释放。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          客户端与</font></font><a class="link" href="performance-schema.html#threads-table" title="26.12.17.5线程表"><code class="literal">threads</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确定连接线程检测</font><font style="vertical-align: inherit;">的性能模式
           </font><font style="vertical-align: inherit;">表行的关联将丢失。</font><font style="vertical-align: inherit;">如果客户端在断开连接后重新连接，则会话与</font></font><a class="link" href="performance-schema.html#threads-table" title="26.12.17.5线程表"><code class="literal">threads</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表中</font><font style="vertical-align: inherit;">的新行相关联，</font><font style="vertical-align: inherit;">并且线程监视状态可能不同。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="performance-schema.html#threads-table" title="26.12.17.5线程表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第26.12.17.5节“线程表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果发生重新连接，</font><font style="vertical-align: inherit;">则重新执行</font><font style="vertical-align: inherit;">通过调用</font></font><a class="link" href="connectors-apis.html#mysql-options" title="28.7.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该
       </font></font><code class="literal">MYSQL_INIT_COMMAND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">指定的任何SQL语句
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果连接断开，则如果服务器尚未检测到客户端不再连接，则与服务器端连接关联的会话可能仍在运行。</font><font style="vertical-align: inherit;">在这种情况下，原始连接所持有的任何锁仍属于该会话，因此您可能希望通过调用将其终止</font></font><a class="link" href="connectors-apis.html#mysql-kill" title="28.7.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-common-issues"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.29 C API常见问题</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#null-mysql-store-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.29.1为什么mysql_store_result（）有时在mysql_query（）返回Success后返回NULL</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#query-results"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.29.2您可以从查询中获得什么结果</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#getting-unique-id"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.29.3如何获取上次插入行的唯一ID</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091545785456"></a><a class="indexterm" name="idm140091545783968"></a>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="null-mysql-store-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.29.1为什么mysql_store_result（）有时在mysql_query（）返回Success后返回NULL</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140091545781328"></a><a class="indexterm" name="idm140091545780288"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这是可能的
         </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
         </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下成功调用
         </font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">发生这种情况时，表示发生以下一种情况：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有一个</font></font><code class="literal">malloc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">故障（例如，如果结果集过大）。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            无法读取数据（连接发生错误）。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            该查询返回任何数据（例如，它是一个
             </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您始终可以通过调用来检查语句是否应该产生非空结果
         </font></font><a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
         </font></font><a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回零，则结果为空，最后一个查询是不返回值的语句（例如，a
         </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或a
         </font></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">如果
         </font></font><a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非零值，则该语句应该产生非空结果。</font><font style="vertical-align: inherit;">有关</font></font><a class="link" href="connectors-apis.html#mysql-field-count" title="28.7.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例，</font><font style="vertical-align: inherit;">请参阅该
         </font><font style="vertical-align: inherit;">函数的说明。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您可以通过调用</font></font><a class="link" href="connectors-apis.html#mysql-error" title="28.7.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font><font style="vertical-align: inherit;">测试错误
         </font></font><a class="link" href="connectors-apis.html#mysql-errno" title="28.7.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="query-results"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.29.2您可以从查询中获得什么结果</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091545755728"></a><a class="indexterm" name="idm140091545754688"></a><a class="indexterm" name="idm140091545753616"></a><a class="indexterm" name="idm140091545752544"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除了查询返回的结果集之外，您还可以获得以下信息：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在执行</font><font style="vertical-align: inherit;">，或
             </font><font style="vertical-align: inherit;">时</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font><font style="vertical-align: inherit;">返回上一个查询所影响的行数</font><font style="vertical-align: inherit;">。
          </font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要快速重新创建，请使用</font></font><a class="link" href="sql-syntax.html#truncate-table" title="13.1.37 TRUNCATE TABLE语法"><code class="literal">TRUNCATE
            TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回结果集中的行数。</font><font style="vertical-align: inherit;">随着
             </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以尽快
             </font></font><a class="link" href="connectors-apis.html#mysql-store-result" title="28.7.7.79 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            回来。</font><font style="vertical-align: inherit;">使用
             </font></font><a class="link" href="connectors-apis.html#mysql-use-result" title="28.7.7.81 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="connectors-apis.html#mysql-num-rows" title="28.7.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只有在您获取了所有行后才可以调用
             </font></font><a class="link" href="connectors-apis.html#mysql-fetch-row" title="28.7.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将插入行的最后一个查询生成的ID返回到带</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引</font><font style="vertical-align: inherit;">的表中</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.38节“mysql_insert_id（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            某些查询（</font></font><a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA语法"><code class="literal">LOAD DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="sql-syntax.html#insert-select" title="13.2.6.1 INSERT ... SELECT语法"><code class="literal">INSERT INTO
            ... SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）返回的附加信息。</font><font style="vertical-align: inherit;">结果返回
             </font></font><a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关</font></font><a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            它返回的字符串格式，</font><font style="vertical-align: inherit;">请参阅说明</font><font style="vertical-align: inherit;">。
            </font><font style="vertical-align: inherit;">如果没有其他信息，则</font></font><a class="link" href="connectors-apis.html#mysql-info" title="28.7.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="getting-unique-id"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.7.29.3如何获取上次插入行的唯一ID</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091545719680"></a><a class="indexterm" name="idm140091545718640"></a><a class="indexterm" name="idm140091545717568"></a><a class="indexterm" name="idm140091545716496"></a><a class="indexterm" name="idm140091545715008"></a><a class="indexterm" name="idm140091545713552"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果将记录插入到包含</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的表中
         </font><font style="vertical-align: inherit;">，则可以通过调用该</font></font><a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">来获取存储在该列中的值
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您可以</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过执行以下代码（假设您已检查语句成功）</font><font style="vertical-align: inherit;">从C应用程序检查值是否存储在</font><font style="vertical-align: inherit;">列中。</font><font style="vertical-align: inherit;">它确定查询是否</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带
         </font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引：
      </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if（（result = mysql_store_result（＆mysql））== 0 &amp;&amp;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    mysql_field_count（＆mysql）== 0 &amp;&amp;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    mysql_insert_id（＆mysql）！= 0）</font></font><font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    used_id = mysql_insert_id（＆mysql）;</font></font><font></font>
}<font></font>
</pre><p><font style="vertical-align: inherit;"></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成</font><font style="vertical-align: inherit;">
        新</font><font style="vertical-align: inherit;">值时，您还可以通过执行</font></font><code class="literal">SELECT
        LAST_INSERT_ID()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句
         </font></font><a class="link" href="connectors-apis.html#mysql-query" title="28.7.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并从语句返回的结果集中检索值来</font><font style="vertical-align: inherit;">获取它</font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        插入多个值时，将返回最后一个自动递增的值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        因为</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，最近生成的ID是基于每个连接在服务器中维护的。</font><font style="vertical-align: inherit;">它不会被其他客户更改。</font><font style="vertical-align: inherit;">如果您</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用非魔法值</font><font style="vertical-align: inherit;">更新另一</font><font style="vertical-align: inherit;">列（即，不是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和不是
         </font><font style="vertical-align: inherit;">的值），</font><font style="vertical-align: inherit;">它甚至不会更改
         </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">从多个客户端同时</font><font style="vertical-align: inherit;">使用
         </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列是完全有效的。</font><font style="vertical-align: inherit;">每个客户端将收到最后插入的ID为最后一条语句
         </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端执行。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果要使用为一个表生成的ID并将其插入第二个表，则可以使用如下SQL语句：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INSERT INTO foo（自动，文本）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    VALUES（NULL， '文本'）; </font><font style="vertical-align: inherit;">＃通过插入NULL生成ID</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INSERT INTO foo2（id，text）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    VALUES（LAST_INSERT_ID（）， '文本'）; </font><font style="vertical-align: inherit;">＃在第二个表中使用ID</font></font><font></font>
</pre><p>
        <a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回存储到一个值</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中，是否该值是自动通过存储生成
         </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或指定为一个显式值。
        </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅返回自动生成的</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        值。</font><font style="vertical-align: inherit;">如果存储除</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font><font style="vertical-align: inherit;">之外的显式值
         </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则不会影响返回的值
         </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关获取</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">最后一个ID的更多信息
         </font><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关
             </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可在SQL语句中使用的信息，请参见
             </font></font><a class="xref" href="functions.html#information-functions" title="12.15信息功能"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.15节“信息函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关</font></font><a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您在C API中使用的函数的</font><font style="vertical-align: inherit;">信息
             </font><font style="vertical-align: inherit;">，请参见
             </font></font><a class="xref" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.38节“mysql_insert_id（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关使用Connector / J时获取自动递增值的信息，请参阅
             </font><a class="ulink" href="https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-usagenotes-last-insert-id.html" target="_top"><font style="vertical-align: inherit;">通过JDBC </font></a></font><a class="ulink" href="https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-usagenotes-last-insert-id.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列值</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关使用Connector / ODBC时</font></font><a class="ulink" href="https://dev.mysql.com/doc/connector-odbc/en/connector-odbc-usagenotes-functionality-last-insert-id.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取自动递增值的信息</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请参阅
             </font><a class="ulink" href="https://dev.mysql.com/doc/connector-odbc/en/connector-odbc-usagenotes-functionality-last-insert-id.html" target="_top"><font style="vertical-align: inherit;">获取自动递增值</font></a><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-php-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.8 MySQL PHP API</font></font></h2>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL PHP API手册现在以独立形式发布，而不是作为MySQL参考手册的一部分。</font><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="https://dev.mysql.com/doc/apis-php/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL和PHP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-perl"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.9 MySQL Perl API</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091545668704"></a><a class="indexterm" name="idm140091545667248"></a><a class="indexterm" name="idm140091545666176"></a><a class="indexterm" name="idm140091545665104"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Perl </font></font><code class="literal">DBI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块为数据库访问提供通用接口。</font><font style="vertical-align: inherit;">您可以编写一个DBI脚本，该脚本可以在不做任何更改的情 </font><font style="vertical-align: inherit;">要将DBI与MySQL一起使用，请安装以下命令：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><code class="literal">DBI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><code class="literal">DBD::mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块。</font><font style="vertical-align: inherit;">这是Perl的数据库驱动程序（DBD）模块。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        （可选）DBD模块，用于您要访问的任何其他类型的数据库服务器。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Perl DBI是推荐的Perl接口。</font><font style="vertical-align: inherit;">它取代了一个名为的旧接口</font></font><code class="literal">mysqlperl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，应该被认为是过时的。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    这些部分包含有关在Perl中使用Perl和在Perl中编写MySQL应用程序的信息：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关Perl DBI支持的安装说明，请参见
         </font></font><a class="xref" href="installing.html#perl-support" title="2.13 Perl安装说明"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.13节“Perl安装说明”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关从选项文件中读取选项的示例，请参见
         </font></font><a class="xref" href="server-administration.html#multiple-server-clients" title="5.8.4在多服务器环境中使用客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.8.4节“在多服务器环境中使用客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关安全编码提示，请参见
         </font></font><a class="xref" href="security.html#security-guidelines" title="6.1.1安全指南"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.1.1节“安全准则”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关调试技​​巧，请参见</font></font><a class="xref" href="extending-mysql.html#using-gdb-on-mysqld" title="29.5.1.4在gdb下调试mysqld"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第29.5.1.4节“在gdb下调试mysqld”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关特定于Perl的环境变量，请参见
         </font></font><a class="xref" href="programs.html#environment-variables" title="4.9 MySQL程序环境变量"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.9节“MySQL程序环境变量”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关在OS X上运行的注意事项，请参见
         </font></font><a class="xref" href="installing.html#osx-installation" title="2.4在macOS上安装MySQL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.4节“在macOS上安装MySQL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关引用字符串文字的方法，请参见
         </font></font><a class="xref" href="language-structure.html#string-literals" title="9.1.1字符串文字"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9.1.1节“字符串文字”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    DBI信息可在命令行，在线或打印形式获得：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        一旦你拥有了</font></font><code class="literal">DBI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="literal">DBD::mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装的模块，你可以用命令行中获得关于它们的信息
         </font></font><code class="literal">perldoc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令：
      </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shell&gt; </font></font><strong class="userinput"><code>perldoc DBI</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
shell&gt; </font></font><strong class="userinput"><code>perldoc DBI::FAQ</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
shell&gt;</font></font><strong class="userinput"><code>perldoc DBD::mysql</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您还可以使用</font></font><code class="literal">pod2man</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><code class="literal">pod2html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等等将此信息转换为其他格式。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关Perl DBI的在线信息，请访问DBI网站
         </font></font><a class="ulink" href="http://dbi.perl.org/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://dbi.perl.org/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该站点拥有一个通用的DBI邮件列表。</font><font style="vertical-align: inherit;">Oracle Corporation专门列出了一个列表</font></font><code class="literal">DBD::mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">请参见
         </font></font><a class="xref" href="introduction.html#mailing-lists" title="1.6.2 MySQL邮件列表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1.6.2节“MySQL邮件列表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关印刷信息，官方DBI书籍是
         </font></font><em class="citetitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perl DBI编程</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Alligator Descartes和Tim Bunce，O'Reilly＆Associates，2000）。</font><font style="vertical-align: inherit;">有关该书的信息，请访问DBI网站
         </font></font><a class="ulink" href="http://dbi.perl.org/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://dbi.perl.org/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-python"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.10 MySQL Python API</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091545628416"></a><p>
    <code class="literal">MySQLdb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是第三方驱动程序，提供Python的Python支持，符合Python DB API 2.0版。</font><font style="vertical-align: inherit;">它可以在</font></font><a class="ulink" href="http://sourceforge.net/projects/mysql-python/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://sourceforge.net/projects/mysql-python/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到
     </font><font style="vertical-align: inherit;">。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    新的MySQL Connector / Python组件提供了相同Python API的接口，并内置在MySQL服务器中并由Oracle提供支持。</font><font style="vertical-align: inherit;">有关</font></font><a class="ulink" href="https://dev.mysql.com/doc/connector-python/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connector</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的详细信息，</font><font style="vertical-align: inherit;">请参阅</font><a class="ulink" href="https://dev.mysql.com/doc/connector-python/en/" target="_top"><font style="vertical-align: inherit;">MySQL Connector / Python开发人员指南</font></a><font style="vertical-align: inherit;">，以及Python应用程序和Python代码示例的编码指南。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-ruby"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.11 MySQL Ruby API</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="connectors-apis.html#apis-ruby-mysqlruby"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.11.1 MySQL / Ruby API</font></font></a></span></dt><dt><span class="section"><a href="connectors-apis.html#apis-ruby-rubymysql"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.11.2 Ruby / MySQL API</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091545622144"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    开发MySQL应用程序的Ruby程序员可以使用两个API：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL / Ruby API基于
         </font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API库。</font><font style="vertical-align: inherit;">有关安装和使用MySQL / Ruby API的信息，请参见
         </font></font><a class="xref" href="connectors-apis.html#apis-ruby-mysqlruby" title="28.11.1 MySQL / Ruby API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.11.1节“MySQL / Ruby API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        Ruby / MySQL API编写为使用本机MySQL网络协议（本机驱动程序）。</font><font style="vertical-align: inherit;">有关安装和使用Ruby / MySQL API的信息，请参见
         </font></font><a class="xref" href="connectors-apis.html#apis-ruby-rubymysql" title="28.11.2 Ruby / MySQL API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.11.2节“Ruby / MySQL API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    有关Ruby语言的背景和语法信息，请参阅
     </font></font><a class="ulink" href="http://www.ruby-lang.org" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ruby Programming Language</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="apis-ruby-mysqlruby"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.11.1 MySQL / Ruby API</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL / Ruby模块使用Ruby提供对MySQL数据库的访问</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关安装模块和公开的函数的信息，请参阅
       </font></font><a class="ulink" href="http://tmtm.org/en/mysql/ruby/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL / Ruby</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="apis-ruby-rubymysql"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.11.2 Ruby / MySQL API</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Ruby / MySQL模块使用MySQL网络协议通过本机驱动程序接口使用Ruby访问MySQL数据库。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关安装模块和公开的函数的信息，请参阅
       </font></font><a class="ulink" href="http://tmtm.org/en/ruby/mysql/README_en.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ruby / MySQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-tcl"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.12 MySQL Tcl API</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091545606912"></a><p>
    <code class="literal">MySQLtcl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个用于从</font></font><a class="ulink" href="http://en.wikipedia.org/wiki/Tcl" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tcl编程语言</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">访问MySQL数据库服务器的简单API
     </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它可以在</font></font><a class="ulink" href="http://www.xdobry.de/mysqltcl/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.xdobry.de/mysqltcl/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到
     </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-eiffel"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.13 MySQL Eiffel Wrapper</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091545601872"></a><a class="indexterm" name="idm140091545600832"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Eiffel MySQL是使用</font><font style="vertical-align: inherit;">由Michael Ravits编写</font><font style="vertical-align: inherit;">的</font></font><a class="ulink" href="http://en.wikipedia.org/wiki/Eiffel_(programming_language)" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eiffel编程语言</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的MySQL数据库服务器的接口
     </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它可以在</font></font><a class="ulink" href="http://efsa.sourceforge.net/archive/ravits/mysql.htm" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://efsa.sourceforge.net/archive/ravits/mysql.htm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到
     </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="copyright-footer">

</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tbody><tr>
<td width="40%" align="left"><a accesskey="p" href="sys-schema.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a></td>
<td width="20%" align="center"><a accesskey="u" href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向上</font></font></a></td>
<td width="40%" align="right">&nbsp;<a accesskey="n" href="extending-mysql.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个</font></font></a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27章MySQL sys Schema</font></font></td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">家</font></font></a></td>
<td width="40%" align="right" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第29章扩展MySQL</font></font></td>
</tr>
</tbody></table>
</div>


