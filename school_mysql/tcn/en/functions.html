<!--?xml version="1.0" encoding="utf-8"?-->



<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Chapter&nbsp;12 Functions and Operators</title>
<link rel="stylesheet" href="mvl.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2">
<link rel="start" href="index.html" title="{书名}">
<link rel="up" href="" title="">
<link rel="prev" href="data-types.html" title="第11章数据类型">
<link rel="next" href="sql-syntax.html" title="第13章SQL语句语法">


<div class="navheader">
<table width="100%" summary="Navigation header">
<tbody><tr>
<th colspan="3" align="center">Chapter&nbsp;12 Functions and Operators</th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="data-types.html">Prev</a>&nbsp;</td>
<th width="60%" align="center"></th>
<td width="20%" align="right">&nbsp;<a accesskey="n" href="sql-syntax.html">Next</a></td>
</tr>
</tbody></table>
<hr>
</div>
<div class="chapter">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="functions"></a>Chapter&nbsp;12&nbsp;Functions and Operators</h1>

</div>

</div>

</div>
<div class="toc">
<p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="functions.html#func-op-summary-ref">12.1 Function and Operator Reference</a></span></dt><dt><span class="section"><a href="functions.html#type-conversion">12.2 Type Conversion in Expression Evaluation</a></span></dt><dt><span class="section"><a href="functions.html#non-typed-operators">12.3 Operators</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#operator-precedence">12.3.1 Operator Precedence</a></span></dt><dt><span class="section"><a href="functions.html#comparison-operators">12.3.2 Comparison Functions and Operators</a></span></dt><dt><span class="section"><a href="functions.html#logical-operators">12.3.3 Logical Operators</a></span></dt><dt><span class="section"><a href="functions.html#assignment-operators">12.3.4 Assignment Operators</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#control-flow-functions">12.4 Control Flow Functions</a></span></dt><dt><span class="section"><a href="functions.html#string-functions">12.5 String Functions</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#string-comparison-functions">12.5.1 String Comparison Functions</a></span></dt><dt><span class="section"><a href="functions.html#regexp">12.5.2 Regular Expressions</a></span></dt><dt><span class="section"><a href="functions.html#string-functions-charset">12.5.3 Character Set and Collation of Function Results</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#numeric-functions">12.6 Numeric Functions and Operators</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#arithmetic-functions">12.6.1 Arithmetic Operators</a></span></dt><dt><span class="section"><a href="functions.html#mathematical-functions">12.6.2 Mathematical Functions</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#date-and-time-functions">12.7 Date and Time Functions</a></span></dt><dt><span class="section"><a href="functions.html#mysql-calendar">12.8 What Calendar Is Used By MySQL?</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search">12.9 Full-Text Search Functions</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#fulltext-natural-language">12.9.1 Natural Language Full-Text Searches</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-boolean">12.9.2 Boolean Full-Text Searches</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-query-expansion">12.9.3 Full-Text Searches with Query Expansion</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-stopwords">12.9.4 Full-Text Stopwords</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-restrictions">12.9.5 Full-Text Restrictions</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-fine-tuning">12.9.6 Fine-Tuning MySQL Full-Text Search</a></span></dt><dt><span class="section"><a href="functions.html#full-text-adding-collation">12.9.7 Adding a Collation for Full-Text Indexing</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search-ngram">12.9.8 ngram Full-Text Parser</a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search-mecab">12.9.9 MeCab Full-Text Parser Plugin</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#cast-functions">12.10 Cast Functions and Operators</a></span></dt><dt><span class="section"><a href="functions.html#xml-functions">12.11 XML Functions</a></span></dt><dt><span class="section"><a href="functions.html#bit-functions">12.12 Bit Functions and Operators</a></span></dt><dt><span class="section"><a href="functions.html#encryption-functions">12.13 Encryption and Compression Functions</a></span></dt><dt><span class="section"><a href="functions.html#locking-functions">12.14 Locking Functions</a></span></dt><dt><span class="section"><a href="functions.html#information-functions">12.15 Information Functions</a></span></dt><dt><span class="section"><a href="functions.html#spatial-analysis-functions">12.16 Spatial Analysis Functions</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#spatial-function-reference">12.16.1 Spatial Function Reference</a></span></dt><dt><span class="section"><a href="functions.html#spatial-function-argument-handling">12.16.2 Argument Handling by Spatial Functions</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkt-functions">12.16.3 Functions That Create Geometry Values from WKT Values</a></span></dt><dt><span class="section"><a href="functions.html#gis-wkb-functions">12.16.4 Functions That Create Geometry Values from WKB Values</a></span></dt><dt><span class="section"><a href="functions.html#gis-mysql-specific-functions">12.16.5 MySQL-Specific Functions That Create Geometry Values</a></span></dt><dt><span class="section"><a href="functions.html#gis-format-conversion-functions">12.16.6 Geometry Format Conversion Functions</a></span></dt><dt><span class="section"><a href="functions.html#gis-property-functions">12.16.7 Geometry Property Functions</a></span></dt><dt><span class="section"><a href="functions.html#spatial-operator-functions">12.16.8 Spatial Operator Functions</a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions">12.16.9 Functions That Test Spatial Relations Between Geometry Objects</a></span></dt><dt><span class="section"><a href="functions.html#spatial-geohash-functions">12.16.10 Spatial Geohash Functions</a></span></dt><dt><span class="section"><a href="functions.html#spatial-geojson-functions">12.16.11 Spatial GeoJSON Functions</a></span></dt><dt><span class="section"><a href="functions.html#spatial-convenience-functions">12.16.12 Spatial Convenience Functions</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#json-functions">12.17 JSON Functions</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#json-function-reference">12.17.1 JSON Function Reference</a></span></dt><dt><span class="section"><a href="functions.html#json-creation-functions">12.17.2 Functions That Create JSON Values</a></span></dt><dt><span class="section"><a href="functions.html#json-search-functions">12.17.3 Functions That Search JSON Values</a></span></dt><dt><span class="section"><a href="functions.html#json-modification-functions">12.17.4 Functions That Modify JSON Values</a></span></dt><dt><span class="section"><a href="functions.html#json-attribute-functions">12.17.5 Functions That Return JSON Value Attributes</a></span></dt><dt><span class="section"><a href="functions.html#json-table-functions">12.17.6 JSON Table Functions</a></span></dt><dt><span class="section"><a href="functions.html#json-validation-functions">12.17.7 JSON Schema Validation Functions</a></span></dt><dt><span class="section"><a href="functions.html#json-utility-functions">12.17.8 JSON Utility Functions</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#gtid-functions">12.18 Functions Used with Global Transaction Identifiers (GTIDs)</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption">12.19 MySQL Enterprise Encryption Functions</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#enterprise-encryption-installation">12.19.1 MySQL Enterprise Encryption Installation</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-usage">12.19.2 MySQL Enterprise Encryption Usage and Examples</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-function-reference">12.19.3 MySQL Enterprise Encryption Function Reference</a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-functions">12.19.4 MySQL Enterprise Encryption Function Descriptions</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#group-by-functions-and-modifiers">12.20 Aggregate (GROUP BY) Functions</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#group-by-functions">12.20.1 Aggregate (GROUP BY) Function Descriptions</a></span></dt><dt><span class="section"><a href="functions.html#group-by-modifiers">12.20.2 GROUP BY Modifiers</a></span></dt><dt><span class="section"><a href="functions.html#group-by-handling">12.20.3 MySQL Handling of GROUP BY</a></span></dt><dt><span class="section"><a href="functions.html#group-by-functional-dependence">12.20.4 Detection of Functional Dependence</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#window-functions">12.21 Window Functions</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#window-function-descriptions">12.21.1 Window Function Descriptions</a></span></dt><dt><span class="section"><a href="functions.html#window-functions-usage">12.21.2 Window Function Concepts and Syntax</a></span></dt><dt><span class="section"><a href="functions.html#window-functions-frames">12.21.3 Window Function Frame Specification</a></span></dt><dt><span class="section"><a href="functions.html#window-functions-named-windows">12.21.4 Named Windows</a></span></dt><dt><span class="section"><a href="functions.html#window-function-restrictions">12.21.5 Window Function Restrictions</a></span></dt></dl></dd><dt><span class="section"><a href="functions.html#performance-schema-functions">12.22 Performance Schema Functions</a></span></dt><dt><span class="section"><a href="functions.html#internal-functions">12.23 Internal Functions</a></span></dt><dt><span class="section"><a href="functions.html#miscellaneous-functions">12.24 Miscellaneous Functions</a></span></dt><dt><span class="section"><a href="functions.html#precision-math">12.25 Precision Math</a></span></dt><dd><dl><dt><span class="section"><a href="functions.html#precision-math-numbers">12.25.1 Types of Numeric Values</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-decimal-characteristics">12.25.2 DECIMAL Data Type Characteristics</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-expressions">12.25.3 Expression Handling</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-rounding">12.25.4 Rounding Behavior</a></span></dt><dt><span class="section"><a href="functions.html#precision-math-examples">12.25.5 Precision Math Examples</a></span></dt></dl></dd></dl>
</div>
<a class="indexterm" name="idm140091690699088"></a><a class="indexterm" name="idm140091690697584"></a><a class="indexterm" name="idm140091690696512"></a><p>
    Expressions can be used at several points in
    <a class="link" href="glossary.html#glos_sql" title="SQL">SQL</a> statements, such as in the
    <code class="literal">ORDER BY</code> or <code class="literal">HAVING</code> clauses of
    <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a> statements, in the
    <code class="literal">WHERE</code> clause of a
    <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a>,
    <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a>, or
    <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a> statement, or in
    <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a>
    statements. Expressions can be written using literal values, column
    values, <code class="literal">NULL</code>, built-in functions, stored
    functions, user-defined functions, and operators. This chapter
    describes the functions and operators that are permitted for writing
    expressions in MySQL. Instructions for writing stored functions and
    user-defined functions are given in
    <a class="xref" href="stored-objects.html#stored-routines" title="24.2使用存储的例程">Section&nbsp;24.2, “Using Stored Routines”</a>, and
    <a class="xref" href="extending-mysql.html#adding-functions" title="29.4向MySQL添加新功能">Section&nbsp;29.4, “Adding New Functions to MySQL”</a>. See
    <a class="xref" href="language-structure.html#function-resolution" title="9.2.4函数名称解析和解析">Section&nbsp;9.2.4, “Function Name Parsing and Resolution”</a>, for the rules describing how
    the server interprets references to different kinds of functions.
  </p><p>
    An expression that contains <code class="literal">NULL</code> always produces
    a <code class="literal">NULL</code> value unless otherwise indicated in the
    documentation for a particular function or operator.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
      By default, there must be no whitespace between a function name
      and the parenthesis following it. This helps the MySQL parser
      distinguish between function calls and references to tables or
      columns that happen to have the same name as a function. However,
      spaces around function arguments are permitted.
</p>
</div>
<p>
    You can tell the MySQL server to accept spaces after function names
    by starting it with the
    <a class="link" href="server-administration.html#option_mysqld_sql-mode"><code class="option">--sql-mode=IGNORE_SPACE</code></a> option. (See
    <a class="xref" href="server-administration.html#sql-mode" title="5.1.11服务器SQL模式">Section&nbsp;5.1.11, “Server SQL Modes”</a>.) Individual client programs can request
    this behavior by using the <code class="literal">CLIENT_IGNORE_SPACE</code>
    option for <a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a>. In
    either case, all function names become reserved words.
  </p><p>
    For the sake of brevity, most examples in this chapter display the
    output from the <a class="link" href="programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行客户端"><span class="command"><strong>mysql</strong></span></a> program in abbreviated
    form. Rather than showing examples in this format:
  </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MOD(29,9);</code></strong><font></font>
+-----------+<font></font>
| mod(29,9) |<font></font>
+-----------+<font></font>
|         2 |<font></font>
+-----------+<font></font>
1 rows in set (0.00 sec)<font></font>
</pre><p>
    This format is used instead:
  </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MOD(29,9);</code></strong><font></font>
        -&gt; 2<font></font>
</pre>
<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="func-op-summary-ref"></a>12.1&nbsp;Function and Operator Reference</h2>
</div>
</div>
</div>

<div class="table">
<a name="idm140091690667840"></a><p class="title"><b>Table&nbsp;12.1&nbsp;Functions and Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists all functions and operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a></td>
<td>
      Return the absolute value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_acos"><code class="literal">ACOS()</code></a></td>
<td>
      Return the arc cosine
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_adddate"><code class="literal">ADDDATE()</code></a></td>
<td>
      Add time values (intervals) to a date value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_addtime"><code class="literal">ADDTIME()</code></a></td>
<td>
      Add time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a></td>
<td>
      Decrypt using AES
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a></td>
<td>
      Encrypt using AES
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_and"><code class="literal">AND</code>, <code class="literal">&amp;&amp;</code></a></td>
<td>
      Logical AND
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a></td>
<td>
      Suppress ONLY_FULL_GROUP_BY value rejection
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a></td>
<td>
      Return numeric value of left-most character
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asin"><code class="literal">ASIN()</code></a></td>
<td>
      Return the arc sine
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a></td>
<td>
      Assign a value (as part of a
      <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a>
      statement, or as part of the <code class="literal">SET</code> clause in an
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a> statement)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a></td>
<td>
      Assign a value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-decrypt"><code class="literal">ASYMMETRIC_DECRYPT()</code></a></td>
<td>
      Decrypt ciphertext using private or public key
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-derive"><code class="literal">ASYMMETRIC_DERIVE()</code></a></td>
<td>
      Derive symmetric key from asymmetric keys
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a></td>
<td>
      Encrypt cleartext using private or public key
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-sign"><code class="literal">ASYMMETRIC_SIGN()</code></a></td>
<td>
      Generate signature from digest
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-verify"><code class="literal">ASYMMETRIC_VERIFY()</code></a></td>
<td>
      Verify that signature matches digest
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_atan"><code class="literal">ATAN()</code></a></td>
<td>
      Return the arc tangent
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2()</code>, <code class="literal">ATAN()</code></a></td>
<td>
      Return the arc tangent of the two arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a></td>
<td>
      Return the average value of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a></td>
<td>
      Repeatedly execute an expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN ... AND ...</code></a></td>
<td>
      Check whether a value is within a range of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bin"><code class="literal">BIN()</code></a></td>
<td>
      Return a string containing binary representation of a number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a></td>
<td>
      Convert binary UUID to string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a></td>
<td>
      Cast a string to a binary string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a></td>
<td>
      Return bitwise AND
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-count"><code class="literal">BIT_COUNT()</code></a></td>
<td>
      Return the number of bits that are set
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-length"><code class="literal">BIT_LENGTH()</code></a></td>
<td>
      Return length of argument in bits
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a></td>
<td>
      Return bitwise OR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a></td>
<td>
      Return bitwise XOR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a></td>
<td>
      Bitwise AND
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a></td>
<td>
      Bitwise inversion
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a></td>
<td>
      Bitwise OR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a></td>
<td>
      Bitwise XOR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_can-access-column"><code class="literal">CAN_ACCESS_COLUMN()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_can-access-database"><code class="literal">CAN_ACCESS_DATABASE()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_can-access-table"><code class="literal">CAN_ACCESS_TABLE()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_can-access-view"><code class="literal">CAN_ACCESS_VIEW()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a></td>
<td>
      Case operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a></td>
<td>
      Cast a value as a certain type
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a></td>
<td>
      Return the smallest integer value not less than the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a></td>
<td>
      Return the smallest integer value not less than the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a></td>
<td>
      Return the character for each integer passed
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH()</code></a></td>
<td>
      Return number of characters in argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_character-length"><code class="literal">CHARACTER_LENGTH()</code></a></td>
<td>
      Synonym for CHAR_LENGTH()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_charset"><code class="literal">CHARSET()</code></a></td>
<td>
      Return the character set of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE()</code></a></td>
<td>
      Return the first non-NULL argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_coercibility"><code class="literal">COERCIBILITY()</code></a></td>
<td>
      Return the collation coercibility value of the string argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_collation"><code class="literal">COLLATION()</code></a></td>
<td>
      Return the collation of the string argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_compress"><code class="literal">COMPRESS()</code></a></td>
<td>
      Return result as a binary string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a></td>
<td>
      Return concatenated string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS()</code></a></td>
<td>
      Return concatenate with separator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a></td>
<td>
      Return the connection ID (thread ID) for the connection
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a></td>
<td>
      Convert numbers between different number bases
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a></td>
<td>
      Cast a value as a certain type
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a></td>
<td>
      Convert from one time zone to another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_cos"><code class="literal">COS()</code></a></td>
<td>
      Return the cosine
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_cot"><code class="literal">COT()</code></a></td>
<td>
      Return the cotangent
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a></td>
<td>
      Return a count of the number of rows returned
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_count-distinct"><code class="literal">COUNT(DISTINCT)</code></a></td>
<td>
      Return the count of a number of different values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_crc32"><code class="literal">CRC32()</code></a></td>
<td>
      Compute a cyclic redundancy check value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a></td>
<td>
      Create private key
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-pub-key"><code class="literal">CREATE_ASYMMETRIC_PUB_KEY()</code></a></td>
<td>
      Create public key
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a></td>
<td>
      Generate shared DH secret
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-digest"><code class="literal">CREATE_DIGEST()</code></a></td>
<td>
      Generate digest from string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_cume-dist"><code class="literal">CUME_DIST()</code></a></td>
<td>
      Cumulative distribution value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_curdate"><code class="literal">CURDATE()</code></a></td>
<td>
      Return the current date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE()</code>, <code class="literal">CURRENT_DATE</code></a></td>
<td>
      Synonyms for CURDATE()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-role"><code class="literal">CURRENT_ROLE()</code></a></td>
<td>
      Return the current active roles
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME()</code>, <code class="literal">CURRENT_TIME</code></a></td>
<td>
      Synonyms for CURTIME()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP()</code>, <code class="literal">CURRENT_TIMESTAMP</code></a></td>
<td>
      Synonyms for NOW()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code>, <code class="literal">CURRENT_USER</code></a></td>
<td>
      The authenticated user name and host name
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_curtime"><code class="literal">CURTIME()</code></a></td>
<td>
      Return the current time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a></td>
<td>
      Return the default (current) database name
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_date"><code class="literal">DATE()</code></a></td>
<td>
      Extract the date part of a date or datetime expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a></td>
<td>
      Add time values (intervals) to a date value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a></td>
<td>
      Format date as specified
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a></td>
<td>
      Subtract a time value (interval) from a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_datediff"><code class="literal">DATEDIFF()</code></a></td>
<td>
      Subtract two dates
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_day"><code class="literal">DAY()</code></a></td>
<td>
      Synonym for DAYOFMONTH()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dayname"><code class="literal">DAYNAME()</code></a></td>
<td>
      Return the name of the weekday
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofmonth"><code class="literal">DAYOFMONTH()</code></a></td>
<td>
      Return the day of the month (0-31)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofweek"><code class="literal">DAYOFWEEK()</code></a></td>
<td>
      Return the weekday index of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofyear"><code class="literal">DAYOFYEAR()</code></a></td>
<td>
      Return the day of the year (1-366)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_decode"><code class="literal">DECODE()</code></a></td>
<td>
      Decode a string encrypted using ENCODE()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_default"><code class="literal">DEFAULT()</code></a></td>
<td>
      Return the default value for a table column
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES()</code></a></td>
<td>
      Convert radians to degrees
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a></td>
<td>
      Rank of current row within its partition, without gaps
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_des-decrypt"><code class="literal">DES_DECRYPT()</code></a></td>
<td>
      Decrypt a string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_des-encrypt"><code class="literal">DES_ENCRYPT()</code></a></td>
<td>
      Encrypt a string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td>
<td>
      Integer division
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td>
<td>
      Division operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a></td>
<td>
      Return string at index number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_encode"><code class="literal">ENCODE()</code></a></td>
<td>
      Encode a string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_encrypt"><code class="literal">ENCRYPT()</code></a></td>
<td>
      Encrypt a string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a></td>
<td>
      Equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a></td>
<td>
      NULL-safe equal to operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a></td>
<td>
      Raise to the power of
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_export-set"><code class="literal">EXPORT_SET()</code></a></td>
<td>
      Return a string such that for every bit set in the value bits, you
      get an on string and for every unset bit, you get an off string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_extract"><code class="literal">EXTRACT()</code></a></td>
<td>
      Extract part of a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a></td>
<td>
      Extract a value from an XML string using XPath notation
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_field"><code class="literal">FIELD()</code></a></td>
<td>
      Index (position) of first argument in subsequent arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_find-in-set"><code class="literal">FIND_IN_SET()</code></a></td>
<td>
      Index (position) of first argument within second argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a></td>
<td>
      Value of argument from first row of window frame
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a></td>
<td>
      Return the largest integer value not greater than the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_format"><code class="literal">FORMAT()</code></a></td>
<td>
      Return a number formatted to specified number of decimal places
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_format-bytes"><code class="literal">FORMAT_BYTES()</code></a></td>
<td>
      Convert byte count to value with units
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_format-pico-time"><code class="literal">FORMAT_PICO_TIME()</code></a></td>
<td>
      Convert time in picoseconds to value with units
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a></td>
<td>
      For a SELECT with a LIMIT clause, the number of rows that would be
      returned were there no LIMIT clause
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_from-base64"><code class="literal">FROM_BASE64()</code></a></td>
<td>
      Decode base64 encoded string and return result
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_from-days"><code class="literal">FROM_DAYS()</code></a></td>
<td>
      Convert a day number to a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a></td>
<td>
      Format Unix timestamp as a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a></td>
<td>
      Construct geometry collection from geometries
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a></td>
<td>
      Construct geometry collection from geometries
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_get-dd-column-privileges"><code class="literal">GET_DD_COLUMN_PRIVILEGES()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_get-dd-create-options"><code class="literal">GET_DD_CREATE_OPTIONS()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_get-dd-index-sub-part-length"><code class="literal">GET_DD_INDEX_SUB_PART_LENGTH()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT()</code></a></td>
<td>
      Return a date format string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a></td>
<td>
      Get a named lock
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a></td>
<td>
      Greater than operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a></td>
<td>
      Greater than or equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST()</code></a></td>
<td>
      Return the largest argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_group-concat"><code class="literal">GROUP_CONCAT()</code></a></td>
<td>
      Return a concatenated string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a></td>
<td>
      Distinguish super-aggregate ROLLUP rows from regular rows
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_gtid-subset"><code class="literal">GTID_SUBSET()</code></a></td>
<td>
      Return true if all GTIDs in subset are also in set; otherwise
      false.
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_gtid-subtract"><code class="literal">GTID_SUBTRACT()</code></a></td>
<td>
      Return all GTIDs in set that are not in subset.
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a></td>
<td>
      Hexadecimal representation of decimal or string value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_hour"><code class="literal">HOUR()</code></a></td>
<td>
      Extract the hour
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_icu-version"><code class="literal">ICU_VERSION()</code></a></td>
<td>
      ICU library version
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a></td>
<td>
      If/else construct
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL()</code></a></td>
<td>
      Null if/else construct
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_in"><code class="literal">IN()</code></a></td>
<td>
      Check whether a value is within a set of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a></td>
<td>
      Return the numeric value of an IP address
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_inet-ntoa"><code class="literal">INET_NTOA()</code></a></td>
<td>
      Return the IP address from a numeric value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a></td>
<td>
      Return the numeric value of an IPv6 address
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_inet6-ntoa"><code class="literal">INET6_NTOA()</code></a></td>
<td>
      Return the IPv6 address from a numeric value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_insert"><code class="literal">INSERT()</code></a></td>
<td>
      Insert substring at specified position up to specified number of
      characters
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_instr"><code class="literal">INSTR()</code></a></td>
<td>
      Return the index of the first occurrence of substring
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-auto-increment"><code class="literal">INTERNAL_AUTO_INCREMENT()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-avg-row-length"><code class="literal">INTERNAL_AVG_ROW_LENGTH()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-check-time"><code class="literal">INTERNAL_CHECK_TIME()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-checksum"><code class="literal">INTERNAL_CHECKSUM()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-data-free"><code class="literal">INTERNAL_DATA_FREE()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-data-length"><code class="literal">INTERNAL_DATA_LENGTH()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-dd-char-length"><code class="literal">INTERNAL_DD_CHAR_LENGTH()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-get-comment-or-error"><code class="literal">INTERNAL_GET_COMMENT_OR_ERROR()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-get-view-warning-or-error"><code class="literal">INTERNAL_GET_VIEW_WARNING_OR_ERROR()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-index-column-cardinality"><code class="literal">INTERNAL_INDEX_COLUMN_CARDINALITY()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-index-length"><code class="literal">INTERNAL_INDEX_LENGTH()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-keys-disabled"><code class="literal">INTERNAL_KEYS_DISABLED()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-max-data-length"><code class="literal">INTERNAL_MAX_DATA_LENGTH()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-table-rows"><code class="literal">INTERNAL_TABLE_ROWS()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-update-time"><code class="literal">INTERNAL_UPDATE_TIME()</code></a></td>
<td>
      Internal use only
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_interval"><code class="literal">INTERVAL()</code></a></td>
<td>
      Return the index of the argument that is less than the first
      argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a></td>
<td>
      Test a value against a boolean
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-free-lock"><code class="literal">IS_FREE_LOCK()</code></a></td>
<td>
      Whether the named lock is free
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a></td>
<td>
      Whether argument is an IPv4 address
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4-compat"><code class="literal">IS_IPV4_COMPAT()</code></a></td>
<td>
      Whether argument is an IPv4-compatible address
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4-mapped"><code class="literal">IS_IPV4_MAPPED()</code></a></td>
<td>
      Whether argument is an IPv4-mapped address
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv6"><code class="literal">IS_IPV6()</code></a></td>
<td>
      Whether argument is an IPv6 address
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT</code></a></td>
<td>
      Test a value against a boolean
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not-null"><code class="literal">IS NOT NULL</code></a></td>
<td>
      NOT NULL value test
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a></td>
<td>
      NULL value test
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-used-lock"><code class="literal">IS_USED_LOCK()</code></a></td>
<td>
      Whether the named lock is in use; return connection identifier if
      true
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-uuid"><code class="literal">IS_UUID()</code></a></td>
<td>
      Whether argument is a valid UUID
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL()</code></a></td>
<td>
      Test whether the argument is NULL
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-array"><code class="literal">JSON_ARRAY()</code></a></td>
<td>
      Create JSON array
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-array-append"><code class="literal">JSON_ARRAY_APPEND()</code></a></td>
<td>
      Append data to JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-array-insert"><code class="literal">JSON_ARRAY_INSERT()</code></a></td>
<td>
      Insert into JSON array
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-arrayagg"><code class="literal">JSON_ARRAYAGG()</code></a></td>
<td>
      Return result set as a single JSON array
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a></td>
<td>
      Return value from JSON column after evaluating path; equivalent to
      JSON_EXTRACT().
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-contains"><code class="literal">JSON_CONTAINS()</code></a></td>
<td>
      Whether JSON document contains specific object at path
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-contains-path"><code class="literal">JSON_CONTAINS_PATH()</code></a></td>
<td>
      Whether JSON document contains any data at path
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-depth"><code class="literal">JSON_DEPTH()</code></a></td>
<td>
      Maximum depth of JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-extract"><code class="literal">JSON_EXTRACT()</code></a></td>
<td>
      Return data from JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_json-inline-path"><code class="literal">-&gt;&gt;</code></a></td>
<td>
      Return value from JSON column after evaluating path and unquoting
      the result; equivalent to JSON_UNQUOTE(JSON_EXTRACT()).
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a></td>
<td>
      Insert data into JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-keys"><code class="literal">JSON_KEYS()</code></a></td>
<td>
      Array of keys from JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-length"><code class="literal">JSON_LENGTH()</code></a></td>
<td>
      Number of elements in JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-merge"><code class="literal">JSON_MERGE()</code></a> (deprecated 8.0.3)</td>
<td>
      Merge JSON documents, preserving duplicate keys. Deprecated
      synonym for JSON_MERGE_PRESERVE()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH()</code></a></td>
<td>
      Merge JSON documents, replacing values of duplicate keys
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a></td>
<td>
      Merge JSON documents, preserving duplicate keys
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a></td>
<td>
      Create JSON object
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-objectagg"><code class="literal">JSON_OBJECTAGG()</code></a></td>
<td>
      Return result set as a single JSON object
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-overlaps"><code class="literal">JSON_OVERLAPS()</code></a></td>
<td>
      Compares two JSON documents, returns TRUE (1) if these have any
      key-value pairs or array elements in common, otherwise FALSE (0)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-pretty"><code class="literal">JSON_PRETTY()</code></a></td>
<td>
      Print a JSON document in human-readable format
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-quote"><code class="literal">JSON_QUOTE()</code></a></td>
<td>
      Quote JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-remove"><code class="literal">JSON_REMOVE()</code></a></td>
<td>
      Remove data from JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a></td>
<td>
      Replace values in JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-schema-valid"><code class="literal">JSON_SCHEMA_VALID()</code></a></td>
<td>
      Validate JSON document against JSON schema; returns TRUE/1 if
      document validates against schema, or FALSE/0 if it does not
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-schema-validation-report"><code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code></a></td>
<td>
      Validate JSON document against JSON schema; returns report in JSON
      format on outcome on validation including success or failure and
      reasons for failure
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-search"><code class="literal">JSON_SEARCH()</code></a></td>
<td>
      Path to value within JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a></td>
<td>
      Insert data into JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-storage-free"><code class="literal">JSON_STORAGE_FREE()</code></a></td>
<td>
      Freed space within binary representation of JSON column value
      following partial update
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-storage-size"><code class="literal">JSON_STORAGE_SIZE()</code></a></td>
<td>
      Space used for storage of binary representation of a JSON document
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-table"><code class="literal">JSON_TABLE()</code></a></td>
<td>
      Return data from a JSON expression as a relational table
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-type"><code class="literal">JSON_TYPE()</code></a></td>
<td>
      Type of JSON value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE()</code></a></td>
<td>
      Unquote JSON value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-valid"><code class="literal">JSON_VALID()</code></a></td>
<td>
      Whether JSON value is valid
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a></td>
<td>
      Value of argument from row lagging current row within partition
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_last-day"><code class="literal">LAST_DAY</code></a></td>
<td>
      Return the last day of the month for the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a></td>
<td>
      Value of the AUTOINCREMENT column for the last INSERT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_last-value"><code class="literal">LAST_VALUE()</code></a></td>
<td>
      Value of argument from last row of window frame
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lcase"><code class="literal">LCASE()</code></a></td>
<td>
      Synonym for LOWER()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a></td>
<td>
      Value of argument from row leading current row within partition
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a></td>
<td>
      Return the smallest argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_left"><code class="literal">LEFT()</code></a></td>
<td>
      Return the leftmost number of characters as specified
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a></td>
<td>
      Left shift
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_length"><code class="literal">LENGTH()</code></a></td>
<td>
      Return the length of a string in bytes
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a></td>
<td>
      Less than operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a></td>
<td>
      Less than or equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td>
<td>
      Simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_linestring"><code class="literal">LineString()</code></a></td>
<td>
      Construct LineString from Point values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a></td>
<td>
      Return the natural logarithm of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a></td>
<td>
      Load the named file
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME()</code>, <code class="literal">LOCALTIME</code></a></td>
<td>
      Synonym for NOW()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP</code>, <code class="literal">LOCALTIMESTAMP()</code></a></td>
<td>
      Synonym for NOW()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_locate"><code class="literal">LOCATE()</code></a></td>
<td>
      Return the position of the first occurrence of substring
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a></td>
<td>
      Return the natural logarithm of the first argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_log10"><code class="literal">LOG10()</code></a></td>
<td>
      Return the base-10 logarithm of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a></td>
<td>
      Return the base-2 logarithm of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a></td>
<td>
      Return the argument in lowercase
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lpad"><code class="literal">LPAD()</code></a></td>
<td>
      Return the string argument, left-padded with the specified string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ltrim"><code class="literal">LTRIM()</code></a></td>
<td>
      Remove leading spaces
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_make-set"><code class="literal">MAKE_SET()</code></a></td>
<td>
      Return a set of comma-separated strings that have the
      corresponding bit in bits set
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_makedate"><code class="literal">MAKEDATE()</code></a></td>
<td>
      Create a date from the year and day of year
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_maketime"><code class="literal">MAKETIME()</code></a></td>
<td>
      Create time from hour, minute, second
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT()</code></a></td>
<td>
      Block until the slave has read and applied all updates up to the
      specified position
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_match"><code class="literal">MATCH</code></a></td>
<td>
      Perform full-text search
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a></td>
<td>
      Return the maximum value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrcontains"><code class="literal">MBRContains()</code></a></td>
<td>
      Whether MBR of one geometry contains MBR of another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrcoveredby"><code class="literal">MBRCoveredBy()</code></a></td>
<td>
      Whether one MBR is covered by another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrcovers"><code class="literal">MBRCovers()</code></a></td>
<td>
      Whether one MBR covers another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrdisjoint"><code class="literal">MBRDisjoint()</code></a></td>
<td>
      Whether MBRs of two geometries are disjoint
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrequals"><code class="literal">MBREquals()</code></a></td>
<td>
      Whether MBRs of two geometries are equal
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrintersects"><code class="literal">MBRIntersects()</code></a></td>
<td>
      Whether MBRs of two geometries intersect
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbroverlaps"><code class="literal">MBROverlaps()</code></a></td>
<td>
      Whether MBRs of two geometries overlap
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrtouches"><code class="literal">MBRTouches()</code></a></td>
<td>
      Whether MBRs of two geometries touch
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrwithin"><code class="literal">MBRWithin()</code></a></td>
<td>
      Whether MBR of one geometry is within MBR of another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a></td>
<td>
      Calculate MD5 checksum
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_member-of"><code class="literal">MEMBER OF()</code></a></td>
<td>
      Returns true (1) if first operand matches any element of JSON
      array passed as second operand, otherwise returns false (0)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_microsecond"><code class="literal">MICROSECOND()</code></a></td>
<td>
      Return the microseconds from argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mid"><code class="literal">MID()</code></a></td>
<td>
      Return a substring starting from the specified position
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a></td>
<td>
      Return the minimum value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td>
<td>
      Minus operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_minute"><code class="literal">MINUTE()</code></a></td>
<td>
      Return the minute from the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mod"><code class="literal">MOD()</code></a></td>
<td>
      Return the remainder
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_mod"><code class="literal">%</code>, <code class="literal">MOD</code></a></td>
<td>
      Modulo operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_month"><code class="literal">MONTH()</code></a></td>
<td>
      Return the month from the date passed
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_monthname"><code class="literal">MONTHNAME()</code></a></td>
<td>
      Return the name of the month
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_multilinestring"><code class="literal">MultiLineString()</code></a></td>
<td>
      Contruct MultiLineString from LineString values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_multipoint"><code class="literal">MultiPoint()</code></a></td>
<td>
      Construct MultiPoint from Point values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_multipolygon"><code class="literal">MultiPolygon()</code></a></td>
<td>
      Construct MultiPolygon from Polygon values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_name-const"><code class="literal">NAME_CONST()</code></a></td>
<td>
      Cause the column to have the given name
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not"><code class="literal">NOT</code>, <code class="literal">!</code></a></td>
<td>
      Negates value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-between"><code class="literal">NOT BETWEEN ... AND ...</code></a></td>
<td>
      Check whether a value is not within a range of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-equal"><code class="literal">!=</code>, <code class="literal">&lt;&gt;</code></a></td>
<td>
      Not equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-in"><code class="literal">NOT IN()</code></a></td>
<td>
      Check whether a value is not within a set of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td>
<td>
      Negation of simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td>
<td>
      Negation of REGEXP
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a></td>
<td>
      Return the current date and time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a></td>
<td>
      Value of argument from N-th row of window frame
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ntile"><code class="literal">NTILE()</code></a></td>
<td>
      Bucket number of current row within its partition.
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_nullif"><code class="literal">NULLIF()</code></a></td>
<td>
      Return NULL if expr1 = expr2
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_oct"><code class="literal">OCT()</code></a></td>
<td>
      Return a string containing octal representation of a number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_octet-length"><code class="literal">OCTET_LENGTH()</code></a></td>
<td>
      Synonym for LENGTH()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_or"><code class="literal">OR</code>, <code class="literal">||</code></a></td>
<td>
      Logical OR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ord"><code class="literal">ORD()</code></a></td>
<td>
      Return character code for leftmost character of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a></td>
<td>
      Calculate and return a password string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_percent-rank"><code class="literal">PERCENT_RANK()</code></a></td>
<td>
      Percentage rank value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_period-add"><code class="literal">PERIOD_ADD()</code></a></td>
<td>
      Add a period to a year-month
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_period-diff"><code class="literal">PERIOD_DIFF()</code></a></td>
<td>
      Return the number of months between periods
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a></td>
<td>
      Return the value of pi
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td>
<td>
      Addition operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_point"><code class="literal">Point()</code></a></td>
<td>
      Construct Point from coordinates
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_polygon"><code class="literal">Polygon()</code></a></td>
<td>
      Construct Polygon from LineString arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_position"><code class="literal">POSITION()</code></a></td>
<td>
      Synonym for LOCATE()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a></td>
<td>
      Return the argument raised to the specified power
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_power"><code class="literal">POWER()</code></a></td>
<td>
      Return the argument raised to the specified power
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ps-current-thread-id"><code class="literal">PS_CURRENT_THREAD_ID()</code></a></td>
<td>
      Performance Schema thread ID for current thread
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a></td>
<td>
      Performance Schema thread ID for given thread
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_quarter"><code class="literal">QUARTER()</code></a></td>
<td>
      Return the quarter from a date argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_quote"><code class="literal">QUOTE()</code></a></td>
<td>
      Escape the argument for use in an SQL statement
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_radians"><code class="literal">RADIANS()</code></a></td>
<td>
      Return argument converted to radians
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td>
<td>
      Return a random floating-point value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES()</code></a></td>
<td>
      Return a random byte vector
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a></td>
<td>
      Rank of current row within its partition, with gaps
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR()</code></a></td>
<td>
      Starting index of substring matching regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-replace"><code class="literal">REGEXP_REPLACE()</code></a></td>
<td>
      Replace substrings matching regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-substr"><code class="literal">REGEXP_SUBSTR()</code></a></td>
<td>
      Return substring matching regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_release-all-locks"><code class="literal">RELEASE_ALL_LOCKS()</code></a></td>
<td>
      Release all current named locks
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a></td>
<td>
      Release the named lock
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_repeat"><code class="literal">REPEAT()</code></a></td>
<td>
      Repeat a string the specified number of times
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_replace"><code class="literal">REPLACE()</code></a></td>
<td>
      Replace occurrences of a specified string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_reverse"><code class="literal">REVERSE()</code></a></td>
<td>
      Reverse the characters in a string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_right"><code class="literal">RIGHT()</code></a></td>
<td>
      Return the specified rightmost number of characters
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a></td>
<td>
      Right shift
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_roles-graphml"><code class="literal">ROLES_GRAPHML()</code></a></td>
<td>
      Return a GraphML document representing memory role subgraphs
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a></td>
<td>
      Round the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a></td>
<td>
      The number of rows updated
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a></td>
<td>
      Number of current row within its partition
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rpad"><code class="literal">RPAD()</code></a></td>
<td>
      Append string the specified number of times
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rtrim"><code class="literal">RTRIM()</code></a></td>
<td>
      Remove trailing spaces
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_schema"><code class="literal">SCHEMA()</code></a></td>
<td>
      Synonym for DATABASE()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sec-to-time"><code class="literal">SEC_TO_TIME()</code></a></td>
<td>
      Converts seconds to 'hh:mm:ss' format
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_second"><code class="literal">SECOND()</code></a></td>
<td>
      Return the second (0-59)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_session-user"><code class="literal">SESSION_USER()</code></a></td>
<td>
      Synonym for USER()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code>, <code class="literal">SHA()</code></a></td>
<td>
      Calculate an SHA-1 160-bit checksum
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a></td>
<td>
      Calculate an SHA-2 checksum
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sign"><code class="literal">SIGN()</code></a></td>
<td>
      Return the sign of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sin"><code class="literal">SIN()</code></a></td>
<td>
      Return the sine of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a></td>
<td>
      Sleep for a number of seconds
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX()</code></a></td>
<td>
      Return a soundex string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_sounds-like"><code class="literal">SOUNDS LIKE</code></a></td>
<td>
      Compare sounds
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_space"><code class="literal">SPACE()</code></a></td>
<td>
      Return a string of the specified number of spaces
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT()</code></a></td>
<td>
      Return the square root of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area()</code></a></td>
<td>
      Return Polygon or MultiPolygon area
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-asbinary"><code class="literal">ST_AsBinary()</code>, <code class="literal">ST_AsWKB()</code></a></td>
<td>
      Convert from internal geometry format to WKB
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-asgeojson"><code class="literal">ST_AsGeoJSON()</code></a></td>
<td>
      Generate GeoJSON object from geometry
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsText()</code>, <code class="literal">ST_AsWKT()</code></a></td>
<td>
      Convert from internal geometry format to WKT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a></td>
<td>
      Return geometry of points within given distance from geometry
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy()</code></a></td>
<td>
      Produce strategy option for ST_Buffer()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-centroid"><code class="literal">ST_Centroid()</code></a></td>
<td>
      Return centroid as a point
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-contains"><code class="literal">ST_Contains()</code></a></td>
<td>
      Whether one geometry contains another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-convexhull"><code class="literal">ST_ConvexHull()</code></a></td>
<td>
      Return convex hull of geometry
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-crosses"><code class="literal">ST_Crosses()</code></a></td>
<td>
      Whether one geometry crosses another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-difference"><code class="literal">ST_Difference()</code></a></td>
<td>
      Return point set difference of two geometries
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-dimension"><code class="literal">ST_Dimension()</code></a></td>
<td>
      Dimension of geometry
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-disjoint"><code class="literal">ST_Disjoint()</code></a></td>
<td>
      Whether one geometry is disjoint from another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a></td>
<td>
      The distance of one geometry from another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-distance-sphere"><code class="literal">ST_Distance_Sphere()</code></a></td>
<td>
      Minimum distance on earth between two geometries
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-endpoint"><code class="literal">ST_EndPoint()</code></a></td>
<td>
      End Point of LineString
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope()</code></a></td>
<td>
      Return MBR of geometry
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-equals"><code class="literal">ST_Equals()</code></a></td>
<td>
      Whether one geometry is equal to another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-exteriorring"><code class="literal">ST_ExteriorRing()</code></a></td>
<td>
      Return exterior ring of Polygon
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geohash"><code class="literal">ST_GeoHash()</code></a></td>
<td>
      Produce a geohash value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomcollfromtext"><code class="literal">ST_GeomCollFromText()</code>, <code class="literal">ST_GeometryCollectionFromText()</code>, <code class="literal">ST_GeomCollFromTxt()</code></a></td>
<td>
      Return geometry collection from WKT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomcollfromwkb"><code class="literal">ST_GeomCollFromWKB()</code>, <code class="literal">ST_GeometryCollectionFromWKB()</code></a></td>
<td>
      Return geometry collection from WKB
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geometryn"><code class="literal">ST_GeometryN()</code></a></td>
<td>
      Return N-th geometry from geometry collection
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geometrytype"><code class="literal">ST_GeometryType()</code></a></td>
<td>
      Return name of geometry type
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomfromgeojson"><code class="literal">ST_GeomFromGeoJSON()</code></a></td>
<td>
      Generate geometry from GeoJSON object
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code>, <code class="literal">ST_GeometryFromText()</code></a></td>
<td>
      Return geometry from WKT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomfromwkb"><code class="literal">ST_GeomFromWKB()</code>, <code class="literal">ST_GeometryFromWKB()</code></a></td>
<td>
      Return geometry from WKB
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-interiorringn"><code class="literal">ST_InteriorRingN()</code></a></td>
<td>
      Return N-th interior ring of Polygon
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-intersection"><code class="literal">ST_Intersection()</code></a></td>
<td>
      Return point set intersection of two geometries
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-intersects"><code class="literal">ST_Intersects()</code></a></td>
<td>
      Whether one geometry intersects another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-isclosed"><code class="literal">ST_IsClosed()</code></a></td>
<td>
      Whether a geometry is closed and simple
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-isempty"><code class="literal">ST_IsEmpty()</code></a></td>
<td>
      Placeholder function
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-issimple"><code class="literal">ST_IsSimple()</code></a></td>
<td>
      Whether a geometry is simple
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-isvalid"><code class="literal">ST_IsValid()</code></a></td>
<td>
      Whether a geometry is valid
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-latfromgeohash"><code class="literal">ST_LatFromGeoHash()</code></a></td>
<td>
      Return latitude from geohash value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-latitude"><code class="literal">ST_Latitude()</code></a></td>
<td>
      Return latitude of Point
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-length"><code class="literal">ST_Length()</code></a></td>
<td>
      Return length of LineString
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-linefromtext"><code class="literal">ST_LineFromText()</code>, <code class="literal">ST_LineStringFromText()</code></a></td>
<td>
      Construct LineString from WKT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-linefromwkb"><code class="literal">ST_LineFromWKB()</code>, <code class="literal">ST_LineStringFromWKB()</code></a></td>
<td>
      Construct LineString from WKB
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-longfromgeohash"><code class="literal">ST_LongFromGeoHash()</code></a></td>
<td>
      Return longitude from geohash value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-longitude"><code class="literal">ST_Longitude()</code></a></td>
<td>
      Return longitude of Point
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-makeenvelope"><code class="literal">ST_MakeEnvelope()</code></a></td>
<td>
      Rectangle around two points
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mlinefromtext"><code class="literal">ST_MLineFromText()</code>, <code class="literal">ST_MultiLineStringFromText()</code></a></td>
<td>
      Construct MultiLineString from WKT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mlinefromwkb"><code class="literal">ST_MLineFromWKB()</code>, <code class="literal">ST_MultiLineStringFromWKB()</code></a></td>
<td>
      Construct MultiLineString from WKB
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mpointfromtext"><code class="literal">ST_MPointFromText()</code>, <code class="literal">ST_MultiPointFromText()</code></a></td>
<td>
      Construct MultiPoint from WKT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mpointfromwkb"><code class="literal">ST_MPointFromWKB()</code>, <code class="literal">ST_MultiPointFromWKB()</code></a></td>
<td>
      Construct MultiPoint from WKB
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mpolyfromtext"><code class="literal">ST_MPolyFromText()</code>, <code class="literal">ST_MultiPolygonFromText()</code></a></td>
<td>
      Construct MultiPolygon from WKT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mpolyfromwkb"><code class="literal">ST_MPolyFromWKB()</code>, <code class="literal">ST_MultiPolygonFromWKB()</code></a></td>
<td>
      Construct MultiPolygon from WKB
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-numgeometries"><code class="literal">ST_NumGeometries()</code></a></td>
<td>
      Return number of geometries in geometry collection
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-numinteriorrings"><code class="literal">ST_NumInteriorRing()</code>, <code class="literal">ST_NumInteriorRings()</code></a></td>
<td>
      Return number of interior rings in Polygon
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-numpoints"><code class="literal">ST_NumPoints()</code></a></td>
<td>
      Return number of points in LineString
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-overlaps"><code class="literal">ST_Overlaps()</code></a></td>
<td>
      Whether one geometry overlaps another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-pointfromgeohash"><code class="literal">ST_PointFromGeoHash()</code></a></td>
<td>
      Convert geohash value to POINT value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-pointfromtext"><code class="literal">ST_PointFromText()</code></a></td>
<td>
      Construct Point from WKT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-pointfromwkb"><code class="literal">ST_PointFromWKB()</code></a></td>
<td>
      Construct Point from WKB
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-pointn"><code class="literal">ST_PointN()</code></a></td>
<td>
      Return N-th point from LineString
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-polyfromtext"><code class="literal">ST_PolyFromText()</code>, <code class="literal">ST_PolygonFromText()</code></a></td>
<td>
      Construct Polygon from WKT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-polyfromwkb"><code class="literal">ST_PolyFromWKB()</code>, <code class="literal">ST_PolygonFromWKB()</code></a></td>
<td>
      Construct Polygon from WKB
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-simplify"><code class="literal">ST_Simplify()</code></a></td>
<td>
      Return simplified geometry
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a></td>
<td>
      Return spatial reference system ID for geometry
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-startpoint"><code class="literal">ST_StartPoint()</code></a></td>
<td>
      Start Point of LineString
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-swapxy"><code class="literal">ST_SwapXY()</code></a></td>
<td>
      Return argument with X/Y coordinates swapped
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-symdifference"><code class="literal">ST_SymDifference()</code></a></td>
<td>
      Return point set symmetric difference of two geometries
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-touches"><code class="literal">ST_Touches()</code></a></td>
<td>
      Whether one geometry touches another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform()</code></a></td>
<td>
      Transform coordinates of geometry
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-union"><code class="literal">ST_Union()</code></a></td>
<td>
      Return point set union of two geometries
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate()</code></a></td>
<td>
      Return validated geometry
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-within"><code class="literal">ST_Within()</code></a></td>
<td>
      Whether one geometry is within another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-x"><code class="literal">ST_X()</code></a></td>
<td>
      Return X coordinate of Point
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-y"><code class="literal">ST_Y()</code></a></td>
<td>
      Return Y coordinate of Point
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_statement-digest"><code class="literal">STATEMENT_DIGEST()</code></a></td>
<td>
      Compute statement digest hash value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_statement-digest-text"><code class="literal">STATEMENT_DIGEST_TEXT()</code></a></td>
<td>
      Compute normalized statement digest
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_std"><code class="literal">STD()</code></a></td>
<td>
      Return the population standard deviation
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV()</code></a></td>
<td>
      Return the population standard deviation
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP()</code></a></td>
<td>
      Return the population standard deviation
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev-samp"><code class="literal">STDDEV_SAMP()</code></a></td>
<td>
      Return the sample standard deviation
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a></td>
<td>
      Convert a string to a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td>
<td>
      Compare two strings
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE()</code></a></td>
<td>
      Synonym for DATE_SUB() when invoked with three arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR()</code></a></td>
<td>
      Return the substring as specified
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a></td>
<td>
      Return the substring as specified
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_substring-index"><code class="literal">SUBSTRING_INDEX()</code></a></td>
<td>
      Return a substring from a string before the specified number of
      occurrences of the delimiter
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_subtime"><code class="literal">SUBTIME()</code></a></td>
<td>
      Subtract times
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a></td>
<td>
      Return the sum
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a></td>
<td>
      Return the time at which the function executes
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_system-user"><code class="literal">SYSTEM_USER()</code></a></td>
<td>
      Synonym for USER()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_tan"><code class="literal">TAN()</code></a></td>
<td>
      Return the tangent of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_time"><code class="literal">TIME()</code></a></td>
<td>
      Extract the time portion of the expression passed
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_time-format"><code class="literal">TIME_FORMAT()</code></a></td>
<td>
      Format as time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_time-to-sec"><code class="literal">TIME_TO_SEC()</code></a></td>
<td>
      Return the argument converted to seconds
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_timediff"><code class="literal">TIMEDIFF()</code></a></td>
<td>
      Subtract time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td>
<td>
      Multiplication operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_timestamp"><code class="literal">TIMESTAMP()</code></a></td>
<td>
      With a single argument, this function returns the date or datetime
      expression; with two arguments, the sum of the arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_timestampadd"><code class="literal">TIMESTAMPADD()</code></a></td>
<td>
      Add an interval to a datetime expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_timestampdiff"><code class="literal">TIMESTAMPDIFF()</code></a></td>
<td>
      Subtract an interval from a datetime expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64()</code></a></td>
<td>
      Return the argument converted to a base-64 string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a></td>
<td>
      Return the date argument converted to days
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_to-seconds"><code class="literal">TO_SECONDS()</code></a></td>
<td>
      Return the date or datetime argument converted to seconds since
      Year 0
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_trim"><code class="literal">TRIM()</code></a></td>
<td>
      Remove leading and trailing spaces
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE()</code></a></td>
<td>
      Truncate to specified number of decimal places
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ucase"><code class="literal">UCASE()</code></a></td>
<td>
      Synonym for UPPER()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td>
<td>
      Change the sign of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uncompress"><code class="literal">UNCOMPRESS()</code></a></td>
<td>
      Uncompress a string compressed
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uncompressed-length"><code class="literal">UNCOMPRESSED_LENGTH()</code></a></td>
<td>
      Return the length of a string before compression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a></td>
<td>
      Return a string containing hex representation of a number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a></td>
<td>
      Return a Unix timestamp
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML()</code></a></td>
<td>
      Return replaced XML fragment
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a></td>
<td>
      Convert to uppercase
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a></td>
<td>
      The user name and host name provided by the client
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-date"><code class="literal">UTC_DATE()</code></a></td>
<td>
      Return the current UTC date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-time"><code class="literal">UTC_TIME()</code></a></td>
<td>
      Return the current UTC time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-timestamp"><code class="literal">UTC_TIMESTAMP()</code></a></td>
<td>
      Return the current UTC date and time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a></td>
<td>
      Return a Universal Unique Identifier (UUID)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a></td>
<td>
      Return an integer-valued universal identifier
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a></td>
<td>
      Convert string UUID to binary
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_validate-password-strength"><code class="literal">VALIDATE_PASSWORD_STRENGTH()</code></a></td>
<td>
      Determine strength of password
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_values"><code class="literal">VALUES()</code></a></td>
<td>
      Define the values to be used during an INSERT
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP()</code></a></td>
<td>
      Return the population standard variance
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_var-samp"><code class="literal">VAR_SAMP()</code></a></td>
<td>
      Return the sample variance
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE()</code></a></td>
<td>
      Return the population standard variance
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_version"><code class="literal">VERSION()</code></a></td>
<td>
      Return a string that indicates the MySQL server version
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_wait-for-executed-gtid-set"><code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code></a></td>
<td>
      Wait until the given GTIDs have executed on slave.
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_wait-until-sql-thread-after-gtids"><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code></a></td>
<td>
      Wait until the given GTIDs have executed on slave.
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a></td>
<td>
      Return the week number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_weekday"><code class="literal">WEEKDAY()</code></a></td>
<td>
      Return the weekday index
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_weekofyear"><code class="literal">WEEKOFYEAR()</code></a></td>
<td>
      Return the calendar week of the date (1-53)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING()</code></a></td>
<td>
      Return the weight string for a string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a></td>
<td>
      Logical XOR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_year"><code class="literal">YEAR()</code></a></td>
<td>
      Return the year
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK()</code></a></td>
<td>
      Return the year and week
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="type-conversion"></a>12.2&nbsp;Type Conversion in Expression Evaluation</h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091689138784"></a><a class="indexterm" name="idm140091689137744"></a><p>
      When an operator is used with operands of different types, type
      conversion occurs to make the operands compatible. Some
      conversions occur implicitly. For example, MySQL automatically
      converts strings to numbers as necessary, and vice versa.
    </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1+'1';</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CONCAT(2,' test');</code></strong><font></font>
        -&gt; '2 test'<font></font>
</pre><p>
      It is also possible to convert a number to a string explicitly
      using the <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> function.
      Conversion occurs implicitly with the
      <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a> function because it
      expects string arguments.
    </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 38.8, CAST(38.8 AS CHAR);</code></strong><font></font>
        -&gt; 38.8, '38.8'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 38.8, CONCAT(38.8);</code></strong><font></font>
        -&gt; 38.8, '38.8'<font></font>
</pre><p>
      See later in this section for information about the character set
      of implicit number-to-string conversions, and for modified rules
      that apply to <code class="literal">CREATE TABLE ... SELECT</code>
      statements.
    </p><p>
      The following rules describe how conversion occurs for comparison
      operations:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If one or both arguments are <code class="literal">NULL</code>, the
          result of the comparison is <code class="literal">NULL</code>, except
          for the <code class="literal">NULL</code>-safe
          <a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a>
          equality comparison operator. For <code class="literal">NULL &lt;=&gt;
          NULL</code>, the result is true. No conversion is needed.
        </p></li><li class="listitem"><p>
          If both arguments in a comparison operation are strings, they
          are compared as strings.
        </p></li><li class="listitem"><p>
          If both arguments are integers, they are compared as integers.
        </p></li><li class="listitem"><p>
          Hexadecimal values are treated as binary strings if not
          compared to a number.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140091689117744"></a>

          <a class="indexterm" name="idm140091689116672"></a>

          If one of the arguments is a
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a> or
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a> column and the other
          argument is a constant, the constant is converted to a
          timestamp before the comparison is performed. This is done to
          be more ODBC-friendly. This is not done for the arguments to
          <a class="link" href="functions.html#operator_in"><code class="literal">IN()</code></a>. To be safe, always use
          complete datetime, date, or time strings when doing
          comparisons. For example, to achieve best results when using
          <a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN</code></a> with date or time values,
          use <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> to explicitly
          convert the values to the desired data type.
        </p><p>
          A single-row subquery from a table or tables is not considered
          a constant. For example, if a subquery returns an integer to
          be compared to a <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a>
          value, the comparison is done as two integers. The integer is
          not converted to a temporal value. To compare the operands as
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a> values, use
          <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> to explicitly convert
          the subquery value to <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a>.
        </p></li><li class="listitem"><p>
          If one of the arguments is a decimal value, comparison depends
          on the other argument. The arguments are compared as decimal
          values if the other argument is a decimal or integer value, or
          as floating-point values if the other argument is a
          floating-point value.
        </p></li><li class="listitem"><p>
          In all other cases, the arguments are compared as
          floating-point (real) numbers.
</p></li></ul>
</div>
<p>
      For information about conversion of values from one temporal type
      to another, see <a class="xref" href="data-types.html#date-and-time-type-conversion" title="11.3.6日期和时间类型之间的转换">Section&nbsp;11.3.6, “Conversion Between Date and Time Types”</a>.
    </p><p>
      Comparison of JSON values takes place at two levels. The first
      level of comparison is based on the JSON types of the compared
      values. If the types differ, the comparison result is determined
      solely by which type has higher precedence. If the two values have
      the same JSON type, a second level of comparison occurs using
      type-specific rules. For comparison of JSON and non-JSON values,
      the non-JSON value is converted to JSON and the values compared as
      JSON values. For details, see <a class="xref" href="data-types.html#json-comparison" title="JSON值的比较和排序">Comparison and Ordering of JSON Values</a>.
    </p><p>
      The following examples illustrate conversion of strings to numbers
      for comparison operations:
    </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 &gt; '6x';</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 7 &gt; '6x';</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 0 &gt; 'x6';</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 0 = 'x6';</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
      For comparisons of a string column with a number, MySQL cannot use
      an index on the column to look up the value quickly. If
      <em class="replaceable"><code>str_col</code></em> is an indexed string column,
      the index cannot be used when performing the lookup in the
      following statement:
    </p><pre data-lang="sql" class="programlisting">SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>str_col</code></em>=1;
</pre><p>
      The reason for this is that there are many different strings that
      may convert to the value <code class="literal">1</code>, such as
      <code class="literal">'1'</code>, <code class="literal">' 1'</code>, or
      <code class="literal">'1a'</code>.
    </p><p>
      Comparisons that use floating-point numbers (or values that are
      converted to floating-point numbers) are approximate because such
      numbers are inexact. This might lead to results that appear
      inconsistent:
    </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT '18015376320243458' = 18015376320243458;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT '18015376320243459' = 18015376320243459;</code></strong><font></font>
        -&gt; 0<font></font>
</pre><p>
      Such results can occur because the values are converted to
      floating-point numbers, which have only 53 bits of precision and
      are subject to rounding:
    </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT '18015376320243459'+0.0;</code></strong><font></font>
        -&gt; 1.8015376320243e+16<font></font>
</pre><p>
      Furthermore, the conversion from string to floating-point and from
      integer to floating-point do not necessarily occur the same way.
      The integer may be converted to floating-point by the CPU, whereas
      the string is converted digit by digit in an operation that
      involves floating-point multiplications.
    </p><p>
      The results shown will vary on different systems, and can be
      affected by factors such as computer architecture or the compiler
      version or optimization level. One way to avoid such problems is
      to use <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> so that a value is
      not converted implicitly to a float-point number:
    </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CAST('18015376320243459' AS UNSIGNED) = 18015376320243459;</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
      For more information about floating-point comparisons, see
      <a class="xref" href="error-handling.html#problems-with-float" title="B.4.4.8浮点值的问题">Section&nbsp;B.4.4.8, “Problems with Floating-Point Values”</a>.
    </p><p>
      The server includes <code class="literal">dtoa</code>, a conversion library
      that provides the basis for improved conversion between string or
      <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a> values and
      approximate-value
      (<a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a>/<a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a>)
      numbers:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Consistent conversion results across platforms, which
          eliminates, for example, Unix versus Windows conversion
          differences.
        </p></li><li class="listitem"><p>
          Accurate representation of values in cases where results
          previously did not provide sufficient precision, such as for
          values close to IEEE limits.
        </p></li><li class="listitem"><p>
          Conversion of numbers to string format with the best possible
          precision. The precision of <code class="literal">dtoa</code> is always
          the same or better than that of the standard C library
          functions.
</p></li></ul>
</div>
<p>
      Because the conversions produced by this library differ in some
      cases from non-<code class="literal">dtoa</code> results, the potential
      exists for incompatibilities in applications that rely on previous
      results. For example, applications that depend on a specific exact
      result from previous conversions might need adjustment to
      accommodate additional precision.
    </p><p>
      The <code class="literal">dtoa</code> library provides conversions with the
      following properties. <em class="replaceable"><code>D</code></em> represents a
      value with a <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a> or string
      representation, and <em class="replaceable"><code>F</code></em> represents a
      floating-point number in native binary (IEEE) format.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <em class="replaceable"><code>F</code></em> -&gt;
          <em class="replaceable"><code>D</code></em> conversion is done with the best
          possible precision, returning <em class="replaceable"><code>D</code></em> as
          the shortest string that yields <em class="replaceable"><code>F</code></em>
          when read back in and rounded to the nearest value in native
          binary format as specified by IEEE.
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>D</code></em> -&gt;
          <em class="replaceable"><code>F</code></em> conversion is done such that
          <em class="replaceable"><code>F</code></em> is the nearest native binary
          number to the input decimal string
          <em class="replaceable"><code>D</code></em>.
</p></li></ul>
</div>
<p>
      These properties imply that <em class="replaceable"><code>F</code></em> -&gt;
      <em class="replaceable"><code>D</code></em> -&gt; <em class="replaceable"><code>F</code></em>
      conversions are lossless unless <em class="replaceable"><code>F</code></em> is
      <code class="literal">-inf</code>, <code class="literal">+inf</code>, or
      <code class="literal">NaN</code>. The latter values are not supported
      because the SQL standard defines them as invalid values for
      <a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a> or
      <a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a>.
    </p><p>
      For <em class="replaceable"><code>D</code></em> -&gt;
      <em class="replaceable"><code>F</code></em> -&gt; <em class="replaceable"><code>D</code></em>
      conversions, a sufficient condition for losslessness is that
      <em class="replaceable"><code>D</code></em> uses 15 or fewer digits of precision,
      is not a denormal value, <code class="literal">-inf</code>,
      <code class="literal">+inf</code>, or <code class="literal">NaN</code>. In some cases,
      the conversion is lossless even if <em class="replaceable"><code>D</code></em>
      has more than 15 digits of precision, but this is not always the
      case.
    </p><p>
      Implicit conversion of a numeric or temporal value to string
      produces a value that has a character set and collation determined
      by the <a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a>
      and <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
      variables. (These variables commonly are set with
      <a class="link" href="sql-syntax.html#set-names" title="13.7.5.3 SET NAMES语法"><code class="literal">SET NAMES</code></a>. For information about
      connection character sets, see
      <a class="xref" href="charset.html#charset-connection" title="10.4连接字符集和排序规则">Section&nbsp;10.4, “Connection Character Sets and Collations”</a>.)
    </p><p>
      This means that such a conversion results in a character
      (nonbinary) string (a <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a>,
      <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a>, or
      <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">LONGTEXT</code></a> value), except in the case
      that the connection character set is set to
      <code class="literal">binary</code>. In that case, the conversion result is
      a binary string (a <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a>,
      <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a>, or
      <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">LONGBLOB</code></a> value).
    </p><p>
      For integer expressions, the preceding remarks about expression
      <span class="emphasis"><em>evaluation</em></span> apply somewhat differently for
      expression <span class="emphasis"><em>assignment</em></span>; for example, in a
      statement such as this:
    </p><pre data-lang="sql" class="programlisting">CREATE TABLE t SELECT <em class="replaceable"><code>integer_expr</code></em>;
</pre><p>
      In this case, the table in the column resulting from the
      expression has type <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a> or
      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a> depending on the length of
      the integer expression. If the maximum length of the expression
      does not fit in an <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a>,
      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a> is used instead. The length
      is taken from the <code class="literal">max_length</code> value of the
      <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a> result set metadata (see
      <a class="xref" href="connectors-apis.html#c-api-data-structures" title="28.7.5 C API数据结构">Section&nbsp;28.7.5, “C API Data Structures”</a>). This means that you can
      force a <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a> rather than
      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a> by use of a sufficiently long
      expression:
    </p><pre data-lang="sql" class="programlisting">CREATE TABLE t SELECT 000000000000000000000;
</pre>
</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="non-typed-operators"></a>12.3&nbsp;Operators</h2>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#operator-precedence">12.3.1 Operator Precedence</a></span></dt><dt><span class="section"><a href="functions.html#comparison-operators">12.3.2 Comparison Functions and Operators</a></span></dt><dt><span class="section"><a href="functions.html#logical-operators">12.3.3 Logical Operators</a></span></dt><dt><span class="section"><a href="functions.html#assignment-operators">12.3.4 Assignment Operators</a></span></dt></dl>
</div>

<div class="table">
<a name="idm140091689015632"></a><p class="title"><b>Table&nbsp;12.2&nbsp;Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists all operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_and"><code class="literal">AND</code>, <code class="literal">&amp;&amp;</code></a></td>
<td>
      Logical AND
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a></td>
<td>
      Assign a value (as part of a
      <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a>
      statement, or as part of the <code class="literal">SET</code> clause in an
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a> statement)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a></td>
<td>
      Assign a value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN ... AND ...</code></a></td>
<td>
      Check whether a value is within a range of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a></td>
<td>
      Cast a string to a binary string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a></td>
<td>
      Bitwise AND
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a></td>
<td>
      Bitwise inversion
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a></td>
<td>
      Bitwise OR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a></td>
<td>
      Bitwise XOR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a></td>
<td>
      Case operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td>
<td>
      Integer division
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td>
<td>
      Division operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a></td>
<td>
      Equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a></td>
<td>
      NULL-safe equal to operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a></td>
<td>
      Greater than operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a></td>
<td>
      Greater than or equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_in"><code class="literal">IN()</code></a></td>
<td>
      Check whether a value is within a set of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a></td>
<td>
      Test a value against a boolean
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT</code></a></td>
<td>
      Test a value against a boolean
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not-null"><code class="literal">IS NOT NULL</code></a></td>
<td>
      NOT NULL value test
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a></td>
<td>
      NULL value test
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a></td>
<td>
      Return value from JSON column after evaluating path; equivalent to
      JSON_EXTRACT().
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_json-inline-path"><code class="literal">-&gt;&gt;</code></a></td>
<td>
      Return value from JSON column after evaluating path and unquoting
      the result; equivalent to JSON_UNQUOTE(JSON_EXTRACT()).
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a></td>
<td>
      Left shift
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a></td>
<td>
      Less than operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a></td>
<td>
      Less than or equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td>
<td>
      Simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_member-of"><code class="literal">MEMBER OF()</code></a></td>
<td>
      Returns true (1) if first operand matches any element of JSON
      array passed as second operand, otherwise returns false (0)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td>
<td>
      Minus operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_mod"><code class="literal">%</code>, <code class="literal">MOD</code></a></td>
<td>
      Modulo operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not"><code class="literal">NOT</code>, <code class="literal">!</code></a></td>
<td>
      Negates value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-between"><code class="literal">NOT BETWEEN ... AND ...</code></a></td>
<td>
      Check whether a value is not within a range of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-equal"><code class="literal">!=</code>, <code class="literal">&lt;&gt;</code></a></td>
<td>
      Not equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-in"><code class="literal">NOT IN()</code></a></td>
<td>
      Check whether a value is not within a set of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td>
<td>
      Negation of simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td>
<td>
      Negation of REGEXP
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_or"><code class="literal">OR</code>, <code class="literal">||</code></a></td>
<td>
      Logical OR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td>
<td>
      Addition operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a></td>
<td>
      Right shift
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_sounds-like"><code class="literal">SOUNDS LIKE</code></a></td>
<td>
      Compare sounds
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td>
<td>
      Multiplication operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td>
<td>
      Change the sign of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a></td>
<td>
      Logical XOR
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="operator-precedence"></a>12.3.1&nbsp;Operator Precedence</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091688857104"></a><a class="indexterm" name="idm140091688855616"></a><p>
        Operator precedences are shown in the following list, from
        highest precedence to the lowest. Operators that are shown
        together on a line have the same precedence.
      </p><pre data-lang="sql" class="programlisting">INTERVAL<font></font>
BINARY, COLLATE<font></font>
!<font></font>
- (unary minus), ~ (unary bit inversion)<font></font>
^<font></font>
*, /, DIV, %, MOD<font></font>
-, +<font></font>
&lt;&lt;, &gt;&gt;<font></font>
&amp;<font></font>
|<font></font>
= (comparison), &lt;=&gt;, &gt;=, &gt;, &lt;=, &lt;, &lt;&gt;, !=, IS, LIKE, REGEXP, IN<font></font>
BETWEEN, CASE, WHEN, THEN, ELSE<font></font>
NOT<font></font>
AND, &amp;&amp;<font></font>
XOR<font></font>
OR, ||<font></font>
= (assignment), :=<font></font>
</pre><p>
        The precedence of <code class="literal">=</code> depends on whether it is
        used as a comparison operator
        (<a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a>) or as an
        assignment operator
        (<a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a>). When
        used as a comparison operator, it has the same precedence as
        <a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a>,
        <a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a>,
        <a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a>,
        <a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a>,
        <a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a>,
        <a class="link" href="functions.html#operator_not-equal"><code class="literal">&lt;&gt;</code></a>,
        <a class="link" href="functions.html#operator_not-equal"><code class="literal">!=</code></a>,
        <a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a>,
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a>,
        <a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a>, and
        <a class="link" href="functions.html#operator_in"><code class="literal">IN</code></a>. When used as an assignment
        operator, it has the same precedence as
        <a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a>.
        <a class="xref" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法">Section&nbsp;13.7.5.1, “SET Syntax for Variable Assignment”</a>, and
        <a class="xref" href="language-structure.html#user-variables" title="9.4用户定义的变量">Section&nbsp;9.4, “User-Defined Variables”</a>, explain how MySQL determines
        which interpretation of <code class="literal">=</code> should apply.
      </p><p>
        For operators that occur at the same precedence level within an
        expression, evaluation proceeds left to right, with the
        exception that assignments evaluate right to left.
      </p><p>
        The precedence and meaning of some operators depends on the SQL
        mode:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            By default, <a class="link" href="functions.html#operator_or"><code class="literal">||</code></a>
            is a logical <a class="link" href="functions.html#operator_or"><code class="literal">OR</code></a> operator. With
            <a class="link" href="server-administration.html#sqlmode_pipes_as_concat"><code class="literal">PIPES_AS_CONCAT</code></a> enabled,
            <a class="link" href="functions.html#operator_or"><code class="literal">||</code></a> is string
            concatenation, with a precedence between
            <a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a> and
            the unary operators.
          </p></li><li class="listitem"><p>
            By default, <a class="link" href="functions.html#operator_not"><code class="literal">!</code></a>
            has a higher precedence than <code class="literal">NOT</code>. With
            <a class="link" href="server-administration.html#sqlmode_high_not_precedence"><code class="literal">HIGH_NOT_PRECEDENCE</code></a>
            enabled, <a class="link" href="functions.html#operator_not"><code class="literal">!</code></a> and
            <code class="literal">NOT</code> have the same precedence.
</p></li></ul>
</div>
<p>
        See <a class="xref" href="server-administration.html#sql-mode" title="5.1.11服务器SQL模式">Section&nbsp;5.1.11, “Server SQL Modes”</a>.
      </p><a class="indexterm" name="idm140091688815280"></a><a class="indexterm" name="idm140091688814208"></a><a class="indexterm" name="idm140091688813136"></a><a class="indexterm" name="idm140091688811648"></a><p>
        The precedence of operators determines the order of evaluation
        of terms in an expression. To override this order and group
        terms explicitly, use parentheses. For example:
      </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1+2*3;</code></strong><font></font>
        -&gt; 7<font></font>
mysql&gt; <strong class="userinput"><code>SELECT (1+2)*3;</code></strong><font></font>
        -&gt; 9<font></font>
</pre>
</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="comparison-operators"></a>12.3.2&nbsp;Comparison Functions and Operators</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091688805920"></a>
<div class="table">
<a name="idm140091688804880"></a><p class="title"><b>Table&nbsp;12.3&nbsp;Comparison Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists comparison operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN ... AND ...</code></a></td>
<td>
      Check whether a value is within a range of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE()</code></a></td>
<td>
      Return the first non-NULL argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a></td>
<td>
      Equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a></td>
<td>
      NULL-safe equal to operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a></td>
<td>
      Greater than operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a></td>
<td>
      Greater than or equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST()</code></a></td>
<td>
      Return the largest argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_in"><code class="literal">IN()</code></a></td>
<td>
      Check whether a value is within a set of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_interval"><code class="literal">INTERVAL()</code></a></td>
<td>
      Return the index of the argument that is less than the first
      argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is"><code class="literal">IS</code></a></td>
<td>
      Test a value against a boolean
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT</code></a></td>
<td>
      Test a value against a boolean
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-not-null"><code class="literal">IS NOT NULL</code></a></td>
<td>
      NOT NULL value test
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a></td>
<td>
      NULL value test
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL()</code></a></td>
<td>
      Test whether the argument is NULL
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a></td>
<td>
      Return the smallest argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a></td>
<td>
      Less than operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a></td>
<td>
      Less than or equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td>
<td>
      Simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-between"><code class="literal">NOT BETWEEN ... AND ...</code></a></td>
<td>
      Check whether a value is not within a range of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-equal"><code class="literal">!=</code>, <code class="literal">&lt;&gt;</code></a></td>
<td>
      Not equal operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-in"><code class="literal">NOT IN()</code></a></td>
<td>
      Check whether a value is not within a set of values
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td>
<td>
      Negation of simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td>
<td>
      Compare two strings
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><a class="indexterm" name="idm140091688722800"></a><a class="indexterm" name="idm140091688721728"></a><p>
        Comparison operations result in a value of <code class="literal">1</code>
        (<code class="literal">TRUE</code>), <code class="literal">0</code>
        (<code class="literal">FALSE</code>), or <code class="literal">NULL</code>. These
        operations work for both numbers and strings. Strings are
        automatically converted to numbers and numbers to strings as
        necessary.
      </p><p>
        The following relational comparison operators can be used to
        compare not only scalar operands, but row operands:
      </p><pre data-lang="sql" class="programlisting">=  &gt;  &lt;  &gt;=  &lt;=  &lt;&gt;  !=
</pre><p>
        The descriptions for those operators later in this section
        detail how they work with row operands. For additional examples
        of row comparisons in the context of row subqueries, see
        <a class="xref" href="sql-syntax.html#row-subqueries" title="13.2.11.5行子查询">Section&nbsp;13.2.11.5, “Row Subqueries”</a>.
      </p><p>
        Some of the functions in this section return values other than
        <code class="literal">1</code> (<code class="literal">TRUE</code>),
        <code class="literal">0</code> (<code class="literal">FALSE</code>), or
        <code class="literal">NULL</code>. <a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a>
        and <a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST()</code></a> are examples of
        such functions; <a class="xref" href="functions.html#type-conversion" title="12.2表达式评估中的类型转换">Section&nbsp;12.2, “Type Conversion in Expression Evaluation”</a>, describes the
        rules for comparison operations performed by these and similar
        functions for determining their return values.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          In previous versions of MySQL, when evaluating an expression
          containing <code class="literal">LEAST()</code> or
          <code class="literal">GREATEST()</code>, the server attempted to guess
          the context in which the function was used, and to coerce the
          function's arguments to the data type of the expression
          as a whole. For example, the arguments to <code class="literal">LEAST("11",
          "45", "2")</code> are evaluated and sorted as strings, so
          that this expression returns <code class="literal">"11"</code>. In MySQL
          8.0.3 and earlier, when evaluating the expression
          <code class="literal">LEAST("11", "45", "2") + 0</code>, the server
          converted the arguments to integers (anticipating the addition
          of integer 0 to the result) before sorting them, thus
          returning 2.
        </p><p>
          Beginning with MySQL 8.0.4, the server no longer attempts to
          infer context in this fashion. Instead, the function is
          executed using the arguments as provided, performing data type
          conversions to one or more of the arguments if and only if
          they are not all of the same type. Any type coercion mandated
          by an expression that makes use of the return value is now
          performed following function execution. This means that, in
          MySQl 8.0.4 and later, <code class="literal">LEAST("11", "45", "2") +
          0</code> evaluates to <code class="literal">"11" + 0</code> and thus
          to integer 11. (Bug #83895, Bug #25123839)
</p>
</div>
<p>
        To convert a value to a specific type for comparison purposes,
        you can use the <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> function.
        String values can be converted to a different character set
        using <a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a>. See
        <a class="xref" href="functions.html#cast-functions" title="12.10演员函数和运算符">Section&nbsp;12.10, “Cast Functions and Operators”</a>.
      </p><p>
        By default, string comparisons are not case-sensitive and use
        the current character set. The default is
        <code class="literal">utf8mb4</code>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_equal"></a><p>
            <a class="indexterm" name="idm140091688691488"></a>

            <a class="indexterm" name="idm140091688690416"></a>

            <a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a>
          </p><p>
            Equal:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 = 0;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT '0' = 0;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT '0.0' = 0;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT '0.01' = 0;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT '.01' = 0.01;</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            For row comparisons, <code class="literal">(a, b) = (x, y)</code> is
            equivalent to:
          </p><pre data-lang="sql" class="programlisting">(a = x) AND (b = y)
</pre></li><li class="listitem"><a name="operator_equal-to"></a><p>
            <a class="indexterm" name="idm140091688677520"></a>

            <a class="indexterm" name="idm140091688676032"></a>

            <a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a>
          </p><p>
            <code class="literal">NULL</code>-safe equal. This operator performs
            an equality comparison like the
            <a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a> operator,
            but returns <code class="literal">1</code> rather than
            <code class="literal">NULL</code> if both operands are
            <code class="literal">NULL</code>, and <code class="literal">0</code> rather
            than <code class="literal">NULL</code> if one operand is
            <code class="literal">NULL</code>.
          </p><a class="indexterm" name="idm140091688665840"></a><p>
            The
            <a class="link" href="functions.html#operator_equal-to"><code class="literal">&lt;=&gt;</code></a>
            operator is equivalent to the standard SQL <code class="literal">IS NOT
            DISTINCT FROM</code> operator.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 &lt;=&gt; 1, NULL &lt;=&gt; NULL, 1 &lt;=&gt; NULL;</code></strong><font></font>
        -&gt; 1, 1, 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 1 = 1, NULL = NULL, 1 = NULL;</code></strong><font></font>
        -&gt; 1, NULL, NULL<font></font>
</pre><p>
            For row comparisons, <code class="literal">(a, b) &lt;=&gt; (x,
            y)</code> is equivalent to:
          </p><pre data-lang="sql" class="programlisting">(a &lt;=&gt; x) AND (b &lt;=&gt; y)
</pre></li><li class="listitem"><a name="operator_not-equal"></a><p>
            <a class="indexterm" name="idm140091688653504"></a>

            <a class="indexterm" name="idm140091688652416"></a>

            <a class="indexterm" name="idm140091688651328"></a>

            <a class="indexterm" name="idm140091688650256"></a>

            <a class="link" href="functions.html#operator_not-equal"><code class="literal">&lt;&gt;</code></a>,
            <a class="link" href="functions.html#operator_not-equal"><code class="literal">!=</code></a>
          </p><p>
            Not equal:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT '.01' &lt;&gt; '0.01';</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT .01 &lt;&gt; '0.01';</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'zapp' &lt;&gt; 'zappp';</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            For row comparisons, <code class="literal">(a, b) &lt;&gt; (x,
            y)</code> and <code class="literal">(a, b) != (x, y)</code> are
            equivalent to:
          </p><pre data-lang="sql" class="programlisting">(a &lt;&gt; x) OR (b &lt;&gt; y)
</pre></li><li class="listitem"><a name="operator_less-than-or-equal"></a><p>
            <a class="indexterm" name="idm140091688635568"></a>

            <a class="indexterm" name="idm140091688634464"></a>

            <a class="link" href="functions.html#operator_less-than-or-equal"><code class="literal">&lt;=</code></a>
          </p><p>
            Less than or equal:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 0.1 &lt;= 2;</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            For row comparisons, <code class="literal">(a, b) &lt;= (x, y)</code>
            is equivalent to:
          </p><pre data-lang="sql" class="programlisting">(a &lt; x) OR ((a = x) AND (b &lt;= y))
</pre></li><li class="listitem"><a name="operator_less-than"></a><p>
            <a class="indexterm" name="idm140091688623328"></a>

            <a class="indexterm" name="idm140091688622240"></a>

            <a class="link" href="functions.html#operator_less-than"><code class="literal">&lt;</code></a>
          </p><p>
            Less than:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 &lt; 2;</code></strong><font></font>
        -&gt; 0<font></font>
</pre><p>
            For row comparisons, <code class="literal">(a, b) &lt; (x, y)</code>
            is equivalent to:
          </p><pre data-lang="sql" class="programlisting">(a &lt; x) OR ((a = x) AND (b &lt; y))
</pre></li><li class="listitem"><a name="operator_greater-than-or-equal"></a><p>
            <a class="indexterm" name="idm140091688611056"></a>

            <a class="indexterm" name="idm140091688609952"></a>

            <a class="link" href="functions.html#operator_greater-than-or-equal"><code class="literal">&gt;=</code></a>
          </p><p>
            Greater than or equal:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 &gt;= 2;</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            For row comparisons, <code class="literal">(a, b) &gt;= (x, y)</code>
            is equivalent to:
          </p><pre data-lang="sql" class="programlisting">(a &gt; x) OR ((a = x) AND (b &gt;= y))
</pre></li><li class="listitem"><a name="operator_greater-than"></a><p>
            <a class="indexterm" name="idm140091688598768"></a>

            <a class="indexterm" name="idm140091688597680"></a>

            <a class="link" href="functions.html#operator_greater-than"><code class="literal">&gt;</code></a>
          </p><p>
            Greater than:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 &gt; 2;</code></strong><font></font>
        -&gt; 0<font></font>
</pre><p>
            For row comparisons, <code class="literal">(a, b) &gt; (x, y)</code>
            is equivalent to:
          </p><pre data-lang="sql" class="programlisting">(a &gt; x) OR ((a = x) AND (b &gt; y))
</pre></li><li class="listitem"><a name="operator_is"></a><p>
            <a class="indexterm" name="idm140091688585840"></a>

            <a class="indexterm" name="idm140091688584352"></a>

            <a class="indexterm" name="idm140091688582864"></a>

            <a class="indexterm" name="idm140091688581376"></a>

            <a class="link" href="functions.html#operator_is"><code class="literal">IS
            <em class="replaceable"><code>boolean_value</code></em></code></a>
          </p><p>
            Tests a value against a boolean value, where
            <em class="replaceable"><code>boolean_value</code></em> can be
            <code class="literal">TRUE</code>, <code class="literal">FALSE</code>, or
            <code class="literal">UNKNOWN</code>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 IS TRUE, 0 IS FALSE, NULL IS UNKNOWN;</code></strong><font></font>
        -&gt; 1, 1, 1<font></font>
</pre></li><li class="listitem"><a name="operator_is-not"></a><p>
            <a class="indexterm" name="idm140091688568816"></a>

            <a class="indexterm" name="idm140091688567328"></a>

            <a class="indexterm" name="idm140091688565840"></a>

            <a class="indexterm" name="idm140091688564352"></a>

            <a class="link" href="functions.html#operator_is-not"><code class="literal">IS NOT
            <em class="replaceable"><code>boolean_value</code></em></code></a>
          </p><p>
            Tests a value against a boolean value, where
            <em class="replaceable"><code>boolean_value</code></em> can be
            <code class="literal">TRUE</code>, <code class="literal">FALSE</code>, or
            <code class="literal">UNKNOWN</code>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 IS NOT UNKNOWN, 0 IS NOT UNKNOWN, NULL IS NOT UNKNOWN;</code></strong><font></font>
        -&gt; 1, 1, 0<font></font>
</pre></li><li class="listitem"><a name="operator_is-null"></a><p>
            <a class="indexterm" name="idm140091688551712"></a>

            <a class="indexterm" name="idm140091688550224"></a>

            <a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a>
          </p><p>
            Tests whether a value is <code class="literal">NULL</code>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 IS NULL, 0 IS NULL, NULL IS NULL;</code></strong><font></font>
        -&gt; 0, 0, 1<font></font>
</pre><p>
            <a class="indexterm" name="idm140091688542624"></a>

            <a class="indexterm" name="idm140091688541552"></a>

            To work well with ODBC programs, MySQL supports the
            following extra features when using <a class="link" href="functions.html#operator_is-null"><code class="literal">IS
            NULL</code></a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                If <a class="link" href="server-administration.html#sysvar_sql_auto_is_null"><code class="literal">sql_auto_is_null</code></a>
                variable is set to 1, then after a statement that
                successfully inserts an automatically generated
                <code class="literal">AUTO_INCREMENT</code> value, you can find
                that value by issuing a statement of the following form:
              </p><pre data-lang="sql" class="programlisting">SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>auto_col</code></em> IS NULL
</pre><p>
                If the statement returns a row, the value returned is
                the same as if you invoked the
                <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a>
                function. For details, including the return value after
                a multiple-row insert, see
                <a class="xref" href="functions.html#information-functions" title="12.15信息功能">Section&nbsp;12.15, “Information Functions”</a>. If no
                <code class="literal">AUTO_INCREMENT</code> value was successfully
                inserted, the <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a>
                statement returns no row.
              </p><p>
                The behavior of retrieving an
                <code class="literal">AUTO_INCREMENT</code> value by using an
                <a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a> comparison can be
                disabled by setting
                <a class="link" href="server-administration.html#sysvar_sql_auto_is_null"><code class="literal">sql_auto_is_null = 0</code></a>.
                See <a class="xref" href="server-administration.html#server-system-variables" title="5.1.8服务器系统变量">Section&nbsp;5.1.8, “Server System Variables”</a>.
              </p><p>
                The default value of
                <a class="link" href="server-administration.html#sysvar_sql_auto_is_null"><code class="literal">sql_auto_is_null</code></a> is 0.
              </p></li><li class="listitem"><p>
                For <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a> and
                <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a> columns that are
                declared as <code class="literal">NOT NULL</code>, you can find
                the special date <code class="literal">'0000-00-00'</code> by
                using a statement like this:
              </p><pre data-lang="sql" class="programlisting">SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>date_column</code></em> IS NULL
</pre><p>
                This is needed to get some ODBC applications to work
                because ODBC does not support a
                <code class="literal">'0000-00-00'</code> date value.
              </p><p>
                See
                <a class="ulink" href="https://dev.mysql.com/doc/connector-odbc/en/connector-odbc-usagenotes-functionality-last-insert-id.html" target="_top">Obtaining Auto-Increment Values</a>,
                and the description for the
                <code class="literal">FLAG_AUTO_IS_NULL</code> option at
                <a class="ulink" href="https://dev.mysql.com/doc/connector-odbc/en/connector-odbc-configuration-connection-parameters.html" target="_top">Connector/ODBC Connection Parameters</a>.
</p></li></ul>
</div>
</li><li class="listitem"><a name="operator_is-not-null"></a><p>
            <a class="indexterm" name="idm140091688508880"></a>

            <a class="indexterm" name="idm140091688507392"></a>

            <a class="link" href="functions.html#operator_is-null"><code class="literal">IS NOT NULL</code></a>
          </p><p>
            Tests whether a value is not <code class="literal">NULL</code>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 IS NOT NULL, 0 IS NOT NULL, NULL IS NOT NULL;</code></strong><font></font>
        -&gt; 1, 1, 0<font></font>
</pre></li><li class="listitem"><a name="operator_between"></a><p>
            <a class="indexterm" name="idm140091688496928"></a>

            <a class="link" href="functions.html#operator_between"><code class="literal"><em class="replaceable"><code>expr</code></em>
            BETWEEN <em class="replaceable"><code>min</code></em> AND
            <em class="replaceable"><code>max</code></em></code></a>
          </p><p>
            If <em class="replaceable"><code>expr</code></em> is greater than or equal
            to <em class="replaceable"><code>min</code></em> and
            <em class="replaceable"><code>expr</code></em> is less than or equal to
            <em class="replaceable"><code>max</code></em>,
            <a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN</code></a> returns
            <code class="literal">1</code>, otherwise it returns
            <code class="literal">0</code>. This is equivalent to the expression
            <code class="literal">(<em class="replaceable"><code>min</code></em> &lt;=
            <em class="replaceable"><code>expr</code></em> AND
            <em class="replaceable"><code>expr</code></em> &lt;=
            <em class="replaceable"><code>max</code></em>)</code> if all the
            arguments are of the same type. Otherwise type conversion
            takes place according to the rules described in
            <a class="xref" href="functions.html#type-conversion" title="12.2表达式评估中的类型转换">Section&nbsp;12.2, “Type Conversion in Expression Evaluation”</a>, but applied to all the
            three arguments.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 BETWEEN 1 AND 3, 2 BETWEEN 3 and 1;</code></strong><font></font>
        -&gt; 1, 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 1 BETWEEN 2 AND 3;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'b' BETWEEN 'a' AND 'c';</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 2 BETWEEN 2 AND '3';</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 2 BETWEEN 2 AND 'x-3';</code></strong><font></font>
        -&gt; 0<font></font>
</pre><p>
            For best results when using
            <a class="link" href="functions.html#operator_between"><code class="literal">BETWEEN</code></a> with date or time
            values, use <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> to
            explicitly convert the values to the desired data type.
            Examples: If you compare a
            <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a> to two
            <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a> values, convert the
            <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a> values to
            <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a> values. If you use a
            string constant such as <code class="literal">'2001-1-1'</code> in a
            comparison to a <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a>, cast
            the string to a <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a>.
          </p></li><li class="listitem"><a name="operator_not-between"></a><p>
            <a class="indexterm" name="idm140091688464912"></a>

            <a class="link" href="functions.html#operator_not-between"><code class="literal"><em class="replaceable"><code>expr</code></em>
            NOT BETWEEN <em class="replaceable"><code>min</code></em> AND
            <em class="replaceable"><code>max</code></em></code></a>
          </p><p>
            This is the same as <code class="literal">NOT
            (<em class="replaceable"><code>expr</code></em> BETWEEN
            <em class="replaceable"><code>min</code></em> AND
            <em class="replaceable"><code>max</code></em>)</code>.
          </p></li><li class="listitem"><a name="function_coalesce"></a><p>
            <a class="indexterm" name="idm140091688455152"></a>

            <a class="indexterm" name="idm140091688453664"></a>

            <a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE(<em class="replaceable"><code>value</code></em>,...)</code></a>
          </p><p>
            Returns the first non-<code class="literal">NULL</code> value in the
            list, or <code class="literal">NULL</code> if there are no
            non-<code class="literal">NULL</code> values.
          </p><p>
            The return type of <a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE()</code></a>
            is the aggregated type of the argument types.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COALESCE(NULL,1);</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT COALESCE(NULL,NULL,NULL);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre></li><li class="listitem"><a name="function_greatest"></a><p>
            <a class="indexterm" name="idm140091688439568"></a>

            <a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST(<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,...)</code></a>
          </p><p>
            With two or more arguments, returns the largest
            (maximum-valued) argument. The arguments are compared using
            the same rules as for
            <a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT GREATEST(2,0);</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT GREATEST(34.0,3.0,5.0,767.0);</code></strong><font></font>
        -&gt; 767.0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT GREATEST('B','A','C');</code></strong><font></font>
        -&gt; 'C'<font></font>
</pre><p>
            <a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST()</code></a> returns
            <code class="literal">NULL</code> if any argument is
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><a name="operator_in"></a><p>
            <a class="indexterm" name="idm140091688423792"></a>

            <a class="link" href="functions.html#operator_in"><code class="literal"><em class="replaceable"><code>expr</code></em>
            IN (<em class="replaceable"><code>value</code></em>,...)</code></a>
          </p><p>
            Returns <code class="literal">1</code> if
            <em class="replaceable"><code>expr</code></em> is equal to any of the
            values in the <code class="literal">IN</code> list, else returns
            <code class="literal">0</code>. If all values are constants, they are
            evaluated according to the type of
            <em class="replaceable"><code>expr</code></em> and sorted. The search for
            the item then is done using a binary search. This means
            <code class="literal">IN</code> is very quick if the
            <code class="literal">IN</code> value list consists entirely of
            constants. Otherwise, type conversion takes place according
            to the rules described in <a class="xref" href="functions.html#type-conversion" title="12.2表达式评估中的类型转换">Section&nbsp;12.2, “Type Conversion in Expression Evaluation”</a>,
            but applied to all the arguments.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 2 IN (0,3,5,7);</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'wefwf' IN ('wee','wefwf','weg');</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            <code class="literal">IN</code> can be used to compare row
            constructors:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT (3,4) IN ((1,2), (3,4));</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT (3,4) IN ((1,2), (3,5));</code></strong><font></font>
        -&gt; 0<font></font>
</pre><p>
            You should never mix quoted and unquoted values in an
            <code class="literal">IN</code> list because the comparison rules for
            quoted values (such as strings) and unquoted values (such as
            numbers) differ. Mixing types may therefore lead to
            inconsistent results. For example, do not write an
            <code class="literal">IN</code> expression like this:
          </p><pre data-lang="sql" class="programlisting">SELECT val1 FROM tbl1 WHERE val1 IN (1,2,'a');
</pre><p>
            Instead, write it like this:
          </p><pre data-lang="sql" class="programlisting">SELECT val1 FROM tbl1 WHERE val1 IN ('1','2','a');
</pre><p>
            The number of values in the <code class="literal">IN</code> list is
            only limited by the
            <a class="link" href="server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a> value.
          </p><p>
            To comply with the SQL standard, <code class="literal">IN</code>
            returns <code class="literal">NULL</code> not only if the expression
            on the left hand side is <code class="literal">NULL</code>, but also
            if no match is found in the list and one of the expressions
            in the list is <code class="literal">NULL</code>.
          </p><p>
            <code class="literal">IN()</code> syntax can also be used to write
            certain types of subqueries. See
            <a class="xref" href="sql-syntax.html#any-in-some-subqueries" title="13.2.11.3具有ANY，IN或SOME的子查询">Section&nbsp;13.2.11.3, “Subqueries with ANY, IN, or SOME”</a>.
          </p></li><li class="listitem"><a name="operator_not-in"></a><p>
            <a class="indexterm" name="idm140091688392032"></a>

            <a class="link" href="functions.html#operator_not-in"><code class="literal"><em class="replaceable"><code>expr</code></em>
            NOT IN (<em class="replaceable"><code>value</code></em>,...)</code></a>
          </p><p>
            This is the same as <code class="literal">NOT
            (<em class="replaceable"><code>expr</code></em> IN
            (<em class="replaceable"><code>value</code></em>,...))</code>.
          </p></li><li class="listitem"><a name="function_isnull"></a><p>
            <a class="indexterm" name="idm140091688382928"></a>

            <a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL(<em class="replaceable"><code>expr</code></em>)</code></a>
          </p><p>
            If <em class="replaceable"><code>expr</code></em> is
            <code class="literal">NULL</code>,
            <a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL()</code></a> returns
            <code class="literal">1</code>, otherwise it returns
            <code class="literal">0</code>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ISNULL(1+1);</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ISNULL(1/0);</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            <a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL()</code></a> can be used instead
            of <a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a> to test
            whether a value is <code class="literal">NULL</code>. (Comparing a
            value to <code class="literal">NULL</code> using
            <a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a> always
            yields <code class="literal">NULL</code>.)
          </p><p>
            The <a class="link" href="functions.html#function_isnull"><code class="literal">ISNULL()</code></a> function shares
            some special behaviors with the
            <a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a>
            comparison operator. See the description of
            <a class="link" href="functions.html#operator_is-null"><code class="literal">IS NULL</code></a>.
          </p></li><li class="listitem"><a name="function_interval"></a><p>
            <a class="indexterm" name="idm140091688358544"></a>

            <a class="link" href="functions.html#function_interval"><code class="literal">INTERVAL(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>N1</code></em>,<em class="replaceable"><code>N2</code></em>,<em class="replaceable"><code>N3</code></em>,...)</code></a>
          </p><p>
            Returns <code class="literal">0</code> if <em class="replaceable"><code>N</code></em>
            &lt; <em class="replaceable"><code>N1</code></em>, <code class="literal">1</code> if
            <em class="replaceable"><code>N</code></em> &lt;
            <em class="replaceable"><code>N2</code></em> and so on or
            <code class="literal">-1</code> if <em class="replaceable"><code>N</code></em> is
            <code class="literal">NULL</code>. All arguments are treated as
            integers. It is required that <em class="replaceable"><code>N1</code></em>
            &lt; <em class="replaceable"><code>N2</code></em> &lt;
            <em class="replaceable"><code>N3</code></em> &lt; <code class="literal">...</code>
            &lt; <em class="replaceable"><code>Nn</code></em> for this function to work
            correctly. This is because a binary search is used (very
            fast).
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INTERVAL(23, 1, 15, 17, 30, 44, 200);</code></strong><font></font>
        -&gt; 3<font></font>
mysql&gt; <strong class="userinput"><code>SELECT INTERVAL(10, 1, 10, 100, 1000);</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT INTERVAL(22, 23, 30, 44, 200);</code></strong><font></font>
        -&gt; 0<font></font>
</pre></li><li class="listitem"><a name="function_least"></a><p>
            <a class="indexterm" name="idm140091688338896"></a>

            <a class="link" href="functions.html#function_least"><code class="literal">LEAST(<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,...)</code></a>
          </p><p>
            With two or more arguments, returns the smallest
            (minimum-valued) argument. The arguments are compared using
            the following rules:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                If any argument is <code class="literal">NULL</code>, the result
                is <code class="literal">NULL</code>. No comparison is needed.
              </p></li><li class="listitem"><p>
                If all arguments are integer-valued, they are compared
                as integers.
              </p></li><li class="listitem"><p>
                If at least one argument is double precision, they are
                compared as double-precision values. Otherwise, if at
                least one argument is a
                <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a> value, they are
                compared as <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a>
                values.
              </p></li><li class="listitem"><p>
                If the arguments comprise a mix of numbers and strings,
                they are compared as strings.
              </p></li><li class="listitem"><p>
                If any argument is a nonbinary (character) string, the
                arguments are compared as nonbinary strings.
              </p></li><li class="listitem"><p>
                In all other cases, the arguments are compared as binary
                strings.
</p></li></ul>
</div>
<p>
            The return type of <a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a> is
            the aggregated type of the comparison argument types.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LEAST(2,0);</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LEAST(34.0,3.0,5.0,767.0);</code></strong><font></font>
        -&gt; 3.0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LEAST('B','A','C');</code></strong><font></font>
        -&gt; 'A'<font></font>
</pre></li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="logical-operators"></a>12.3.3&nbsp;Logical Operators</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091688316816"></a><a class="indexterm" name="idm140091688315744"></a>
<div class="table">
<a name="idm140091688314256"></a><p class="title"><b>Table&nbsp;12.4&nbsp;Logical Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists logical operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_and"><code class="literal">AND</code>, <code class="literal">&amp;&amp;</code></a></td>
<td>
      Logical AND
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not"><code class="literal">NOT</code>, <code class="literal">!</code></a></td>
<td>
      Negates value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_or"><code class="literal">OR</code>, <code class="literal">||</code></a></td>
<td>
      Logical OR
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a></td>
<td>
      Logical XOR
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
        In SQL, all logical operators evaluate to
        <code class="literal">TRUE</code>, <code class="literal">FALSE</code>, or
        <code class="literal">NULL</code> (<code class="literal">UNKNOWN</code>). In MySQL,
        these are implemented as 1 (<code class="literal">TRUE</code>), 0
        (<code class="literal">FALSE</code>), and <code class="literal">NULL</code>. Most of
        this is common to different SQL database servers, although some
        servers may return any nonzero value for
        <code class="literal">TRUE</code>.
      </p><p>
        MySQL evaluates any nonzero, non-<code class="literal">NULL</code> value
        to <code class="literal">TRUE</code>. For example, the following
        statements all assess to <code class="literal">TRUE</code>:
      </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 10 IS TRUE;</code></strong><font></font>
-&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT -10 IS TRUE;</code></strong><font></font>
-&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'string' IS NOT NULL;</code></strong><font></font>
-&gt; 1<font></font>
</pre>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_not"></a><p>
            <a class="indexterm" name="idm140091688277088"></a>

            <a class="indexterm" name="idm140091688275632"></a>

            <a class="link" href="functions.html#operator_not"><code class="literal">NOT</code></a>,
            <a class="link" href="functions.html#operator_not"><code class="literal">!</code></a>
          </p><p>
            Logical NOT. Evaluates to <code class="literal">1</code> if the
            operand is <code class="literal">0</code>, to <code class="literal">0</code> if
            the operand is nonzero, and <code class="literal">NOT NULL</code>
            returns <code class="literal">NULL</code>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NOT 10;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT NOT 0;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT NOT NULL;</code></strong><font></font>
        -&gt; NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ! (1+1);</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ! 1+1;</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            The last example produces <code class="literal">1</code> because the
            expression evaluates the same way as
            <code class="literal">(!1)+1</code>.
          </p><p>
            The <a class="link" href="functions.html#operator_not"><code class="literal">!</code></a>, operator
            is a nonstandard MySQL extension. As of MySQL 8.0.17, this
            operator is deprecated and support for it will be removed in
            a future MySQL version. Applications should be adjusted to
            use the standard SQL <a class="link" href="functions.html#operator_not"><code class="literal">NOT</code></a>
            operator.
          </p></li><li class="listitem"><a name="operator_and"></a><p>
            <a class="indexterm" name="idm140091688253360"></a>

            <a class="indexterm" name="idm140091688251904"></a>

            <a class="link" href="functions.html#operator_and"><code class="literal">AND</code></a>,
            <a class="link" href="functions.html#operator_and"><code class="literal">&amp;&amp;</code></a>
          </p><p>
            Logical AND. Evaluates to <code class="literal">1</code> if all
            operands are nonzero and not <code class="literal">NULL</code>, to
            <code class="literal">0</code> if one or more operands are
            <code class="literal">0</code>, otherwise <code class="literal">NULL</code> is
            returned.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 AND 1;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 1 AND 0;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 1 AND NULL;</code></strong><font></font>
        -&gt; NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 0 AND NULL;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT NULL AND 0;</code></strong><font></font>
        -&gt; 0<font></font>
</pre><p>
            The <a class="link" href="functions.html#operator_and"><code class="literal">&amp;&amp;</code></a>,
            operator is a nonstandard MySQL extension. As of MySQL
            8.0.17, this operator is deprecated and support for it will
            be removed in a future MySQL version. Applications should be
            adjusted to use the standard SQL
            <a class="link" href="functions.html#operator_and"><code class="literal">AND</code></a> operator.
          </p></li><li class="listitem"><a name="operator_or"></a><p>
            <a class="indexterm" name="idm140091688231488"></a>

            <a class="indexterm" name="idm140091688230032"></a>

            <a class="link" href="functions.html#operator_or"><code class="literal">OR</code></a>,
            <a class="link" href="functions.html#operator_or"><code class="literal">||</code></a>
          </p><p>
            Logical OR. When both operands are
            non-<code class="literal">NULL</code>, the result is
            <code class="literal">1</code> if any operand is nonzero, and
            <code class="literal">0</code> otherwise. With a
            <code class="literal">NULL</code> operand, the result is
            <code class="literal">1</code> if the other operand is nonzero, and
            <code class="literal">NULL</code> otherwise. If both operands are
            <code class="literal">NULL</code>, the result is
            <code class="literal">NULL</code>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 OR 1;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 1 OR 0;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 0 OR 0;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 0 OR NULL;</code></strong><font></font>
        -&gt; NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 1 OR NULL;</code></strong><font></font>
        -&gt; 1<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              If the <a class="link" href="server-administration.html#sqlmode_pipes_as_concat"><code class="literal">PIPES_AS_CONCAT</code></a>
              SQL mode is enabled,
              <a class="link" href="functions.html#operator_or"><code class="literal">||</code></a> signifies
              the SQL-standard string concatenation operator (like
              <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a>).
</p>
</div>
<p>
            The <a class="link" href="functions.html#operator_or"><code class="literal">||</code></a>, operator
            is a nonstandard MySQL extension. As of MySQL 8.0.17, this
            operator is deprecated and support for it will be removed in
            a future MySQL version. Applications should be adjusted to
            use the standard SQL <a class="link" href="functions.html#operator_or"><code class="literal">OR</code></a>
            operator. Exception: Deprecation does not apply if
            <a class="link" href="server-administration.html#sqlmode_pipes_as_concat"><code class="literal">PIPES_AS_CONCAT</code></a> is enabled
            because, in that case,
            <a class="link" href="functions.html#operator_or"><code class="literal">||</code></a> signifies
            string concatentation.
          </p></li><li class="listitem"><a name="operator_xor"></a><p>
            <a class="indexterm" name="idm140091688200912"></a>

            <a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a>
          </p><p>
            Logical XOR. Returns <code class="literal">NULL</code> if either
            operand is <code class="literal">NULL</code>. For
            non-<code class="literal">NULL</code> operands, evaluates to
            <code class="literal">1</code> if an odd number of operands is
            nonzero, otherwise <code class="literal">0</code> is returned.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 1 XOR 1;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR 0;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR NULL;</code></strong><font></font>
        -&gt; NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 1 XOR 1 XOR 1;</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            <code class="literal">a XOR b</code> is mathematically equal to
            <code class="literal">(a AND (NOT b)) OR ((NOT a) and b)</code>.
</p></li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="assignment-operators"></a>12.3.4&nbsp;Assignment Operators</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091688184800"></a><a class="indexterm" name="idm140091688183728"></a>
<div class="table">
<a name="idm140091688182240"></a><p class="title"><b>Table&nbsp;12.5&nbsp;Assignment Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists assignment operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a></td>
<td>
      Assign a value (as part of a
      <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a>
      statement, or as part of the <code class="literal">SET</code> clause in an
      <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a> statement)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a></td>
<td>
      Assign a value
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_assign-value"></a><p>
            <a class="indexterm" name="idm140091688163904"></a>

            <a class="indexterm" name="idm140091688162816"></a>

            <a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a>
          </p><p>
            Assignment operator. Causes the user variable on the left
            hand side of the operator to take on the value to its right.
            The value on the right hand side may be a literal value,
            another variable storing a value, or any legal expression
            that yields a scalar value, including the result of a query
            (provided that this value is a scalar value). You can
            perform multiple assignments in the same
            <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a>
            statement. You can perform multiple assignments in the same
            statement.
          </p><p>
            Unlike
            <a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a>, the
            <a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a>
            operator is never interpreted as a comparison operator. This
            means you can use
            <a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a> in
            any valid SQL statement (not just in
            <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a>
            statements) to assign a value to a variable.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong><font></font>
        -&gt; NULL, NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1 := 1, @var2;</code></strong><font></font>
        -&gt; 1, NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong><font></font>
        -&gt; 1, NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2 := @var1;</code></strong><font></font>
        -&gt; 1, 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong><font></font>
        -&gt; 1, 1<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1:=COUNT(*) FROM t1;</code></strong><font></font>
        -&gt; 4<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1;</code></strong><font></font>
        -&gt; 4<font></font>
</pre><p>
            You can make value assignments using
            <a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a> in
            other statements besides
            <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a>, such as
            <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a>, as shown here:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @var1;</code></strong><font></font>
        -&gt; 4<font></font>
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1;</code></strong><font></font>
        -&gt; 1, 3, 5, 7<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>UPDATE t1 SET c1 = 2 WHERE c1 = @var1:= 1;</code></strong><font></font>
Query OK, 1 row affected (0.00 sec)<font></font>
Rows matched: 1  Changed: 1  Warnings: 0<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1;</code></strong><font></font>
        -&gt; 2, 3, 5, 7<font></font>
</pre><p>
            While it is also possible both to set and to read the value
            of the same variable in a single SQL statement using the
            <a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a>
            operator, this is not recommended.
            <a class="xref" href="language-structure.html#user-variables" title="9.4用户定义的变量">Section&nbsp;9.4, “User-Defined Variables”</a>, explains why you should
            avoid doing this.
          </p></li><li class="listitem"><a name="operator_assign-equal"></a><p>
            <a class="indexterm" name="idm140091688130192"></a>

            <a class="indexterm" name="idm140091688129120"></a>

            <a class="indexterm" name="idm140091688127664"></a>

            <a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a>
          </p><p>
            This operator is used to perform value assignments in two
            cases, described in the next two paragraphs.
          </p><p>
            Within a
            <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a>
            statement, <code class="literal">=</code> is treated as an assignment
            operator that causes the user variable on the left hand side
            of the operator to take on the value to its right. (In other
            words, when used in a
            <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a>
            statement, <code class="literal">=</code> is treated identically to
            <a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a>.)
            The value on the right hand side may be a literal value,
            another variable storing a value, or any legal expression
            that yields a scalar value, including the result of a query
            (provided that this value is a scalar value). You can
            perform multiple assignments in the same
            <a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a>
            statement.
          </p><p>
            In the <code class="literal">SET</code> clause of an
            <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a> statement,
            <code class="literal">=</code> also acts as an assignment operator; in
            this case, however, it causes the column named on the left
            hand side of the operator to assume the value given to the
            right, provided any <code class="literal">WHERE</code> conditions that
            are part of the <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a> are
            met. You can make multiple assignments in the same
            <code class="literal">SET</code> clause of an
            <a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a> statement.
          </p><p>
            In any other context, <code class="literal">=</code> is treated as a
            <a class="link" href="functions.html#operator_equal">comparison operator</a>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong><font></font>
        -&gt; NULL, NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1 := 1, @var2;</code></strong><font></font>
        -&gt; 1, NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong><font></font>
        -&gt; 1, NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2 := @var1;</code></strong><font></font>
        -&gt; 1, 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT @var1, @var2;</code></strong><font></font>
        -&gt; 1, 1<font></font>
</pre><p>
            For more information, see <a class="xref" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法">Section&nbsp;13.7.5.1, “SET Syntax for Variable Assignment”</a>,
            <a class="xref" href="sql-syntax.html#update" title="13.2.12 UPDATE语法">Section&nbsp;13.2.12, “UPDATE Syntax”</a>, and <a class="xref" href="sql-syntax.html#subqueries" title="13.2.11子查询语法">Section&nbsp;13.2.11, “Subquery Syntax”</a>.
</p></li></ul>
</div>

</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="control-flow-functions"></a>12.4&nbsp;Control Flow Functions</h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091688096784"></a><a class="indexterm" name="idm140091688095712"></a>
<div class="table">
<a name="idm140091688094224"></a><p class="title"><b>Table&nbsp;12.6&nbsp;Flow Control Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists flow control operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a></td>
<td>
      Case operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a></td>
<td>
      If/else construct
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL()</code></a></td>
<td>
      Null if/else construct
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_nullif"><code class="literal">NULLIF()</code></a></td>
<td>
      Return NULL if expr1 = expr2
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_case"></a><p>
          <a class="indexterm" name="idm140091688070928"></a>

          <a class="link" href="functions.html#operator_case"><code class="literal">CASE
          <em class="replaceable"><code>value</code></em> WHEN
          [<em class="replaceable"><code>compare_value</code></em>] THEN
          <em class="replaceable"><code>result</code></em> [WHEN
          [<em class="replaceable"><code>compare_value</code></em>] THEN
          <em class="replaceable"><code>result</code></em> ...] [ELSE
          <em class="replaceable"><code>result</code></em>] END</code></a>
        </p><p>
          <a class="link" href="functions.html#operator_case"><code class="literal">CASE WHEN
          [<em class="replaceable"><code>condition</code></em>] THEN
          <em class="replaceable"><code>result</code></em> [WHEN
          [<em class="replaceable"><code>condition</code></em>] THEN
          <em class="replaceable"><code>result</code></em> ...] [ELSE
          <em class="replaceable"><code>result</code></em>] END</code></a>
        </p><p>
          The first <a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a> syntax returns the
          <em class="replaceable"><code>result</code></em> for the first
          <code class="literal"><em class="replaceable"><code>value</code></em>=<em class="replaceable"><code>compare_value</code></em></code>
          comparison that is true. The second syntax returns the result
          for the first condition that is true. If no comparison or
          condition is true, the result after <code class="literal">ELSE</code> is
          returned, or <code class="literal">NULL</code> if there is no
          <code class="literal">ELSE</code> part.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The syntax of the <a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a>
            <span class="emphasis"><em>expr</em></span> described here differs slightly
            from that of the SQL <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE语法"><code class="literal">CASE</code></a>
            <span class="emphasis"><em>statement</em></span> described in
            <a class="xref" href="sql-syntax.html#case" title="13.6.5.1 CASE语法">Section&nbsp;13.6.5.1, “CASE Syntax”</a>, for use inside stored programs. The
            <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE语法"><code class="literal">CASE</code></a> statement cannot have an
            <code class="literal">ELSE NULL</code> clause, and it is terminated
            with <code class="literal">END CASE</code> instead of
            <code class="literal">END</code>.
</p>
</div>
<p>
          The return type of a <a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a>
          expression result is the aggregated type of all result values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              If all types are numeric, the aggregated type is also
              numeric:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  If at least one argument is double precision, the
                  result is double precision.
                </p></li><li class="listitem"><p>
                  Otherwise, if at least one argument is
                  <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a>, the result is
                  <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a>.
                </p></li><li class="listitem"><p>
                  Otherwise, the result is an integer type (with one
                  exception):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                      If all integer types are all signed or all
                      unsigned, the result is the same sign and the
                      precision is the highest of all specified integer
                      types (that is,
                      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">TINYINT</code></a>,
                      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">SMALLINT</code></a>,
                      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">MEDIUMINT</code></a>,
                      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a>, or
                      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>).
                    </p></li><li class="listitem"><p>
                      If there is a combination of signed and unsigned
                      integer types, the result is signed and the
                      precision may be higher. For example, if the types
                      are signed <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a> and
                      unsigned <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a>, the
                      result is signed
                      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>.
                    </p></li><li class="listitem"><p>
                      The exception is unsigned
                      <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a> combined
                      with any signed integer type. The result is
                      <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a> with
                      sufficient precision and scale 0.
</p></li></ul>
</div>
</li></ul>
</div>
</li><li class="listitem"><p>
              If all types are <a class="link" href="data-types.html#bit-type" title="11.2.4比特值类型 -  BIT"><code class="literal">BIT</code></a>, the
              result is <a class="link" href="data-types.html#bit-type" title="11.2.4比特值类型 -  BIT"><code class="literal">BIT</code></a>. Otherwise,
              <a class="link" href="data-types.html#bit-type" title="11.2.4比特值类型 -  BIT"><code class="literal">BIT</code></a> arguments are treated
              similar to <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>.
            </p></li><li class="listitem"><p>
              If all types are <a class="link" href="data-types.html#year" title="11.3.3年份类型"><code class="literal">YEAR</code></a>, the
              result is <a class="link" href="data-types.html#year" title="11.3.3年份类型"><code class="literal">YEAR</code></a>. Otherwise,
              <code class="literal">YEAR</code> arguments are treated similar to
              <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a>.
            </p></li><li class="listitem"><p>
              If all types are character string
              (<a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a> or
              <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a>), the result is
              <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a> with maximum length
              determined by the longest character length of the
              operands.
            </p></li><li class="listitem"><p>
              If all types are character or binary string, the result is
              <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a>.
            </p></li><li class="listitem"><p>
              <a class="link" href="data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a> and
              <a class="link" href="data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a> are treated similar to
              <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a>; the result is
              <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a>.
            </p></li><li class="listitem"><p>
              If all types are <a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a>, the
              result is <a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a>.
            </p></li><li class="listitem"><p>
              If all types are temporal, the result is temporal:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  If all temporal types are
                  <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a>,
                  <a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a>, or
                  <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a>, the result
                  is <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a>,
                  <a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a>, or
                  <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a>,
                  respectively.
                </p></li><li class="listitem"><p>
                  Otherwise, for a mix of temporal types, the result is
                  <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a>.
</p></li></ul>
</div>
</li><li class="listitem"><p>
              If all types are <code class="literal">GEOMETRY</code>, the result
              is <code class="literal">GEOMETRY</code>.
            </p></li><li class="listitem"><p>
              If any type is <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a>, the
              result is <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a>.
            </p></li><li class="listitem"><p>
              For all other type combinations, the result is
              <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a>.
            </p></li><li class="listitem"><p>
              Literal <code class="literal">NULL</code> operands are ignored for
              type aggregation.
</p></li></ul>
</div>
<pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CASE 1 WHEN 1 THEN 'one'</code></strong>
    -&gt;     <strong class="userinput"><code>WHEN 2 THEN 'two' ELSE 'more' END;</code></strong><font></font>
        -&gt; 'one'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CASE WHEN 1&gt;0 THEN 'true' ELSE 'false' END;</code></strong><font></font>
        -&gt; 'true'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CASE BINARY 'B'</code></strong>
    -&gt;     <strong class="userinput"><code>WHEN 'a' THEN 1 WHEN 'b' THEN 2 END;</code></strong><font></font>
        -&gt; NULL<font></font>
</pre></li><li class="listitem"><a name="function_if"></a><p>
          <a class="indexterm" name="idm140091687966000"></a>

          <a class="link" href="functions.html#function_if"><code class="literal">IF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>,<em class="replaceable"><code>expr3</code></em>)</code></a>
        </p><p>
          If <em class="replaceable"><code>expr1</code></em> is <code class="literal">TRUE</code>
          (<code class="literal"><em class="replaceable"><code>expr1</code></em> &lt;&gt;
          0</code> and <code class="literal"><em class="replaceable"><code>expr1</code></em>
          &lt;&gt; NULL</code>), <a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a>
          returns <em class="replaceable"><code>expr2</code></em>. Otherwise, it
          returns <em class="replaceable"><code>expr3</code></em>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            There is also an <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF语法"><code class="literal">IF</code></a>
            <span class="emphasis"><em>statement</em></span>, which differs from the
            <a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a>
            <span class="emphasis"><em>function</em></span> described here. See
            <a class="xref" href="sql-syntax.html#if" title="13.6.5.2 IF语法">Section&nbsp;13.6.5.2, “IF Syntax”</a>.
</p>
</div>
<p>
          If only one of <em class="replaceable"><code>expr2</code></em> or
          <em class="replaceable"><code>expr3</code></em> is explicitly
          <code class="literal">NULL</code>, the result type of the
          <a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a> function is the type of
          the non-<code class="literal">NULL</code> expression.
        </p><p>
          The default return type of <a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a>
          (which may matter when it is stored into a temporary table) is
          calculated as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              If <em class="replaceable"><code>expr2</code></em> or
              <em class="replaceable"><code>expr3</code></em> produce a string, the
              result is a string.
            </p><p>
              If <em class="replaceable"><code>expr2</code></em> and
              <em class="replaceable"><code>expr3</code></em> are both strings, the
              result is case-sensitive if either string is case
              sensitive.
            </p></li><li class="listitem"><p>
              If <em class="replaceable"><code>expr2</code></em> or
              <em class="replaceable"><code>expr3</code></em> produce a floating-point
              value, the result is a floating-point value.
            </p></li><li class="listitem"><p>
              If <em class="replaceable"><code>expr2</code></em> or
              <em class="replaceable"><code>expr3</code></em> produce an integer, the
              result is an integer.
</p></li></ul>
</div>
<pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT IF(1&gt;2,2,3);</code></strong><font></font>
        -&gt; 3<font></font>
mysql&gt; <strong class="userinput"><code>SELECT IF(1&lt;2,'yes','no');</code></strong><font></font>
        -&gt; 'yes'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT IF(STRCMP('test','test1'),'no','yes');</code></strong><font></font>
        -&gt; 'no'<font></font>
</pre></li><li class="listitem"><a name="function_ifnull"></a><p>
          <a class="indexterm" name="idm140091687931264"></a>

          <a class="indexterm" name="idm140091687929776"></a>

          <a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code></a>
        </p><p>
          If <em class="replaceable"><code>expr1</code></em> is not
          <code class="literal">NULL</code>,
          <a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL()</code></a> returns
          <em class="replaceable"><code>expr1</code></em>; otherwise it returns
          <em class="replaceable"><code>expr2</code></em>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT IFNULL(1,0);</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(NULL,10);</code></strong><font></font>
        -&gt; 10<font></font>
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(1/0,10);</code></strong><font></font>
        -&gt; 10<font></font>
mysql&gt; <strong class="userinput"><code>SELECT IFNULL(1/0,'yes');</code></strong><font></font>
        -&gt; 'yes'<font></font>
</pre><p>
          The default return type of
          <a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code></a>
          is the more <span class="quote">“<span class="quote">general</span>”</span> of the two expressions, in
          the order <code class="literal">STRING</code>, <code class="literal">REAL</code>,
          or <code class="literal">INTEGER</code>. Consider the case of a table
          based on expressions or where MySQL must internally store a
          value returned by <a class="link" href="functions.html#function_ifnull"><code class="literal">IFNULL()</code></a> in a
          temporary table:
        </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE tmp SELECT IFNULL(1,'test') AS test;</code></strong>
mysql&gt; <strong class="userinput"><code>DESCRIBE tmp;</code></strong><font></font>
+-------+--------------+------+-----+---------+-------+<font></font>
| Field | Type         | Null | Key | Default | Extra |<font></font>
+-------+--------------+------+-----+---------+-------+<font></font>
| test  | varbinary(4) | NO   |     |         |       |<font></font>
+-------+--------------+------+-----+---------+-------+<font></font>
</pre><p>
          In this example, the type of the <code class="literal">test</code>
          column is <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY(4)</code></a> (a
          string type).
        </p></li><li class="listitem"><a name="function_nullif"></a><p>
          <a class="indexterm" name="idm140091687902896"></a>

          <a class="link" href="functions.html#function_nullif"><code class="literal">NULLIF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code></a>
        </p><p>
          Returns <code class="literal">NULL</code> if
          <code class="literal"><em class="replaceable"><code>expr1</code></em> =
          <em class="replaceable"><code>expr2</code></em></code> is true, otherwise
          returns <em class="replaceable"><code>expr1</code></em>. This is the same as
          <a class="link" href="functions.html#operator_case"><code class="literal">CASE WHEN
          <em class="replaceable"><code>expr1</code></em> =
          <em class="replaceable"><code>expr2</code></em> THEN NULL ELSE
          <em class="replaceable"><code>expr1</code></em> END</code></a>.
        </p><p>
          The return value has the same type as the first argument.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NULLIF(1,1);</code></strong><font></font>
        -&gt; NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT NULLIF(1,2);</code></strong><font></font>
        -&gt; 1<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            MySQL evaluates <em class="replaceable"><code>expr1</code></em> twice if
            the arguments are not equal.
</p>
</div>
</li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="string-functions"></a>12.5&nbsp;String Functions</h2>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#string-comparison-functions">12.5.1 String Comparison Functions</a></span></dt><dt><span class="section"><a href="functions.html#regexp">12.5.2 Regular Expressions</a></span></dt><dt><span class="section"><a href="functions.html#string-functions-charset">12.5.3 Character Set and Collation of Function Results</a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091687886368"></a><a class="indexterm" name="idm140091687885296"></a>
<div class="table">
<a name="idm140091687883808"></a><p class="title"><b>Table&nbsp;12.7&nbsp;String Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists string operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a></td>
<td>
      Return numeric value of left-most character
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bin"><code class="literal">BIN()</code></a></td>
<td>
      Return a string containing binary representation of a number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-length"><code class="literal">BIT_LENGTH()</code></a></td>
<td>
      Return length of argument in bits
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a></td>
<td>
      Return the character for each integer passed
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH()</code></a></td>
<td>
      Return number of characters in argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_character-length"><code class="literal">CHARACTER_LENGTH()</code></a></td>
<td>
      Synonym for CHAR_LENGTH()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a></td>
<td>
      Return concatenated string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS()</code></a></td>
<td>
      Return concatenate with separator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a></td>
<td>
      Return string at index number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_export-set"><code class="literal">EXPORT_SET()</code></a></td>
<td>
      Return a string such that for every bit set in the value bits, you
      get an on string and for every unset bit, you get an off string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_field"><code class="literal">FIELD()</code></a></td>
<td>
      Index (position) of first argument in subsequent arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_find-in-set"><code class="literal">FIND_IN_SET()</code></a></td>
<td>
      Index (position) of first argument within second argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_format"><code class="literal">FORMAT()</code></a></td>
<td>
      Return a number formatted to specified number of decimal places
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_from-base64"><code class="literal">FROM_BASE64()</code></a></td>
<td>
      Decode base64 encoded string and return result
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a></td>
<td>
      Hexadecimal representation of decimal or string value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_insert"><code class="literal">INSERT()</code></a></td>
<td>
      Insert substring at specified position up to specified number of
      characters
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_instr"><code class="literal">INSTR()</code></a></td>
<td>
      Return the index of the first occurrence of substring
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lcase"><code class="literal">LCASE()</code></a></td>
<td>
      Synonym for LOWER()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_left"><code class="literal">LEFT()</code></a></td>
<td>
      Return the leftmost number of characters as specified
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_length"><code class="literal">LENGTH()</code></a></td>
<td>
      Return the length of a string in bytes
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td>
<td>
      Simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a></td>
<td>
      Load the named file
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_locate"><code class="literal">LOCATE()</code></a></td>
<td>
      Return the position of the first occurrence of substring
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a></td>
<td>
      Return the argument in lowercase
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lpad"><code class="literal">LPAD()</code></a></td>
<td>
      Return the string argument, left-padded with the specified string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ltrim"><code class="literal">LTRIM()</code></a></td>
<td>
      Remove leading spaces
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_make-set"><code class="literal">MAKE_SET()</code></a></td>
<td>
      Return a set of comma-separated strings that have the
      corresponding bit in bits set
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_match"><code class="literal">MATCH</code></a></td>
<td>
      Perform full-text search
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mid"><code class="literal">MID()</code></a></td>
<td>
      Return a substring starting from the specified position
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td>
<td>
      Negation of simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td>
<td>
      Negation of REGEXP
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_oct"><code class="literal">OCT()</code></a></td>
<td>
      Return a string containing octal representation of a number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_octet-length"><code class="literal">OCTET_LENGTH()</code></a></td>
<td>
      Synonym for LENGTH()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ord"><code class="literal">ORD()</code></a></td>
<td>
      Return character code for leftmost character of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_position"><code class="literal">POSITION()</code></a></td>
<td>
      Synonym for LOCATE()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_quote"><code class="literal">QUOTE()</code></a></td>
<td>
      Escape the argument for use in an SQL statement
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR()</code></a></td>
<td>
      Starting index of substring matching regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-replace"><code class="literal">REGEXP_REPLACE()</code></a></td>
<td>
      Replace substrings matching regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-substr"><code class="literal">REGEXP_SUBSTR()</code></a></td>
<td>
      Return substring matching regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_repeat"><code class="literal">REPEAT()</code></a></td>
<td>
      Repeat a string the specified number of times
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_replace"><code class="literal">REPLACE()</code></a></td>
<td>
      Replace occurrences of a specified string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_reverse"><code class="literal">REVERSE()</code></a></td>
<td>
      Reverse the characters in a string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_right"><code class="literal">RIGHT()</code></a></td>
<td>
      Return the specified rightmost number of characters
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rpad"><code class="literal">RPAD()</code></a></td>
<td>
      Append string the specified number of times
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rtrim"><code class="literal">RTRIM()</code></a></td>
<td>
      Remove trailing spaces
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX()</code></a></td>
<td>
      Return a soundex string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_sounds-like"><code class="literal">SOUNDS LIKE</code></a></td>
<td>
      Compare sounds
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_space"><code class="literal">SPACE()</code></a></td>
<td>
      Return a string of the specified number of spaces
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td>
<td>
      Compare two strings
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR()</code></a></td>
<td>
      Return the substring as specified
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a></td>
<td>
      Return the substring as specified
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_substring-index"><code class="literal">SUBSTRING_INDEX()</code></a></td>
<td>
      Return a substring from a string before the specified number of
      occurrences of the delimiter
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64()</code></a></td>
<td>
      Return the argument converted to a base-64 string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_trim"><code class="literal">TRIM()</code></a></td>
<td>
      Remove leading and trailing spaces
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ucase"><code class="literal">UCASE()</code></a></td>
<td>
      Synonym for UPPER()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a></td>
<td>
      Return a string containing hex representation of a number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a></td>
<td>
      Convert to uppercase
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING()</code></a></td>
<td>
      Return the weight string for a string
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
      String-valued functions return <code class="literal">NULL</code> if the
      length of the result would be greater than the value of the
      <a class="link" href="server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a> system
      variable. See <a class="xref" href="server-administration.html#server-configuration" title="5.1.1配置服务器">Section&nbsp;5.1.1, “Configuring the Server”</a>.
    </p><p>
      For functions that operate on string positions, the first position
      is numbered 1.
    </p><p>
      For functions that take length arguments, noninteger arguments are
      rounded to the nearest integer.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_ascii"></a><p>
          <a class="indexterm" name="idm140091687672352"></a>

          <a class="link" href="functions.html#function_ascii"><code class="literal">ASCII(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the numeric value of the leftmost character of the
          string <em class="replaceable"><code>str</code></em>. Returns
          <code class="literal">0</code> if <em class="replaceable"><code>str</code></em> is the
          empty string. Returns <code class="literal">NULL</code> if
          <em class="replaceable"><code>str</code></em> is <code class="literal">NULL</code>.
          <a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a> works for 8-bit
          characters.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ASCII('2');</code></strong><font></font>
        -&gt; 50<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ASCII(2);</code></strong><font></font>
        -&gt; 50<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ASCII('dx');</code></strong><font></font>
        -&gt; 100<font></font>
</pre><p>
          See also the <a class="link" href="functions.html#function_ord"><code class="literal">ORD()</code></a> function.
        </p></li><li class="listitem"><a name="function_bin"></a><p>
          <a class="indexterm" name="idm140091687655136"></a>

          <a class="link" href="functions.html#function_bin"><code class="literal">BIN(<em class="replaceable"><code>N</code></em>)</code></a>
        </p><p>
          Returns a string representation of the binary value of
          <em class="replaceable"><code>N</code></em>, where
          <em class="replaceable"><code>N</code></em> is a longlong
          (<a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>) number. This is
          equivalent to
          <a class="link" href="functions.html#function_conv"><code class="literal">CONV(<em class="replaceable"><code>N</code></em>,10,2)</code></a>.
          Returns <code class="literal">NULL</code> if
          <em class="replaceable"><code>N</code></em> is <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT BIN(12);</code></strong><font></font>
        -&gt; '1100'<font></font>
</pre></li><li class="listitem"><a name="function_bit-length"></a><p>
          <a class="indexterm" name="idm140091687640160"></a>

          <a class="link" href="functions.html#function_bit-length"><code class="literal">BIT_LENGTH(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the length of the string
          <em class="replaceable"><code>str</code></em> in bits.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT BIT_LENGTH('text');</code></strong><font></font>
        -&gt; 32<font></font>
</pre></li><li class="listitem"><a name="function_char"></a><p>
          <a class="indexterm" name="idm140091687630336"></a>

          <a class="link" href="functions.html#function_char"><code class="literal">CHAR(<em class="replaceable"><code>N</code></em>,...
          [USING <em class="replaceable"><code>charset_name</code></em>])</code></a>
        </p><p>
          <a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a> interprets each argument
          <em class="replaceable"><code>N</code></em> as an integer and returns a
          string consisting of the characters given by the code values
          of those integers. <code class="literal">NULL</code> values are skipped.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CHAR(77,121,83,81,'76');</code></strong><font></font>
        -&gt; 'MySQL'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CHAR(77,77.3,'77.3');</code></strong><font></font>
        -&gt; 'MMM'<font></font>
</pre><p>
          <a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a> arguments larger than
          255 are converted into multiple result bytes. For example,
          <a class="link" href="functions.html#function_char"><code class="literal">CHAR(256)</code></a> is equivalent to
          <a class="link" href="functions.html#function_char"><code class="literal">CHAR(1,0)</code></a>, and
          <a class="link" href="functions.html#function_char"><code class="literal">CHAR(256*256)</code></a> is equivalent to
          <a class="link" href="functions.html#function_char"><code class="literal">CHAR(1,0,0)</code></a>:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(CHAR(1,0)), HEX(CHAR(256));</code></strong><font></font>
+----------------+----------------+<font></font>
| HEX(CHAR(1,0)) | HEX(CHAR(256)) |<font></font>
+----------------+----------------+<font></font>
| 0100           | 0100           |<font></font>
+----------------+----------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT HEX(CHAR(1,0,0)), HEX(CHAR(256*256));</code></strong><font></font>
+------------------+--------------------+<font></font>
| HEX(CHAR(1,0,0)) | HEX(CHAR(256*256)) |<font></font>
+------------------+--------------------+<font></font>
| 010000           | 010000             |<font></font>
+------------------+--------------------+<font></font>
</pre><p>
          By default, <a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a> returns a
          binary string. To produce a string in a given character set,
          use the optional <code class="literal">USING</code> clause:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CHARSET(CHAR(X'65')), CHARSET(CHAR(X'65' USING utf8));</code></strong><font></font>
+----------------------+---------------------------------+<font></font>
| CHARSET(CHAR(X'65')) | CHARSET(CHAR(X'65' USING utf8)) |<font></font>
+----------------------+---------------------------------+<font></font>
| binary               | utf8                            |<font></font>
+----------------------+---------------------------------+<font></font>
</pre><p>
          If <code class="literal">USING</code> is given and the result string is
          illegal for the given character set, a warning is issued.
          Also, if strict SQL mode is enabled, the result from
          <a class="link" href="functions.html#function_char"><code class="literal">CHAR()</code></a> becomes
          <code class="literal">NULL</code>.
        </p></li><li class="listitem"><a name="function_char-length"></a><p>
          <a class="indexterm" name="idm140091687598864"></a>

          <a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the length of the string
          <em class="replaceable"><code>str</code></em>, measured in characters. A
          multibyte character counts as a single character. This means
          that for a string containing five 2-byte characters,
          <a class="link" href="functions.html#function_length"><code class="literal">LENGTH()</code></a> returns
          <code class="literal">10</code>, whereas
          <a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH()</code></a> returns
          <code class="literal">5</code>.
        </p></li><li class="listitem"><a name="function_character-length"></a><p>
          <a class="indexterm" name="idm140091687587152"></a>

          <a class="link" href="functions.html#function_character-length"><code class="literal">CHARACTER_LENGTH(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_character-length"><code class="literal">CHARACTER_LENGTH()</code></a> is a synonym
          for <a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH()</code></a>.
        </p></li><li class="listitem"><a name="function_concat"></a><p>
          <a class="indexterm" name="idm140091687577504"></a>

          <a class="indexterm" name="idm140091687576432"></a>

          <a class="indexterm" name="idm140091687575360"></a>

          <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT(<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,...)</code></a>
        </p><p>
          Returns the string that results from concatenating the
          arguments. May have one or more arguments. If all arguments
          are nonbinary strings, the result is a nonbinary string. If
          the arguments include any binary strings, the result is a
          binary string. A numeric argument is converted to its
          equivalent nonbinary string form.
        </p><p>
          <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a> returns
          <code class="literal">NULL</code> if any argument is
          <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONCAT('My', 'S', 'QL');</code></strong><font></font>
        -&gt; 'MySQL'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CONCAT('My', NULL, 'QL');</code></strong><font></font>
        -&gt; NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CONCAT(14.3);</code></strong><font></font>
        -&gt; '14.3'<font></font>
</pre><p>
          For quoted strings, concatenation can be performed by placing
          the strings next to each other:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'My' 'S' 'QL';</code></strong><font></font>
        -&gt; 'MySQL'<font></font>
</pre></li><li class="listitem"><a name="function_concat-ws"></a><p>
          <a class="indexterm" name="idm140091687557920"></a>

          <a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS(<em class="replaceable"><code>separator</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,...)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS()</code></a> stands for
          Concatenate With Separator and is a special form of
          <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a>. The first argument is
          the separator for the rest of the arguments. The separator is
          added between the strings to be concatenated. The separator
          can be a string, as can the rest of the arguments. If the
          separator is <code class="literal">NULL</code>, the result is
          <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONCAT_WS(',','First name','Second name','Last Name');</code></strong><font></font>
        -&gt; 'First name,Second name,Last Name'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CONCAT_WS(',','First name',NULL,'Last Name');</code></strong><font></font>
        -&gt; 'First name,Last Name'<font></font>
</pre><p>
          <a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS()</code></a> does not skip empty
          strings. However, it does skip any <code class="literal">NULL</code>
          values after the separator argument.
        </p></li><li class="listitem"><a name="function_elt"></a><p>
          <a class="indexterm" name="idm140091687540032"></a>

          <a class="link" href="functions.html#function_elt"><code class="literal">ELT(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,<em class="replaceable"><code>str3</code></em>,...)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a> returns the
          <em class="replaceable"><code>N</code></em>th element of the list of strings:
          <em class="replaceable"><code>str1</code></em> if
          <em class="replaceable"><code>N</code></em> = <code class="literal">1</code>,
          <em class="replaceable"><code>str2</code></em> if
          <em class="replaceable"><code>N</code></em> = <code class="literal">2</code>, and so
          on. Returns <code class="literal">NULL</code> if
          <em class="replaceable"><code>N</code></em> is less than <code class="literal">1</code>
          or greater than the number of arguments.
          <a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a> is the complement of
          <a class="link" href="functions.html#function_field"><code class="literal">FIELD()</code></a>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ELT(1, 'Aa', 'Bb', 'Cc', 'Dd');</code></strong><font></font>
        -&gt; 'Aa'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ELT(4, 'Aa', 'Bb', 'Cc', 'Dd');</code></strong><font></font>
        -&gt; 'Dd'<font></font>
</pre></li><li class="listitem"><a name="function_export-set"></a><p>
          <a class="indexterm" name="idm140091687519552"></a>

          <a class="link" href="functions.html#function_export-set"><code class="literal">EXPORT_SET(<em class="replaceable"><code>bits</code></em>,<em class="replaceable"><code>on</code></em>,<em class="replaceable"><code>off</code></em>[,<em class="replaceable"><code>separator</code></em>[,<em class="replaceable"><code>number_of_bits</code></em>]])</code></a>
        </p><p>
          Returns a string such that for every bit set in the value
          <em class="replaceable"><code>bits</code></em>, you get an
          <em class="replaceable"><code>on</code></em> string and for every bit not set
          in the value, you get an <em class="replaceable"><code>off</code></em>
          string. Bits in <em class="replaceable"><code>bits</code></em> are examined
          from right to left (from low-order to high-order bits).
          Strings are added to the result from left to right, separated
          by the <em class="replaceable"><code>separator</code></em> string (the
          default being the comma character <code class="literal">,</code>). The
          number of bits examined is given by
          <em class="replaceable"><code>number_of_bits</code></em>, which has a default
          of 64 if not specified.
          <em class="replaceable"><code>number_of_bits</code></em> is silently clipped
          to 64 if larger than 64. It is treated as an unsigned integer,
          so a value of −1 is effectively the same as 64.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT EXPORT_SET(5,'Y','N',',',4);</code></strong><font></font>
        -&gt; 'Y,N,Y,N'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT EXPORT_SET(6,'1','0',',',10);</code></strong><font></font>
        -&gt; '0,1,1,0,0,0,0,0,0,0'<font></font>
</pre></li><li class="listitem"><a name="function_field"></a><p>
          <a class="indexterm" name="idm140091687503120"></a>

          <a class="link" href="functions.html#function_field"><code class="literal">FIELD(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,<em class="replaceable"><code>str3</code></em>,...)</code></a>
        </p><p>
          Returns the index (position) of <em class="replaceable"><code>str</code></em>
          in the <em class="replaceable"><code>str1</code></em>,
          <em class="replaceable"><code>str2</code></em>,
          <em class="replaceable"><code>str3</code></em>, <code class="literal">...</code> list.
          Returns <code class="literal">0</code> if <em class="replaceable"><code>str</code></em>
          is not found.
        </p><p>
          If all arguments to <a class="link" href="functions.html#function_field"><code class="literal">FIELD()</code></a> are
          strings, all arguments are compared as strings. If all
          arguments are numbers, they are compared as numbers.
          Otherwise, the arguments are compared as double.
        </p><p>
          If <em class="replaceable"><code>str</code></em> is <code class="literal">NULL</code>,
          the return value is <code class="literal">0</code> because
          <code class="literal">NULL</code> fails equality comparison with any
          value. <a class="link" href="functions.html#function_field"><code class="literal">FIELD()</code></a> is the
          complement of <a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FIELD('Bb', 'Aa', 'Bb', 'Cc', 'Dd', 'Ff');</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT FIELD('Gg', 'Aa', 'Bb', 'Cc', 'Dd', 'Ff');</code></strong><font></font>
        -&gt; 0<font></font>
</pre></li><li class="listitem"><a name="function_find-in-set"></a><p>
          <a class="indexterm" name="idm140091687480832"></a>

          <a class="link" href="functions.html#function_find-in-set"><code class="literal">FIND_IN_SET(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>strlist</code></em>)</code></a>
        </p><p>
          Returns a value in the range of 1 to
          <em class="replaceable"><code>N</code></em> if the string
          <em class="replaceable"><code>str</code></em> is in the string list
          <em class="replaceable"><code>strlist</code></em> consisting of
          <em class="replaceable"><code>N</code></em> substrings. A string list is a
          string composed of substrings separated by
          <code class="literal">,</code> characters. If the first argument is a
          constant string and the second is a column of type
          <a class="link" href="data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a>, the
          <a class="link" href="functions.html#function_find-in-set"><code class="literal">FIND_IN_SET()</code></a> function is
          optimized to use bit arithmetic. Returns <code class="literal">0</code>
          if <em class="replaceable"><code>str</code></em> is not in
          <em class="replaceable"><code>strlist</code></em> or if
          <em class="replaceable"><code>strlist</code></em> is the empty string.
          Returns <code class="literal">NULL</code> if either argument is
          <code class="literal">NULL</code>. This function does not work properly
          if the first argument contains a comma (<code class="literal">,</code>)
          character.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FIND_IN_SET('b','a,b,c,d');</code></strong><font></font>
        -&gt; 2<font></font>
</pre></li><li class="listitem"><a name="function_format"></a><p>
          <a class="indexterm" name="idm140091687461664"></a>

          <a class="link" href="functions.html#function_format"><code class="literal">FORMAT(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>[,<em class="replaceable"><code>locale</code></em>])</code></a>
        </p><p>
          Formats the number <em class="replaceable"><code>X</code></em> to a format
          like <code class="literal">'#,###,###.##'</code>, rounded to
          <em class="replaceable"><code>D</code></em> decimal places, and returns the
          result as a string. If <em class="replaceable"><code>D</code></em> is
          <code class="literal">0</code>, the result has no decimal point or
          fractional part.
        </p><p>
          The optional third parameter enables a locale to be specified
          to be used for the result number's decimal point, thousands
          separator, and grouping between separators. Permissible locale
          values are the same as the legal values for the
          <a class="link" href="server-administration.html#sysvar_lc_time_names"><code class="literal">lc_time_names</code></a> system variable
          (see <a class="xref" href="charset.html#locale-support" title="10.15 MySQL服务器区域设置支持">Section&nbsp;10.15, “MySQL Server Locale Support”</a>). If no locale is
          specified, the default is <code class="literal">'en_US'</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.123456, 4);</code></strong><font></font>
        -&gt; '12,332.1235'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.1,4);</code></strong><font></font>
        -&gt; '12,332.1000'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.2,0);</code></strong><font></font>
        -&gt; '12,332'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT FORMAT(12332.2,2,'de_DE');</code></strong><font></font>
        -&gt; '12.332,20'<font></font>
</pre></li><li class="listitem"><a name="function_from-base64"></a><p>
          <a class="indexterm" name="idm140091687442864"></a>

          <a class="link" href="functions.html#function_from-base64"><code class="literal">FROM_BASE64(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Takes a string encoded with the base-64 encoded rules used by
          <a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64()</code></a> and returns the
          decoded result as a binary string. The result is
          <code class="literal">NULL</code> if the argument is
          <code class="literal">NULL</code> or not a valid base-64 string. See the
          description of <a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64()</code></a> for
          details about the encoding and decoding rules.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_BASE64('abc'), FROM_BASE64(TO_BASE64('abc'));</code></strong><font></font>
        -&gt; 'JWJj', 'abc'<font></font>
</pre></li><li class="listitem"><a name="function_hex"></a><p>
          <a class="indexterm" name="idm140091687429296"></a>

          <a class="link" href="functions.html#function_hex"><code class="literal">HEX(<em class="replaceable"><code>str</code></em>)</code></a>,
          <a class="link" href="functions.html#function_hex"><code class="literal">HEX(<em class="replaceable"><code>N</code></em>)</code></a>
        </p><p>
          For a string argument <em class="replaceable"><code>str</code></em>,
          <a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a> returns a hexadecimal
          string representation of <em class="replaceable"><code>str</code></em> where
          each byte of each character in <em class="replaceable"><code>str</code></em>
          is converted to two hexadecimal digits. (Multibyte characters
          therefore become more than two digits.) The inverse of this
          operation is performed by the
          <a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a> function.
        </p><p>
          For a numeric argument <em class="replaceable"><code>N</code></em>,
          <a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a> returns a hexadecimal
          string representation of the value of
          <em class="replaceable"><code>N</code></em> treated as a longlong
          (<a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>) number. This is
          equivalent to
          <a class="link" href="functions.html#function_conv"><code class="literal">CONV(<em class="replaceable"><code>N</code></em>,10,16)</code></a>.
          The inverse of this operation is performed by
          <a class="link" href="functions.html#function_conv"><code class="literal">CONV(HEX(<em class="replaceable"><code>N</code></em>),16,10)</code></a>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT X'616263', HEX('abc'), UNHEX(HEX('abc'));</code></strong><font></font>
        -&gt; 'abc', 616263, 'abc'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT HEX(255), CONV(HEX(255),16,10);</code></strong><font></font>
        -&gt; 'FF', 255<font></font>
</pre></li><li class="listitem"><a name="function_insert"></a><p>
          <a class="indexterm" name="idm140091687405600"></a>

          <a class="link" href="functions.html#function_insert"><code class="literal">INSERT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>,<em class="replaceable"><code>newstr</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em>, with the
          substring beginning at position <em class="replaceable"><code>pos</code></em>
          and <em class="replaceable"><code>len</code></em> characters long replaced by
          the string <em class="replaceable"><code>newstr</code></em>. Returns the
          original string if <em class="replaceable"><code>pos</code></em> is not
          within the length of the string. Replaces the rest of the
          string from position <em class="replaceable"><code>pos</code></em> if
          <em class="replaceable"><code>len</code></em> is not within the length of the
          rest of the string. Returns <code class="literal">NULL</code> if any
          argument is <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INSERT('Quadratic', 3, 4, 'What');</code></strong><font></font>
        -&gt; 'QuWhattic'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT INSERT('Quadratic', -1, 4, 'What');</code></strong><font></font>
        -&gt; 'Quadratic'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT INSERT('Quadratic', 3, 100, 'What');</code></strong><font></font>
        -&gt; 'QuWhat'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_instr"></a><p>
          <a class="indexterm" name="idm140091687388304"></a>

          <a class="link" href="functions.html#function_instr"><code class="literal">INSTR(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>substr</code></em>)</code></a>
        </p><p>
          Returns the position of the first occurrence of substring
          <em class="replaceable"><code>substr</code></em> in string
          <em class="replaceable"><code>str</code></em>. This is the same as the
          two-argument form of <a class="link" href="functions.html#function_locate"><code class="literal">LOCATE()</code></a>,
          except that the order of the arguments is reversed.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT INSTR('foobarbar', 'bar');</code></strong><font></font>
        -&gt; 4<font></font>
mysql&gt; <strong class="userinput"><code>SELECT INSTR('xbar', 'foobar');</code></strong><font></font>
        -&gt; 0<font></font>
</pre><p>
          This function is multibyte safe, and is case-sensitive only if
          at least one argument is a binary string.
        </p></li><li class="listitem"><a name="function_lcase"></a><p>
          <a class="indexterm" name="idm140091687374976"></a>

          <a class="link" href="functions.html#function_lcase"><code class="literal">LCASE(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_lcase"><code class="literal">LCASE()</code></a> is a synonym for
          <a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a>.
        </p><p>
          <code class="literal">LCASE()</code> used in a view is rewritten as
          <code class="literal">LOWER()</code> when storing the view's
          definition. (Bug #12844279)
        </p></li><li class="listitem"><a name="function_left"></a><p>
          <a class="indexterm" name="idm140091687363504"></a>

          <a class="link" href="functions.html#function_left"><code class="literal">LEFT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>)</code></a>
        </p><p>
          Returns the leftmost <em class="replaceable"><code>len</code></em> characters
          from the string <em class="replaceable"><code>str</code></em>, or
          <code class="literal">NULL</code> if any argument is
          <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LEFT('foobarbar', 5);</code></strong><font></font>
        -&gt; 'fooba'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_length"></a><p>
          <a class="indexterm" name="idm140091687350976"></a>

          <a class="link" href="functions.html#function_length"><code class="literal">LENGTH(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the length of the string
          <em class="replaceable"><code>str</code></em>, measured in bytes. A multibyte
          character counts as multiple bytes. This means that for a
          string containing five 2-byte characters,
          <a class="link" href="functions.html#function_length"><code class="literal">LENGTH()</code></a> returns
          <code class="literal">10</code>, whereas
          <a class="link" href="functions.html#function_char-length"><code class="literal">CHAR_LENGTH()</code></a> returns
          <code class="literal">5</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LENGTH('text');</code></strong><font></font>
        -&gt; 4<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The <code class="literal">Length()</code> OpenGIS spatial function is
            named <a class="link" href="functions.html#function_st-length"><code class="literal">ST_Length()</code></a> in MySQL.
</p>
</div>
</li><li class="listitem"><a name="function_load-file"></a><p>
          <a class="indexterm" name="idm140091687334400"></a>

          <a class="indexterm" name="idm140091687333328"></a>

          <a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE(<em class="replaceable"><code>file_name</code></em>)</code></a>
        </p><p>
          Reads the file and returns the file contents as a string. To
          use this function, the file must be located on the server
          host, you must specify the full path name to the file, and you
          must have the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege.
          The file must be readable by the server and its size less than
          <a class="link" href="server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a> bytes. If
          the <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a> system
          variable is set to a nonempty directory name, the file to be
          loaded must be located in that directory. (Prior to MySQL
          8.0.17, the file must be readable by all, not just readable by
          the server.)
        </p><p>
          If the file does not exist or cannot be read because one of
          the preceding conditions is not satisfied, the function
          returns <code class="literal">NULL</code>.
        </p><p>
          The <a class="link" href="server-administration.html#sysvar_character_set_filesystem"><code class="literal">character_set_filesystem</code></a>
          system variable controls interpretation of file names that are
          given as literal strings.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>UPDATE t</code></strong>
          <strong class="userinput"><code>  SET blob_col=LOAD_FILE('/tmp/picture')</code></strong>
          <strong class="userinput"><code>  WHERE id=1;</code></strong>
</pre></li><li class="listitem"><a name="function_locate"></a><p>
          <a class="indexterm" name="idm140091687315200"></a>

          <a class="link" href="functions.html#function_locate"><code class="literal">LOCATE(<em class="replaceable"><code>substr</code></em>,<em class="replaceable"><code>str</code></em>)</code></a>,
          <a class="link" href="functions.html#function_locate"><code class="literal">LOCATE(<em class="replaceable"><code>substr</code></em>,<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>)</code></a>
        </p><p>
          The first syntax returns the position of the first occurrence
          of substring <em class="replaceable"><code>substr</code></em> in string
          <em class="replaceable"><code>str</code></em>. The second syntax returns the
          position of the first occurrence of substring
          <em class="replaceable"><code>substr</code></em> in string
          <em class="replaceable"><code>str</code></em>, starting at position
          <em class="replaceable"><code>pos</code></em>. Returns <code class="literal">0</code>
          if <em class="replaceable"><code>substr</code></em> is not in
          <em class="replaceable"><code>str</code></em>. Returns
          <code class="literal">NULL</code> if any argument is
          <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOCATE('bar', 'foobarbar');</code></strong><font></font>
        -&gt; 4<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LOCATE('xbar', 'foobar');</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LOCATE('bar', 'foobarbar', 5);</code></strong><font></font>
        -&gt; 7<font></font>
</pre><p>
          This function is multibyte safe, and is case-sensitive only if
          at least one argument is a binary string.
        </p></li><li class="listitem"><a name="function_lower"></a><p>
          <a class="indexterm" name="idm140091687295664"></a>

          <a class="link" href="functions.html#function_lower"><code class="literal">LOWER(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em> with all
          characters changed to lowercase according to the current
          character set mapping. The default is
          <code class="literal">utf8mb4</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOWER('QUADRATICALLY');</code></strong><font></font>
        -&gt; 'quadratically'<font></font>
</pre><p>
          <a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a> (and
          <a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a>) are ineffective when
          applied to binary strings
          (<a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a>,
          <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a>). To perform lettercase
          conversion, convert the string to a nonbinary string:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET @str = BINARY 'New York';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT LOWER(@str), LOWER(CONVERT(@str USING utf8mb4));</code></strong><font></font>
+-------------+------------------------------------+<font></font>
| LOWER(@str) | LOWER(CONVERT(@str USING utf8mb4)) |<font></font>
+-------------+------------------------------------+<font></font>
| New York    | new york                           |<font></font>
+-------------+------------------------------------+<font></font>
</pre><p>
          For collations of Unicode character sets,
          <a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a> and
          <a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a> work according to the
          Unicode Collation Algorithm (UCA) version in the collation
          name, if there is one, and UCA 4.0.0 if no version is
          specified. For example, <code class="literal">utf8mb4_0900_ai_ci</code>
          and <code class="literal">utf8_unicode_520_ci</code> work according to
          UCA 9.0.0 and 5.2.0, respectively, whereas
          <code class="literal">utf8_unicode_ci</code> works according to UCA
          4.0.0. See <a class="xref" href="charset.html#charset-unicode-sets" title="10.10.1 Unicode字符集">Section&nbsp;10.10.1, “Unicode Character Sets”</a>.
        </p><p>
          This function is multibyte safe.
        </p><p>
          <code class="literal">LCASE()</code> used within views is rewritten as
          <code class="literal">LOWER()</code>.
        </p></li><li class="listitem"><a name="function_lpad"></a><p>
          <a class="indexterm" name="idm140091687267808"></a>

          <a class="link" href="functions.html#function_lpad"><code class="literal">LPAD(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>,<em class="replaceable"><code>padstr</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em>, left-padded
          with the string <em class="replaceable"><code>padstr</code></em> to a length
          of <em class="replaceable"><code>len</code></em> characters. If
          <em class="replaceable"><code>str</code></em> is longer than
          <em class="replaceable"><code>len</code></em>, the return value is shortened
          to <em class="replaceable"><code>len</code></em> characters.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LPAD('hi',4,'??');</code></strong><font></font>
        -&gt; '??hi'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LPAD('hi',1,'??');</code></strong><font></font>
        -&gt; 'h'<font></font>
</pre></li><li class="listitem"><a name="function_ltrim"></a><p>
          <a class="indexterm" name="idm140091687254176"></a>

          <a class="link" href="functions.html#function_ltrim"><code class="literal">LTRIM(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em> with leading
          space characters removed.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LTRIM('  barbar');</code></strong><font></font>
        -&gt; 'barbar'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_make-set"></a><p>
          <a class="indexterm" name="idm140091687243872"></a>

          <a class="link" href="functions.html#function_make-set"><code class="literal">MAKE_SET(<em class="replaceable"><code>bits</code></em>,<em class="replaceable"><code>str1</code></em>,<em class="replaceable"><code>str2</code></em>,...)</code></a>
        </p><p>
          Returns a set value (a string containing substrings separated
          by <code class="literal">,</code> characters) consisting of the strings
          that have the corresponding bit in
          <em class="replaceable"><code>bits</code></em> set.
          <em class="replaceable"><code>str1</code></em> corresponds to bit 0,
          <em class="replaceable"><code>str2</code></em> to bit 1, and so on.
          <code class="literal">NULL</code> values in
          <em class="replaceable"><code>str1</code></em>,
          <em class="replaceable"><code>str2</code></em>, <code class="literal">...</code> are
          not appended to the result.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(1,'a','b','c');</code></strong><font></font>
        -&gt; 'a'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(1 | 4,'hello','nice','world');</code></strong><font></font>
        -&gt; 'hello,world'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(1 | 4,'hello','nice',NULL,'world');</code></strong><font></font>
        -&gt; 'hello'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT MAKE_SET(0,'a','b','c');</code></strong><font></font>
        -&gt; ''<font></font>
</pre></li><li class="listitem"><a name="function_mid"></a><p>
          <a class="indexterm" name="idm140091687226752"></a>

          <a class="link" href="functions.html#function_mid"><code class="literal">MID(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_mid"><code class="literal">MID(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code></a>
          is a synonym for
          <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code></a>.
        </p></li><li class="listitem"><a name="function_oct"></a><p>
          <a class="indexterm" name="idm140091687214032"></a>

          <a class="link" href="functions.html#function_oct"><code class="literal">OCT(<em class="replaceable"><code>N</code></em>)</code></a>
        </p><p>
          Returns a string representation of the octal value of
          <em class="replaceable"><code>N</code></em>, where
          <em class="replaceable"><code>N</code></em> is a longlong
          (<a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>) number. This is
          equivalent to
          <a class="link" href="functions.html#function_conv"><code class="literal">CONV(<em class="replaceable"><code>N</code></em>,10,8)</code></a>.
          Returns <code class="literal">NULL</code> if
          <em class="replaceable"><code>N</code></em> is <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT OCT(12);</code></strong><font></font>
        -&gt; '14'<font></font>
</pre></li><li class="listitem"><a name="function_octet-length"></a><p>
          <a class="indexterm" name="idm140091687198992"></a>

          <a class="link" href="functions.html#function_octet-length"><code class="literal">OCTET_LENGTH(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_octet-length"><code class="literal">OCTET_LENGTH()</code></a> is a synonym for
          <a class="link" href="functions.html#function_length"><code class="literal">LENGTH()</code></a>.
        </p></li><li class="listitem"><a name="function_ord"></a><p>
          <a class="indexterm" name="idm140091687189344"></a>

          <a class="link" href="functions.html#function_ord"><code class="literal">ORD(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          If the leftmost character of the string
          <em class="replaceable"><code>str</code></em> is a multibyte character,
          returns the code for that character, calculated from the
          numeric values of its constituent bytes using this formula:
        </p><pre data-lang="clike" class="programlisting">  (1st byte code)<font></font>
+ (2nd byte code * 256)<font></font>
+ (3rd byte code * 256^2) ...<font></font>
</pre><p>
          If the leftmost character is not a multibyte character,
          <a class="link" href="functions.html#function_ord"><code class="literal">ORD()</code></a> returns the same value as
          the <a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a> function.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ORD('2');</code></strong><font></font>
        -&gt; 50<font></font>
</pre></li><li class="listitem"><a name="function_position"></a><p>
          <a class="indexterm" name="idm140091687175360"></a>

          <a class="link" href="functions.html#function_position"><code class="literal">POSITION(<em class="replaceable"><code>substr</code></em>
          IN <em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_position"><code class="literal">POSITION(<em class="replaceable"><code>substr</code></em>
          IN <em class="replaceable"><code>str</code></em>)</code></a> is a synonym for
          <a class="link" href="functions.html#function_locate"><code class="literal">LOCATE(<em class="replaceable"><code>substr</code></em>,<em class="replaceable"><code>str</code></em>)</code></a>.
        </p></li><li class="listitem"><a name="function_quote"></a><p>
          <a class="indexterm" name="idm140091687163648"></a>

          <a class="link" href="functions.html#function_quote"><code class="literal">QUOTE(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Quotes a string to produce a result that can be used as a
          properly escaped data value in an SQL statement. The string is
          returned enclosed by single quotation marks and with each
          instance of backslash (<code class="literal">\</code>), single quote
          (<code class="literal">'</code>), ASCII <code class="literal">NUL</code>, and
          Control+Z preceded by a backslash. If the argument is
          <code class="literal">NULL</code>, the return value is the word
          <span class="quote">“<span class="quote">NULL</span>”</span> without enclosing single quotation marks.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT QUOTE('Don\'t!');</code></strong><font></font>
        -&gt; 'Don\'t!'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT QUOTE(NULL);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre><a class="indexterm" name="idm140091687152288"></a><p>
          For comparison, see the quoting rules for literal strings and
          within the C API in <a class="xref" href="language-structure.html#string-literals" title="9.1.1字符串文字">Section&nbsp;9.1.1, “String Literals”</a>, and
          <a class="xref" href="connectors-apis.html#mysql-real-escape-string-quote" title="28.7.7.56 mysql_real_escape_string_quote（）">Section&nbsp;28.7.7.56, “mysql_real_escape_string_quote()”</a>.
        </p></li><li class="listitem"><a name="function_repeat"></a><p>
          <a class="indexterm" name="idm140091687146880"></a>

          <a class="link" href="functions.html#function_repeat"><code class="literal">REPEAT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>count</code></em>)</code></a>
        </p><p>
          Returns a string consisting of the string
          <em class="replaceable"><code>str</code></em> repeated
          <em class="replaceable"><code>count</code></em> times. If
          <em class="replaceable"><code>count</code></em> is less than 1, returns an
          empty string. Returns <code class="literal">NULL</code> if
          <em class="replaceable"><code>str</code></em> or
          <em class="replaceable"><code>count</code></em> are <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REPEAT('MySQL', 3);</code></strong><font></font>
        -&gt; 'MySQLMySQLMySQL'<font></font>
</pre></li><li class="listitem"><a name="function_replace"></a><p>
          <a class="indexterm" name="idm140091687133360"></a>

          <a class="link" href="functions.html#function_replace"><code class="literal">REPLACE(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>from_str</code></em>,<em class="replaceable"><code>to_str</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em> with all
          occurrences of the string <em class="replaceable"><code>from_str</code></em>
          replaced by the string <em class="replaceable"><code>to_str</code></em>.
          <a class="link" href="functions.html#function_replace"><code class="literal">REPLACE()</code></a> performs a
          case-sensitive match when searching for
          <em class="replaceable"><code>from_str</code></em>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REPLACE('www.mysql.com', 'w', 'Ww');</code></strong><font></font>
        -&gt; 'WwWwWw.mysql.com'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_reverse"></a><p>
          <a class="indexterm" name="idm140091687119504"></a>

          <a class="link" href="functions.html#function_reverse"><code class="literal">REVERSE(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em> with the
          order of the characters reversed.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REVERSE('abc');</code></strong><font></font>
        -&gt; 'cba'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_right"></a><p>
          <a class="indexterm" name="idm140091687109216"></a>

          <a class="link" href="functions.html#function_right"><code class="literal">RIGHT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>)</code></a>
        </p><p>
          Returns the rightmost <em class="replaceable"><code>len</code></em>
          characters from the string <em class="replaceable"><code>str</code></em>, or
          <code class="literal">NULL</code> if any argument is
          <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT RIGHT('foobarbar', 4);</code></strong><font></font>
        -&gt; 'rbar'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_rpad"></a><p>
          <a class="indexterm" name="idm140091687096688"></a>

          <a class="link" href="functions.html#function_rpad"><code class="literal">RPAD(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>len</code></em>,<em class="replaceable"><code>padstr</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em>,
          right-padded with the string <em class="replaceable"><code>padstr</code></em>
          to a length of <em class="replaceable"><code>len</code></em> characters. If
          <em class="replaceable"><code>str</code></em> is longer than
          <em class="replaceable"><code>len</code></em>, the return value is shortened
          to <em class="replaceable"><code>len</code></em> characters.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT RPAD('hi',5,'?');</code></strong><font></font>
        -&gt; 'hi???'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT RPAD('hi',1,'?');</code></strong><font></font>
        -&gt; 'h'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_rtrim"></a><p>
          <a class="indexterm" name="idm140091687082608"></a>

          <a class="link" href="functions.html#function_rtrim"><code class="literal">RTRIM(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em> with
          trailing space characters removed.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT RTRIM('barbar   ');</code></strong><font></font>
        -&gt; 'barbar'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_soundex"></a><p>
          <a class="indexterm" name="idm140091687072368"></a>

          <a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns a soundex string from <em class="replaceable"><code>str</code></em>.
          Two strings that sound almost the same should have identical
          soundex strings. A standard soundex string is four characters
          long, but the <a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX()</code></a>
          function returns an arbitrarily long string. You can use
          <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a> on the result to
          get a standard soundex string. All nonalphabetic characters in
          <em class="replaceable"><code>str</code></em> are ignored. All international
          alphabetic characters outside the A-Z range are treated as
          vowels.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            When using <a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX()</code></a>, you
            should be aware of the following limitations:
</p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              This function, as currently implemented, is intended to
              work well with strings that are in the English language
              only. Strings in other languages may not produce reliable
              results.
            </p></li><li class="listitem"><p>
              This function is not guaranteed to provide consistent
              results with strings that use multibyte character sets,
              including <code class="literal">utf-8</code>. See Bug #22638 for
              more information.
</p></li></ul>
</div>
<pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SOUNDEX('Hello');</code></strong><font></font>
        -&gt; 'H400'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SOUNDEX('Quadratically');</code></strong><font></font>
        -&gt; 'Q36324'<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            This function implements the original Soundex algorithm, not
            the more popular enhanced version (also described by D.
            Knuth). The difference is that original version discards
            vowels first and duplicates second, whereas the enhanced
            version discards duplicates first and vowels second.
</p>
</div>
</li><li class="listitem"><a name="operator_sounds-like"></a><p>
          <a class="indexterm" name="idm140091687051360"></a>

          <a class="link" href="functions.html#operator_sounds-like"><code class="literal"><em class="replaceable"><code>expr1</code></em>
          SOUNDS LIKE <em class="replaceable"><code>expr2</code></em></code></a>
        </p><p>
          This is the same as
          <a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX(<em class="replaceable"><code>expr1</code></em>)
          = SOUNDEX(<em class="replaceable"><code>expr2</code></em>)</code></a>.
        </p></li><li class="listitem"><a name="function_space"></a><p>
          <a class="indexterm" name="idm140091687041856"></a>

          <a class="link" href="functions.html#function_space"><code class="literal">SPACE(<em class="replaceable"><code>N</code></em>)</code></a>
        </p><p>
          Returns a string consisting of <em class="replaceable"><code>N</code></em>
          space characters.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SPACE(6);</code></strong><font></font>
        -&gt; '      '<font></font>
</pre></li><li class="listitem"><a name="function_substr"></a><p>
          <a class="indexterm" name="idm140091687032032"></a>

          <a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>)</code></a>,
          <a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em>
          FROM <em class="replaceable"><code>pos</code></em>)</code></a>,
          <a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code></a>,
          <a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR(<em class="replaceable"><code>str</code></em>
          FROM <em class="replaceable"><code>pos</code></em> FOR
          <em class="replaceable"><code>len</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR()</code></a> is a synonym for
          <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a>.
        </p></li><li class="listitem"><a name="function_substring"></a><p>
          <a class="indexterm" name="idm140091687015152"></a>

          <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>)</code></a>,
          <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>
          FROM <em class="replaceable"><code>pos</code></em>)</code></a>,
          <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pos</code></em>,<em class="replaceable"><code>len</code></em>)</code></a>,
          <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING(<em class="replaceable"><code>str</code></em>
          FROM <em class="replaceable"><code>pos</code></em> FOR
          <em class="replaceable"><code>len</code></em>)</code></a>
        </p><p>
          The forms without a <em class="replaceable"><code>len</code></em> argument
          return a substring from string <em class="replaceable"><code>str</code></em>
          starting at position <em class="replaceable"><code>pos</code></em>. The forms
          with a <em class="replaceable"><code>len</code></em> argument return a
          substring <em class="replaceable"><code>len</code></em> characters long from
          string <em class="replaceable"><code>str</code></em>, starting at position
          <em class="replaceable"><code>pos</code></em>. The forms that use
          <code class="literal">FROM</code> are standard SQL syntax. It is also
          possible to use a negative value for
          <em class="replaceable"><code>pos</code></em>. In this case, the beginning of
          the substring is <em class="replaceable"><code>pos</code></em> characters
          from the end of the string, rather than the beginning. A
          negative value may be used for <em class="replaceable"><code>pos</code></em>
          in any of the forms of this function.
        </p><p>
          For all forms of <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a>,
          the position of the first character in the string from which
          the substring is to be extracted is reckoned as
          <code class="literal">1</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Quadratically',5);</code></strong><font></font>
        -&gt; 'ratically'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('foobarbar' FROM 4);</code></strong><font></font>
        -&gt; 'barbar'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Quadratically',5,6);</code></strong><font></font>
        -&gt; 'ratica'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Sakila', -3);</code></strong><font></font>
        -&gt; 'ila'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Sakila', -5, 3);</code></strong><font></font>
        -&gt; 'aki'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING('Sakila' FROM -4 FOR 2);</code></strong><font></font>
        -&gt; 'ki'<font></font>
</pre><p>
          This function is multibyte safe.
        </p><p>
          If <em class="replaceable"><code>len</code></em> is less than 1, the result
          is the empty string.
        </p></li><li class="listitem"><a name="function_substring-index"></a><p>
          <a class="indexterm" name="idm140091686985376"></a>

          <a class="link" href="functions.html#function_substring-index"><code class="literal">SUBSTRING_INDEX(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>delim</code></em>,<em class="replaceable"><code>count</code></em>)</code></a>
        </p><p>
          Returns the substring from string
          <em class="replaceable"><code>str</code></em> before
          <em class="replaceable"><code>count</code></em> occurrences of the delimiter
          <em class="replaceable"><code>delim</code></em>. If
          <em class="replaceable"><code>count</code></em> is positive, everything to
          the left of the final delimiter (counting from the left) is
          returned. If <em class="replaceable"><code>count</code></em> is negative,
          everything to the right of the final delimiter (counting from
          the right) is returned.
          <a class="link" href="functions.html#function_substring-index"><code class="literal">SUBSTRING_INDEX()</code></a> performs a
          case-sensitive match when searching for
          <em class="replaceable"><code>delim</code></em>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING_INDEX('www.mysql.com', '.', 2);</code></strong><font></font>
        -&gt; 'www.mysql'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SUBSTRING_INDEX('www.mysql.com', '.', -2);</code></strong><font></font>
        -&gt; 'mysql.com'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_to-base64"></a><p>
          <a class="indexterm" name="idm140091686969520"></a>

          <a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Converts the string argument to base-64 encoded form and
          returns the result as a character string with the connection
          character set and collation. If the argument is not a string,
          it is converted to a string before conversion takes place. The
          result is <code class="literal">NULL</code> if the argument is
          <code class="literal">NULL</code>. Base-64 encoded strings can be
          decoded using the <a class="link" href="functions.html#function_from-base64"><code class="literal">FROM_BASE64()</code></a>
          function.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_BASE64('abc'), FROM_BASE64(TO_BASE64('abc'));</code></strong><font></font>
        -&gt; 'JWJj', 'abc'<font></font>
</pre><p>
          Different base-64 encoding schemes exist. These are the
          encoding and decoding rules used by
          <a class="link" href="functions.html#function_to-base64"><code class="literal">TO_BASE64()</code></a> and
          <a class="link" href="functions.html#function_from-base64"><code class="literal">FROM_BASE64()</code></a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              The encoding for alphabet value 62 is
              <code class="literal">'+'</code>.
            </p></li><li class="listitem"><p>
              The encoding for alphabet value 63 is
              <code class="literal">'/'</code>.
            </p></li><li class="listitem"><p>
              Encoded output consists of groups of 4 printable
              characters. Each 3 bytes of the input data are encoded
              using 4 characters. If the last group is incomplete, it is
              padded with <code class="literal">'='</code> characters to a length
              of 4.
            </p></li><li class="listitem"><p>
              A newline is added after each 76 characters of encoded
              output to divide long output into multiple lines.
            </p></li><li class="listitem"><p>
              Decoding recognizes and ignores newline, carriage return,
              tab, and space.
</p></li></ul>
</div>
</li><li class="listitem"><a name="function_trim"></a><p>
          <a class="indexterm" name="idm140091686946176"></a>

          <a class="link" href="functions.html#function_trim"><code class="literal">TRIM([{BOTH | LEADING | TRAILING}
          [<em class="replaceable"><code>remstr</code></em>] FROM]
          <em class="replaceable"><code>str</code></em>)</code></a>,
          <a class="link" href="functions.html#function_trim"><code class="literal">TRIM([<em class="replaceable"><code>remstr</code></em>
          FROM] <em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em> with all
          <em class="replaceable"><code>remstr</code></em> prefixes or suffixes
          removed. If none of the specifiers <code class="literal">BOTH</code>,
          <code class="literal">LEADING</code>, or <code class="literal">TRAILING</code> is
          given, <code class="literal">BOTH</code> is assumed.
          <em class="replaceable"><code>remstr</code></em> is optional and, if not
          specified, spaces are removed.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TRIM('  bar   ');</code></strong><font></font>
        -&gt; 'bar'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TRIM(LEADING 'x' FROM 'xxxbarxxx');</code></strong><font></font>
        -&gt; 'barxxx'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TRIM(BOTH 'x' FROM 'xxxbarxxx');</code></strong><font></font>
        -&gt; 'bar'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TRIM(TRAILING 'xyz' FROM 'barxxyz');</code></strong><font></font>
        -&gt; 'barx'<font></font>
</pre><p>
          This function is multibyte safe.
        </p></li><li class="listitem"><a name="function_ucase"></a><p>
          <a class="indexterm" name="idm140091686927120"></a>

          <a class="link" href="functions.html#function_ucase"><code class="literal">UCASE(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_ucase"><code class="literal">UCASE()</code></a> is a synonym for
          <a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a>.
        </p><p>
          <code class="literal">UCASE()</code> used within views is rewritten as
          <code class="literal">UPPER()</code>.
        </p></li><li class="listitem"><a name="function_unhex"></a><p>
          <a class="indexterm" name="idm140091686915632"></a>

          <a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          For a string argument <em class="replaceable"><code>str</code></em>,
          <a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX(<em class="replaceable"><code>str</code></em>)</code></a>
          interprets each pair of characters in the argument as a
          hexadecimal number and converts it to the byte represented by
          the number. The return value is a binary string.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UNHEX('4D7953514C');</code></strong><font></font>
        -&gt; 'MySQL'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT X'4D7953514C';</code></strong><font></font>
        -&gt; 'MySQL'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT UNHEX(HEX('string'));</code></strong><font></font>
        -&gt; 'string'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT HEX(UNHEX('1267'));</code></strong><font></font>
        -&gt; '1267'<font></font>
</pre><p>
          The characters in the argument string must be legal
          hexadecimal digits: <code class="literal">'0'</code> ..
          <code class="literal">'9'</code>, <code class="literal">'A'</code> ..
          <code class="literal">'F'</code>, <code class="literal">'a'</code> ..
          <code class="literal">'f'</code>. If the argument contains any
          nonhexadecimal digits, the result is <code class="literal">NULL</code>:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UNHEX('GG');</code></strong><font></font>
+-------------+<font></font>
| UNHEX('GG') |<font></font>
+-------------+<font></font>
| NULL        |<font></font>
+-------------+<font></font>
</pre><p>
          A <code class="literal">NULL</code> result can occur if the argument to
          <a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a> is a
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a> column, because values
          are padded with 0x00 bytes when stored but those bytes are not
          stripped on retrieval. For example, <code class="literal">'41'</code> is
          stored into a <code class="literal">CHAR(3)</code> column as
          <code class="literal">'41&nbsp;'</code> and retrieved as
          <code class="literal">'41'</code> (with the trailing pad space
          stripped), so <a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a> for the
          column value returns <code class="literal">'A'</code>. By contrast
          <code class="literal">'41'</code> is stored into a
          <code class="literal">BINARY(3)</code> column as
          <code class="literal">'41\0'</code> and retrieved as
          <code class="literal">'41\0'</code> (with the trailing pad
          <code class="literal">0x00</code> byte not stripped).
          <code class="literal">'\0'</code> is not a legal hexadecimal digit, so
          <a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a> for the column value
          returns <code class="literal">NULL</code>.
        </p><p>
          For a numeric argument <em class="replaceable"><code>N</code></em>, the
          inverse of
          <a class="link" href="functions.html#function_hex"><code class="literal">HEX(<em class="replaceable"><code>N</code></em>)</code></a>
          is not performed by <a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a>.
          Use
          <a class="link" href="functions.html#function_conv"><code class="literal">CONV(HEX(<em class="replaceable"><code>N</code></em>),16,10)</code></a>
          instead. See the description of
          <a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a>.
        </p></li><li class="listitem"><a name="function_upper"></a><p>
          <a class="indexterm" name="idm140091686872752"></a>

          <a class="link" href="functions.html#function_upper"><code class="literal">UPPER(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p>
          Returns the string <em class="replaceable"><code>str</code></em> with all
          characters changed to uppercase according to the current
          character set mapping. The default is
          <code class="literal">utf8mb4</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UPPER('Hej');</code></strong><font></font>
        -&gt; 'HEJ'<font></font>
</pre><p>
          See the description of <a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a>
          for information that also applies to
          <a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a>. This included
          information about how to perform lettercase conversion of
          binary strings (<a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a>,
          <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a>) for which these functions
          are ineffective, and information about case folding for
          Unicode character sets.
        </p><p>
          This function is multibyte safe.
        </p><p>
          <code class="literal">UCASE()</code> used within views is rewritten as
          <code class="literal">UPPER()</code>.
        </p></li><li class="listitem"><a name="function_weight-string"></a><p>
          <a class="indexterm" name="idm140091686853488"></a>

          <a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str</code></em>
          [AS {CHAR|BINARY}(<em class="replaceable"><code>N</code></em>)]
          [<em class="replaceable"><code>flags</code></em>])</code></a>
        </p><p>
          This function returns the weight string for the input string.
          The return value is a binary string that represents the
          comparison and sorting value of the string. It has these
          properties:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              If
              <a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str1</code></em>)</code></a>
              =
              <a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str2</code></em>)</code></a>,
              then <code class="literal"><em class="replaceable"><code>str1</code></em> =
              <em class="replaceable"><code>str2</code></em></code>
              (<em class="replaceable"><code>str1</code></em> and
              <em class="replaceable"><code>str2</code></em> are considered equal)
            </p></li><li class="listitem"><p>
              If
              <a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str1</code></em>)</code></a>
              &lt;
              <a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING(<em class="replaceable"><code>str2</code></em>)</code></a>,
              then <code class="literal"><em class="replaceable"><code>str1</code></em> &lt;
              <em class="replaceable"><code>str2</code></em></code>
              (<em class="replaceable"><code>str1</code></em> sorts before
              <em class="replaceable"><code>str2</code></em>)
</p></li></ul>
</div>
<p>
          <a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING()</code></a> is a debugging
          function intended for internal use. Its behavior can change
          without notice between MySQL versions. It can be used for
          testing and debugging of collations, especially if you are
          adding a new collation. See
          <a class="xref" href="charset.html#adding-collation" title="10.13为字符集添加排序规则">Section&nbsp;10.13, “Adding a Collation to a Character Set”</a>.
        </p><p>
          This list briefly summarizes the arguments. More details are
          given in the discussion following the list.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <em class="replaceable"><code>str</code></em>: The input string
              expression.
            </p></li><li class="listitem"><p>
              <code class="literal">AS</code> clause: Optional; cast the input
              string to a given type and length.
            </p></li><li class="listitem"><p>
              <em class="replaceable"><code>flags</code></em>: Optional; unused.
</p></li></ul>
</div>
<p>
          The input string, <em class="replaceable"><code>str</code></em>, is a string
          expression. If the input is a nonbinary (character) string
          such as a <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a>, or
          <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a> value, the return value
          contains the collation weights for the string. If the input is
          a binary (byte) string such as a
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a>, or
          <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a> value, the return value is
          the same as the input (the weight for each byte in a binary
          string is the byte value). If the input is
          <code class="literal">NULL</code>,
          <a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING()</code></a> returns
          <code class="literal">NULL</code>.
        </p><p>
          Examples:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = _utf8mb4 'AB' COLLATE utf8mb4_0900_ai_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong><font></font>
+------+---------+------------------------+<font></font>
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |<font></font>
+------+---------+------------------------+<font></font>
| AB   | 4142    | 1C471C60               |<font></font>
+------+---------+------------------------+<font></font>
</pre><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = _utf8mb4 'ab' COLLATE utf8mb4_0900_ai_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong><font></font>
+------+---------+------------------------+<font></font>
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |<font></font>
+------+---------+------------------------+<font></font>
| ab   | 6162    | 1C471C60               |<font></font>
+------+---------+------------------------+<font></font>
</pre><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = CAST('AB' AS BINARY);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong><font></font>
+------+---------+------------------------+<font></font>
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |<font></font>
+------+---------+------------------------+<font></font>
| AB   | 4142    | 4142                   |<font></font>
+------+---------+------------------------+<font></font>
</pre><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = CAST('ab' AS BINARY);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @s, HEX(@s), HEX(WEIGHT_STRING(@s));</code></strong><font></font>
+------+---------+------------------------+<font></font>
| @s   | HEX(@s) | HEX(WEIGHT_STRING(@s)) |<font></font>
+------+---------+------------------------+<font></font>
| ab   | 6162    | 6162                   |<font></font>
+------+---------+------------------------+<font></font>
</pre><p>
          The preceding examples use
          <a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a> to display the
          <a class="link" href="functions.html#function_weight-string"><code class="literal">WEIGHT_STRING()</code></a> result. Because
          the result is a binary value,
          <a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a> can be especially useful
          when the result contains nonprinting values, to display it in
          printable form:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s = CONVERT(X'C39F' USING utf8) COLLATE utf8_czech_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING(@s));</code></strong><font></font>
+------------------------+<font></font>
| HEX(WEIGHT_STRING(@s)) |<font></font>
+------------------------+<font></font>
| 0FEA0FEA               |<font></font>
+------------------------+<font></font>
</pre><p>
          For non-<code class="literal">NULL</code> return values, the data type
          of the value is <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a> if
          its length is within the maximum length for
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a>, otherwise the data
          type is <a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a>.
        </p><p>
          The <code class="literal">AS</code> clause may be given to cast the
          input string to a nonbinary or binary string and to force it
          to a given length:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">AS CHAR(<em class="replaceable"><code>N</code></em>)</code>
              casts the string to a nonbinary string and pads it on the
              right with spaces to a length of
              <em class="replaceable"><code>N</code></em> characters.
              <em class="replaceable"><code>N</code></em> must be at least 1. If
              <em class="replaceable"><code>N</code></em> is less than the length of
              the input string, the string is truncated to
              <em class="replaceable"><code>N</code></em> characters. No warning occurs
              for truncation.
            </p></li><li class="listitem"><p>
              <code class="literal">AS BINARY(<em class="replaceable"><code>N</code></em>)</code>
              is similar but casts the string to a binary string,
              <em class="replaceable"><code>N</code></em> is measured in bytes (not
              characters), and padding uses <code class="literal">0x00</code>
              bytes (not spaces).
</p></li></ul>
</div>
<pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET NAMES 'latin1';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING('ab' AS CHAR(4)));</code></strong><font></font>
+-------------------------------------+<font></font>
| HEX(WEIGHT_STRING('ab' AS CHAR(4))) |<font></font>
+-------------------------------------+<font></font>
| 41422020                            |<font></font>
+-------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SET NAMES 'utf8';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING('ab' AS CHAR(4)));</code></strong><font></font>
+-------------------------------------+<font></font>
| HEX(WEIGHT_STRING('ab' AS CHAR(4))) |<font></font>
+-------------------------------------+<font></font>
| 0041004200200020                    |<font></font>
+-------------------------------------+<font></font>
</pre><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HEX(WEIGHT_STRING('ab' AS BINARY(4)));</code></strong><font></font>
+---------------------------------------+<font></font>
| HEX(WEIGHT_STRING('ab' AS BINARY(4))) |<font></font>
+---------------------------------------+<font></font>
| 61620000                              |<font></font>
+---------------------------------------+<font></font>
</pre><p>
          The <em class="replaceable"><code>flags</code></em> clause currently is
          unused.
</p></li></ul>
</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="string-comparison-functions"></a>12.5.1&nbsp;String Comparison Functions</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091686775648"></a><a class="indexterm" name="idm140091686774560"></a>
<div class="table">
<a name="idm140091686773072"></a><p class="title"><b>Table&nbsp;12.8&nbsp;String Comparison Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists string comparison operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a></td>
<td>
      Simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_not-like"><code class="literal">NOT LIKE</code></a></td>
<td>
      Negation of simple pattern matching
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a></td>
<td>
      Compare two strings
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
        If a string function is given a binary string as an argument,
        the resulting string is also a binary string. A number converted
        to a string is treated as a binary string. This affects only
        comparisons.
      </p><a class="indexterm" name="idm140091686755584"></a><a class="indexterm" name="idm140091686754096"></a><p>
        Normally, if any expression in a string comparison is case
        sensitive, the comparison is performed in case-sensitive
        fashion.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_like"></a><p>
            <a class="indexterm" name="idm140091686748880"></a>

            <a class="link" href="functions.html#operator_like"><code class="literal"><em class="replaceable"><code>expr</code></em>
            LIKE <em class="replaceable"><code>pat</code></em> [ESCAPE
            '<em class="replaceable"><code>escape_char</code></em>']</code></a>
          </p><p>
            Pattern matching using an SQL pattern. Returns
            <code class="literal">1</code> (<code class="literal">TRUE</code>) or
            <code class="literal">0</code> (<code class="literal">FALSE</code>). If either
            <em class="replaceable"><code>expr</code></em> or
            <em class="replaceable"><code>pat</code></em> is <code class="literal">NULL</code>,
            the result is <code class="literal">NULL</code>.
          </p><p>
            The pattern need not be a literal string. For example, it
            can be specified as a string expression or table column.
          </p><p>
            Per the SQL standard, <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a>
            performs matching on a per-character basis, thus it can
            produce results different from the
            <a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a> comparison
            operator:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'ä' LIKE 'ae' COLLATE latin1_german2_ci;</code></strong><font></font>
+-----------------------------------------+<font></font>
| 'ä' LIKE 'ae' COLLATE latin1_german2_ci |<font></font>
+-----------------------------------------+<font></font>
|                                       0 |<font></font>
+-----------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'ä' = 'ae' COLLATE latin1_german2_ci;</code></strong><font></font>
+--------------------------------------+<font></font>
| 'ä' = 'ae' COLLATE latin1_german2_ci |<font></font>
+--------------------------------------+<font></font>
|                                    1 |<font></font>
+--------------------------------------+<font></font>
</pre><p>
            In particular, trailing spaces are significant, which is not
            true for <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a> or
            <a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a> comparisons performed
            with the <a class="link" href="functions.html#operator_equal"><code class="literal">=</code></a>
            operator:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'a' = 'a ', 'a' LIKE 'a ';</code></strong><font></font>
+------------+---------------+<font></font>
| 'a' = 'a ' | 'a' LIKE 'a ' |<font></font>
+------------+---------------+<font></font>
|          1 |             0 |<font></font>
+------------+---------------+<font></font>
1 row in set (0.00 sec)<font></font>
</pre><p>
            With <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> you can use the
            following two wildcard characters in the pattern:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">%</code> matches any number of characters,
                even zero characters.
              </p></li><li class="listitem"><p>
                <code class="literal">_</code> matches exactly one character.
</p></li></ul>
</div>
<pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'David!' LIKE 'David_';</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'David!' LIKE '%D%v%';</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            To test for literal instances of a wildcard character,
            precede it by the escape character. If you do not specify
            the <code class="literal">ESCAPE</code> character,
            <code class="literal">\</code> is assumed.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">\%</code> matches one <code class="literal">%</code>
                character.
              </p></li><li class="listitem"><p>
                <code class="literal">\_</code> matches one <code class="literal">_</code>
                character.
</p></li></ul>
</div>
<pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'David!' LIKE 'David\_';</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'David_' LIKE 'David\_';</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            To specify a different escape character, use the
            <code class="literal">ESCAPE</code> clause:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'David_' LIKE 'David|_' ESCAPE '|';</code></strong><font></font>
        -&gt; 1<font></font>
</pre><p>
            The escape sequence should be empty or one character long.
            The expression must evaluate as a constant at execution
            time. If the
            <a class="link" href="server-administration.html#sqlmode_no_backslash_escapes"><code class="literal">NO_BACKSLASH_ESCAPES</code></a> SQL
            mode is enabled, the sequence cannot be empty.
          </p><p>
            The following two statements illustrate that string
            comparisons are not case-sensitive unless one of the
            operands is case-sensitive (uses a case-sensitive collation
            or is a binary string):
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE 'ABC';</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE _utf8mb4 'ABC' COLLATE utf8mb4_0900_as_cs;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE _utf8mb4 'ABC' COLLATE utf8mb4_bin;</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'abc' LIKE BINARY 'ABC';</code></strong><font></font>
        -&gt; 0<font></font>
</pre><p>
            As an extension to standard SQL, MySQL permits
            <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> on numeric expressions.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 10 LIKE '1%';</code></strong><font></font>
        -&gt; 1<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Because MySQL uses C escape syntax in strings (for
              example, <code class="literal">\n</code> to represent a newline
              character), you must double any <code class="literal">\</code> that
              you use in <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> strings. For
              example, to search for <code class="literal">\n</code>, specify it
              as <code class="literal">\\n</code>. To search for
              <code class="literal">\</code>, specify it as
              <code class="literal">\\\\</code>; this is because the backslashes
              are stripped once by the parser and again when the pattern
              match is made, leaving a single backslash to be matched
              against.
            </p><p>
              Exception: At the end of the pattern string, backslash can
              be specified as <code class="literal">\\</code>. At the end of the
              string, backslash stands for itself because there is
              nothing following to escape. Suppose that a table contains
              the following values:
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT filename FROM t1;</code></strong><font></font>
+--------------+<font></font>
| filename     |<font></font>
+--------------+<font></font>
| C:           |<font></font>
| C:\          |<font></font>
| C:\Programs  |<font></font>
| C:\Programs\ |<font></font>
+--------------+<font></font>
</pre><p>
              To test for values that end with backslash, you can match
              the values using either of the following patterns:
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT filename, filename LIKE '%\\' FROM t1;</code></strong><font></font>
+--------------+---------------------+<font></font>
| filename     | filename LIKE '%\\' |<font></font>
+--------------+---------------------+<font></font>
| C:           |                   0 |<font></font>
| C:\          |                   1 |<font></font>
| C:\Programs  |                   0 |<font></font>
| C:\Programs\ |                   1 |<font></font>
+--------------+---------------------+<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT filename, filename LIKE '%\\\\' FROM t1;</code></strong><font></font>
+--------------+-----------------------+<font></font>
| filename     | filename LIKE '%\\\\' |<font></font>
+--------------+-----------------------+<font></font>
| C:           |                     0 |<font></font>
| C:\          |                     1 |<font></font>
| C:\Programs  |                     0 |<font></font>
| C:\Programs\ |                     1 |<font></font>
+--------------+-----------------------+<font></font>
</pre>
</div>
</li><li class="listitem"><a name="operator_not-like"></a><p>
            <a class="indexterm" name="idm140091686679152"></a>

            <a class="link" href="functions.html#operator_not-like"><code class="literal"><em class="replaceable"><code>expr</code></em>
            NOT LIKE <em class="replaceable"><code>pat</code></em> [ESCAPE
            '<em class="replaceable"><code>escape_char</code></em>']</code></a>
          </p><p>
            This is the same as <code class="literal">NOT
            (<em class="replaceable"><code>expr</code></em> LIKE
            <em class="replaceable"><code>pat</code></em> [ESCAPE
            '<em class="replaceable"><code>escape_char</code></em>'])</code>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Aggregate queries involving <a class="link" href="functions.html#operator_not-like"><code class="literal">NOT
              LIKE</code></a> comparisons with columns containing
              <code class="literal">NULL</code> may yield unexpected results. For
              example, consider the following table and data:
            </p><pre data-lang="sql" class="programlisting">CREATE TABLE foo (bar VARCHAR(10));<font></font>
<font></font>
INSERT INTO foo VALUES (NULL), (NULL);<font></font>
</pre><p>
              The query <code class="literal">SELECT COUNT(*) FROM foo WHERE bar LIKE
              '%baz%';</code> returns <code class="literal">0</code>. You might
              assume that <code class="literal">SELECT COUNT(*) FROM foo WHERE bar
              NOT LIKE '%baz%';</code> would return
              <code class="literal">2</code>. However, this is not the case: The
              second query returns <code class="literal">0</code>. This is because
              <code class="literal">NULL NOT LIKE
              <em class="replaceable"><code>expr</code></em></code> always returns
              <code class="literal">NULL</code>, regardless of the value of
              <em class="replaceable"><code>expr</code></em>. The same is true for
              aggregate queries involving <code class="literal">NULL</code> and
              comparisons using
              <a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT
              RLIKE</code></a> or <a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT
              REGEXP</code></a>. In such cases, you must test explicitly
              for <code class="literal">NOT NULL</code> using
              <a class="link" href="functions.html#operator_or"><code class="literal">OR</code></a> (and not
              <a class="link" href="functions.html#operator_and"><code class="literal">AND</code></a>), as shown here:
            </p><pre data-lang="sql" class="programlisting">SELECT COUNT(*) FROM foo WHERE bar NOT LIKE '%baz%' OR bar IS NULL;
</pre>
</div>
</li><li class="listitem"><a name="function_strcmp"></a><p>
            <a class="indexterm" name="idm140091686651424"></a>

            <a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code></a>
          </p><p>
            <a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a> returns
            <code class="literal">0</code> if the strings are the same,
            <code class="literal">-1</code> if the first argument is smaller than
            the second according to the current sort order, and
            <code class="literal">1</code> otherwise.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STRCMP('text', 'text2');</code></strong><font></font>
        -&gt; -1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STRCMP('text2', 'text');</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STRCMP('text', 'text');</code></strong><font></font>
        -&gt; 0<font></font>
</pre><p>
            <a class="link" href="functions.html#function_strcmp"><code class="literal">STRCMP()</code></a> performs the
            comparison using the collation of the arguments.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET @s1 = _utf8mb4 'x' COLLATE utf8mb4_0900_ai_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s2 = _utf8mb4 'X' COLLATE utf8mb4_0900_ai_ci;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s3 = _utf8mb4 'x' COLLATE utf8mb4_0900_as_cs;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s4 = _utf8mb4 'X' COLLATE utf8mb4_0900_as_cs;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT STRCMP(@s1, @s2), STRCMP(@s3, @s4);</code></strong><font></font>
+------------------+------------------+<font></font>
| STRCMP(@s1, @s2) | STRCMP(@s3, @s4) |<font></font>
+------------------+------------------+<font></font>
|                0 |               -1 |<font></font>
+------------------+------------------+<font></font>
</pre><p>
            If the collations are incompatible, one of the arguments
            must be converted to be compatible with the other. See
            <a class="xref" href="charset.html#charset-collation-coercibility" title="10.8.4表达式中的整理强制性">Section&nbsp;10.8.4, “Collation Coercibility in Expressions”</a>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; SET @s1 = _utf8mb4 'x' COLLATE utf8mb4_0900_ai_ci;<font></font>
mysql&gt; SET @s2 = _utf8mb4 'X' COLLATE utf8mb4_0900_ai_ci;<font></font>
mysql&gt; SET @s3 = _utf8mb4 'x' COLLATE utf8mb4_0900_as_cs;<font></font>
mysql&gt; SET @s4 = _utf8mb4 'X' COLLATE utf8mb4_0900_as_cs;<font></font>
--&gt;<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STRCMP(@s1, @s3);</code></strong><font></font>
ERROR 1267 (HY000): Illegal mix of collations (utf8mb4_0900_ai_ci,IMPLICIT)<font></font>
and (utf8mb4_0900_as_cs,IMPLICIT) for operation 'strcmp'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STRCMP(@s1, @s3 COLLATE utf8mb4_0900_ai_ci);</code></strong><font></font>
+---------------------------------------------+<font></font>
| STRCMP(@s1, @s3 COLLATE utf8mb4_0900_ai_ci) |<font></font>
+---------------------------------------------+<font></font>
|                                           0 |<font></font>
+---------------------------------------------+<font></font>
</pre></li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="regexp"></a>12.5.2&nbsp;Regular Expressions</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091686626544"></a><a class="indexterm" name="idm140091686625472"></a><a class="indexterm" name="idm140091686624384"></a>
<div class="table">
<a name="idm140091686622896"></a><p class="title"><b>Table&nbsp;12.9&nbsp;Regular Expression Functions and
Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists regular expression functions and operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_not-regexp"><code class="literal">NOT REGEXP</code></a></td>
<td>
      Negation of REGEXP
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR()</code></a></td>
<td>
      Starting index of substring matching regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-replace"><code class="literal">REGEXP_REPLACE()</code></a></td>
<td>
      Replace substrings matching regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_regexp-substr"><code class="literal">REGEXP_SUBSTR()</code></a></td>
<td>
      Return substring matching regular expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a></td>
<td>
      Whether string matches regular expression
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
        A regular expression is a powerful way of specifying a pattern
        for a complex search. This section discusses the functions and
        operators available for regular expression matching and
        illustrates, with examples, some of the special characters and
        constructs that can be used for regular expression operations.
        See also <a class="xref" href="tutorial.html#pattern-matching" title="3.3.4.7模式匹配">Section&nbsp;3.3.4.7, “Pattern Matching”</a>.
      </p><p>
        MySQL implements regular expression support using International
        Components for Unicode (ICU), which provides full Unicode
        support and is multibyte safe. (Prior to MySQL 8.0.4, MySQL used
        Henry Spencer's implementation of regular expressions, which
        operates in byte-wise fashion and is not multibyte safe. For
        information about ways in which applications that use regular
        expressions may be affected by the implementation change, see
        <a class="xref" href="functions.html#regexp-compatibility" title="正则表达式兼容性注意事项">Regular Expression Compatibility Considerations</a>.)
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#regexp-operators" title="正则表达式函数和运算符">Regular Expression Functions and Operators</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#regexp-syntax" title="正则表达式语法">Regular Expression Syntax</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#regexp-resource-control" title="正则表达式资源控制">Regular Expression Resource Control</a></p></li><li class="listitem"><p><a class="xref" href="functions.html#regexp-compatibility" title="正则表达式兼容性注意事项">Regular Expression Compatibility Considerations</a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="regexp-operators"></a>Regular Expression Functions and Operators</h4>

</div>

</div>

</div>

<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_not-regexp"></a><p>
              <a class="indexterm" name="idm140091686582736"></a>

              <a class="link" href="functions.html#operator_not-regexp"><code class="literal"><em class="replaceable"><code>expr</code></em>
              NOT REGEXP <em class="replaceable"><code>pat</code></em></code></a>,
              <a class="link" href="functions.html#operator_not-regexp"><code class="literal"><em class="replaceable"><code>expr</code></em>
              NOT RLIKE <em class="replaceable"><code>pat</code></em></code></a>
            </p><p>
              This is the same as <code class="literal">NOT
              (<em class="replaceable"><code>expr</code></em> REGEXP
              <em class="replaceable"><code>pat</code></em>)</code>.
            </p></li><li class="listitem"><a name="operator_regexp"></a><p>
              <a class="indexterm" name="idm140091686571312"></a>

              <a class="indexterm" name="idm140091686570240"></a>

              <a class="link" href="functions.html#operator_regexp"><code class="literal"><em class="replaceable"><code>expr</code></em>
              REGEXP <em class="replaceable"><code>pat</code></em></code></a>,
              <a class="link" href="functions.html#operator_regexp"><code class="literal"><em class="replaceable"><code>expr</code></em>
              RLIKE <em class="replaceable"><code>pat</code></em></code></a>
            </p><p>
              Returns 1 if the string <em class="replaceable"><code>expr</code></em>
              matches the regular expression specified by the pattern
              <em class="replaceable"><code>pat</code></em>, 0 otherwise. If
              <em class="replaceable"><code>expr</code></em> or
              <em class="replaceable"><code>pat</code></em> is <code class="literal">NULL</code>,
              the return value is <code class="literal">NULL</code>.
            </p><p>
              <a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a> and
              <a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a> are
              synonyms for <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a>.
            </p><p>
              For additional information about how matching occurs, see
              the description for
              <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a>.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 'Michael!' REGEXP '.*';</code></strong><font></font>
+------------------------+<font></font>
| 'Michael!' REGEXP '.*' |<font></font>
+------------------------+<font></font>
|                      1 |<font></font>
+------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'new*\n*line' REGEXP 'new\\*.\\*line';</code></strong><font></font>
+---------------------------------------+<font></font>
| 'new*\n*line' REGEXP 'new\\*.\\*line' |<font></font>
+---------------------------------------+<font></font>
|                                     0 |<font></font>
+---------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'a' REGEXP '^[a-d]';</code></strong><font></font>
+---------------------+<font></font>
| 'a' REGEXP '^[a-d]' |<font></font>
+---------------------+<font></font>
|                   1 |<font></font>
+---------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 'a' REGEXP 'A', 'a' REGEXP BINARY 'A';</code></strong><font></font>
+----------------+-----------------------+<font></font>
| 'a' REGEXP 'A' | 'a' REGEXP BINARY 'A' |<font></font>
+----------------+-----------------------+<font></font>
|              1 |                     0 |<font></font>
+----------------+-----------------------+<font></font>
</pre></li><li class="listitem"><a name="function_regexp-instr"></a><p>
              <a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR(<em class="replaceable"><code>expr</code></em>,
              <em class="replaceable"><code>pat</code></em>[,
              <em class="replaceable"><code>pos</code></em>[,
              <em class="replaceable"><code>occurrence</code></em>[,
              <em class="replaceable"><code>return_option</code></em>[,
              <em class="replaceable"><code>match_type</code></em>]]]])</code></a>
            </p><a class="indexterm" name="idm140091686541744"></a><p>
              Returns the starting index of the substring of the string
              <em class="replaceable"><code>expr</code></em> that matches the regular
              expression specified by the pattern
              <em class="replaceable"><code>pat</code></em>, 0 if there is no match. If
              <em class="replaceable"><code>expr</code></em> or
              <em class="replaceable"><code>pat</code></em> is <code class="literal">NULL</code>,
              the return value is <code class="literal">NULL</code>. Character
              indexes begin at 1.
            </p><p>
              <a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR()</code></a> takes these
              optional arguments:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <em class="replaceable"><code>pos</code></em>: The position in
                  <em class="replaceable"><code>expr</code></em> at which to start the
                  search. If omitted, the default is 1.
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>occurrence</code></em>: Which
                  occurrence of a match to search for. If omitted, the
                  default is 1.
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>return_option</code></em>: Which type
                  of position to return. If this value is 0,
                  <a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR()</code></a> returns
                  the position of the matched substring's first
                  character. If this value is 1,
                  <a class="link" href="functions.html#function_regexp-instr"><code class="literal">REGEXP_INSTR()</code></a> returns
                  the position following the matched substring. If
                  omitted, the default is 0.
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>match_type</code></em>: A string that
                  specifies how to perform matching. The meaning is as
                  described for
                  <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a>.
</p></li></ul>
</div>
<p>
              For additional information about how matching occurs, see
              the description for
              <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a>.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('dog cat dog', 'dog');</code></strong><font></font>
+------------------------------------+<font></font>
| REGEXP_INSTR('dog cat dog', 'dog') |<font></font>
+------------------------------------+<font></font>
|                                  1 |<font></font>
+------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('dog cat dog', 'dog', 2);</code></strong><font></font>
+---------------------------------------+<font></font>
| REGEXP_INSTR('dog cat dog', 'dog', 2) |<font></font>
+---------------------------------------+<font></font>
|                                     9 |<font></font>
+---------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('aa aaa aaaa', 'a{2}');</code></strong><font></font>
+-------------------------------------+<font></font>
| REGEXP_INSTR('aa aaa aaaa', 'a{2}') |<font></font>
+-------------------------------------+<font></font>
|                                   1 |<font></font>
+-------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('aa aaa aaaa', 'a{4}');</code></strong><font></font>
+-------------------------------------+<font></font>
| REGEXP_INSTR('aa aaa aaaa', 'a{4}') |<font></font>
+-------------------------------------+<font></font>
|                                   8 |<font></font>
+-------------------------------------+<font></font>
</pre></li><li class="listitem"><a name="function_regexp-like"></a><p>
              <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE(<em class="replaceable"><code>expr</code></em>,
              <em class="replaceable"><code>pat</code></em>[,
              <em class="replaceable"><code>match_type</code></em>])</code></a>
            </p><a class="indexterm" name="idm140091686510768"></a><p>
              Returns 1 if the string <em class="replaceable"><code>expr</code></em>
              matches the regular expression specified by the pattern
              <em class="replaceable"><code>pat</code></em>, 0 otherwise. If
              <em class="replaceable"><code>expr</code></em> or
              <em class="replaceable"><code>pat</code></em> is <code class="literal">NULL</code>,
              the return value is <code class="literal">NULL</code>.
            </p><p>
              The pattern can be an extended regular expression, the
              syntax for which is discussed in
              <a class="xref" href="functions.html#regexp-syntax" title="正则表达式语法">Regular Expression Syntax</a>. The pattern need not be a
              literal string. For example, it can be specified as a
              string expression or table column.
            </p><p>
              The optional <em class="replaceable"><code>match_type</code></em>
              argument is a string that may contain any or all the
              following characters specifying how to perform matching:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">c</code>: Case sensitive matching.
                </p></li><li class="listitem"><p>
                  <code class="literal">i</code>: Case insensitive matching.
                </p></li><li class="listitem"><p>
                  <code class="literal">m</code>: Multiple-line mode. Recognize
                  line terminators within the string. The default
                  behavior is to match line terminators only at the
                  start and end of the string expression.
                </p></li><li class="listitem"><p>
                  <code class="literal">n</code>: The <code class="literal">.</code>
                  character matches line terminators. The default is for
                  <code class="literal">.</code> matching to stop at the end of a
                  line.
                </p></li><li class="listitem"><p>
                  <code class="literal">u</code>: Unix-only line endings. Only the
                  newline character is recognized as a line ending by
                  the <code class="literal">.</code>, <code class="literal">^</code>, and
                  <code class="literal">$</code> match operators.
</p></li></ul>
</div>
<p>
              If characters specifying contradictory options are
              specified within <em class="replaceable"><code>match_type</code></em>,
              the rightmost one takes precedence.
            </p><p>
              By default, regular expression operations use the
              character set and collation of the
              <em class="replaceable"><code>expr</code></em> and
              <em class="replaceable"><code>pat</code></em> arguments when deciding the
              type of a character and performing the comparison. If the
              arguments have different character sets or collations,
              coercibility rules apply as described in
              <a class="xref" href="charset.html#charset-collation-coercibility" title="10.8.4表达式中的整理强制性">Section&nbsp;10.8.4, “Collation Coercibility in Expressions”</a>.
              Arguments may be specified with explicit collation
              indicators to change comparison behavior.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('CamelCase', 'CAMELCASE');</code></strong><font></font>
+---------------------------------------+<font></font>
| REGEXP_LIKE('CamelCase', 'CAMELCASE') |<font></font>
+---------------------------------------+<font></font>
|                                     1 |<font></font>
+---------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('CamelCase', 'CAMELCASE' COLLATE utf8mb4_0900_as_cs);</code></strong><font></font>
+------------------------------------------------------------------+<font></font>
| REGEXP_LIKE('CamelCase', 'CAMELCASE' COLLATE utf8mb4_0900_as_cs) |<font></font>
+------------------------------------------------------------------+<font></font>
|                                                                0 |<font></font>
+------------------------------------------------------------------+<font></font>
</pre><p>
              <em class="replaceable"><code>match_type</code></em> may be specified
              with the <code class="literal">c</code> or <code class="literal">i</code>
              characters to override the default case sensitivity.
              Exception: If either argument is a binary string, the
              arguments are handled in case-sensitive fashion as binary
              strings, even if <em class="replaceable"><code>match_type</code></em>
              contains the <code class="literal">i</code> character.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
                Because MySQL uses the C escape syntax in strings (for
                example, <code class="literal">\n</code> to represent the newline
                character), you must double any <code class="literal">\</code>
                that you use in your <em class="replaceable"><code>expr</code></em> and
                <em class="replaceable"><code>pat</code></em> arguments.
</p>
</div>
<pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Michael!', '.*');</code></strong><font></font>
+-------------------------------+<font></font>
| REGEXP_LIKE('Michael!', '.*') |<font></font>
+-------------------------------+<font></font>
|                             1 |<font></font>
+-------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('new*\n*line', 'new\\*.\\*line');</code></strong><font></font>
+----------------------------------------------+<font></font>
| REGEXP_LIKE('new*\n*line', 'new\\*.\\*line') |<font></font>
+----------------------------------------------+<font></font>
|                                            0 |<font></font>
+----------------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('a', '^[a-d]');</code></strong><font></font>
+----------------------------+<font></font>
| REGEXP_LIKE('a', '^[a-d]') |<font></font>
+----------------------------+<font></font>
|                          1 |<font></font>
+----------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('a', 'A'), REGEXP_LIKE('a', BINARY 'A');</code></strong><font></font>
+-----------------------+------------------------------+<font></font>
| REGEXP_LIKE('a', 'A') | REGEXP_LIKE('a', BINARY 'A') |<font></font>
+-----------------------+------------------------------+<font></font>
|                     1 |                            0 |<font></font>
+-----------------------+------------------------------+<font></font>
</pre><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abc', 'ABC');</code></strong><font></font>
+---------------------------+<font></font>
| REGEXP_LIKE('abc', 'ABC') |<font></font>
+---------------------------+<font></font>
|                         1 |<font></font>
+---------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abc', 'ABC', 'c');</code></strong><font></font>
+--------------------------------+<font></font>
| REGEXP_LIKE('abc', 'ABC', 'c') |<font></font>
+--------------------------------+<font></font>
|                              0 |<font></font>
+--------------------------------+<font></font>
</pre></li><li class="listitem"><a name="function_regexp-replace"></a><p>
              <a class="link" href="functions.html#function_regexp-replace"><code class="literal">REGEXP_REPLACE(<em class="replaceable"><code>expr</code></em>,
              <em class="replaceable"><code>pat</code></em>,
              <em class="replaceable"><code>repl</code></em>[,
              <em class="replaceable"><code>pos</code></em>[,
              <em class="replaceable"><code>occurrence</code></em>[,
              <em class="replaceable"><code>match_type</code></em>]]])</code></a>
            </p><a class="indexterm" name="idm140091686461600"></a><p>
              Replaces occurrences in the string
              <em class="replaceable"><code>expr</code></em> that match the regular
              expression specified by the pattern
              <em class="replaceable"><code>pat</code></em> with the replacement string
              <em class="replaceable"><code>repl</code></em>, and returns the resulting
              string. If <em class="replaceable"><code>expr</code></em>,
              <em class="replaceable"><code>pat</code></em>, or
              <em class="replaceable"><code>repl</code></em> is
              <code class="literal">NULL</code>, the return value is
              <code class="literal">NULL</code>.
            </p><p>
              <a class="link" href="functions.html#function_regexp-replace"><code class="literal">REGEXP_REPLACE()</code></a> takes
              these optional arguments:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <em class="replaceable"><code>pos</code></em>: The position in
                  <em class="replaceable"><code>expr</code></em> at which to start the
                  search. If omitted, the default is 1.
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>occurrence</code></em>: Which
                  occurrence of a match to replace. If omitted, the
                  default is 0 (which means <span class="quote">“<span class="quote">replace all
                  occurrences</span>”</span>).
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>match_type</code></em>: A string that
                  specifies how to perform matching. The meaning is as
                  described for
                  <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a>.
</p></li></ul>
</div>
<p>
              Prior to MySQL 8.0.17, the result returned by this
              function used the <code class="literal">UTF-16</code> character set;
              in MySQL 8.0.17 and later, the character set and collation
              of the expression searched for matches is used. (Bug
              #94203, Bug #29308212)
            </p><p>
              For additional information about how matching occurs, see
              the description for
              <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a>.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_REPLACE('a b c', 'b', 'X');</code></strong><font></font>
+-----------------------------------+<font></font>
| REGEXP_REPLACE('a b c', 'b', 'X') |<font></font>
+-----------------------------------+<font></font>
| a X c                             |<font></font>
+-----------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_REPLACE('abc def ghi', '[a-z]+', 'X', 1, 3);</code></strong><font></font>
+----------------------------------------------------+<font></font>
| REGEXP_REPLACE('abc def ghi', '[a-z]+', 'X', 1, 3) |<font></font>
+----------------------------------------------------+<font></font>
| abc def X                                          |<font></font>
+----------------------------------------------------+<font></font>
</pre></li><li class="listitem"><a name="function_regexp-substr"></a><p>
              <a class="link" href="functions.html#function_regexp-substr"><code class="literal">REGEXP_SUBSTR(<em class="replaceable"><code>expr</code></em>,
              <em class="replaceable"><code>pat</code></em>[,
              <em class="replaceable"><code>pos</code></em>[,
              <em class="replaceable"><code>occurrence</code></em>[,
              <em class="replaceable"><code>match_type</code></em>]]])</code></a>
            </p><a class="indexterm" name="idm140091686433216"></a><p>
              Returns the substring of the string
              <em class="replaceable"><code>expr</code></em> that matches the regular
              expression specified by the pattern
              <em class="replaceable"><code>pat</code></em>, <code class="literal">NULL</code> if
              there is no match. If <em class="replaceable"><code>expr</code></em> or
              <em class="replaceable"><code>pat</code></em> is <code class="literal">NULL</code>,
              the return value is <code class="literal">NULL</code>.
            </p><p>
              <a class="link" href="functions.html#function_regexp-substr"><code class="literal">REGEXP_SUBSTR()</code></a> takes these
              optional arguments:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <em class="replaceable"><code>pos</code></em>: The position in
                  <em class="replaceable"><code>expr</code></em> at which to start the
                  search. If omitted, the default is 1.
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>occurrence</code></em>: Which
                  occurrence of a match to search for. If omitted, the
                  default is 1.
                </p></li><li class="listitem"><p>
                  <em class="replaceable"><code>match_type</code></em>: A string that
                  specifies how to perform matching. The meaning is as
                  described for
                  <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a>.
</p></li></ul>
</div>
<p>
              Prior to MySQL 8.0.17, the result returned by this
              function used the <code class="literal">UTF-16</code> character set;
              in MySQL 8.0.17 and later, the character set and collation
              of the expression searched for matches is used. (Bug
              #94203, Bug #29308212)
            </p><p>
              For additional information about how matching occurs, see
              the description for
              <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a>.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_SUBSTR('abc def ghi', '[a-z]+');</code></strong><font></font>
+----------------------------------------+<font></font>
| REGEXP_SUBSTR('abc def ghi', '[a-z]+') |<font></font>
+----------------------------------------+<font></font>
| abc                                    |<font></font>
+----------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_SUBSTR('abc def ghi', '[a-z]+', 1, 3);</code></strong><font></font>
+----------------------------------------------+<font></font>
| REGEXP_SUBSTR('abc def ghi', '[a-z]+', 1, 3) |<font></font>
+----------------------------------------------+<font></font>
| ghi                                          |<font></font>
+----------------------------------------------+<font></font>
</pre></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="regexp-syntax"></a>Regular Expression Syntax</h4>

</div>

</div>

</div>
<p>
          A regular expression describes a set of strings. The simplest
          regular expression is one that has no special characters in
          it. For example, the regular expression
          <code class="literal">hello</code> matches <code class="literal">hello</code> and
          nothing else.
        </p><p>
          Nontrivial regular expressions use certain special constructs
          so that they can match more than one string. For example, the
          regular expression <code class="literal">hello|world</code> contains the
          <code class="literal">|</code> alternation operator and matches either
          the <code class="literal">hello</code> or <code class="literal">world</code>.
        </p><p>
          As a more complex example, the regular expression
          <code class="literal">B[an]*s</code> matches any of the strings
          <code class="literal">Bananas</code>, <code class="literal">Baaaaas</code>,
          <code class="literal">Bs</code>, and any other string starting with a
          <code class="literal">B</code>, ending with an <code class="literal">s</code>, and
          containing any number of <code class="literal">a</code> or
          <code class="literal">n</code> characters in between.
        </p><p>
          The following list covers some of the basic special characters
          and constructs that can be used in regular expressions. For
          information about the full regular expression syntax supported
          by the ICU library used to implement regular expression
          support, visit the
          <a class="ulink" href="http://userguide.icu-project.org/strings/regexp" target="_top">
          International Components for Unicode website</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">^</code>
            </p><p>
              Match the beginning of a string.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\nfo', '^fo$');</code></strong>                   -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fofo', '^fo');</code></strong>                      -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">$</code>
            </p><p>
              Match the end of a string.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\no', '^fo\no$');</code></strong>                 -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\no', '^fo$');</code></strong>                    -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">.</code>
            </p><p>
              Match any character (including carriage return and
              newline, although to match these in the middle of a
              string, the <code class="literal">m</code> (multiple line)
              match-control character or the <code class="literal">(?m)</code>
              within-pattern modifier must be given).
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fofo', '^f.*$');</code></strong>                    -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\r\nfo', '^f.*$');</code></strong>                -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\r\nfo', '^f.*$', 'm');</code></strong>           -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('fo\r\nfo', '(?m)^f.*$');</code></strong>           -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">a*</code>
            </p><p>
              Match any sequence of zero or more <code class="literal">a</code>
              characters.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Ban', '^Ba*n');</code></strong>                     -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Baaan', '^Ba*n');</code></strong>                   -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Bn', '^Ba*n');</code></strong>                      -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">a+</code>
            </p><p>
              Match any sequence of one or more <code class="literal">a</code>
              characters.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Ban', '^Ba+n');</code></strong>                     -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Bn', '^Ba+n');</code></strong>                      -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">a?</code>
            </p><p>
              Match either zero or one <code class="literal">a</code> character.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Bn', '^Ba?n');</code></strong>                      -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Ban', '^Ba?n');</code></strong>                     -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('Baan', '^Ba?n');</code></strong>                    -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">de|abc</code>
            </p><p>
              Alternation; match either of the sequences
              <code class="literal">de</code> or <code class="literal">abc</code>.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pi', 'pi|apa');</code></strong>                     -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('axe', 'pi|apa');</code></strong>                    -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('apa', 'pi|apa');</code></strong>                    -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('apa', '^(pi|apa)$');</code></strong>                -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pi', '^(pi|apa)$');</code></strong>                 -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pix', '^(pi|apa)$');</code></strong>                -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">(abc)*</code>
            </p><p>
              Match zero or more instances of the sequence
              <code class="literal">abc</code>.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pi', '^(pi)*$');</code></strong>                    -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pip', '^(pi)*$');</code></strong>                   -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('pipi', '^(pi)*$');</code></strong>                  -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">{1}</code>, <code class="literal">{2,3}</code>
            </p><p>
              Repetition;
              <code class="literal">{<em class="replaceable"><code>n</code></em>}</code> and
              <code class="literal">{<em class="replaceable"><code>m</code></em>,<em class="replaceable"><code>n</code></em>}</code>
              notation provide a more general way of writing regular
              expressions that match many occurrences of the previous
              atom (or <span class="quote">“<span class="quote">piece</span>”</span>) of the pattern.
              <em class="replaceable"><code>m</code></em> and
              <em class="replaceable"><code>n</code></em> are integers.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">a*</code>
                </p><p>
                  Can be written as <code class="literal">a{0,}</code>.
                </p></li><li class="listitem"><p>
                  <code class="literal">a+</code>
                </p><p>
                  Can be written as <code class="literal">a{1,}</code>.
                </p></li><li class="listitem"><p>
                  <code class="literal">a?</code>
                </p><p>
                  Can be written as <code class="literal">a{0,1}</code>.
</p></li></ul>
</div>
<p>
              To be more precise,
              <code class="literal">a{<em class="replaceable"><code>n</code></em>}</code> matches
              exactly <em class="replaceable"><code>n</code></em> instances of
              <code class="literal">a</code>.
              <code class="literal">a{<em class="replaceable"><code>n</code></em>,}</code>
              matches <em class="replaceable"><code>n</code></em> or more instances of
              <code class="literal">a</code>.
              <code class="literal">a{<em class="replaceable"><code>m</code></em>,<em class="replaceable"><code>n</code></em>}</code>
              matches <em class="replaceable"><code>m</code></em> through
              <em class="replaceable"><code>n</code></em> instances of
              <code class="literal">a</code>, inclusive. If both
              <em class="replaceable"><code>m</code></em> and
              <em class="replaceable"><code>n</code></em> are given,
              <em class="replaceable"><code>m</code></em> must be less than or equal to
              <em class="replaceable"><code>n</code></em>.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abcde', 'a[bcd]{2}e');</code></strong>              -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abcde', 'a[bcd]{3}e');</code></strong>              -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('abcde', 'a[bcd]{1,10}e');</code></strong>           -&gt; 1
</pre></li><li class="listitem"><p>
              <code class="literal">[a-dX]</code>, <code class="literal">[^a-dX]</code>
            </p><p>
              Matches any character that is (or is not, if
              <code class="literal">^</code> is used) either <code class="literal">a</code>,
              <code class="literal">b</code>, <code class="literal">c</code>,
              <code class="literal">d</code> or <code class="literal">X</code>. A
              <code class="literal">-</code> character between two other
              characters forms a range that matches all characters from
              the first character to the second. For example,
              <code class="literal">[0-9]</code> matches any decimal digit. To
              include a literal <code class="literal">]</code> character, it must
              immediately follow the opening bracket
              <code class="literal">[</code>. To include a literal
              <code class="literal">-</code> character, it must be written first
              or last. Any character that does not have a defined
              special meaning inside a <code class="literal">[]</code> pair
              matches only itself.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('aXbc', '[a-dXYZ]');</code></strong>                 -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('aXbc', '^[a-dXYZ]$');</code></strong>               -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('aXbc', '^[a-dXYZ]+$');</code></strong>              -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('aXbc', '^[^a-dXYZ]+$');</code></strong>             -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('gheis', '^[^a-dXYZ]+$');</code></strong>            -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('gheisa', '^[^a-dXYZ]+$');</code></strong>           -&gt; 0
</pre></li><li class="listitem"><p>
              <code class="literal">[=character_class=]</code>
            </p><p>
              Within a bracket expression (written using
              <code class="literal">[</code> and <code class="literal">]</code>),
              <code class="literal">[=character_class=]</code> represents an
              equivalence class. It matches all characters with the same
              collation value, including itself. For example, if
              <code class="literal">o</code> and <code class="literal">(+)</code> are the
              members of an equivalence class,
              <code class="literal">[[=o=]]</code>, <code class="literal">[[=(+)=]]</code>,
              and <code class="literal">[o(+)]</code> are all synonymous. An
              equivalence class may not be used as an endpoint of a
              range.
            </p></li><li class="listitem"><p>
              <code class="literal">[:character_class:]</code>
            </p><p>
              Within a bracket expression (written using
              <code class="literal">[</code> and <code class="literal">]</code>),
              <code class="literal">[:character_class:]</code> represents a
              character class that matches all characters belonging to
              that class. The following table lists the standard class
              names. These names stand for the character classes defined
              in the <code class="literal">ctype(3)</code> manual page. A
              particular locale may provide other class names. A
              character class may not be used as an endpoint of a range.
</p>
<div class="informaltable">
<table summary="Character class names and the meaning of each class."><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr>
                  <th scope="col">Character Class Name</th>
                  <th scope="col">Meaning</th>
                </tr></thead><tbody><tr>
                  <td scope="row"><code class="literal">alnum</code></td>
                  <td>Alphanumeric characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">alpha</code></td>
                  <td>Alphabetic characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">blank</code></td>
                  <td>Whitespace characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">cntrl</code></td>
                  <td>Control characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">digit</code></td>
                  <td>Digit characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">graph</code></td>
                  <td>Graphic characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">lower</code></td>
                  <td>Lowercase alphabetic characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">print</code></td>
                  <td>Graphic or space characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">punct</code></td>
                  <td>Punctuation characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">space</code></td>
                  <td>Space, tab, newline, and carriage return</td>
                </tr><tr>
                  <td scope="row"><code class="literal">upper</code></td>
                  <td>Uppercase alphabetic characters</td>
                </tr><tr>
                  <td scope="row"><code class="literal">xdigit</code></td>
                  <td>Hexadecimal digit characters</td>
</tr></tbody></table>
</div>
<pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('justalnums', '[[:alnum:]]+');</code></strong>       -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('!!', '[[:alnum:]]+');</code></strong>               -&gt; 0
</pre></li></ul>
</div>
<p>
          To use a literal instance of a special character in a regular
          expression, precede it by two backslash (\) characters. The
          MySQL parser interprets one of the backslashes, and the
          regular expression library interprets the other. For example,
          to match the string <code class="literal">1+2</code> that contains the
          special <code class="literal">+</code> character, only the last of the
          following regular expressions is the correct one:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('1+2', '1+2');</code></strong>                       -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('1+2', '1\+2');</code></strong>                      -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('1+2', '1\\+2');</code></strong>                     -&gt; 1
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="regexp-resource-control"></a>Regular Expression Resource Control</h4>

</div>

</div>

</div>
<p>
          <a class="link" href="functions.html#function_regexp-like"><code class="literal">REGEXP_LIKE()</code></a> and similar
          functions use resources that can be controlled by setting
          system variables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              The match engine uses memory for its internal stack. To
              control the maximum available memory for the stack in
              bytes, set the
              <a class="link" href="server-administration.html#sysvar_regexp_stack_limit"><code class="literal">regexp_stack_limit</code></a> system
              variable.
            </p></li><li class="listitem"><p>
              The match engine operates in steps. To control the maximum
              number of steps performed by the engine (and thus
              indirectly the execution time), set the
              <a class="link" href="server-administration.html#sysvar_regexp_time_limit"><code class="literal">regexp_time_limit</code></a> system
              variable. Because this limit is expressed as number of
              steps, it affects execution time only indirectly.
              Typically, it is on the order of milliseconds.
</p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="regexp-compatibility"></a>Regular Expression Compatibility Considerations</h4>

</div>

</div>

</div>
<p>
          Prior to MySQL 8.0.4, MySQL used the Henry Spencer regular
          expression library to support regular expression operations,
          rather than International Components for Unicode (ICU). The
          following discussion describes differences between the Spencer
          and ICU libraries that may affect applications:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              With the Spencer library, the
              <a class="link" href="functions.html#operator_regexp"><code class="literal">REGEXP</code></a> and
              <a class="link" href="functions.html#operator_regexp"><code class="literal">RLIKE</code></a>
              operators work in byte-wise fashion, so they are not
              multibyte safe and may produce unexpected results with
              multibyte character sets. In addition, these operators
              compare characters by their byte values and accented
              characters may not compare as equal even if a given
              collation treats them as equal.
            </p><p>
              ICU has full Unicode support and is multibyte safe. Its
              regular expression functions treat all strings as
              <code class="literal">UTF-16</code>. You should keep in mind that
              positional indexes are based on 16-bit chunks and not on
              code points. This means that, when passed to such
              functions, characters using more than one chunk may
              produce unanticipated results, such as those shown here:
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('🍣🍣b', 'b');</code></strong><font></font>
+--------------------------+<font></font>
| REGEXP_INSTR('??b', 'b') |<font></font>
+--------------------------+<font></font>
|                        5 |<font></font>
+--------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('🍣🍣bxxx', 'b', 4);</code></strong><font></font>
+--------------------------------+<font></font>
| REGEXP_INSTR('??bxxx', 'b', 4) |<font></font>
+--------------------------------+<font></font>
|                              5 |<font></font>
+--------------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
</pre><p>
              Characters within the Unicode Basic Multilingual Plane,
              which includes characters used by most modern languages,
              are safe in this regard:
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('бжb', 'b');</code></strong><font></font>
+----------------------------+<font></font>
| REGEXP_INSTR('бжb', 'b')   |<font></font>
+----------------------------+<font></font>
|                          3 |<font></font>
+----------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('עבb', 'b');</code></strong><font></font>
+----------------------------+<font></font>
| REGEXP_INSTR('עבb', 'b')   |<font></font>
+----------------------------+<font></font>
|                          3 |<font></font>
+----------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_INSTR('µå周çб', '周');</code></strong><font></font>
+------------------------------------+<font></font>
| REGEXP_INSTR('µå周çб', '周')       |<font></font>
+------------------------------------+<font></font>
|                                  3 |<font></font>
+------------------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
</pre><p>
              Emoji, such as the <span class="quote">“<span class="quote">sushi</span>”</span> character
              <code class="literal">🍣</code> (U+1F363) used in the first two
              examples, are not included in the Basic Multilingual
              Plane, but rather in Unicode's Supplementary
              Multilingual Plane. Another issue can arise with emoji and
              other 4-byte characters when
              <a class="link" href="functions.html#function_regexp-substr"><code class="literal">REGEXP_SUBSTR()</code></a> or a
              similar function begins searching in the middle of a
              character. Each of the two statements in the following
              example starts from the second 2-byte position in the
              first argument. The first statement works on a string
              consisting solely of 2-byte (BMP) characters. The second
              statement contains 4-byte characters which are incorrectly
              interpreted in the result because the first two bytes are
              stripped off and so the remainder of the character data is
              misaligned.
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_SUBSTR('周周周周', '.*', 2);</code></strong><font></font>
+----------------------------------------+<font></font>
| REGEXP_SUBSTR('周周周周', '.*', 2)     |<font></font>
+----------------------------------------+<font></font>
| 周周周                                 |<font></font>
+----------------------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_SUBSTR('🍣🍣🍣🍣', '.*', 2);</code></strong><font></font>
+--------------------------------+<font></font>
| REGEXP_SUBSTR('????', '.*', 2) |<font></font>
+--------------------------------+<font></font>
| ?㳟揘㳟揘㳟揘                  |<font></font>
+--------------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
</pre></li><li class="listitem"><p>
              For the <code class="literal">.</code> operator, the Spencer library
              matches line-terminator characters (carriage return,
              newline) anywhere in string expressions, including in the
              middle. To match line terminator characters in the middle
              of strings with ICU, specify the <code class="literal">m</code>
              match-control character.
            </p></li><li class="listitem"><p>
              The Spencer library supports word-beginning and word-end
              boundary markers (<code class="literal">[[:&lt;:]]</code> and
              <code class="literal">[[:&gt;:]]</code> notation). ICU does not. For
              ICU, you can use <code class="literal">\b</code> to match word
              boundaries; double the backslash because MySQL interprets
              it as the escape character within strings.
            </p></li><li class="listitem"><p>
              The Spencer library supports collating element bracket
              expressions (<code class="literal">[.characters.]</code> notation).
              ICU does not.
            </p></li><li class="listitem"><p>
              For repetition counts (<code class="literal">{n}</code> and
              <code class="literal">{m,n}</code> notation), the Spencer library
              has a maximum of 255. ICU has no such limit, although the
              maximum number of match engine steps can be limited by
              setting the
              <a class="link" href="server-administration.html#sysvar_regexp_time_limit"><code class="literal">regexp_time_limit</code></a> system
              variable.
            </p></li><li class="listitem"><p>
              ICU interprets parentheses as metacharacters. To specify a
              literal open parenthesis <code class="literal">(</code> in a regular
              expression, it must be escaped:
            </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('(', '(');</code></strong><font></font>
ERROR 3692 (HY000): Mismatched parenthesis in regular expression.<font></font>
mysql&gt; <strong class="userinput"><code>SELECT REGEXP_LIKE('(', '\\(');</code></strong><font></font>
+-------------------------+<font></font>
| REGEXP_LIKE('(', '\\(') |<font></font>
+-------------------------+<font></font>
|                       1 |<font></font>
+-------------------------+<font></font>
</pre></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="string-functions-charset"></a>12.5.3&nbsp;Character Set and Collation of Function Results</h3>

</div>

</div>

</div>
<p>
        MySQL has many operators and functions that return a string.
        This section answers the question: What is the character set and
        collation of such a string?
      </p><p>
        For simple functions that take string input and return a string
        result as output, the output's character set and collation are
        the same as those of the principal input value. For example,
        <a class="link" href="functions.html#function_upper"><code class="literal">UPPER(<em class="replaceable"><code>X</code></em>)</code></a>
        returns a string with the same character string and collation as
        <em class="replaceable"><code>X</code></em>. The same applies for
        <a class="link" href="functions.html#function_instr"><code class="literal">INSTR()</code></a>,
        <a class="link" href="functions.html#function_lcase"><code class="literal">LCASE()</code></a>,
        <a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a>,
        <a class="link" href="functions.html#function_ltrim"><code class="literal">LTRIM()</code></a>,
        <a class="link" href="functions.html#function_mid"><code class="literal">MID()</code></a>,
        <a class="link" href="functions.html#function_repeat"><code class="literal">REPEAT()</code></a>,
        <a class="link" href="functions.html#function_replace"><code class="literal">REPLACE()</code></a>,
        <a class="link" href="functions.html#function_reverse"><code class="literal">REVERSE()</code></a>,
        <a class="link" href="functions.html#function_right"><code class="literal">RIGHT()</code></a>,
        <a class="link" href="functions.html#function_rpad"><code class="literal">RPAD()</code></a>,
        <a class="link" href="functions.html#function_rtrim"><code class="literal">RTRIM()</code></a>,
        <a class="link" href="functions.html#function_soundex"><code class="literal">SOUNDEX()</code></a>,
        <a class="link" href="functions.html#function_substring"><code class="literal">SUBSTRING()</code></a>,
        <a class="link" href="functions.html#function_trim"><code class="literal">TRIM()</code></a>,
        <a class="link" href="functions.html#function_ucase"><code class="literal">UCASE()</code></a>, and
        <a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          The <a class="link" href="functions.html#function_replace"><code class="literal">REPLACE()</code></a> function, unlike
          all other functions, always ignores the collation of the
          string input and performs a case-sensitive comparison.
</p>
</div>
<p>
        If a string input or function result is a binary string, the
        string has the <code class="literal">binary</code> character set and
        collation. This can be checked by using the
        <a class="link" href="functions.html#function_charset"><code class="literal">CHARSET()</code></a> and
        <a class="link" href="functions.html#function_collation"><code class="literal">COLLATION()</code></a> functions, both of
        which return <code class="literal">binary</code> for a binary string
        argument:
      </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CHARSET(BINARY 'a'), COLLATION(BINARY 'a');</code></strong><font></font>
+---------------------+-----------------------+<font></font>
| CHARSET(BINARY 'a') | COLLATION(BINARY 'a') |<font></font>
+---------------------+-----------------------+<font></font>
| binary              | binary                |<font></font>
+---------------------+-----------------------+<font></font>
</pre><p>
        For operations that combine multiple string inputs and return a
        single string output, the <span class="quote">“<span class="quote">aggregation rules</span>”</span> of
        standard SQL apply for determining the collation of the result:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If an explicit <code class="literal">COLLATE
            <em class="replaceable"><code>Y</code></em></code> occurs, use
            <em class="replaceable"><code>Y</code></em>.
          </p></li><li class="listitem"><p>
            If explicit <code class="literal">COLLATE
            <em class="replaceable"><code>Y</code></em></code> and <code class="literal">COLLATE
            <em class="replaceable"><code>Z</code></em></code> occur, raise an
            error.
          </p></li><li class="listitem"><p>
            Otherwise, if all collations are
            <em class="replaceable"><code>Y</code></em>, use
            <em class="replaceable"><code>Y</code></em>.
          </p></li><li class="listitem"><p>
            Otherwise, the result has no collation.
</p></li></ul>
</div>
<p>
        For example, with <code class="literal">CASE ... WHEN a THEN b WHEN b THEN c
        COLLATE <em class="replaceable"><code>X</code></em> END</code>, the
        resulting collation is <em class="replaceable"><code>X</code></em>. The same
        applies for <a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a>,
        <a class="link" href="functions.html#operator_or"><code class="literal">||</code></a>,
        <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a>,
        <a class="link" href="functions.html#function_elt"><code class="literal">ELT()</code></a>,
        <a class="link" href="functions.html#function_greatest"><code class="literal">GREATEST()</code></a>,
        <a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a>, and
        <a class="link" href="functions.html#function_least"><code class="literal">LEAST()</code></a>.
      </p><p>
        For operations that convert to character data, the character set
        and collation of the strings that result from the operations are
        defined by the
        <a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a> and
        <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
        variables that determine the default connection character set
        and collation (see <a class="xref" href="charset.html#charset-connection" title="10.4连接字符集和排序规则">Section&nbsp;10.4, “Connection Character Sets and Collations”</a>). This
        applies only to <a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a>,
        <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a>,
        <a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a>,
        <a class="link" href="functions.html#function_format"><code class="literal">FORMAT()</code></a>,
        <a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a>, and
        <a class="link" href="functions.html#function_space"><code class="literal">SPACE()</code></a>.
      </p><p>
        An exception to the preceding priniciple occurs for expressions
        for virtual generated columns. In such expressions, the table
        character set is used for
        <a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a>,
        <a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a>, or
        <a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a> results, regardless of
        connection character set.
      </p><p>
        If there is any question about the character set or collation of
        the result returned by a string function, use the
        <a class="link" href="functions.html#function_charset"><code class="literal">CHARSET()</code></a> or
        <a class="link" href="functions.html#function_collation"><code class="literal">COLLATION()</code></a> function to find out:
      </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT USER(), CHARSET(USER()), COLLATION(USER());</code></strong><font></font>
+----------------+-----------------+-------------------+<font></font>
| USER()         | CHARSET(USER()) | COLLATION(USER()) |<font></font>
+----------------+-----------------+-------------------+<font></font>
| test@localhost | utf8            | utf8_general_ci   |<font></font>
+----------------+-----------------+-------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CHARSET(COMPRESS('abc')), COLLATION(COMPRESS('abc'));</code></strong><font></font>
+--------------------------+----------------------------+<font></font>
| CHARSET(COMPRESS('abc')) | COLLATION(COMPRESS('abc')) |<font></font>
+--------------------------+----------------------------+<font></font>
| binary                   | binary                     |<font></font>
+--------------------------+----------------------------+<font></font>
</pre>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="numeric-functions"></a>12.6&nbsp;Numeric Functions and Operators</h2>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#arithmetic-functions">12.6.1 Arithmetic Operators</a></span></dt><dt><span class="section"><a href="functions.html#mathematical-functions">12.6.2 Mathematical Functions</a></span></dt></dl>
</div>

<div class="table">
<a name="idm140091686121472"></a><p class="title"><b>Table&nbsp;12.10&nbsp;Numeric Functions and Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists numeric functions and operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a></td>
<td>
      Return the absolute value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_acos"><code class="literal">ACOS()</code></a></td>
<td>
      Return the arc cosine
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asin"><code class="literal">ASIN()</code></a></td>
<td>
      Return the arc sine
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_atan"><code class="literal">ATAN()</code></a></td>
<td>
      Return the arc tangent
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2()</code>, <code class="literal">ATAN()</code></a></td>
<td>
      Return the arc tangent of the two arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a></td>
<td>
      Return the smallest integer value not less than the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a></td>
<td>
      Return the smallest integer value not less than the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a></td>
<td>
      Convert numbers between different number bases
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_cos"><code class="literal">COS()</code></a></td>
<td>
      Return the cosine
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_cot"><code class="literal">COT()</code></a></td>
<td>
      Return the cotangent
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_crc32"><code class="literal">CRC32()</code></a></td>
<td>
      Compute a cyclic redundancy check value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES()</code></a></td>
<td>
      Convert radians to degrees
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td>
<td>
      Integer division
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td>
<td>
      Division operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a></td>
<td>
      Raise to the power of
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a></td>
<td>
      Return the largest integer value not greater than the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a></td>
<td>
      Return the natural logarithm of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a></td>
<td>
      Return the natural logarithm of the first argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_log10"><code class="literal">LOG10()</code></a></td>
<td>
      Return the base-10 logarithm of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a></td>
<td>
      Return the base-2 logarithm of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td>
<td>
      Minus operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mod"><code class="literal">MOD()</code></a></td>
<td>
      Return the remainder
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_mod"><code class="literal">%</code>, <code class="literal">MOD</code></a></td>
<td>
      Modulo operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a></td>
<td>
      Return the value of pi
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td>
<td>
      Addition operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a></td>
<td>
      Return the argument raised to the specified power
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_power"><code class="literal">POWER()</code></a></td>
<td>
      Return the argument raised to the specified power
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_radians"><code class="literal">RADIANS()</code></a></td>
<td>
      Return argument converted to radians
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td>
<td>
      Return a random floating-point value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a></td>
<td>
      Round the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sign"><code class="literal">SIGN()</code></a></td>
<td>
      Return the sign of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sin"><code class="literal">SIN()</code></a></td>
<td>
      Return the sine of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT()</code></a></td>
<td>
      Return the square root of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_tan"><code class="literal">TAN()</code></a></td>
<td>
      Return the tangent of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td>
<td>
      Multiplication operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE()</code></a></td>
<td>
      Truncate to specified number of decimal places
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td>
<td>
      Change the sign of the argument
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="arithmetic-functions"></a>12.6.1&nbsp;Arithmetic Operators</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091685993456"></a>
<div class="table">
<a name="idm140091685991968"></a><p class="title"><b>Table&nbsp;12.11&nbsp;Arithmetic Operators</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists arithmetic operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a></td>
<td>
      Integer division
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a></td>
<td>
      Division operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a></td>
<td>
      Minus operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_mod"><code class="literal">%</code>, <code class="literal">MOD</code></a></td>
<td>
      Modulo operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a></td>
<td>
      Addition operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_times"><code class="literal">*</code></a></td>
<td>
      Multiplication operator
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a></td>
<td>
      Change the sign of the argument
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
        The usual arithmetic operators are available. The result is
        determined according to the following rules:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            In the case of
            <a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a>,
            <a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a>, and
            <a class="link" href="functions.html#operator_times"><code class="literal">*</code></a>, the result
            is calculated with <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>
            (64-bit) precision if both operands are integers.
          </p></li><li class="listitem"><p>
            If both operands are integers and any of them are unsigned,
            the result is an unsigned integer. For subtraction, if the
            <a class="link" href="server-administration.html#sqlmode_no_unsigned_subtraction"><code class="literal">NO_UNSIGNED_SUBTRACTION</code></a>
            SQL mode is enabled, the result is signed even if any
            operand is unsigned.
          </p></li><li class="listitem"><p>
            If any of the operands of a
            <a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a>,
            <a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a>,
            <a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a>,
            <a class="link" href="functions.html#operator_times"><code class="literal">*</code></a>,
            <a class="link" href="functions.html#operator_mod"><code class="literal">%</code></a> is a real or
            string value, the precision of the result is the precision
            of the operand with the maximum precision.
          </p></li><li class="listitem"><p>
            In division performed with
            <a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a>, the scale
            of the result when using two exact-value operands is the
            scale of the first operand plus the value of the
            <a class="link" href="server-administration.html#sysvar_div_precision_increment"><code class="literal">div_precision_increment</code></a>
            system variable (which is 4 by default). For example, the
            result of the expression <code class="literal">5.05 / 0.014</code> has
            a scale of six decimal places
            (<code class="literal">360.714286</code>).
</p></li></ul>
</div>
<p>
        These rules are applied for each operation, such that nested
        calculations imply the precision of each component. Hence,
        <code class="literal">(14620 / 9432456) / (24250 / 9432456)</code>,
        resolves first to <code class="literal">(0.0014) / (0.0026)</code>, with
        the final result having 8 decimal places
        (<code class="literal">0.60288653</code>).
      </p><p>
        Because of these rules and the way they are applied, care should
        be taken to ensure that components and subcomponents of a
        calculation use the appropriate level of precision. See
        <a class="xref" href="functions.html#cast-functions" title="12.10演员函数和运算符">Section&nbsp;12.10, “Cast Functions and Operators”</a>.
      </p><p>
        For information about handling of overflow in numeric expression
        evaluation, see <a class="xref" href="data-types.html#out-of-range-and-overflow" title="11.2.6超出范围和溢出处理">Section&nbsp;11.2.6, “Out-of-Range and Overflow Handling”</a>.
      </p><p>
        Arithmetic operators apply to numbers. For other types of
        values, alternative operations may be available. For example, to
        add date values, use <a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a>;
        see <a class="xref" href="functions.html#date-and-time-functions" title="12。7日期和时间函数">Section&nbsp;12.7, “Date and Time Functions”</a>.
</p><a class="indexterm" name="idm140091685933136"></a><a class="indexterm" name="idm140091685931648"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_plus"></a><p>
            <a class="indexterm" name="idm140091685928080"></a>

            <a class="indexterm" name="idm140091685927008"></a>

            <a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a>
          </p><p>
            Addition:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 3+5;</code></strong><font></font>
        -&gt; 8<font></font>
</pre></li><li class="listitem"><a name="operator_minus"></a><p>
            <a class="indexterm" name="idm140091685918048"></a>

            <a class="indexterm" name="idm140091685916976"></a>

            <a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a>
          </p><p>
            Subtraction:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 3-5;</code></strong><font></font>
        -&gt; -2<font></font>
</pre></li><li class="listitem"><a name="operator_unary-minus"></a><p>
            <a class="indexterm" name="idm140091685908016"></a>

            <a class="indexterm" name="idm140091685906944"></a>

            <a class="indexterm" name="idm140091685905456"></a>

            <a class="link" href="functions.html#operator_unary-minus"><code class="literal">-</code></a>
          </p><p>
            Unary minus. This operator changes the sign of the operand.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT - 2;</code></strong><font></font>
        -&gt; -2<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              If this operator is used with a
              <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>, the return value is
              also a <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>. This means
              that you should avoid using <code class="literal">-</code> on
              integers that may have the value of
              −2<sup>63</sup>.
</p>
</div>
</li><li class="listitem"><a name="operator_times"></a><p>
            <a class="indexterm" name="idm140091685891872"></a>

            <a class="indexterm" name="idm140091685890800"></a>

            <a class="link" href="functions.html#operator_times"><code class="literal">*</code></a>
          </p><p>
            Multiplication:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 3*5;</code></strong><font></font>
        -&gt; 15<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 18014398509481984*18014398509481984.0;</code></strong><font></font>
        -&gt; 324518553658426726783156020576256.0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 18014398509481984*18014398509481984;</code></strong><font></font>
        -&gt; out-of-range error<font></font>
</pre><p>
            The last expression produces an error because the result of
            the integer multiplication exceeds the 64-bit range of
            <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a> calculations. (See
            <a class="xref" href="data-types.html#numeric-types" title="11.2数字类型">Section&nbsp;11.2, “Numeric Types”</a>.)
          </p></li><li class="listitem"><a name="operator_divide"></a><p>
            <a class="indexterm" name="idm140091685877776"></a>

            <a class="indexterm" name="idm140091685876704"></a>

            <a class="link" href="functions.html#operator_divide"><code class="literal">/</code></a>
          </p><p>
            Division:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 3/5;</code></strong><font></font>
        -&gt; 0.60<font></font>
</pre><p>
            Division by zero produces a <code class="literal">NULL</code> result:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 102/(1-1);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre><p>
            A division is calculated with
            <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a> arithmetic only if
            performed in a context where its result is converted to an
            integer.
          </p></li><li class="listitem"><a name="operator_div"></a><p>
            <a class="indexterm" name="idm140091685862528"></a>

            <a class="link" href="functions.html#operator_div"><code class="literal">DIV</code></a>
          </p><p>
            Integer division. Discards from the division result any
            fractional part to the right of the decimal point.
          </p><p>
            If either operand has a noninteger type, the operands are
            converted to <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a> and
            divided using <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a>
            arithmetic before converting the result to
            <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a>. If the result exceeds
            <code class="literal">BIGINT</code> range, an error occurs.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT 5 DIV 2, -5 DIV 2, 5 DIV -2, -5 DIV -2;</code></strong><font></font>
        -&gt; 2, -2, -2, 2<font></font>
</pre></li><li class="listitem"><a name="operator_mod"></a><p>
            <a class="indexterm" name="idm140091685847712"></a>

            <a class="link" href="functions.html#operator_mod"><code class="literal"><em class="replaceable"><code>N</code></em>
            % <em class="replaceable"><code>M</code></em></code></a>,
            <a class="link" href="functions.html#operator_mod"><code class="literal"><em class="replaceable"><code>N</code></em>
            MOD <em class="replaceable"><code>M</code></em></code></a>
          </p><p>
            Modulo operation. Returns the remainder of
            <em class="replaceable"><code>N</code></em> divided by
            <em class="replaceable"><code>M</code></em>. For more information, see the
            description for the <a class="link" href="functions.html#function_mod"><code class="literal">MOD()</code></a>
            function in <a class="xref" href="functions.html#mathematical-functions" title="12.6.2数学函数">Section&nbsp;12.6.2, “Mathematical Functions”</a>.
</p></li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="mathematical-functions"></a>12.6.2&nbsp;Mathematical Functions</h3>

</div>

</div>

</div>

<div class="table">
<a name="idm140091685836560"></a><p class="title"><b>Table&nbsp;12.12&nbsp;Mathematical Functions</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists mathematical functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a></td>
<td>
      Return the absolute value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_acos"><code class="literal">ACOS()</code></a></td>
<td>
      Return the arc cosine
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asin"><code class="literal">ASIN()</code></a></td>
<td>
      Return the arc sine
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_atan"><code class="literal">ATAN()</code></a></td>
<td>
      Return the arc tangent
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2()</code>, <code class="literal">ATAN()</code></a></td>
<td>
      Return the arc tangent of the two arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a></td>
<td>
      Return the smallest integer value not less than the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a></td>
<td>
      Return the smallest integer value not less than the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a></td>
<td>
      Convert numbers between different number bases
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_cos"><code class="literal">COS()</code></a></td>
<td>
      Return the cosine
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_cot"><code class="literal">COT()</code></a></td>
<td>
      Return the cotangent
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_crc32"><code class="literal">CRC32()</code></a></td>
<td>
      Compute a cyclic redundancy check value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES()</code></a></td>
<td>
      Convert radians to degrees
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a></td>
<td>
      Raise to the power of
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a></td>
<td>
      Return the largest integer value not greater than the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a></td>
<td>
      Return the natural logarithm of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a></td>
<td>
      Return the natural logarithm of the first argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_log10"><code class="literal">LOG10()</code></a></td>
<td>
      Return the base-10 logarithm of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a></td>
<td>
      Return the base-2 logarithm of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mod"><code class="literal">MOD()</code></a></td>
<td>
      Return the remainder
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a></td>
<td>
      Return the value of pi
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a></td>
<td>
      Return the argument raised to the specified power
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_power"><code class="literal">POWER()</code></a></td>
<td>
      Return the argument raised to the specified power
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_radians"><code class="literal">RADIANS()</code></a></td>
<td>
      Return argument converted to radians
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td>
<td>
      Return a random floating-point value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a></td>
<td>
      Round the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sign"><code class="literal">SIGN()</code></a></td>
<td>
      Return the sign of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sin"><code class="literal">SIN()</code></a></td>
<td>
      Return the sine of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT()</code></a></td>
<td>
      Return the square root of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_tan"><code class="literal">TAN()</code></a></td>
<td>
      Return the tangent of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE()</code></a></td>
<td>
      Truncate to specified number of decimal places
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
        All mathematical functions return <code class="literal">NULL</code> in the
        event of an error.
</p><a class="indexterm" name="idm140091685730512"></a><a class="indexterm" name="idm140091685729440"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_abs"></a><p>
            <a class="indexterm" name="idm140091685725456"></a>

            <a class="link" href="functions.html#function_abs"><code class="literal">ABS(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the absolute value of <em class="replaceable"><code>X</code></em>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ABS(2);</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ABS(-32);</code></strong><font></font>
        -&gt; 32<font></font>
</pre><p>
            This function is safe to use with
            <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a> values.
          </p></li><li class="listitem"><a name="function_acos"></a><p>
            <a class="indexterm" name="idm140091685713232"></a>

            <a class="link" href="functions.html#function_acos"><code class="literal">ACOS(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the arc cosine of <em class="replaceable"><code>X</code></em>, that
            is, the value whose cosine is <em class="replaceable"><code>X</code></em>.
            Returns <code class="literal">NULL</code> if
            <em class="replaceable"><code>X</code></em> is not in the range
            <code class="literal">-1</code> to <code class="literal">1</code>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ACOS(1);</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ACOS(1.0001);</code></strong><font></font>
        -&gt; NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ACOS(0);</code></strong><font></font>
        -&gt; 1.5707963267949<font></font>
</pre></li><li class="listitem"><a name="function_asin"></a><p>
            <a class="indexterm" name="idm140091685698928"></a>

            <a class="link" href="functions.html#function_asin"><code class="literal">ASIN(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the arc sine of <em class="replaceable"><code>X</code></em>, that
            is, the value whose sine is <em class="replaceable"><code>X</code></em>.
            Returns <code class="literal">NULL</code> if
            <em class="replaceable"><code>X</code></em> is not in the range
            <code class="literal">-1</code> to <code class="literal">1</code>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ASIN(0.2);</code></strong><font></font>
        -&gt; 0.20135792079033<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ASIN('foo');</code></strong><font></font>
<font></font>
+-------------+<font></font>
| ASIN('foo') |<font></font>
+-------------+<font></font>
|           0 |<font></font>
+-------------+<font></font>
1 row in set, 1 warning (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong><font></font>
+---------+------+-----------------------------------------+<font></font>
| Level   | Code | Message                                 |<font></font>
+---------+------+-----------------------------------------+<font></font>
| Warning | 1292 | Truncated incorrect DOUBLE value: 'foo' |<font></font>
+---------+------+-----------------------------------------+<font></font>
</pre></li><li class="listitem"><a name="function_atan"></a><p>
            <a class="indexterm" name="idm140091685684112"></a>

            <a class="link" href="functions.html#function_atan"><code class="literal">ATAN(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the arc tangent of <em class="replaceable"><code>X</code></em>,
            that is, the value whose tangent is
            <em class="replaceable"><code>X</code></em>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ATAN(2);</code></strong><font></font>
        -&gt; 1.1071487177941<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ATAN(-2);</code></strong><font></font>
        -&gt; -1.1071487177941<font></font>
</pre></li><li class="listitem"><a name="function_atan2"></a><p>
            <a class="indexterm" name="idm140091685672976"></a>

            <a class="link" href="functions.html#function_atan2"><code class="literal">ATAN(<em class="replaceable"><code>Y</code></em>,<em class="replaceable"><code>X</code></em>)</code></a>,
            <a class="link" href="functions.html#function_atan2"><code class="literal">ATAN2(<em class="replaceable"><code>Y</code></em>,<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the arc tangent of the two variables
            <em class="replaceable"><code>X</code></em> and
            <em class="replaceable"><code>Y</code></em>. It is similar to calculating
            the arc tangent of <code class="literal"><em class="replaceable"><code>Y</code></em> /
            <em class="replaceable"><code>X</code></em></code>, except that the
            signs of both arguments are used to determine the quadrant
            of the result.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ATAN(-2,2);</code></strong><font></font>
        -&gt; -0.78539816339745<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ATAN2(PI(),0);</code></strong><font></font>
        -&gt; 1.5707963267949<font></font>
</pre></li><li class="listitem"><a name="function_ceil"></a><p>
            <a class="indexterm" name="idm140091685657392"></a>

            <a class="link" href="functions.html#function_ceil"><code class="literal">CEIL(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            <a class="link" href="functions.html#function_ceil"><code class="literal">CEIL()</code></a> is a synonym for
            <a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING()</code></a>.
          </p></li><li class="listitem"><a name="function_ceiling"></a><p>
            <a class="indexterm" name="idm140091685647056"></a>

            <a class="link" href="functions.html#function_ceiling"><code class="literal">CEILING(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the smallest integer value not less than
            <em class="replaceable"><code>X</code></em>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CEILING(1.23);</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CEILING(-1.23);</code></strong><font></font>
        -&gt; -1<font></font>
</pre><p>
            For exact-value numeric arguments, the return value has an
            exact-value numeric type. For string or floating-point
            arguments, the return value has a floating-point type.
          </p></li><li class="listitem"><a name="function_conv"></a><p>
            <a class="indexterm" name="idm140091685635872"></a>

            <a class="link" href="functions.html#function_conv"><code class="literal">CONV(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>from_base</code></em>,<em class="replaceable"><code>to_base</code></em>)</code></a>
          </p><p>
            Converts numbers between different number bases. Returns a
            string representation of the number
            <em class="replaceable"><code>N</code></em>, converted from base
            <em class="replaceable"><code>from_base</code></em> to base
            <em class="replaceable"><code>to_base</code></em>. Returns
            <code class="literal">NULL</code> if any argument is
            <code class="literal">NULL</code>. The argument
            <em class="replaceable"><code>N</code></em> is interpreted as an integer,
            but may be specified as an integer or a string. The minimum
            base is <code class="literal">2</code> and the maximum base is
            <code class="literal">36</code>. If
            <em class="replaceable"><code>from_base</code></em> is a negative number,
            <em class="replaceable"><code>N</code></em> is regarded as a signed number.
            Otherwise, <em class="replaceable"><code>N</code></em> is treated as
            unsigned. <a class="link" href="functions.html#function_conv"><code class="literal">CONV()</code></a> works with
            64-bit precision.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONV('a',16,2);</code></strong><font></font>
        -&gt; '1010'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CONV('6E',18,8);</code></strong><font></font>
        -&gt; '172'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CONV(-17,10,-18);</code></strong><font></font>
        -&gt; '-H'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CONV(10+'10'+'10'+X'0a',10,10);</code></strong><font></font>
        -&gt; '40'<font></font>
</pre></li><li class="listitem"><a name="function_cos"></a><p>
            <a class="indexterm" name="idm140091685615840"></a>

            <a class="link" href="functions.html#function_cos"><code class="literal">COS(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the cosine of <em class="replaceable"><code>X</code></em>, where
            <em class="replaceable"><code>X</code></em> is given in radians.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COS(PI());</code></strong><font></font>
        -&gt; -1<font></font>
</pre></li><li class="listitem"><a name="function_cot"></a><p>
            <a class="indexterm" name="idm140091685605600"></a>

            <a class="link" href="functions.html#function_cot"><code class="literal">COT(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the cotangent of <em class="replaceable"><code>X</code></em>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT COT(12);</code></strong><font></font>
        -&gt; -1.5726734063977<font></font>
mysql&gt; <strong class="userinput"><code>SELECT COT(0);</code></strong><font></font>
        -&gt; out-of-range error<font></font>
</pre></li><li class="listitem"><a name="function_crc32"></a><p>
            <a class="indexterm" name="idm140091685594944"></a>

            <a class="link" href="functions.html#function_crc32"><code class="literal">CRC32(<em class="replaceable"><code>expr</code></em>)</code></a>
          </p><p>
            Computes a cyclic redundancy check value and returns a
            32-bit unsigned value. The result is <code class="literal">NULL</code>
            if the argument is <code class="literal">NULL</code>. The argument is
            expected to be a string and (if possible) is treated as one
            if it is not.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CRC32('MySQL');</code></strong><font></font>
        -&gt; 3259397556<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CRC32('mysql');</code></strong><font></font>
        -&gt; 2501908538<font></font>
</pre></li><li class="listitem"><a name="function_degrees"></a><p>
            <a class="indexterm" name="idm140091685583104"></a>

            <a class="link" href="functions.html#function_degrees"><code class="literal">DEGREES(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the argument <em class="replaceable"><code>X</code></em>, converted
            from radians to degrees.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DEGREES(PI());</code></strong><font></font>
        -&gt; 180<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DEGREES(PI() / 2);</code></strong><font></font>
        -&gt; 90<font></font>
</pre></li><li class="listitem"><a name="function_exp"></a><p>
            <a class="indexterm" name="idm140091685572512"></a>

            <a class="link" href="functions.html#function_exp"><code class="literal">EXP(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the value of <span class="emphasis"><em>e</em></span> (the base of
            natural logarithms) raised to the power of
            <em class="replaceable"><code>X</code></em>. The inverse of this function
            is <a class="link" href="functions.html#function_log"><code class="literal">LOG()</code></a> (using a single
            argument only) or <a class="link" href="functions.html#function_ln"><code class="literal">LN()</code></a>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT EXP(2);</code></strong><font></font>
        -&gt; 7.3890560989307<font></font>
mysql&gt; <strong class="userinput"><code>SELECT EXP(-2);</code></strong><font></font>
        -&gt; 0.13533528323661<font></font>
mysql&gt; <strong class="userinput"><code>SELECT EXP(0);</code></strong><font></font>
        -&gt; 1<font></font>
</pre></li><li class="listitem"><a name="function_floor"></a><p>
            <a class="indexterm" name="idm140091685558112"></a>

            <a class="link" href="functions.html#function_floor"><code class="literal">FLOOR(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the largest integer value not greater than
            <em class="replaceable"><code>X</code></em>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FLOOR(1.23), FLOOR(-1.23);</code></strong><font></font>
        -&gt; 1, -2<font></font>
</pre><p>
            For exact-value numeric arguments, the return value has an
            exact-value numeric type. For string or floating-point
            arguments, the return value has a floating-point type.
          </p></li><li class="listitem"><p>
            <a class="link" href="functions.html#function_format"><code class="literal">FORMAT(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code></a>
          </p><p>
            Formats the number <em class="replaceable"><code>X</code></em> to a format
            like <code class="literal">'#,###,###.##'</code>, rounded to
            <em class="replaceable"><code>D</code></em> decimal places, and returns the
            result as a string. For details, see
            <a class="xref" href="functions.html#string-functions" title="12.5字符串函数">Section&nbsp;12.5, “String Functions”</a>.
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm140091685542160"></a>

            <a class="link" href="functions.html#function_hex"><code class="literal">HEX(N_or_S)</code></a>
          </p><p>
            This function can be used to obtain a hexadecimal
            representation of a decimal number or a string; the manner
            in which it does so varies according to the argument's
            type. See this function's description in
            <a class="xref" href="functions.html#string-functions" title="12.5字符串函数">Section&nbsp;12.5, “String Functions”</a>, for details.
          </p></li><li class="listitem"><a name="function_ln"></a><p>
            <a class="indexterm" name="idm140091685535984"></a>

            <a class="link" href="functions.html#function_ln"><code class="literal">LN(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the natural logarithm of
            <em class="replaceable"><code>X</code></em>; that is, the
            base-<span class="emphasis"><em>e</em></span> logarithm of
            <em class="replaceable"><code>X</code></em>. If
            <em class="replaceable"><code>X</code></em> is less than or equal to 0.0E0,
            the function returns <code class="literal">NULL</code> and a warning
            <span class="quote">“<span class="quote">Invalid argument for logarithm</span>”</span> is reported.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LN(2);</code></strong><font></font>
        -&gt; 0.69314718055995<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LN(-2);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre><p>
            This function is synonymous with
            <a class="link" href="functions.html#function_log"><code class="literal">LOG(<em class="replaceable"><code>X</code></em>)</code></a>.
            The inverse of this function is the
            <a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a> function.
          </p></li><li class="listitem"><a name="function_log"></a><p>
            <a class="indexterm" name="idm140091685519424"></a>

            <a class="link" href="functions.html#function_log"><code class="literal">LOG(<em class="replaceable"><code>X</code></em>)</code></a>,
            <a class="link" href="functions.html#function_log"><code class="literal">LOG(<em class="replaceable"><code>B</code></em>,<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            If called with one parameter, this function returns the
            natural logarithm of <em class="replaceable"><code>X</code></em>. If
            <em class="replaceable"><code>X</code></em> is less than or equal to 0.0E0,
            the function returns <code class="literal">NULL</code> and a warning
            <span class="quote">“<span class="quote">Invalid argument for logarithm</span>”</span> is reported.
          </p><p>
            The inverse of this function (when called with a single
            argument) is the <a class="link" href="functions.html#function_exp"><code class="literal">EXP()</code></a>
            function.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOG(2);</code></strong><font></font>
        -&gt; 0.69314718055995<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LOG(-2);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre><p>
            If called with two parameters, this function returns the
            logarithm of <em class="replaceable"><code>X</code></em> to the base
            <em class="replaceable"><code>B</code></em>. If
            <em class="replaceable"><code>X</code></em> is less than or equal to 0, or
            if <em class="replaceable"><code>B</code></em> is less than or equal to 1,
            then <code class="literal">NULL</code> is returned.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOG(2,65536);</code></strong><font></font>
        -&gt; 16<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LOG(10,100);</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LOG(1,100);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre><p>
            <a class="link" href="functions.html#function_log"><code class="literal">LOG(<em class="replaceable"><code>B</code></em>,<em class="replaceable"><code>X</code></em>)</code></a>
            is equivalent to
            <a class="link" href="functions.html#function_log"><code class="literal">LOG(<em class="replaceable"><code>X</code></em>) /
            LOG(<em class="replaceable"><code>B</code></em>)</code></a>.
          </p></li><li class="listitem"><a name="function_log2"></a><p>
            <a class="indexterm" name="idm140091685492832"></a>

            <a class="link" href="functions.html#function_log2"><code class="literal">LOG2(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the base-2 logarithm of
            <code class="literal"><em class="replaceable"><code>X</code></em></code>. If
            <em class="replaceable"><code>X</code></em> is less than or equal to 0.0E0,
            the function returns <code class="literal">NULL</code> and a warning
            <span class="quote">“<span class="quote">Invalid argument for logarithm</span>”</span> is reported.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOG2(65536);</code></strong><font></font>
        -&gt; 16<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LOG2(-100);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre><p>
            <a class="link" href="functions.html#function_log2"><code class="literal">LOG2()</code></a> is useful for finding
            out how many bits a number requires for storage. This
            function is equivalent to the expression
            <a class="link" href="functions.html#function_log"><code class="literal">LOG(<em class="replaceable"><code>X</code></em>) /
            LOG(2)</code></a>.
          </p></li><li class="listitem"><a name="function_log10"></a><p>
            <a class="indexterm" name="idm140091685476800"></a>

            <a class="link" href="functions.html#function_log10"><code class="literal">LOG10(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the base-10 logarithm of
            <em class="replaceable"><code>X</code></em>. If
            <em class="replaceable"><code>X</code></em> is less than or equal to 0.0E0,
            the function returns <code class="literal">NULL</code> and a warning
            <span class="quote">“<span class="quote">Invalid argument for logarithm</span>”</span> is reported.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LOG10(2);</code></strong><font></font>
        -&gt; 0.30102999566398<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LOG10(100);</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LOG10(-100);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre><p>
            <a class="link" href="functions.html#function_log10"><code class="literal">LOG10(<em class="replaceable"><code>X</code></em>)</code></a>
            is equivalent to
            <a class="link" href="functions.html#function_log"><code class="literal">LOG(10,<em class="replaceable"><code>X</code></em>)</code></a>.
          </p></li><li class="listitem"><a name="function_mod"></a><p>
            <a class="indexterm" name="idm140091685459456"></a>

            <a class="indexterm" name="idm140091685458384"></a>

            <a class="indexterm" name="idm140091685457312"></a>

            <a class="indexterm" name="idm140091685456240"></a>

            <a class="indexterm" name="idm140091685455168"></a>

            <a class="link" href="functions.html#function_mod"><code class="literal">MOD(<em class="replaceable"><code>N</code></em>,<em class="replaceable"><code>M</code></em>)</code></a>,
            <a class="link" href="functions.html#operator_mod"><code class="literal"><em class="replaceable"><code>N</code></em>
            % <em class="replaceable"><code>M</code></em></code></a>,
            <a class="link" href="functions.html#operator_mod"><code class="literal"><em class="replaceable"><code>N</code></em>
            MOD <em class="replaceable"><code>M</code></em></code></a>
          </p><p>
            Modulo operation. Returns the remainder of
            <em class="replaceable"><code>N</code></em> divided by
            <em class="replaceable"><code>M</code></em>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MOD(234, 10);</code></strong><font></font>
        -&gt; 4<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 253 % 7;</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT MOD(29,9);</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT 29 MOD 9;</code></strong><font></font>
        -&gt; 2<font></font>
</pre><p>
            This function is safe to use with
            <a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a> values.
          </p><p>
            <a class="link" href="functions.html#function_mod"><code class="literal">MOD()</code></a> also works on values
            that have a fractional part and returns the exact remainder
            after division:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MOD(34.5,3);</code></strong><font></font>
        -&gt; 1.5<font></font>
</pre><p>
            <a class="link" href="functions.html#function_mod"><code class="literal">MOD(<em class="replaceable"><code>N</code></em>,0)</code></a>
            returns <code class="literal">NULL</code>.
          </p></li><li class="listitem"><a name="function_pi"></a><p>
            <a class="indexterm" name="idm140091685431120"></a>

            <a class="link" href="functions.html#function_pi"><code class="literal">PI()</code></a>
          </p><p>
            Returns the value of π (pi). The default number of
            decimal places displayed is seven, but MySQL uses the full
            double-precision value internally.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT PI();</code></strong><font></font>
        -&gt; 3.141593<font></font>
mysql&gt; <strong class="userinput"><code>SELECT PI()+0.000000000000000000;</code></strong><font></font>
        -&gt; 3.141592653589793116<font></font>
</pre></li><li class="listitem"><a name="function_pow"></a><p>
            <a class="indexterm" name="idm140091685420240"></a>

            <a class="link" href="functions.html#function_pow"><code class="literal">POW(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>Y</code></em>)</code></a>
          </p><p>
            Returns the value of <em class="replaceable"><code>X</code></em> raised to
            the power of <em class="replaceable"><code>Y</code></em>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT POW(2,2);</code></strong><font></font>
        -&gt; 4<font></font>
mysql&gt; <strong class="userinput"><code>SELECT POW(2,-2);</code></strong><font></font>
        -&gt; 0.25<font></font>
</pre></li><li class="listitem"><a name="function_power"></a><p>
            <a class="indexterm" name="idm140091685408208"></a>

            <a class="link" href="functions.html#function_power"><code class="literal">POWER(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>Y</code></em>)</code></a>
          </p><p>
            This is a synonym for <a class="link" href="functions.html#function_pow"><code class="literal">POW()</code></a>.
          </p></li><li class="listitem"><a name="function_radians"></a><p>
            <a class="indexterm" name="idm140091685399392"></a>

            <a class="link" href="functions.html#function_radians"><code class="literal">RADIANS(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the argument <em class="replaceable"><code>X</code></em>, converted
            from degrees to radians. (Note that π radians equals 180
            degrees.)
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT RADIANS(90);</code></strong><font></font>
        -&gt; 1.5707963267949<font></font>
</pre></li><li class="listitem"><a name="function_rand"></a><p>
            <a class="indexterm" name="idm140091685389328"></a>

            <a class="link" href="functions.html#function_rand"><code class="literal">RAND([<em class="replaceable"><code>N</code></em>])</code></a>
          </p><p>
            Returns a random floating-point value
            <em class="replaceable"><code>v</code></em> in the range
            <code class="literal">0</code> &lt;= <em class="replaceable"><code>v</code></em> &lt;
            <code class="literal">1.0</code>. To obtain a random integer
            <em class="replaceable"><code>R</code></em> in the range
            <em class="replaceable"><code>i</code></em> &lt;=
            <em class="replaceable"><code>R</code></em> &lt;
            <em class="replaceable"><code>j</code></em>, use the expression
            <a class="link" href="functions.html#function_floor"><code class="literal">FLOOR(<em class="replaceable"><code>i</code></em>
            + RAND() * (<em class="replaceable"><code>j</code></em></code></a>
            − <code class="literal"><em class="replaceable"><code>i</code></em>))</code>.
            For example, to obtain a random integer in the range the
            range <code class="literal">7</code> &lt;=
            <em class="replaceable"><code>R</code></em> &lt; <code class="literal">12</code>, use
            the following statement:
          </p><pre data-lang="sql" class="programlisting">SELECT FLOOR(7 + (RAND() * 5));
</pre><p>
            If an integer argument <em class="replaceable"><code>N</code></em> is
            specified, it is used as the seed value:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                With a constant initializer argument, the seed is
                initialized once when the statement is prepared, prior
                to execution.
              </p></li><li class="listitem"><p>
                With a nonconstant initializer argument (such as a
                column name), the seed is initialized with the value for
                each invocation of
                <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a>.
</p></li></ul>
</div>
<p>
            One implication of this behavior is that for equal argument
            values,
            <a class="link" href="functions.html#function_rand"><code class="literal">RAND(<em class="replaceable"><code>N</code></em>)</code></a>
            returns the same value each time, and thus produces a
            repeatable sequence of column values. In the following
            example, the sequence of values produced by
            <code class="literal">RAND(3)</code> is the same both places it
            occurs.
          </p><pre data-lang="sql" class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t (i INT);</code></strong><font></font>
Query OK, 0 rows affected (0.42 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(1),(2),(3);</code></strong><font></font>
Query OK, 3 rows affected (0.00 sec)<font></font>
Records: 3  Duplicates: 0  Warnings: 0<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT i, RAND() FROM t;</code></strong><font></font>
+------+------------------+<font></font>
| i    | RAND()           |<font></font>
+------+------------------+<font></font>
|    1 | 0.61914388706828 |<font></font>
|    2 | 0.93845168309142 |<font></font>
|    3 | 0.83482678498591 |<font></font>
+------+------------------+<font></font>
3 rows in set (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT i, RAND(3) FROM t;</code></strong><font></font>
+------+------------------+<font></font>
| i    | RAND(3)          |<font></font>
+------+------------------+<font></font>
|    1 | 0.90576975597606 |<font></font>
|    2 | 0.37307905813035 |<font></font>
|    3 | 0.14808605345719 |<font></font>
+------+------------------+<font></font>
3 rows in set (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT i, RAND() FROM t;</code></strong><font></font>
+------+------------------+<font></font>
| i    | RAND()           |<font></font>
+------+------------------+<font></font>
|    1 | 0.35877890638893 |<font></font>
|    2 | 0.28941420772058 |<font></font>
|    3 | 0.37073435016976 |<font></font>
+------+------------------+<font></font>
3 rows in set (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT i, RAND(3) FROM t;</code></strong><font></font>
+------+------------------+<font></font>
| i    | RAND(3)          |<font></font>
+------+------------------+<font></font>
|    1 | 0.90576975597606 |<font></font>
|    2 | 0.37307905813035 |<font></font>
|    3 | 0.14808605345719 |<font></font>
+------+------------------+<font></font>
3 rows in set (0.01 sec)<font></font>
</pre><p>
            <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a> in a
            <code class="literal">WHERE</code> clause is evaluated for every row
            (when selecting from one table) or combination of rows (when
            selecting from a multiple-table join). Thus, for optimizer
            purposes, <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a> is not a
            constant value and cannot be used for index optimizations.
            For more information, see
            <a class="xref" href="optimization.html#function-optimization" title="8.2.1.19函数调用优化">Section&nbsp;8.2.1.19, “Function Call Optimization”</a>.
          </p><p>
            Use of a column with <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a>
            values in an <code class="literal">ORDER BY</code> or <code class="literal">GROUP
            BY</code> clause may yield unexpected results because for
            either clause a <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a>
            expression can be evaluated multiple times for the same row,
            each time returning a different result. If the goal is to
            retrieve rows in random order, you can use a statement like
            this:
          </p><pre data-lang="sql" class="programlisting">SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> ORDER BY RAND();
</pre><p>
            To select a random sample from a set of rows, combine
            <code class="literal">ORDER BY RAND()</code> with
            <code class="literal">LIMIT</code>:
          </p><pre data-lang="sql" class="programlisting">SELECT * FROM table1, table2 WHERE a=b AND c&lt;d ORDER BY RAND() LIMIT 1000;
</pre><p>
            <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a> is not meant to be a
            perfect random generator. It is a fast way to generate
            random numbers on demand that is portable between platforms
            for the same MySQL version.
          </p><p>
            This function is unsafe for statement-based replication. A
            warning is logged if you use this function when
            <a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a> is set to
            <code class="literal">STATEMENT</code>.
          </p></li><li class="listitem"><a name="function_round"></a><p>
            <a class="indexterm" name="idm140091685339152"></a>

            <a class="link" href="functions.html#function_round"><code class="literal">ROUND(<em class="replaceable"><code>X</code></em>)</code></a>,
            <a class="link" href="functions.html#function_round"><code class="literal">ROUND(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code></a>
          </p><p>
            Rounds the argument <em class="replaceable"><code>X</code></em> to
            <em class="replaceable"><code>D</code></em> decimal places. The rounding
            algorithm depends on the data type of
            <em class="replaceable"><code>X</code></em>. <em class="replaceable"><code>D</code></em>
            defaults to 0 if not specified. <em class="replaceable"><code>D</code></em>
            can be negative to cause <em class="replaceable"><code>D</code></em> digits
            left of the decimal point of the value
            <em class="replaceable"><code>X</code></em> to become zero.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROUND(-1.23);</code></strong><font></font>
        -&gt; -1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ROUND(-1.58);</code></strong><font></font>
        -&gt; -2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ROUND(1.58);</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ROUND(1.298, 1);</code></strong><font></font>
        -&gt; 1.3<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ROUND(1.298, 0);</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ROUND(23.298, -1);</code></strong><font></font>
        -&gt; 20<font></font>
</pre><p>
            The return value has the same type as the first argument
            (assuming that it is integer, double, or decimal). This
            means that for an integer argument, the result is an integer
            (no decimal places):
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROUND(150.000,2), ROUND(150,2);</code></strong><font></font>
+------------------+--------------+<font></font>
| ROUND(150.000,2) | ROUND(150,2) |<font></font>
+------------------+--------------+<font></font>
|           150.00 |          150 |<font></font>
+------------------+--------------+<font></font>
</pre><p>
            <a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a> uses the following
            rules depending on the type of the first argument:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                For exact-value numbers,
                <a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a> uses the
                <span class="quote">“<span class="quote">round half away from zero</span>”</span> or <span class="quote">“<span class="quote">round
                toward nearest</span>”</span> rule: A value with a fractional
                part of .5 or greater is rounded up to the next integer
                if positive or down to the next integer if negative. (In
                other words, it is rounded away from zero.) A value with
                a fractional part less than .5 is rounded down to the
                next integer if positive or up to the next integer if
                negative.
              </p></li><li class="listitem"><p>
                For approximate-value numbers, the result depends on the
                C library. On many systems, this means that
                <a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a> uses the
                <span class="quote">“<span class="quote">round to nearest even</span>”</span> rule: A value with
                a fractional part exactly halfway between two integers
                is rounded to the nearest even integer.
</p></li></ul>
</div>
<p>
            The following example shows how rounding differs for exact
            and approximate values:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ROUND(2.5), ROUND(25E-1);</code></strong><font></font>
+------------+--------------+<font></font>
| ROUND(2.5) | ROUND(25E-1) |<font></font>
+------------+--------------+<font></font>
| 3          |            2 |<font></font>
+------------+--------------+<font></font>
</pre><p>
            For more information, see <a class="xref" href="functions.html#precision-math" title="12.25精度数学">Section&nbsp;12.25, “Precision Math”</a>.
          </p></li><li class="listitem"><a name="function_sign"></a><p>
            <a class="indexterm" name="idm140091685306912"></a>

            <a class="link" href="functions.html#function_sign"><code class="literal">SIGN(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the sign of the argument as <code class="literal">-1</code>,
            <code class="literal">0</code>, or <code class="literal">1</code>, depending on
            whether <em class="replaceable"><code>X</code></em> is negative, zero, or
            positive.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SIGN(-32);</code></strong><font></font>
        -&gt; -1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SIGN(0);</code></strong><font></font>
        -&gt; 0<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SIGN(234);</code></strong><font></font>
        -&gt; 1<font></font>
</pre></li><li class="listitem"><a name="function_sin"></a><p>
            <a class="indexterm" name="idm140091685293600"></a>

            <a class="link" href="functions.html#function_sin"><code class="literal">SIN(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the sine of <em class="replaceable"><code>X</code></em>, where
            <em class="replaceable"><code>X</code></em> is given in radians.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SIN(PI());</code></strong><font></font>
        -&gt; 1.2246063538224e-16<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ROUND(SIN(PI()));</code></strong><font></font>
        -&gt; 0<font></font>
</pre></li><li class="listitem"><a name="function_sqrt"></a><p>
            <a class="indexterm" name="idm140091685282560"></a>

            <a class="link" href="functions.html#function_sqrt"><code class="literal">SQRT(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the square root of a nonnegative number
            <em class="replaceable"><code>X</code></em>.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SQRT(4);</code></strong><font></font>
        -&gt; 2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SQRT(20);</code></strong><font></font>
        -&gt; 4.4721359549996<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SQRT(-16);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre></li><li class="listitem"><a name="function_tan"></a><p>
            <a class="indexterm" name="idm140091685271184"></a>

            <a class="link" href="functions.html#function_tan"><code class="literal">TAN(<em class="replaceable"><code>X</code></em>)</code></a>
          </p><p>
            Returns the tangent of <em class="replaceable"><code>X</code></em>, where
            <em class="replaceable"><code>X</code></em> is given in radians.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TAN(PI());</code></strong><font></font>
        -&gt; -1.2246063538224e-16<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TAN(PI()+1);</code></strong><font></font>
        -&gt; 1.5574077246549<font></font>
</pre></li><li class="listitem"><a name="function_truncate"></a><p>
            <a class="indexterm" name="idm140091685260096"></a>

            <a class="link" href="functions.html#function_truncate"><code class="literal">TRUNCATE(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code></a>
          </p><p>
            Returns the number <em class="replaceable"><code>X</code></em>, truncated
            to <em class="replaceable"><code>D</code></em> decimal places. If
            <em class="replaceable"><code>D</code></em> is <code class="literal">0</code>, the
            result has no decimal point or fractional part.
            <em class="replaceable"><code>D</code></em> can be negative to cause
            <em class="replaceable"><code>D</code></em> digits left of the decimal
            point of the value <em class="replaceable"><code>X</code></em> to become
            zero.
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(1.223,1);</code></strong><font></font>
        -&gt; 1.2<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(1.999,1);</code></strong><font></font>
        -&gt; 1.9<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(1.999,0);</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(-1.999,1);</code></strong><font></font>
        -&gt; -1.9<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(122,-2);</code></strong><font></font>
       -&gt; 100<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TRUNCATE(10.28*100,0);</code></strong><font></font>
       -&gt; 1028<font></font>
</pre><p>
            All numbers are rounded toward zero.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="date-and-time-functions"></a>12.7&nbsp;Date and Time Functions</h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091685242720"></a><a class="indexterm" name="idm140091685241648"></a><p>
      This section describes the functions that can be used to
      manipulate temporal values. See
      <a class="xref" href="data-types.html#date-and-time-types" title="11。3日期和时间类型">Section&nbsp;11.3, “Date and Time Types”</a>, for a description of the
      range of values each date and time type has and the valid formats
      in which values may be specified.
</p>
<div class="table">
<a name="idm140091685238816"></a><p class="title"><b>Table&nbsp;12.13&nbsp;Date and Time Functions</b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists date and time functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col">Description</th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_adddate"><code class="literal">ADDDATE()</code></a></td>
<td>
      Add time values (intervals) to a date value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_addtime"><code class="literal">ADDTIME()</code></a></td>
<td>
      Add time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a></td>
<td>
      Convert from one time zone to another
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_curdate"><code class="literal">CURDATE()</code></a></td>
<td>
      Return the current date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE()</code>, <code class="literal">CURRENT_DATE</code></a></td>
<td>
      Synonyms for CURDATE()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME()</code>, <code class="literal">CURRENT_TIME</code></a></td>
<td>
      Synonyms for CURTIME()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP()</code>, <code class="literal">CURRENT_TIMESTAMP</code></a></td>
<td>
      Synonyms for NOW()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_curtime"><code class="literal">CURTIME()</code></a></td>
<td>
      Return the current time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_date"><code class="literal">DATE()</code></a></td>
<td>
      Extract the date part of a date or datetime expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a></td>
<td>
      Add time values (intervals) to a date value
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a></td>
<td>
      Format date as specified
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a></td>
<td>
      Subtract a time value (interval) from a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_datediff"><code class="literal">DATEDIFF()</code></a></td>
<td>
      Subtract two dates
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_day"><code class="literal">DAY()</code></a></td>
<td>
      Synonym for DAYOFMONTH()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dayname"><code class="literal">DAYNAME()</code></a></td>
<td>
      Return the name of the weekday
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofmonth"><code class="literal">DAYOFMONTH()</code></a></td>
<td>
      Return the day of the month (0-31)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofweek"><code class="literal">DAYOFWEEK()</code></a></td>
<td>
      Return the weekday index of the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dayofyear"><code class="literal">DAYOFYEAR()</code></a></td>
<td>
      Return the day of the year (1-366)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_extract"><code class="literal">EXTRACT()</code></a></td>
<td>
      Extract part of a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_from-days"><code class="literal">FROM_DAYS()</code></a></td>
<td>
      Convert a day number to a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a></td>
<td>
      Format Unix timestamp as a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT()</code></a></td>
<td>
      Return a date format string
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_hour"><code class="literal">HOUR()</code></a></td>
<td>
      Extract the hour
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_last-day"><code class="literal">LAST_DAY</code></a></td>
<td>
      Return the last day of the month for the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME()</code>, <code class="literal">LOCALTIME</code></a></td>
<td>
      Synonym for NOW()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP</code>, <code class="literal">LOCALTIMESTAMP()</code></a></td>
<td>
      Synonym for NOW()
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_makedate"><code class="literal">MAKEDATE()</code></a></td>
<td>
      Create a date from the year and day of year
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_maketime"><code class="literal">MAKETIME()</code></a></td>
<td>
      Create time from hour, minute, second
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_microsecond"><code class="literal">MICROSECOND()</code></a></td>
<td>
      Return the microseconds from argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_minute"><code class="literal">MINUTE()</code></a></td>
<td>
      Return the minute from the argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_month"><code class="literal">MONTH()</code></a></td>
<td>
      Return the month from the date passed
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_monthname"><code class="literal">MONTHNAME()</code></a></td>
<td>
      Return the name of the month
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a></td>
<td>
      Return the current date and time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_period-add"><code class="literal">PERIOD_ADD()</code></a></td>
<td>
      Add a period to a year-month
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_period-diff"><code class="literal">PERIOD_DIFF()</code></a></td>
<td>
      Return the number of months between periods
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_quarter"><code class="literal">QUARTER()</code></a></td>
<td>
      Return the quarter from a date argument
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sec-to-time"><code class="literal">SEC_TO_TIME()</code></a></td>
<td>
      Converts seconds to 'hh:mm:ss' format
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_second"><code class="literal">SECOND()</code></a></td>
<td>
      Return the second (0-59)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a></td>
<td>
      Convert a string to a date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE()</code></a></td>
<td>
      Synonym for DATE_SUB() when invoked with three arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_subtime"><code class="literal">SUBTIME()</code></a></td>
<td>
      Subtract times
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a></td>
<td>
      Return the time at which the function executes
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_time"><code class="literal">TIME()</code></a></td>
<td>
      Extract the time portion of the expression passed
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_time-format"><code class="literal">TIME_FORMAT()</code></a></td>
<td>
      Format as time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_time-to-sec"><code class="literal">TIME_TO_SEC()</code></a></td>
<td>
      Return the argument converted to seconds
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_timediff"><code class="literal">TIMEDIFF()</code></a></td>
<td>
      Subtract time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_timestamp"><code class="literal">TIMESTAMP()</code></a></td>
<td>
      With a single argument, this function returns the date or datetime
      expression; with two arguments, the sum of the arguments
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_timestampadd"><code class="literal">TIMESTAMPADD()</code></a></td>
<td>
      Add an interval to a datetime expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_timestampdiff"><code class="literal">TIMESTAMPDIFF()</code></a></td>
<td>
      Subtract an interval from a datetime expression
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a></td>
<td>
      Return the date argument converted to days
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_to-seconds"><code class="literal">TO_SECONDS()</code></a></td>
<td>
      Return the date or datetime argument converted to seconds since
      Year 0
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a></td>
<td>
      Return a Unix timestamp
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-date"><code class="literal">UTC_DATE()</code></a></td>
<td>
      Return the current UTC date
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-time"><code class="literal">UTC_TIME()</code></a></td>
<td>
      Return the current UTC time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_utc-timestamp"><code class="literal">UTC_TIMESTAMP()</code></a></td>
<td>
      Return the current UTC date and time
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a></td>
<td>
      Return the week number
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_weekday"><code class="literal">WEEKDAY()</code></a></td>
<td>
      Return the weekday index
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_weekofyear"><code class="literal">WEEKOFYEAR()</code></a></td>
<td>
      Return the calendar week of the date (1-53)
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_year"><code class="literal">YEAR()</code></a></td>
<td>
      Return the year
    </td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK()</code></a></td>
<td>
      Return the year and week
    </td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
      Here is an example that uses date functions. The following query
      selects all rows with a <em class="replaceable"><code>date_col</code></em> value
      from within the last 30 days:
    </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT <em class="replaceable"><code>something</code></em> FROM <em class="replaceable"><code>tbl_name</code></em></code></strong>
    -&gt; <strong class="userinput"><code>WHERE DATE_SUB(CURDATE(),INTERVAL 30 DAY) &lt;= <em class="replaceable"><code>date_col</code></em>;</code></strong>
</pre><p>
      The query also selects rows with dates that lie in the future.
    </p><p>
      Functions that expect date values usually accept datetime values
      and ignore the time part. Functions that expect time values
      usually accept datetime values and ignore the date part.
    </p><p>
      Functions that return the current date or time each are evaluated
      only once per query at the start of query execution. This means
      that multiple references to a function such as
      <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a> within a single query always
      produce the same result. (For our purposes, a single query also
      includes a call to a stored program (stored routine, trigger, or
      event) and all subprograms called by that program.) This principle
      also applies to <a class="link" href="functions.html#function_curdate"><code class="literal">CURDATE()</code></a>,
      <a class="link" href="functions.html#function_curtime"><code class="literal">CURTIME()</code></a>,
      <a class="link" href="functions.html#function_utc-date"><code class="literal">UTC_DATE()</code></a>,
      <a class="link" href="functions.html#function_utc-time"><code class="literal">UTC_TIME()</code></a>,
      <a class="link" href="functions.html#function_utc-timestamp"><code class="literal">UTC_TIMESTAMP()</code></a>, and to any of
      their synonyms.
    </p><p>
      The <a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP()</code></a>,
      <a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME()</code></a>,
      <a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE()</code></a>, and
      <a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a> functions return
      values in the current session time zone, which is available as the
      session value of the <a class="link" href="server-administration.html#sysvar_time_zone"><code class="literal">time_zone</code></a>
      system variable. In addition,
      <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a> assumes that its
      argument is a datetime value in the session time zone. See
      <a class="xref" href="server-administration.html#time-zone-support" title="5.1.13 MySQL服务器时区支持">Section&nbsp;5.1.13, “MySQL Server Time Zone Support”</a>.
    </p><p>
      Some date functions can be used with <span class="quote">“<span class="quote">zero</span>”</span> dates or
      incomplete dates such as <code class="literal">'2001-11-00'</code>, whereas
      others cannot. Functions that extract parts of dates typically
      work with incomplete dates and thus can return 0 when you might
      otherwise expect a nonzero value. For example:
    </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYOFMONTH('2001-11-00'), MONTH('2005-00-00');</code></strong><font></font>
        -&gt; 0, 0<font></font>
</pre><p>
      Other functions expect complete dates and return
      <code class="literal">NULL</code> for incomplete dates. These include
      functions that perform date arithmetic or that map parts of dates
      to names. For example:
    </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2006-05-00',INTERVAL 1 DAY);</code></strong><font></font>
        -&gt; NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DAYNAME('2006-05-00');</code></strong><font></font>
        -&gt; NULL<font></font>
</pre><p>
      Several functions are more strict when passed a
      <a class="link" href="functions.html#function_date"><code class="literal">DATE()</code></a> function value as their
      argument and reject incomplete dates with a day part of zero.
      These functions are affected:
      <a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a>,
      <a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a>,
      <a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a>,
      <a class="link" href="functions.html#function_dayofyear"><code class="literal">DAYOFYEAR()</code></a>,
      <a class="link" href="functions.html#function_last-day"><code class="literal">LAST_DAY()</code></a> (permits a day part of
      zero), <a class="link" href="functions.html#function_timestampdiff"><code class="literal">TIMESTAMPDIFF()</code></a>,
      <a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a>,
      <a class="link" href="functions.html#function_to-seconds"><code class="literal">TO_SECONDS()</code></a>,
      <a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a>,
      <a class="link" href="functions.html#function_weekday"><code class="literal">WEEKDAY()</code></a>,
      <a class="link" href="functions.html#function_weekofyear"><code class="literal">WEEKOFYEAR()</code></a>,
      <a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK()</code></a>.
    </p><p>
      Fractional seconds for <code class="literal">TIME</code>,
      <code class="literal">DATETIME</code>, and <code class="literal">TIMESTAMP</code>
      values are supported, with up to microsecond precision. Functions
      that take temporal arguments accept values with fractional
      seconds. Return values from temporal functions include fractional
      seconds as appropriate.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_adddate"></a><p>
          <a class="indexterm" name="idm140091684983424"></a>

          <a class="link" href="functions.html#function_adddate"><code class="literal">ADDDATE(<em class="replaceable"><code>date</code></em>,INTERVAL
          <em class="replaceable"><code>expr</code></em>
          <em class="replaceable"><code>unit</code></em>)</code></a>,
          <a class="link" href="functions.html#function_adddate"><code class="literal">ADDDATE(<em class="replaceable"><code>expr</code></em>,<em class="replaceable"><code>days</code></em>)</code></a>
        </p><p>
          When invoked with the <code class="literal">INTERVAL</code> form of the
          second argument, <a class="link" href="functions.html#function_adddate"><code class="literal">ADDDATE()</code></a> is a
          synonym for <a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a>. The
          related function <a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE()</code></a> is a
          synonym for <a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a>. For
          information on the <code class="literal">INTERVAL</code>
          <em class="replaceable"><code>unit</code></em> argument, see
          <a class="xref" href="language-structure.html#temporal-intervals" title="时间间隔">Temporal Intervals</a>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2008-01-02', INTERVAL 31 DAY);</code></strong><font></font>
        -&gt; '2008-02-02'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ADDDATE('2008-01-02', INTERVAL 31 DAY);</code></strong><font></font>
        -&gt; '2008-02-02'<font></font>
</pre><p>
          When invoked with the <em class="replaceable"><code>days</code></em> form of
          the second argument, MySQL treats it as an integer number of
          days to be added to <em class="replaceable"><code>expr</code></em>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ADDDATE('2008-01-02', 31);</code></strong><font></font>
        -&gt; '2008-02-02'<font></font>
</pre></li><li class="listitem"><a name="function_addtime"></a><p>
          <a class="indexterm" name="idm140091684959520"></a>

          <a class="link" href="functions.html#function_addtime"><code class="literal">ADDTIME(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_addtime"><code class="literal">ADDTIME()</code></a> adds
          <em class="replaceable"><code>expr2</code></em> to
          <em class="replaceable"><code>expr1</code></em> and returns the result.
          <em class="replaceable"><code>expr1</code></em> is a time or datetime
          expression, and <em class="replaceable"><code>expr2</code></em> is a time
          expression.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT ADDTIME('2007-12-31 23:59:59.999999', '1 1:1:1.000002');</code></strong><font></font>
        -&gt; '2008-01-02 01:01:01.000001'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT ADDTIME('01:00:00.999999', '02:00:00.999998');</code></strong><font></font>
        -&gt; '03:00:01.999997'<font></font>
</pre></li><li class="listitem"><a name="function_convert-tz"></a><p>
          <a class="indexterm" name="idm140091684945680"></a>

          <a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ(<em class="replaceable"><code>dt</code></em>,<em class="replaceable"><code>from_tz</code></em>,<em class="replaceable"><code>to_tz</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a> converts a
          datetime value <em class="replaceable"><code>dt</code></em> from the time
          zone given by <em class="replaceable"><code>from_tz</code></em> to the time
          zone given by <em class="replaceable"><code>to_tz</code></em> and returns the
          resulting value. Time zones are specified as described in
          <a class="xref" href="server-administration.html#time-zone-support" title="5.1.13 MySQL服务器时区支持">Section&nbsp;5.1.13, “MySQL Server Time Zone Support”</a>. This function returns
          <code class="literal">NULL</code> if the arguments are invalid.
        </p><p>
          If the value falls out of the supported range of the
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a> type when converted
          from <em class="replaceable"><code>from_tz</code></em> to UTC, no conversion
          occurs. The <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a> range is
          described in <a class="xref" href="data-types.html#date-and-time-type-overview" title="11。1。2日期和时间类型概述">Section&nbsp;11.1.2, “Date and Time Type Overview”</a>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CONVERT_TZ('2004-01-01 12:00:00','GMT','MET');</code></strong><font></font>
        -&gt; '2004-01-01 13:00:00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CONVERT_TZ('2004-01-01 12:00:00','+00:00','+10:00');</code></strong><font></font>
        -&gt; '2004-01-01 22:00:00'<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            To use named time zones such as <code class="literal">'MET'</code> or
            <code class="literal">'Europe/Amsterdam'</code>, the time zone tables
            must be properly set up. For instructions, see
            <a class="xref" href="server-administration.html#time-zone-support" title="5.1.13 MySQL服务器时区支持">Section&nbsp;5.1.13, “MySQL Server Time Zone Support”</a>.
</p>
</div>
</li><li class="listitem"><a name="function_curdate"></a><p>
          <a class="indexterm" name="idm140091684923296"></a>

          <a class="link" href="functions.html#function_curdate"><code class="literal">CURDATE()</code></a>
        </p><p>
          Returns the current date as a value in
          <em class="replaceable"><code>'YYYY-MM-DD'</code></em> or
          <em class="replaceable"><code>YYYYMMDD</code></em> format, depending on
          whether the function is used in a string or numeric context.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CURDATE();</code></strong><font></font>
        -&gt; '2008-06-13'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CURDATE() + 0;</code></strong><font></font>
        -&gt; 20080613<font></font>
</pre></li><li class="listitem"><a name="function_current-date"></a><p>
          <a class="indexterm" name="idm140091684912512"></a>

          <a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE</code></a>,
          <a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE()</code></a>
        </p><p>
          <a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE</code></a> and
          <a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE()</code></a> are synonyms for
          <a class="link" href="functions.html#function_curdate"><code class="literal">CURDATE()</code></a>.
        </p></li><li class="listitem"><a name="function_current-time"></a><p>
          <a class="indexterm" name="idm140091684900800"></a>

          <a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME</code></a>,
          <a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME([<em class="replaceable"><code>fsp</code></em>])</code></a>
        </p><p>
          <a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME</code></a> and
          <a class="link" href="functions.html#function_current-time"><code class="literal">CURRENT_TIME()</code></a> are synonyms for
          <a class="link" href="functions.html#function_curtime"><code class="literal">CURTIME()</code></a>.
        </p></li><li class="listitem"><a name="function_current-timestamp"></a><p>
          <a class="indexterm" name="idm140091684888624"></a>

          <a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP</code></a>,
          <a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP([<em class="replaceable"><code>fsp</code></em>])</code></a>
        </p><p>
          <a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP</code></a> and
          <a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP()</code></a> are
          synonyms for <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>.
        </p></li><li class="listitem"><a name="function_curtime"></a><p>
          <a class="indexterm" name="idm140091684876512"></a>

          <a class="link" href="functions.html#function_curtime"><code class="literal">CURTIME([<em class="replaceable"><code>fsp</code></em>])</code></a>
        </p><p>
          Returns the current time as a value in
          <em class="replaceable"><code>'hh:mm:ss'</code></em> or
          <em class="replaceable"><code>hhmmss</code></em> format, depending on whether
          the function is used in a string or numeric context. The value
          is expressed in the session time zone.
        </p><p>
          If the <em class="replaceable"><code>fsp</code></em> argument is given to
          specify a fractional seconds precision from 0 to 6, the return
          value includes a fractional seconds part of that many digits.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT CURTIME();</code></strong><font></font>
        -&gt; '23:50:26'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT CURTIME() + 0;</code></strong><font></font>
        -&gt; 235026.000000<font></font>
</pre></li><li class="listitem"><a name="function_date"></a><p>
          <a class="indexterm" name="idm140091684863584"></a>

          <a class="link" href="functions.html#function_date"><code class="literal">DATE(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p>
          Extracts the date part of the date or datetime expression
          <em class="replaceable"><code>expr</code></em>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE('2003-12-31 01:02:03');</code></strong><font></font>
        -&gt; '2003-12-31'<font></font>
</pre></li><li class="listitem"><a name="function_datediff"></a><p>
          <a class="indexterm" name="idm140091684853600"></a>

          <a class="link" href="functions.html#function_datediff"><code class="literal">DATEDIFF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_datediff"><code class="literal">DATEDIFF()</code></a> returns
          <em class="replaceable"><code>expr1</code></em> −
          <em class="replaceable"><code>expr2</code></em> expressed as a value in days
          from one date to the other. <em class="replaceable"><code>expr1</code></em>
          and <em class="replaceable"><code>expr2</code></em> are date or date-and-time
          expressions. Only the date parts of the values are used in the
          calculation.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATEDIFF('2007-12-31 23:59:59','2007-12-30');</code></strong><font></font>
        -&gt; 1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATEDIFF('2010-11-30 23:59:59','2010-12-31');</code></strong><font></font>
        -&gt; -31<font></font>
</pre></li><li class="listitem"><a name="function_date-add"></a><p>
          <a class="indexterm" name="idm140091684839040"></a>

          <a class="indexterm" name="idm140091684837968"></a>

          <a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD(<em class="replaceable"><code>date</code></em>,INTERVAL
          <em class="replaceable"><code>expr</code></em>
          <em class="replaceable"><code>unit</code></em>)</code></a>,
          <a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB(<em class="replaceable"><code>date</code></em>,INTERVAL
          <em class="replaceable"><code>expr</code></em>
          <em class="replaceable"><code>unit</code></em>)</code></a>
        </p><p>
          These functions perform date arithmetic. The
          <em class="replaceable"><code>date</code></em> argument specifies the
          starting date or datetime value.
          <em class="replaceable"><code>expr</code></em> is an expression specifying
          the interval value to be added or subtracted from the starting
          date. <em class="replaceable"><code>expr</code></em> is evaluated as a
          string; it may start with a <code class="literal">-</code> for negative
          intervals. <em class="replaceable"><code>unit</code></em> is a keyword
          indicating the units in which the expression should be
          interpreted.
        </p><p>
          For more information about temporal interval syntax, including
          a full list of <em class="replaceable"><code>unit</code></em> specifiers, the
          expected form of the <em class="replaceable"><code>expr</code></em> argument
          for each <em class="replaceable"><code>unit</code></em> value, and rules for
          operand interpretation in temporal arithmetic, see
          <a class="xref" href="language-structure.html#temporal-intervals" title="时间间隔">Temporal Intervals</a>.
        </p><p>
          The return value depends on the arguments:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a> if the
              <em class="replaceable"><code>date</code></em> argument is a
              <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a> value and your
              calculations involve only <code class="literal">YEAR</code>,
              <code class="literal">MONTH</code>, and <code class="literal">DAY</code> parts
              (that is, no time parts).
            </p></li><li class="listitem"><p>
              <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a> if the first
              argument is a <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a> (or
              <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a>) value, or if the
              first argument is a <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a>
              and the <em class="replaceable"><code>unit</code></em> value uses
              <code class="literal">HOURS</code>, <code class="literal">MINUTES</code>, or
              <code class="literal">SECONDS</code>.
            </p></li><li class="listitem"><p>
              String otherwise.
</p></li></ul>
</div>
<p>
          To ensure that the result is
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a>, you can use
          <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a> to convert the first
          argument to <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2018-05-01',INTERVAL 1 DAY);</code></strong><font></font>
        -&gt; '2018-05-02'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('2018-05-01',INTERVAL 1 YEAR);</code></strong><font></font>
        -&gt; '2017-05-01'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2020-12-31 23:59:59',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL 1 SECOND);</code></strong><font></font>
        -&gt; '2021-01-01 00:00:00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2018-12-31 23:59:59',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL 1 DAY);</code></strong><font></font>
        -&gt; '2019-01-01 23:59:59'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('2100-12-31 23:59:59',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL '1:1' MINUTE_SECOND);</code></strong><font></font>
        -&gt; '2101-01-01 00:01:00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('2025-01-01 00:00:00',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL '1 1:1:1' DAY_SECOND);</code></strong><font></font>
        -&gt; '2024-12-30 22:58:59'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('1900-01-01 00:00:00',</code></strong>
    -&gt;                 <strong class="userinput"><code>INTERVAL '-1 10' DAY_HOUR);</code></strong><font></font>
        -&gt; '1899-12-30 14:00:00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('1998-01-02', INTERVAL 31 DAY);</code></strong><font></font>
        -&gt; '1997-12-02'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_ADD('1992-12-31 23:59:59.000002',</code></strong>
    -&gt;            <strong class="userinput"><code>INTERVAL '1.999999' SECOND_MICROSECOND);</code></strong><font></font>
        -&gt; '1993-01-01 00:00:01.000001'<font></font>
</pre></li><li class="listitem"><a name="function_date-format"></a><p>
          <a class="indexterm" name="idm140091684788304"></a>

          <a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT(<em class="replaceable"><code>date</code></em>,<em class="replaceable"><code>format</code></em>)</code></a>
        </p><p>
          Formats the <em class="replaceable"><code>date</code></em> value according to
          the <em class="replaceable"><code>format</code></em> string.
        </p><p>
          The specifiers shown in the following table may be used in the
          <em class="replaceable"><code>format</code></em> string. The
          <code class="literal">%</code> character is required before format
          specifier characters. The specifiers apply to other functions
          as well: <a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a>,
          <a class="link" href="functions.html#function_time-format"><code class="literal">TIME_FORMAT()</code></a>,
          <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a>.
</p>
<div class="informaltable">
<table summary="Specifier characters for the DATE_FORMAT function that may be used in the format string and provides a description of each specifier character."><colgroup><col width="20%"><col width="70%"></colgroup><thead><tr>
              <th scope="col">Specifier</th>
              <th scope="col">Description</th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">%a</code></td>
              <td>Abbreviated weekday name
                (<code class="literal">Sun</code>..<code class="literal">Sat</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%b</code></td>
              <td>Abbreviated month name (<code class="literal">Jan</code>..<code class="literal">Dec</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%c</code></td>
              <td>Month, numeric (<code class="literal">0</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%D</code></td>
              <td>Day of the month with English suffix (<code class="literal">0th</code>,
                <code class="literal">1st</code>, <code class="literal">2nd</code>,
                <code class="literal">3rd</code>, …)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%d</code></td>
              <td>Day of the month, numeric (<code class="literal">00</code>..<code class="literal">31</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%e</code></td>
              <td>Day of the month, numeric (<code class="literal">0</code>..<code class="literal">31</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%f</code></td>
              <td>Microseconds (<code class="literal">000000</code>..<code class="literal">999999</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%H</code></td>
              <td>Hour (<code class="literal">00</code>..<code class="literal">23</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%h</code></td>
              <td>Hour (<code class="literal">01</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%I</code></td>
              <td>Hour (<code class="literal">01</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%i</code></td>
              <td>Minutes, numeric (<code class="literal">00</code>..<code class="literal">59</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%j</code></td>
              <td>Day of year (<code class="literal">001</code>..<code class="literal">366</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%k</code></td>
              <td>Hour (<code class="literal">0</code>..<code class="literal">23</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%l</code></td>
              <td>Hour (<code class="literal">1</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%M</code></td>
              <td>Month name (<code class="literal">January</code>..<code class="literal">December</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%m</code></td>
              <td>Month, numeric (<code class="literal">00</code>..<code class="literal">12</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%p</code></td>
              <td><code class="literal">AM</code> or <code class="literal">PM</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">%r</code></td>
              <td>Time, 12-hour (<em class="replaceable"><code>hh:mm:ss</code></em> followed by
                <code class="literal">AM</code> or <code class="literal">PM</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%S</code></td>
              <td>Seconds (<code class="literal">00</code>..<code class="literal">59</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%s</code></td>
              <td>Seconds (<code class="literal">00</code>..<code class="literal">59</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%T</code></td>
              <td>Time, 24-hour (<em class="replaceable"><code>hh:mm:ss</code></em>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%U</code></td>
              <td>Week (<code class="literal">00</code>..<code class="literal">53</code>), where Sunday is the
                first day of the week;
                <a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a> mode 0</td>
            </tr><tr>
              <td scope="row"><code class="literal">%u</code></td>
              <td>Week (<code class="literal">00</code>..<code class="literal">53</code>), where Monday is the
                first day of the week;
                <a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a> mode 1</td>
            </tr><tr>
              <td scope="row"><code class="literal">%V</code></td>
              <td>Week (<code class="literal">01</code>..<code class="literal">53</code>), where Sunday is the
                first day of the week;
                <a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a> mode 2; used with
                <code class="literal">%X</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">%v</code></td>
              <td>Week (<code class="literal">01</code>..<code class="literal">53</code>), where Monday is the
                first day of the week;
                <a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a> mode 3; used with
                <code class="literal">%x</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">%W</code></td>
              <td>Weekday name (<code class="literal">Sunday</code>..<code class="literal">Saturday</code>)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%w</code></td>
              <td>Day of the week
                (<code class="literal">0</code>=Sunday..<code class="literal">6</code>=Saturday)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%X</code></td>
              <td>Year for the week where Sunday is the first day of the week, numeric,
                four digits; used with <code class="literal">%V</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">%x</code></td>
              <td>Year for the week, where Monday is the first day of the week, numeric,
                four digits; used with <code class="literal">%v</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">%Y</code></td>
              <td>Year, numeric, four digits</td>
            </tr><tr>
              <td scope="row"><code class="literal">%y</code></td>
              <td>Year, numeric (two digits)</td>
            </tr><tr>
              <td scope="row"><code class="literal">%%</code></td>
              <td>A literal <code class="literal">%</code> character</td>
            </tr><tr>
              <td scope="row"><code class="literal">%<em class="replaceable"><code>x</code></em></code></td>
              <td><em class="replaceable"><code>x</code></em>, for any
                <span class="quote">“<span class="quote"><em class="replaceable"><code>x</code></em></span>”</span> not listed
                above</td>
</tr></tbody></table>
</div>
<p>
          Ranges for the month and day specifiers begin with zero due to
          the fact that MySQL permits the storing of incomplete dates
          such as <code class="literal">'2014-00-00'</code>.
        </p><p>
          The language used for day and month names and abbreviations is
          controlled by the value of the
          <a class="link" href="server-administration.html#sysvar_lc_time_names"><code class="literal">lc_time_names</code></a> system variable
          (<a class="xref" href="charset.html#locale-support" title="10.15 MySQL服务器区域设置支持">Section&nbsp;10.15, “MySQL Server Locale Support”</a>).
        </p><p>
          For the <code class="literal">%U</code>, <code class="literal">%u</code>,
          <code class="literal">%V</code>, and <code class="literal">%v</code> specifiers,
          see the description of the
          <a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a> function for information
          about the mode values. The mode affects how week numbering
          occurs.
        </p><p>
          <a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a> returns a string
          with a character set and collation given by
          <a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a> and
          <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> so that
          it can return month and weekday names containing non-ASCII
          characters.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2009-10-04 22:23:00', '%W %M %Y');</code></strong><font></font>
        -&gt; 'Sunday October 2009'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2007-10-04 22:23:00', '%H:%i:%s');</code></strong><font></font>
        -&gt; '22:23:00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('1900-10-04 22:23:00',</code></strong>
    -&gt; <strong class="userinput"><code>                '%D %y %a %d %m %b %j');</code></strong><font></font>
        -&gt; '4th 00 Thu 04 10 Oct 277'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('1997-10-04 22:23:00',</code></strong>
    -&gt; <strong class="userinput"><code>                '%H %k %I %r %T %S %w');</code></strong><font></font>
        -&gt; '22 22 10 10:23:00 PM 22:23:00 00 6'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('1999-01-01', '%X %V');</code></strong><font></font>
        -&gt; '1998 52'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2006-06-00', '%d');</code></strong><font></font>
        -&gt; '00'<font></font>
</pre></li><li class="listitem"><a name="function_date-sub"></a><p>
          <a class="indexterm" name="idm140091684608384"></a>

          <a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB(<em class="replaceable"><code>date</code></em>,INTERVAL
          <em class="replaceable"><code>expr</code></em>
          <em class="replaceable"><code>unit</code></em>)</code></a>
        </p><p>
          See the description for
          <a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a>.
        </p></li><li class="listitem"><a name="function_day"></a><p>
          <a class="indexterm" name="idm140091684599072"></a>

          <a class="link" href="functions.html#function_day"><code class="literal">DAY(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_day"><code class="literal">DAY()</code></a> is a synonym for
          <a class="link" href="functions.html#function_dayofmonth"><code class="literal">DAYOFMONTH()</code></a>.
        </p></li><li class="listitem"><a name="function_dayname"></a><p>
          <a class="indexterm" name="idm140091684589408"></a>

          <a class="link" href="functions.html#function_dayname"><code class="literal">DAYNAME(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          Returns the name of the weekday for
          <em class="replaceable"><code>date</code></em>. The language used for the
          name is controlled by the value of the
          <a class="link" href="server-administration.html#sysvar_lc_time_names"><code class="literal">lc_time_names</code></a> system variable
          (<a class="xref" href="charset.html#locale-support" title="10.15 MySQL服务器区域设置支持">Section&nbsp;10.15, “MySQL Server Locale Support”</a>).
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYNAME('2007-02-03');</code></strong><font></font>
        -&gt; 'Saturday'<font></font>
</pre></li><li class="listitem"><a name="function_dayofmonth"></a><p>
          <a class="indexterm" name="idm140091684577520"></a>

          <a class="link" href="functions.html#function_dayofmonth"><code class="literal">DAYOFMONTH(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          Returns the day of the month for
          <em class="replaceable"><code>date</code></em>, in the range
          <code class="literal">1</code> to <code class="literal">31</code>, or
          <code class="literal">0</code> for dates such as
          <code class="literal">'0000-00-00'</code> or
          <code class="literal">'2008-00-00'</code> that have a zero day part.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYOFMONTH('2007-02-03');</code></strong><font></font>
        -&gt; 3<font></font>
</pre></li><li class="listitem"><a name="function_dayofweek"></a><p>
          <a class="indexterm" name="idm140091684564144"></a>

          <a class="link" href="functions.html#function_dayofweek"><code class="literal">DAYOFWEEK(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          Returns the weekday index for <em class="replaceable"><code>date</code></em>
          (<code class="literal">1</code> = Sunday, <code class="literal">2</code> = Monday,
          …, <code class="literal">7</code> = Saturday). These index values
          correspond to the ODBC standard.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYOFWEEK('2007-02-03');</code></strong><font></font>
        -&gt; 7<font></font>
</pre></li><li class="listitem"><a name="function_dayofyear"></a><p>
          <a class="indexterm" name="idm140091684552096"></a>

          <a class="link" href="functions.html#function_dayofyear"><code class="literal">DAYOFYEAR(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          Returns the day of the year for
          <em class="replaceable"><code>date</code></em>, in the range
          <code class="literal">1</code> to <code class="literal">366</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DAYOFYEAR('2007-02-03');</code></strong><font></font>
        -&gt; 34<font></font>
</pre></li><li class="listitem"><a name="function_extract"></a><p>
          <a class="indexterm" name="idm140091684540816"></a>

          <a class="link" href="functions.html#function_extract"><code class="literal">EXTRACT(<em class="replaceable"><code>unit</code></em>
          FROM <em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          The <a class="link" href="functions.html#function_extract"><code class="literal">EXTRACT()</code></a> function uses the
          same kinds of <em class="replaceable"><code>unit</code></em> specifiers as
          <a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a> or
          <a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a>, but extracts parts
          from the date rather than performing date arithmetic. For
          information on the <em class="replaceable"><code>unit</code></em> argument,
          see <a class="xref" href="language-structure.html#temporal-intervals" title="时间间隔">Temporal Intervals</a>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(YEAR FROM '2019-07-02');</code></strong><font></font>
        -&gt; 2019<font></font>
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(YEAR_MONTH FROM '2019-07-02 01:02:03');</code></strong><font></font>
        -&gt; 201907<font></font>
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(DAY_MINUTE FROM '2019-07-02 01:02:03');</code></strong><font></font>
        -&gt; 20102<font></font>
mysql&gt; <strong class="userinput"><code>SELECT EXTRACT(MICROSECOND</code></strong>
    -&gt;                <strong class="userinput"><code>FROM '2003-01-02 10:30:00.000123');</code></strong><font></font>
        -&gt; 123<font></font>
</pre></li><li class="listitem"><a name="function_from-days"></a><p>
          <a class="indexterm" name="idm140091684522384"></a>

          <a class="link" href="functions.html#function_from-days"><code class="literal">FROM_DAYS(<em class="replaceable"><code>N</code></em>)</code></a>
        </p><p>
          Given a day number <em class="replaceable"><code>N</code></em>, returns a
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a> value.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FROM_DAYS(730669);</code></strong><font></font>
        -&gt; '2000-07-03'<font></font>
</pre><p>
          Use <a class="link" href="functions.html#function_from-days"><code class="literal">FROM_DAYS()</code></a> with caution on
          old dates. It is not intended for use with values that precede
          the advent of the Gregorian calendar (1582). See
          <a class="xref" href="functions.html#mysql-calendar" title="12.8 MySQL使用什么日历？">Section&nbsp;12.8, “What Calendar Is Used By MySQL?”</a>.
        </p></li><li class="listitem"><a name="function_from-unixtime"></a><p>
          <a class="indexterm" name="idm140091684508640"></a>

          <a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME(<em class="replaceable"><code>unix_timestamp</code></em>[,<em class="replaceable"><code>format</code></em>])</code></a>
        </p><p>
          Returns a representation of the
          <em class="replaceable"><code>unix_timestamp</code></em> argument as a value
          in <em class="replaceable"><code>'YYYY-MM-DD hh:mm:ss'</code></em> or
          <em class="replaceable"><code>YYYYMMDDhhmmss.uuuuuu</code></em> format,
          depending on whether the function is used in a string or
          numeric context. <em class="replaceable"><code>unix_timestamp</code></em> is
          an internal timestamp value representing seconds since
          <code class="literal">'1970-01-01 00:00:00'</code> UTC, such as produced
          by the <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a>
          function.
        </p><p>
          The return value is expressed in the session time zone.
          (Clients can set the session time zone as described in
          <a class="xref" href="server-administration.html#time-zone-support" title="5.1.13 MySQL服务器时区支持">Section&nbsp;5.1.13, “MySQL Server Time Zone Support”</a>.) The
          <em class="replaceable"><code>format</code></em> string, if given, is used to
          format the result the same way as described in the entry for
          the <a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a> function.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1447430881);</code></strong><font></font>
        -&gt; '2015-11-13 10:08:01'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1447430881) + 0;</code></strong><font></font>
        -&gt; 20151113100801<font></font>
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1447430881,</code></strong>
    -&gt;                      <strong class="userinput"><code>'%Y %D %M %h:%i:%s %x');</code></strong><font></font>
        -&gt; '2015 13th November 10:08:01 2015'<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            If you use <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a>
            and <a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a> to
            convert between values in a non-UTC time zone and Unix
            timestamp values, the conversion is lossy because the
            mapping is not one-to-one in both directions. For details,
            see the description of the
            <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a> function.
</p>
</div>
</li><li class="listitem"><a name="function_get-format"></a><p>
          <a class="indexterm" name="idm140091684484560"></a>

          <a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT({DATE|TIME|DATETIME},
          {'EUR'|'USA'|'JIS'|'ISO'|'INTERNAL'})</code></a>
        </p><p>
          Returns a format string. This function is useful in
          combination with the
          <a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a> and the
          <a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a> functions.
        </p><p>
          The possible values for the first and second arguments result
          in several possible format strings (for the specifiers used,
          see the table in the
          <a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a> function
          description). ISO format refers to ISO 9075, not ISO 8601.
</p>
<div class="informaltable">
<table summary="Function calls for the GET_FORMAT function along with results for each function call."><colgroup><col width="60%"><col width="40%"></colgroup><thead><tr>
              <th scope="col">Function Call</th>
              <th scope="col">Result</th>
            </tr></thead><tbody><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATE,'USA')</code></a></td>
              <td><code class="literal">'%m.%d.%Y'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATE,'JIS')</code></a></td>
              <td><code class="literal">'%Y-%m-%d'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATE,'ISO')</code></a></td>
              <td><code class="literal">'%Y-%m-%d'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATE,'EUR')</code></a></td>
              <td><code class="literal">'%d.%m.%Y'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATE,'INTERNAL')</code></a></td>
              <td><code class="literal">'%Y%m%d'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATETIME,'USA')</code></a></td>
              <td><code class="literal">'%Y-%m-%d %H.%i.%s'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATETIME,'JIS')</code></a></td>
              <td><code class="literal">'%Y-%m-%d %H:%i:%s'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATETIME,'ISO')</code></a></td>
              <td><code class="literal">'%Y-%m-%d %H:%i:%s'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATETIME,'EUR')</code></a></td>
              <td><code class="literal">'%Y-%m-%d %H.%i.%s'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(DATETIME,'INTERNAL')</code></a></td>
              <td><code class="literal">'%Y%m%d%H%i%s'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(TIME,'USA')</code></a></td>
              <td><code class="literal">'%h:%i:%s %p'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(TIME,'JIS')</code></a></td>
              <td><code class="literal">'%H:%i:%s'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(TIME,'ISO')</code></a></td>
              <td><code class="literal">'%H:%i:%s'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(TIME,'EUR')</code></a></td>
              <td><code class="literal">'%H.%i.%s'</code></td>
            </tr><tr>
              <td scope="row"><a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT(TIME,'INTERNAL')</code></a></td>
              <td><code class="literal">'%H%i%s'</code></td>
</tr></tbody></table>
</div>
<p>
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a> can also be used as
          the first argument to
          <a class="link" href="functions.html#function_get-format"><code class="literal">GET_FORMAT()</code></a>, in which case the
          function returns the same values as for
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_FORMAT('2003-10-03',GET_FORMAT(DATE,'EUR'));</code></strong><font></font>
        -&gt; '03.10.2003'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('10.31.2003',GET_FORMAT(DATE,'USA'));</code></strong><font></font>
        -&gt; '2003-10-31'<font></font>
</pre></li><li class="listitem"><a name="function_hour"></a><p>
          <a class="indexterm" name="idm140091684403632"></a>

          <a class="link" href="functions.html#function_hour"><code class="literal">HOUR(<em class="replaceable"><code>time</code></em>)</code></a>
        </p><p>
          Returns the hour for <em class="replaceable"><code>time</code></em>. The
          range of the return value is <code class="literal">0</code> to
          <code class="literal">23</code> for time-of-day values. However, the
          range of <a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a> values actually
          is much larger, so <code class="literal">HOUR</code> can return values
          greater than <code class="literal">23</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT HOUR('10:05:03');</code></strong><font></font>
        -&gt; 10<font></font>
mysql&gt; <strong class="userinput"><code>SELECT HOUR('272:59:59');</code></strong><font></font>
        -&gt; 272<font></font>
</pre></li><li class="listitem"><a name="function_last-day"></a><p>
          <a class="indexterm" name="idm140091684388864"></a>

          <a class="link" href="functions.html#function_last-day"><code class="literal">LAST_DAY(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          Takes a date or datetime value and returns the corresponding
          value for the last day of the month. Returns
          <code class="literal">NULL</code> if the argument is invalid.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2003-02-05');</code></strong><font></font>
        -&gt; '2003-02-28'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2004-02-05');</code></strong><font></font>
        -&gt; '2004-02-29'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2004-01-01 01:01:01');</code></strong><font></font>
        -&gt; '2004-01-31'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT LAST_DAY('2003-03-32');</code></strong><font></font>
        -&gt; NULL<font></font>
</pre></li><li class="listitem"><a name="function_localtime"></a><p>
          <a class="indexterm" name="idm140091684376192"></a>

          <a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME</code></a>,
          <a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME([<em class="replaceable"><code>fsp</code></em>])</code></a>
        </p><p>
          <a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME</code></a> and
          <a class="link" href="functions.html#function_localtime"><code class="literal">LOCALTIME()</code></a> are synonyms for
          <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>.
        </p></li><li class="listitem"><a name="function_localtimestamp"></a><p>
          <a class="indexterm" name="idm140091684364096"></a>

          <a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP</code></a>,
          <a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP([<em class="replaceable"><code>fsp</code></em>])</code></a>
        </p><p>
          <a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP</code></a> and
          <a class="link" href="functions.html#function_localtimestamp"><code class="literal">LOCALTIMESTAMP()</code></a> are synonyms
          for <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>.
        </p></li><li class="listitem"><a name="function_makedate"></a><p>
          <a class="indexterm" name="idm140091684352000"></a>

          <a class="link" href="functions.html#function_makedate"><code class="literal">MAKEDATE(<em class="replaceable"><code>year</code></em>,<em class="replaceable"><code>dayofyear</code></em>)</code></a>
        </p><p>
          Returns a date, given year and day-of-year values.
          <em class="replaceable"><code>dayofyear</code></em> must be greater than 0 or
          the result is <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MAKEDATE(2011,31), MAKEDATE(2011,32);</code></strong><font></font>
        -&gt; '2011-01-31', '2011-02-01'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT MAKEDATE(2011,365), MAKEDATE(2014,365);</code></strong><font></font>
        -&gt; '2011-12-31', '2014-12-31'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT MAKEDATE(2011,0);</code></strong><font></font>
        -&gt; NULL<font></font>
</pre></li><li class="listitem"><a name="function_maketime"></a><p>
          <a class="indexterm" name="idm140091684339216"></a>

          <a class="link" href="functions.html#function_maketime"><code class="literal">MAKETIME(<em class="replaceable"><code>hour</code></em>,<em class="replaceable"><code>minute</code></em>,<em class="replaceable"><code>second</code></em>)</code></a>
        </p><p>
          Returns a time value calculated from the
          <em class="replaceable"><code>hour</code></em>,
          <em class="replaceable"><code>minute</code></em>, and
          <em class="replaceable"><code>second</code></em> arguments.
        </p><p>
          The <em class="replaceable"><code>second</code></em> argument can have a
          fractional part.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MAKETIME(12,15,30);</code></strong><font></font>
        -&gt; '12:15:30'<font></font>
</pre></li><li class="listitem"><a name="function_microsecond"></a><p>
          <a class="indexterm" name="idm140091684326672"></a>

          <a class="link" href="functions.html#function_microsecond"><code class="literal">MICROSECOND(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p>
          Returns the microseconds from the time or datetime expression
          <em class="replaceable"><code>expr</code></em> as a number in the range from
          <code class="literal">0</code> to <code class="literal">999999</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MICROSECOND('12:00:00.123456');</code></strong><font></font>
        -&gt; 123456<font></font>
mysql&gt; <strong class="userinput"><code>SELECT MICROSECOND('2019-12-31 23:59:59.000010');</code></strong><font></font>
        -&gt; 10<font></font>
</pre></li><li class="listitem"><a name="function_minute"></a><p>
          <a class="indexterm" name="idm140091684314496"></a>

          <a class="link" href="functions.html#function_minute"><code class="literal">MINUTE(<em class="replaceable"><code>time</code></em>)</code></a>
        </p><p>
          Returns the minute for <em class="replaceable"><code>time</code></em>, in the
          range <code class="literal">0</code> to <code class="literal">59</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MINUTE('2008-02-03 10:05:03');</code></strong><font></font>
        -&gt; 5<font></font>
</pre></li><li class="listitem"><a name="function_month"></a><p>
          <a class="indexterm" name="idm140091684303232"></a>

          <a class="link" href="functions.html#function_month"><code class="literal">MONTH(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          Returns the month for <em class="replaceable"><code>date</code></em>, in the
          range <code class="literal">1</code> to <code class="literal">12</code> for
          January to December, or <code class="literal">0</code> for dates such as
          <code class="literal">'0000-00-00'</code> or
          <code class="literal">'2008-00-00'</code> that have a zero month part.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MONTH('2008-02-03');</code></strong><font></font>
        -&gt; 2<font></font>
</pre></li><li class="listitem"><a name="function_monthname"></a><p>
          <a class="indexterm" name="idm140091684289792"></a>

          <a class="link" href="functions.html#function_monthname"><code class="literal">MONTHNAME(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          Returns the full name of the month for
          <em class="replaceable"><code>date</code></em>. The language used for the
          name is controlled by the value of the
          <a class="link" href="server-administration.html#sysvar_lc_time_names"><code class="literal">lc_time_names</code></a> system variable
          (<a class="xref" href="charset.html#locale-support" title="10.15 MySQL服务器区域设置支持">Section&nbsp;10.15, “MySQL Server Locale Support”</a>).
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MONTHNAME('2008-02-03');</code></strong><font></font>
        -&gt; 'February'<font></font>
</pre></li><li class="listitem"><a name="function_now"></a><p>
          <a class="indexterm" name="idm140091684277936"></a>

          <a class="link" href="functions.html#function_now"><code class="literal">NOW([<em class="replaceable"><code>fsp</code></em>])</code></a>
        </p><p>
          Returns the current date and time as a value in
          <em class="replaceable"><code>'YYYY-MM-DD hh:mm:ss'</code></em> or
          <em class="replaceable"><code>YYYYMMDDhhmmss</code></em> format, depending on
          whether the function is used in a string or numeric context.
          The value is expressed in the session time zone.
        </p><p>
          If the <em class="replaceable"><code>fsp</code></em> argument is given to
          specify a fractional seconds precision from 0 to 6, the return
          value includes a fractional seconds part of that many digits.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NOW();</code></strong><font></font>
        -&gt; '2007-12-15 23:50:26'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT NOW() + 0;</code></strong><font></font>
        -&gt; 20071215235026.000000<font></font>
</pre><p>
          <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a> returns a constant time
          that indicates the time at which the statement began to
          execute. (Within a stored function or trigger,
          <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a> returns the time at which
          the function or triggering statement began to execute.) This
          differs from the behavior for
          <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a>, which returns the
          exact time at which it executes.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NOW(), SLEEP(2), NOW();</code></strong><font></font>
+---------------------+----------+---------------------+<font></font>
| NOW()               | SLEEP(2) | NOW()               |<font></font>
+---------------------+----------+---------------------+<font></font>
| 2006-04-12 13:47:36 |        0 | 2006-04-12 13:47:36 |<font></font>
+---------------------+----------+---------------------+<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SYSDATE(), SLEEP(2), SYSDATE();</code></strong><font></font>
+---------------------+----------+---------------------+<font></font>
| SYSDATE()           | SLEEP(2) | SYSDATE()           |<font></font>
+---------------------+----------+---------------------+<font></font>
| 2006-04-12 13:47:44 |        0 | 2006-04-12 13:47:46 |<font></font>
+---------------------+----------+---------------------+<font></font>
</pre><p>
          In addition, the <code class="literal">SET TIMESTAMP</code> statement
          affects the value returned by
          <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a> but not by
          <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a>. This means that
          timestamp settings in the binary log have no effect on
          invocations of <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a>.
          Setting the timestamp to a nonzero value causes each
          subsequent invocation of <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>
          to return that value. Setting the timestamp to zero cancels
          this effect so that <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a> once
          again returns the current date and time.
        </p><p>
          See the description for
          <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a> for additional
          information about the differences between the two functions.
        </p></li><li class="listitem"><a name="function_period-add"></a><p>
          <a class="indexterm" name="idm140091684248544"></a>

          <a class="link" href="functions.html#function_period-add"><code class="literal">PERIOD_ADD(<em class="replaceable"><code>P</code></em>,<em class="replaceable"><code>N</code></em>)</code></a>
        </p><p>
          Adds <em class="replaceable"><code>N</code></em> months to period
          <em class="replaceable"><code>P</code></em> (in the format
          <em class="replaceable"><code>YYMM</code></em> or
          <em class="replaceable"><code>YYYYMM</code></em>). Returns a value in the
          format <em class="replaceable"><code>YYYYMM</code></em>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The period argument <em class="replaceable"><code>P</code></em> is
            <span class="emphasis"><em>not</em></span> a date value.
</p>
</div>
<pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT PERIOD_ADD(200801,2);</code></strong><font></font>
        -&gt; 200803<font></font>
</pre></li><li class="listitem"><a name="function_period-diff"></a><p>
          <a class="indexterm" name="idm140091684234880"></a>

          <a class="link" href="functions.html#function_period-diff"><code class="literal">PERIOD_DIFF(<em class="replaceable"><code>P1</code></em>,<em class="replaceable"><code>P2</code></em>)</code></a>
        </p><p>
          Returns the number of months between periods
          <em class="replaceable"><code>P1</code></em> and
          <em class="replaceable"><code>P2</code></em>. <em class="replaceable"><code>P1</code></em>
          and <em class="replaceable"><code>P2</code></em> should be in the format
          <em class="replaceable"><code>YYMM</code></em> or
          <em class="replaceable"><code>YYYYMM</code></em>. Note that the period
          arguments <em class="replaceable"><code>P1</code></em> and
          <em class="replaceable"><code>P2</code></em> are <span class="emphasis"><em>not</em></span>
          date values.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT PERIOD_DIFF(200802,200703);</code></strong><font></font>
        -&gt; 11<font></font>
</pre></li><li class="listitem"><a name="function_quarter"></a><p>
          <a class="indexterm" name="idm140091684221136"></a>

          <a class="link" href="functions.html#function_quarter"><code class="literal">QUARTER(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          Returns the quarter of the year for
          <em class="replaceable"><code>date</code></em>, in the range
          <code class="literal">1</code> to <code class="literal">4</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT QUARTER('2008-04-01');</code></strong><font></font>
        -&gt; 2<font></font>
</pre></li><li class="listitem"><a name="function_second"></a><p>
          <a class="indexterm" name="idm140091684209840"></a>

          <a class="link" href="functions.html#function_second"><code class="literal">SECOND(<em class="replaceable"><code>time</code></em>)</code></a>
        </p><p>
          Returns the second for <em class="replaceable"><code>time</code></em>, in the
          range <code class="literal">0</code> to <code class="literal">59</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SECOND('10:05:03');</code></strong><font></font>
        -&gt; 3<font></font>
</pre></li><li class="listitem"><a name="function_sec-to-time"></a><p>
          <a class="indexterm" name="idm140091684198576"></a>

          <a class="link" href="functions.html#function_sec-to-time"><code class="literal">SEC_TO_TIME(<em class="replaceable"><code>seconds</code></em>)</code></a>
        </p><p>
          Returns the <em class="replaceable"><code>seconds</code></em> argument,
          converted to hours, minutes, and seconds, as a
          <a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a> value. The range of the
          result is constrained to that of the
          <a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a> data type. A warning
          occurs if the argument corresponds to a value outside that
          range.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SEC_TO_TIME(2378);</code></strong><font></font>
        -&gt; '00:39:38'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SEC_TO_TIME(2378) + 0;</code></strong><font></font>
        -&gt; 3938<font></font>
</pre></li><li class="listitem"><a name="function_str-to-date"></a><p>
          <a class="indexterm" name="idm140091684185232"></a>

          <a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>format</code></em>)</code></a>
        </p><p>
          This is the inverse of the
          <a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a> function. It
          takes a string <em class="replaceable"><code>str</code></em> and a format
          string <em class="replaceable"><code>format</code></em>.
          <a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a> returns a
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a> value if the format
          string contains both date and time parts, or a
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a> or
          <a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a> value if the string
          contains only date or time parts. If the date, time, or
          datetime value extracted from <em class="replaceable"><code>str</code></em>
          is illegal, <a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a>
          returns <code class="literal">NULL</code> and produces a warning.
        </p><p>
          The server scans <em class="replaceable"><code>str</code></em> attempting to
          match <em class="replaceable"><code>format</code></em> to it. The format
          string can contain literal characters and format specifiers
          beginning with <code class="literal">%</code>. Literal characters in
          <em class="replaceable"><code>format</code></em> must match literally in
          <em class="replaceable"><code>str</code></em>. Format specifiers in
          <em class="replaceable"><code>format</code></em> must match a date or time
          part in <em class="replaceable"><code>str</code></em>. For the specifiers
          that can be used in <em class="replaceable"><code>format</code></em>, see the
          <a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a> function
          description.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('01,5,2013','%d,%m,%Y');</code></strong><font></font>
        -&gt; '2013-05-01'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('May 1, 2013','%M %d,%Y');</code></strong><font></font>
        -&gt; '2013-05-01'<font></font>
</pre><p>
          Scanning starts at the beginning of
          <em class="replaceable"><code>str</code></em> and fails if
          <em class="replaceable"><code>format</code></em> is found not to match. Extra
          characters at the end of <em class="replaceable"><code>str</code></em> are
          ignored.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('a09:30:17','a%h:%i:%s');</code></strong><font></font>
        -&gt; '09:30:17'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('a09:30:17','%h:%i:%s');</code></strong><font></font>
        -&gt; NULL<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('09:30:17a','%h:%i:%s');</code></strong><font></font>
        -&gt; '09:30:17'<font></font>
</pre><p>
          Unspecified date or time parts have a value of 0, so
          incompletely specified values in
          <em class="replaceable"><code>str</code></em> produce a result with some or
          all parts set to 0:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('abc','abc');</code></strong><font></font>
        -&gt; '0000-00-00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('9','%m');</code></strong><font></font>
        -&gt; '0000-09-00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('9','%s');</code></strong><font></font>
        -&gt; '00:00:09'<font></font>
</pre><p>
          Range checking on the parts of date values is as described in
          <a class="xref" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型">Section&nbsp;11.3.1, “The DATE, DATETIME, and TIMESTAMP Types”</a>. This means, for example, that
          <span class="quote">“<span class="quote">zero</span>”</span> dates or dates with part values of 0 are
          permitted unless the SQL mode is set to disallow such values.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('00/00/0000', '%m/%d/%Y');</code></strong><font></font>
        -&gt; '0000-00-00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('04/31/2004', '%m/%d/%Y');</code></strong><font></font>
        -&gt; '2004-04-31'<font></font>
</pre><p>
          If the <a class="link" href="server-administration.html#sqlmode_no_zero_date"><code class="literal">NO_ZERO_DATE</code></a> or
          <a class="link" href="server-administration.html#sqlmode_no_zero_in_date"><code class="literal">NO_ZERO_IN_DATE</code></a> SQL mode is
          enabled, zero dates or part of dates are disallowed. In that
          case, <a class="link" href="functions.html#function_str-to-date"><code class="literal">STR_TO_DATE()</code></a> returns
          <code class="literal">NULL</code> and generates a warning:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET sql_mode = '';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('15:35:00', '%H:%i:%s');</code></strong><font></font>
+-------------------------------------+<font></font>
| STR_TO_DATE('15:35:00', '%H:%i:%s') |<font></font>
+-------------------------------------+<font></font>
| 15:35:00                            |<font></font>
+-------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SET sql_mode = 'NO_ZERO_IN_DATE';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('15:35:00', '%h:%i:%s');</code></strong><font></font>
+-------------------------------------+<font></font>
| STR_TO_DATE('15:35:00', '%h:%i:%s') |<font></font>
+-------------------------------------+<font></font>
| NULL                                |<font></font>
+-------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong><font></font>
*************************** 1. row ***************************<font></font>
  Level: Warning<font></font>
   Code: 1411<font></font>
Message: Incorrect datetime value: '15:35:00' for function str_to_date<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            You cannot use format <code class="literal">"%X%V"</code> to convert a
            year-week string to a date because the combination of a year
            and week does not uniquely identify a year and month if the
            week crosses a month boundary. To convert a year-week to a
            date, you should also specify the weekday:
          </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT STR_TO_DATE('200442 Monday', '%X%V %W');</code></strong><font></font>
        -&gt; '2004-10-18'<font></font>
</pre>
</div>
</li><li class="listitem"><a name="function_subdate"></a><p>
          <a class="indexterm" name="idm140091684132080"></a>

          <a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE(<em class="replaceable"><code>date</code></em>,INTERVAL
          <em class="replaceable"><code>expr</code></em>
          <em class="replaceable"><code>unit</code></em>)</code></a>,
          <a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE(<em class="replaceable"><code>expr</code></em>,<em class="replaceable"><code>days</code></em>)</code></a>
        </p><p>
          When invoked with the <code class="literal">INTERVAL</code> form of the
          second argument, <a class="link" href="functions.html#function_subdate"><code class="literal">SUBDATE()</code></a> is a
          synonym for <a class="link" href="functions.html#function_date-sub"><code class="literal">DATE_SUB()</code></a>. For
          information on the <code class="literal">INTERVAL</code>
          <em class="replaceable"><code>unit</code></em> argument, see the discussion
          for <a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT DATE_SUB('2008-01-02', INTERVAL 31 DAY);</code></strong><font></font>
        -&gt; '2007-12-02'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SUBDATE('2008-01-02', INTERVAL 31 DAY);</code></strong><font></font>
        -&gt; '2007-12-02'<font></font>
</pre><p>
          The second form enables the use of an integer value for
          <em class="replaceable"><code>days</code></em>. In such cases, it is
          interpreted as the number of days to be subtracted from the
          date or datetime expression <em class="replaceable"><code>expr</code></em>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUBDATE('2008-01-02 12:00:00', 31);</code></strong><font></font>
        -&gt; '2007-12-02 12:00:00'<font></font>
</pre></li><li class="listitem"><a name="function_subtime"></a><p>
          <a class="indexterm" name="idm140091684110528"></a>

          <a class="link" href="functions.html#function_subtime"><code class="literal">SUBTIME(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_subtime"><code class="literal">SUBTIME()</code></a> returns
          <em class="replaceable"><code>expr1</code></em> −
          <em class="replaceable"><code>expr2</code></em> expressed as a value in the
          same format as <em class="replaceable"><code>expr1</code></em>.
          <em class="replaceable"><code>expr1</code></em> is a time or datetime
          expression, and <em class="replaceable"><code>expr2</code></em> is a time
          expression.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUBTIME('2007-12-31 23:59:59.999999','1 1:1:1.000002');</code></strong><font></font>
        -&gt; '2007-12-30 22:58:58.999997'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SUBTIME('01:00:00.999999', '02:00:00.999998');</code></strong><font></font>
        -&gt; '-00:59:59.999999'<font></font>
</pre></li><li class="listitem"><a name="function_sysdate"></a><p>
          <a class="indexterm" name="idm140091684096208"></a>

          <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE([<em class="replaceable"><code>fsp</code></em>])</code></a>
        </p><p>
          Returns the current date and time as a value in
          <em class="replaceable"><code>'YYYY-MM-DD hh:mm:ss'</code></em> or
          <em class="replaceable"><code>YYYYMMDDhhmmss</code></em> format, depending on
          whether the function is used in a string or numeric context.
        </p><p>
          If the <em class="replaceable"><code>fsp</code></em> argument is given to
          specify a fractional seconds precision from 0 to 6, the return
          value includes a fractional seconds part of that many digits.
        </p><p>
          <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a> returns the time at
          which it executes. This differs from the behavior for
          <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>, which returns a constant
          time that indicates the time at which the statement began to
          execute. (Within a stored function or trigger,
          <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a> returns the time at which
          the function or triggering statement began to execute.)
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT NOW(), SLEEP(2), NOW();</code></strong><font></font>
+---------------------+----------+---------------------+<font></font>
| NOW()               | SLEEP(2) | NOW()               |<font></font>
+---------------------+----------+---------------------+<font></font>
| 2006-04-12 13:47:36 |        0 | 2006-04-12 13:47:36 |<font></font>
+---------------------+----------+---------------------+<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT SYSDATE(), SLEEP(2), SYSDATE();</code></strong><font></font>
+---------------------+----------+---------------------+<font></font>
| SYSDATE()           | SLEEP(2) | SYSDATE()           |<font></font>
+---------------------+----------+---------------------+<font></font>
| 2006-04-12 13:47:44 |        0 | 2006-04-12 13:47:46 |<font></font>
+---------------------+----------+---------------------+<font></font>
</pre><p>
          In addition, the <code class="literal">SET TIMESTAMP</code> statement
          affects the value returned by
          <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a> but not by
          <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a>. This means that
          timestamp settings in the binary log have no effect on
          invocations of <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a>.
        </p><p>
          Because <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a> can return
          different values even within the same statement, and is not
          affected by <code class="literal">SET TIMESTAMP</code>, it is
          nondeterministic and therefore unsafe for replication if
          statement-based binary logging is used. If that is a problem,
          you can use row-based logging.
        </p><p>
          Alternatively, you can use the
          <a class="link" href="server-administration.html#option_mysqld_sysdate-is-now"><code class="option">--sysdate-is-now</code></a> option to
          cause <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a> to be an alias
          for <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>. This works if the
          option is used on both the master and the slave.
        </p><p>
          The nondeterministic nature of
          <a class="link" href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a> also means that
          indexes cannot be used for evaluating expressions that refer
          to it.
        </p></li><li class="listitem"><a name="function_time"></a><p>
          <a class="indexterm" name="idm140091684065264"></a>

          <a class="link" href="functions.html#function_time"><code class="literal">TIME(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p>
          Extracts the time part of the time or datetime expression
          <em class="replaceable"><code>expr</code></em> and returns it as a string.
        </p><p>
          This function is unsafe for statement-based replication. A
          warning is logged if you use this function when
          <a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a> is set to
          <code class="literal">STATEMENT</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIME('2003-12-31 01:02:03');</code></strong><font></font>
        -&gt; '01:02:03'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TIME('2003-12-31 01:02:03.000123');</code></strong><font></font>
        -&gt; '01:02:03.000123'<font></font>
</pre></li><li class="listitem"><a name="function_timediff"></a><p>
          <a class="indexterm" name="idm140091684051952"></a>

          <a class="link" href="functions.html#function_timediff"><code class="literal">TIMEDIFF(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_timediff"><code class="literal">TIMEDIFF()</code></a> returns
          <em class="replaceable"><code>expr1</code></em> −
          <em class="replaceable"><code>expr2</code></em> expressed as a time value.
          <em class="replaceable"><code>expr1</code></em> and
          <em class="replaceable"><code>expr2</code></em> are time or date-and-time
          expressions, but both must be of the same type.
        </p><p>
          The result returned by <code class="literal">TIMEDIFF()</code> is
          limited to the range allowed for
          <a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a> values. Alternatively, you
          can use either of the functions
          <a class="link" href="functions.html#function_timestampdiff"><code class="literal">TIMESTAMPDIFF()</code></a> and
          <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a>, both of which
          return integers.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIMEDIFF('2000:01:01 00:00:00',</code></strong>
    -&gt;                 <strong class="userinput"><code>'2000:01:01 00:00:00.000001');</code></strong><font></font>
        -&gt; '-00:00:00.000001'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TIMEDIFF('2008-12-31 23:59:59.000001',</code></strong>
    -&gt; <strong class="userinput"><code>                '2008-12-30 01:01:01.000002');</code></strong><font></font>
        -&gt; '46:58:57.999999'<font></font>
</pre></li><li class="listitem"><a name="function_timestamp"></a><p>
          <a class="indexterm" name="idm140091684030896"></a>

          <a class="link" href="functions.html#function_timestamp"><code class="literal">TIMESTAMP(<em class="replaceable"><code>expr</code></em>)</code></a>,
          <a class="link" href="functions.html#function_timestamp"><code class="literal">TIMESTAMP(<em class="replaceable"><code>expr1</code></em>,<em class="replaceable"><code>expr2</code></em>)</code></a>
        </p><p>
          With a single argument, this function returns the date or
          datetime expression <em class="replaceable"><code>expr</code></em> as a
          datetime value. With two arguments, it adds the time
          expression <em class="replaceable"><code>expr2</code></em> to the date or
          datetime expression <em class="replaceable"><code>expr1</code></em> and
          returns the result as a datetime value.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMP('2003-12-31');</code></strong><font></font>
        -&gt; '2003-12-31 00:00:00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMP('2003-12-31 12:00:00','12:00:00');</code></strong><font></font>
        -&gt; '2004-01-01 00:00:00'<font></font>
</pre></li><li class="listitem"><a name="function_timestampadd"></a><p>
          <a class="indexterm" name="idm140091684016928"></a>

          <a class="link" href="functions.html#function_timestampadd"><code class="literal">TIMESTAMPADD(<em class="replaceable"><code>unit</code></em>,<em class="replaceable"><code>interval</code></em>,<em class="replaceable"><code>datetime_expr</code></em>)</code></a>
        </p><p>
          Adds the integer expression
          <em class="replaceable"><code>interval</code></em> to the date or datetime
          expression <em class="replaceable"><code>datetime_expr</code></em>. The unit
          for <em class="replaceable"><code>interval</code></em> is given by the
          <em class="replaceable"><code>unit</code></em> argument, which should be one
          of the following values: <code class="literal">MICROSECOND</code>
          (microseconds), <code class="literal">SECOND</code>,
          <code class="literal">MINUTE</code>, <code class="literal">HOUR</code>,
          <code class="literal">DAY</code>, <code class="literal">WEEK</code>,
          <code class="literal">MONTH</code>, <code class="literal">QUARTER</code>, or
          <code class="literal">YEAR</code>.
        </p><p>
          The <em class="replaceable"><code>unit</code></em> value may be specified
          using one of keywords as shown, or with a prefix of
          <code class="literal">SQL_TSI_</code>. For example,
          <code class="literal">DAY</code> and <code class="literal">SQL_TSI_DAY</code> both
          are legal.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPADD(MINUTE,1,'2003-01-02');</code></strong><font></font>
        -&gt; '2003-01-02 00:01:00'<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPADD(WEEK,1,'2003-01-02');</code></strong><font></font>
        -&gt; '2003-01-09'<font></font>
</pre></li><li class="listitem"><a name="function_timestampdiff"></a><p>
          <a class="indexterm" name="idm140091683994368"></a>

          <a class="link" href="functions.html#function_timestampdiff"><code class="literal">TIMESTAMPDIFF(<em class="replaceable"><code>unit</code></em>,<em class="replaceable"><code>datetime_expr1</code></em>,<em class="replaceable"><code>datetime_expr2</code></em>)</code></a>
        </p><p>
          Returns <em class="replaceable"><code>datetime_expr2</code></em> −
          <em class="replaceable"><code>datetime_expr1</code></em>, where
          <em class="replaceable"><code>datetime_expr1</code></em> and
          <em class="replaceable"><code>datetime_expr2</code></em> are date or datetime
          expressions. One expression may be a date and the other a
          datetime; a date value is treated as a datetime having the
          time part <code class="literal">'00:00:00'</code> where necessary. The
          unit for the result (an integer) is given by the
          <em class="replaceable"><code>unit</code></em> argument. The legal values for
          <em class="replaceable"><code>unit</code></em> are the same as those listed
          in the description of the
          <a class="link" href="functions.html#function_timestampadd"><code class="literal">TIMESTAMPADD()</code></a> function.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPDIFF(MONTH,'2003-02-01','2003-05-01');</code></strong><font></font>
        -&gt; 3<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPDIFF(YEAR,'2002-05-01','2001-01-01');</code></strong><font></font>
        -&gt; -1<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TIMESTAMPDIFF(MINUTE,'2003-02-01','2003-05-01 12:05:55');</code></strong><font></font>
        -&gt; 128885<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The order of the date or datetime arguments for this
            function is the opposite of that used with the
            <a class="link" href="functions.html#function_timestamp"><code class="literal">TIMESTAMP()</code></a> function when
            invoked with 2 arguments.
</p>
</div>
</li><li class="listitem"><a name="function_time-format"></a><p>
          <a class="indexterm" name="idm140091683975392"></a>

          <a class="link" href="functions.html#function_time-format"><code class="literal">TIME_FORMAT(<em class="replaceable"><code>time</code></em>,<em class="replaceable"><code>format</code></em>)</code></a>
        </p><p>
          This is used like the
          <a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a> function, but the
          <em class="replaceable"><code>format</code></em> string may contain format
          specifiers only for hours, minutes, seconds, and microseconds.
          Other specifiers produce a <code class="literal">NULL</code> value or
          <code class="literal">0</code>.
        </p><p>
          If the <em class="replaceable"><code>time</code></em> value contains an hour
          part that is greater than <code class="literal">23</code>, the
          <code class="literal">%H</code> and <code class="literal">%k</code> hour format
          specifiers produce a value larger than the usual range of
          <code class="literal">0..23</code>. The other hour format specifiers
          produce the hour value modulo 12.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIME_FORMAT('100:00:00', '%H %k %h %I %l');</code></strong><font></font>
        -&gt; '100 100 04 04 4'<font></font>
</pre></li><li class="listitem"><a name="function_time-to-sec"></a><p>
          <a class="indexterm" name="idm140091683958448"></a>

          <a class="link" href="functions.html#function_time-to-sec"><code class="literal">TIME_TO_SEC(<em class="replaceable"><code>time</code></em>)</code></a>
        </p><p>
          Returns the <em class="replaceable"><code>time</code></em> argument,
          converted to seconds.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TIME_TO_SEC('22:23:00');</code></strong><font></font>
        -&gt; 80580<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TIME_TO_SEC('00:39:38');</code></strong><font></font>
        -&gt; 2378<font></font>
</pre></li><li class="listitem"><a name="function_to-days"></a><p>
          <a class="indexterm" name="idm140091683947856"></a>

          <a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p>
          Given a date <em class="replaceable"><code>date</code></em>, returns a day
          number (the number of days since year 0).
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS(950501);</code></strong><font></font>
        -&gt; 728779<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('2007-10-07');</code></strong><font></font>
        -&gt; 733321<font></font>
</pre><p>
          <a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a> is not intended for
          use with values that precede the advent of the Gregorian
          calendar (1582), because it does not take into account the
          days that were lost when the calendar was changed. For dates
          before 1582 (and possibly a later year in other locales),
          results from this function are not reliable. See
          <a class="xref" href="functions.html#mysql-calendar" title="12.8 MySQL使用什么日历？">Section&nbsp;12.8, “What Calendar Is Used By MySQL?”</a>, for details.
        </p><p>
          Remember that MySQL converts two-digit year values in dates to
          four-digit form using the rules in
          <a class="xref" href="data-types.html#date-and-time-types" title="11。3日期和时间类型">Section&nbsp;11.3, “Date and Time Types”</a>. For example,
          <code class="literal">'2008-10-07'</code> and
          <code class="literal">'08-10-07'</code> are seen as identical dates:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('2008-10-07'), TO_DAYS('08-10-07');</code></strong><font></font>
        -&gt; 733687, 733687<font></font>
</pre><p>
          In MySQL, the zero date is defined as
          <code class="literal">'0000-00-00'</code>, even though this date is
          itself considered invalid. This means that, for
          <code class="literal">'0000-00-00'</code> and
          <code class="literal">'0000-01-01'</code>,
          <a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a> returns the values
          shown here:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('0000-00-00');</code></strong><font></font>
+-----------------------+<font></font>
| to_days('0000-00-00') |<font></font>
+-----------------------+<font></font>
|                  NULL |<font></font>
+-----------------------+<font></font>
1 row in set, 1 warning (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong><font></font>
+---------+------+----------------------------------------+<font></font>
| Level   | Code | Message                                |<font></font>
+---------+------+----------------------------------------+<font></font>
| Warning | 1292 | Incorrect datetime value: '0000-00-00' |<font></font>
+---------+------+----------------------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TO_DAYS('0000-01-01');</code></strong><font></font>
+-----------------------+<font></font>
| to_days('0000-01-01') |<font></font>
+-----------------------+<font></font>
|                     1 |<font></font>
+-----------------------+<font></font>
1 row in set (0.00 sec)<font></font>
</pre><p>
          This is true whether or not the
          <a class="link" href="server-administration.html#sqlmode_allow_invalid_dates"><code class="literal">ALLOW_INVALID_DATES</code></a> SQL
          server mode is enabled.
        </p></li><li class="listitem"><a name="function_to-seconds"></a><p>
          <a class="indexterm" name="idm140091683920064"></a>

          <a class="link" href="functions.html#function_to-seconds"><code class="literal">TO_SECONDS(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p>
          Given a date or datetime <em class="replaceable"><code>expr</code></em>,
          returns the number of seconds since the year 0. If
          <em class="replaceable"><code>expr</code></em> is not a valid date or
          datetime value, returns <code class="literal">NULL</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS(950501);</code></strong><font></font>
        -&gt; 62966505600<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('2009-11-29');</code></strong><font></font>
        -&gt; 63426672000<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('2009-11-29 13:43:32');</code></strong><font></font>
        -&gt; 63426721412<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS( NOW() );</code></strong><font></font>
        -&gt; 63426721458<font></font>
</pre><p>
          Like <a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a>,
          <code class="literal">TO_SECONDS()</code> is not intended for use with
          values that precede the advent of the Gregorian calendar
          (1582), because it does not take into account the days that
          were lost when the calendar was changed. For dates before 1582
          (and possibly a later year in other locales), results from
          this function are not reliable. See
          <a class="xref" href="functions.html#mysql-calendar" title="12.8 MySQL使用什么日历？">Section&nbsp;12.8, “What Calendar Is Used By MySQL?”</a>, for details.
        </p><p>
          Like <a class="link" href="functions.html#function_to-days"><code class="literal">TO_DAYS()</code></a>,
          <code class="literal">TO_SECONDS()</code>, converts two-digit year
          values in dates to four-digit form using the rules in
          <a class="xref" href="data-types.html#date-and-time-types" title="11。3日期和时间类型">Section&nbsp;11.3, “Date and Time Types”</a>.
        </p><p>
          In MySQL, the zero date is defined as
          <code class="literal">'0000-00-00'</code>, even though this date is
          itself considered invalid. This means that, for
          <code class="literal">'0000-00-00'</code> and
          <code class="literal">'0000-01-01'</code>,
          <a class="link" href="functions.html#function_to-seconds"><code class="literal">TO_SECONDS()</code></a> returns the values
          shown here:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('0000-00-00');</code></strong><font></font>
+--------------------------+<font></font>
| TO_SECONDS('0000-00-00') |<font></font>
+--------------------------+<font></font>
|                     NULL |<font></font>
+--------------------------+<font></font>
1 row in set, 1 warning (0.00 sec)<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong><font></font>
+---------+------+----------------------------------------+<font></font>
| Level   | Code | Message                                |<font></font>
+---------+------+----------------------------------------+<font></font>
| Warning | 1292 | Incorrect datetime value: '0000-00-00' |<font></font>
+---------+------+----------------------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
<font></font>
<font></font>
mysql&gt; <strong class="userinput"><code>SELECT TO_SECONDS('0000-01-01');</code></strong><font></font>
+--------------------------+<font></font>
| TO_SECONDS('0000-01-01') |<font></font>
+--------------------------+<font></font>
|                    86400 |<font></font>
+--------------------------+<font></font>
1 row in set (0.00 sec)<font></font>
</pre><p>
          This is true whether or not the
          <a class="link" href="server-administration.html#sqlmode_allow_invalid_dates"><code class="literal">ALLOW_INVALID_DATES</code></a> SQL
          server mode is enabled.
        </p></li><li class="listitem"><a name="function_unix-timestamp"></a><p>
          <a class="indexterm" name="idm140091683889968"></a>

          <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP([<em class="replaceable"><code>date</code></em>])</code></a>
        </p><p>
          If <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a> is called
          with no <em class="replaceable"><code>date</code></em> argument, it returns a
          Unix timestamp representing seconds since <code class="literal">'1970-01-01
          00:00:00'</code> UTC.
        </p><p>
          If <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a> is called
          with a <em class="replaceable"><code>date</code></em> argument, it returns
          the value of the argument as seconds since
          <code class="literal">'1970-01-01 00:00:00'</code> UTC. The server
          interprets <em class="replaceable"><code>date</code></em> as a value in the
          session time zone and converts it to an internal Unix
          timestamp value in UTC. (Clients can set the session time zone
          as described in <a class="xref" href="server-administration.html#time-zone-support" title="5.1.13 MySQL服务器时区支持">Section&nbsp;5.1.13, “MySQL Server Time Zone Support”</a>.) The
          <em class="replaceable"><code>date</code></em> argument may be a
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a>,
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a>, or
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a> string, or a number
          in <em class="replaceable"><code>YYMMDD</code></em>,
          <em class="replaceable"><code>YYMMDDhhmmss</code></em>,
          <em class="replaceable"><code>YYYYMMDD</code></em>, or
          <em class="replaceable"><code>YYYYMMDDhhmmss</code></em> format. If the
          argument includes a time part, it may optionally include a
          fractional seconds part.
        </p><p>
          The return value is an integer if no argument is given or the
          argument does not include a fractional seconds part, or
          <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a> if an argument is given
          that includes a fractional seconds part.
        </p><p>
          When the <em class="replaceable"><code>date</code></em> argument is a
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a> column,
          <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a> returns the
          internal timestamp value directly, with no implicit
          <span class="quote">“<span class="quote">string-to-Unix-timestamp</span>”</span> conversion.
        </p><p>
          The valid range of argument values is the same as for the
          <a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a> data type:
          <code class="literal">'1970-01-01 00:00:01.000000'</code> UTC to
          <code class="literal">'2038-01-19 03:14:07.999999'</code> UTC. If you
          pass an out-of-range date to
          <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a>, it returns
          <code class="literal">0</code>.
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP();</code></strong><font></font>
        -&gt; 1447431666<font></font>
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2015-11-13 10:20:19');</code></strong><font></font>
        -&gt; 1447431619<font></font>
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2015-11-13 10:20:19.012');</code></strong><font></font>
        -&gt; 1447431619.012<font></font>
</pre><a class="indexterm" name="idm140091683857680"></a><p>
          If you use <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a> and
          <a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a> to convert
          between values in a non-UTC time zone and Unix timestamp
          values, the conversion is lossy because the mapping is not
          one-to-one in both directions. For example, due to conventions
          for local time zone changes such as Daylight Saving Time
          (DST), it is possible for
          <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a> to map two
          values that are distinct in a non-UTC time zone to the same
          Unix timestamp value.
          <a class="link" href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a> will map that
          value back to only one of the original values. Here is an
          example, using values that are distinct in the
          <code class="literal">MET</code> time zone:
        </p><pre data-lang="sql" class="programlisting">mysql&gt; <strong class="userinput"><code>SET time_zone = 'MET';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2005-03-27 03:00:00');</code></strong><font></font>
+---------------------------------------+<font></font>
| UNIX_TIMESTAMP('2005-03-27 03:00:00') |<font></font>
+---------------------------------------+<font></font>
|                            1111885200 |<font></font>
+---------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT UNIX_TIMESTAMP('2005-03-27 02:00:00');</code></strong><font></font>
+---------------------------------------+<font></font>
| UNIX_TIMESTAMP('2005-03-27 02:00:00') |<font></font>
+---------------------------------------+<font></font>
|                            1111885200 |<font></font>
+---------------------------------------+<font></font>
mysql&gt; <strong class="userinput"><code>SELECT FROM_UNIXTIME(1111885200);</code></strong><font></font>
+---------------------------+<font></font>
| FROM_UNIXTIME(1111885200) |<font></font>
+---------------------------+<font></font>
| 2005-03-27 03:00:00       |<font></font>
+---------------------------+<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            To use named time zones such as <code class="literal">'MET'</code> or
            <code class="literal">'Europe/Amsterdam'</code>, the time zone tables
            must be properly set up. For instructions, see
            <a class="xref" href="server-administration.html#time-zone-support" title="5.1.13 MySQL服务器时区支持">Section&nbsp;5.1.13, “MySQL Server Time Zone Support”</a>.
</p>
</div>
<p>
          If you want to subtract
          <a class="link" href="functions.html#function_unix-timestamp"><code class="literal">UNIX_TIMESTAMP()</code></a> columns, you
          might want to cast them to signed integers. See
          <a class="xref" href="functions.html#cast-functions" title="12.10演员函数和运算符">Section&nbsp;12.10, “Cast Functions and Operators”</a>.
        </p></li><li class="listitem"><a name="function_utc-date"></a><p>
          <a class="indexterm" name="idm140091683837280"></a>

          <a class="link" href="functions.html#function_utc-date"><code class="literal">UTC_DATE</code></a>,
          <a class="link" href="functions.html#function_utc-date"><code class="literal">UTC_DATE()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以值</font></font><em class="replaceable"><code>'YYYY-MM-DD'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><em class="replaceable"><code>YYYYMMDD</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">格式</font><font style="vertical-align: inherit;">返回当前UTC日期
           </font><font style="vertical-align: inherit;">，具体取决于函数是在字符串还是数字上下文中使用。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT UTC_DATE(), UTC_DATE() + 0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'2003-08-14'，20030814</font></font><font></font>
</pre></li><li class="listitem"><a name="function_utc-time"></a><p>
          <a class="indexterm" name="idm140091683825952"></a>

          <a class="link" href="functions.html#function_utc-time"><code class="literal">UTC_TIME</code></a>,
          <a class="link" href="functions.html#function_utc-time"><code class="literal">UTC_TIME([<em class="replaceable"><code>fsp</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以值</font></font><em class="replaceable"><code>'hh:mm:ss'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><em class="replaceable"><code>hhmmss</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">格式</font><font style="vertical-align: inherit;">返回当前UTC时间
           </font><font style="vertical-align: inherit;">，具体取决于函数是在字符串还是数字上下文中使用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>fsp</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出参数以指定从0到6的小数秒精度，则返回值包括该多个数字的小数秒部分。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT UTC_TIME(), UTC_TIME() + 0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; '18：07：53'，180753.000000</font></font><font></font>
</pre></li><li class="listitem"><a name="function_utc-timestamp"></a><p>
          <a class="indexterm" name="idm140091683813248"></a>

          <a class="link" href="functions.html#function_utc-timestamp"><code class="literal">UTC_TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_utc-timestamp"><code class="literal">UTC_TIMESTAMP([<em class="replaceable"><code>fsp</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以值</font></font><em class="replaceable"><code>'YYYY-MM-DD hh:mm:ss'</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><em class="replaceable"><code>YYYYMMDDhhmmss</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">格式</font><font style="vertical-align: inherit;">返回当前UTC日期和时间
           </font><font style="vertical-align: inherit;">，具体取决于函数是在字符串还是数字上下文中使用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>fsp</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出参数以指定从0到6的小数秒精度，则返回值包括该多个数字的小数秒部分。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT UTC_TIMESTAMP(), UTC_TIMESTAMP() + 0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'2003-08-14 18:08:04'，20030814180804.000000</font></font><font></font>
</pre></li><li class="listitem"><a name="function_week"></a><p>
          <a class="indexterm" name="idm140091683800464"></a>

          <a class="link" href="functions.html#function_week"><code class="literal">WEEK(<em class="replaceable"><code>date</code></em>[,<em class="replaceable"><code>mode</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数返回的周数
           </font></font><em class="replaceable"><code>date</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">的双参数形式
           </font></font><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许你指定星期是否在周日或周一，以及是否返回值应在范围从启动</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          到</font></font><code class="literal">53</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者从</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到
           </font></font><code class="literal">53</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>mode</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          省略</font><font style="vertical-align: inherit;">该</font><font style="vertical-align: inherit;">参数，</font></font><a class="link" href="server-administration.html#sysvar_default_week_format"><code class="literal">default_week_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则使用系统变量</font><font style="vertical-align: inherit;">的值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="server-administration.html#server-system-variables" title="5.1.8服务器系统变量"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.8节“服务器系统变量”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下表描述了
           </font></font><em class="replaceable"><code>mode</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数的工作原理。
</font></font></p>
<div class="informaltable">
<table summary="Now the mode argument of the WEEK function works. For each mode value, the table lists the first day of the week, the range, and a description of week 1."><colgroup><col width="10%"><col width="20%"><col width="20%"><col width="50%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一周的第一天</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1周是第一周......</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期日</font></font></td>
              <td>0-53</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在今年的一个星期天</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期一</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0-53</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今年有4天或更多天</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期日</font></font></td>
              <td>1-53</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在今年的一个星期天</font></font></td>
            </tr><tr>
              <td scope="row">3</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期一</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1-53</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今年有4天或更多天</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期日</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0-53</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今年有4天或更多天</font></font></td>
            </tr><tr>
              <td scope="row">5</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期一</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0-53</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在今年的星期一</font></font></td>
            </tr><tr>
              <td scope="row">6</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期日</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1-53</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今年有4天或更多天</font></font></td>
            </tr><tr>
              <td scope="row">7</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期一</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1-53</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在今年的星期一</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><em class="replaceable"><code>mode</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有的意义价值
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有4个或更多天，今年</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">， ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1988年：周根据ISO 8601编号：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果包含1月1日的一周在新的一年中有4天或更多天，则为第1周。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              否则，它是上一年的最后一周，下一周是第1周。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT WEEK('2008-02-20');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 7</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT WEEK('2008-02-20',0);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 7</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT WEEK('2008-02-20',1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 8</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT WEEK('2008-12-31',1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 53</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果日期落入在上周的前一年，MySQL的返回</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果你不使用
           </font></font><code class="literal">2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或</font></font><code class="literal">7</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为可选的
           </font></font><em class="replaceable"><code>mode</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT YEAR('2000-01-01'), WEEK('2000-01-01',0);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 2000,0</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可能有人会说</font></font><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          应该返回</font></font><code class="literal">52</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因为给定的日期实际上是在1999年的第52周时
           </font></font><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的回报
           </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不是使返回值是
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给定年份的周数。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font></span><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当与从日期中提取日期部分的其他功能结合</font><font style="vertical-align: inherit;">使用时，这使得该</font><font style="vertical-align: inherit;">功能可靠。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果你喜欢就包含了一周的指定日期的第一天计算一年的结果，使用
           </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或</font></font><code class="literal">7</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为可选
           </font></font><em class="replaceable"><code>mode</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT WEEK('2000-01-01',2);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 52</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者，使用以下
           </font></font><a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT YEARWEEK('2000-01-01');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 199952</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT MID(YEARWEEK('2000-01-01'),5,2);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; '52'</font></font><font></font>
</pre></li><li class="listitem"><a name="function_weekday"></a><p>
          <a class="indexterm" name="idm140091683711920"></a>

          <a class="link" href="functions.html#function_weekday"><code class="literal">WEEKDAY(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font></font><em class="replaceable"><code>date</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          （</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= Monday，</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= Tuesday，... </font></font><code class="literal">6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= Sunday）</font><font style="vertical-align: inherit;">的工作日索引</font><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT WEEKDAY('2008-02-03 22:23:00');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 6</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT WEEKDAY('2007-11-06');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1</font></font><font></font>
</pre></li><li class="listitem"><a name="function_weekofyear"></a><p>
          <a class="indexterm" name="idm140091683699200"></a>

          <a class="link" href="functions.html#function_weekofyear"><code class="literal">WEEKOFYEAR(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回日期从范围内的数字日历星期</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来</font></font><code class="literal">53</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><a class="link" href="functions.html#function_weekofyear"><code class="literal">WEEKOFYEAR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个相当于的兼容性函数
           </font><font style="vertical-align: inherit;">。
        </font></font><a class="link" href="functions.html#function_week"><code class="literal">WEEK(<em class="replaceable"><code>date</code></em>,3)</code></a><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT WEEKOFYEAR('2008-02-20');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 8</font></font><font></font>
</pre></li><li class="listitem"><a name="function_year"></a><p>
          <a class="indexterm" name="idm140091683685424"></a>

          <a class="link" href="functions.html#function_year"><code class="literal">YEAR(<em class="replaceable"><code>date</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回年</font></font><em class="replaceable"><code>date</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，范围</font></font><code class="literal">1000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">至</font></font><code class="literal">9999</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">零</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日期。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT YEAR('1987-01-01');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1987年</font></font><font></font>
</pre></li><li class="listitem"><a name="function_yearweek"></a><p>
          <a class="indexterm" name="idm140091683672960"></a>

          <a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK(<em class="replaceable"><code>date</code></em>)</code></a>,
          <a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK(<em class="replaceable"><code>date</code></em>,<em class="replaceable"><code>mode</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回日期的年份和星期。</font><font style="vertical-align: inherit;">结果中的年份可能与一年中第一周和最后一周的日期参数中的年份不同。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><em class="replaceable"><code>mode</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">论证的作用与</font></font><em class="replaceable"><code>mode</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数
           </font><font style="vertical-align: inherit;">完全相同</font></font><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于单参数语法，使用</font></font><em class="replaceable"><code>mode</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值0。</font><font style="vertical-align: inherit;">不同</font></font><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，价值
           </font></font><a class="link" href="server-administration.html#sysvar_default_week_format"><code class="literal">default_week_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会影响</font></font><a class="link" href="functions.html#function_yearweek"><code class="literal">YEARWEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT YEARWEEK('1987-01-01');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 198652</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          周数是从什么不同的
           </font></font><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数将返回（</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）的可选参数
           </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为
           </font></font><a class="link" href="functions.html#function_week"><code class="literal">WEEK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后返回周中的给定年份的情况下。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="mysql-calendar"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.8 MySQL使用什么日历？</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091683650256"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL使用所谓的</font></font><span class="firstterm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公历格里高利历</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      每个从朱利安日历到格里高利历的国家都不得不在转换期间丢弃至少十天。</font><font style="vertical-align: inherit;">要了解其工作原理，请考虑1582年10月，即第一个Julian-to-Gregorian切换发生的月份。
</font></font></p>
<div class="informaltable">
<table summary="The month of October 1582, when the first Julian-to-Gregorian switch occurred. Table headings are days of the week and table rows list the dates for each day of the week. The table is intended to illustrate that there are no dates between October 4 and October 15."><colgroup><col width="14%"><col width="14%"><col width="14%"><col width="14%"><col width="14%"><col width="14%"><col width="14%"></colgroup><thead><tr>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期一</font></font></th>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期二</font></font></th>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期三</font></font></th>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期四</font></font></th>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期五</font></font></th>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期六</font></font></th>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">星期日</font></font></th>
        </tr></thead><tbody><tr>
          <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
          <td>3</td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
          <td>15</td>
          <td>16</td>
          <td>17</td>
        </tr><tr>
          <td scope="row">18</td>
          <td>19</td>
          <td>20</td>
          <td>21</td>
          <td>22</td>
          <td>23</td>
          <td>24</td>
        </tr><tr>
          <td scope="row">25</td>
          <td>26</td>
          <td>27</td>
          <td>28</td>
          <td>29</td>
          <td>30</td>
          <td>31</td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      10月4日至10月15日之间没有日期。这种不连续性称为
       </font></font><span class="firstterm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">转换</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">切换前的任何日期都是朱利安，切换后的任何日期都是格里高利。</font><font style="vertical-align: inherit;">切换期间的日期不存在。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      应用于未实际使用的日期的日历称为</font></font><span class="firstterm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预感</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因此，如果我们假设从来没有切换和格里高利规则总是统治，我们有一个预感格里高利历。</font><font style="vertical-align: inherit;">这是MySQL使用的，正如标准SQL所要求的那样。</font><font style="vertical-align: inherit;">出于这个原因，切换之前的日期存储为MySQL
       </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
      </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须调整值以补偿差异。</font><font style="vertical-align: inherit;">重要的是要意识到切换并非在所有国家同时发生，而且发生的时间越晚，丢失的天数就越多。</font><font style="vertical-align: inherit;">例如，在英国，它发生在1752年，当时9月2日星期三之后是9月14日星期四。俄罗斯一直保持朱利安历法直到1918年，在此过程中损失了13天，并且通常被称为</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">十月”</font></font></span><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据格里高利历法，</font><span class="quote"><span class="quote"><font style="vertical-align: inherit;">革命</font></span></span><span class="quote"><font style="vertical-align: inherit;"> “</font></span><font style="vertical-align: inherit;">发生在11月。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="fulltext-search"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9全文搜索功能</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#fulltext-natural-language"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.1自然语言全文检索</font></font></a></span></dt><dt><span class="section"><a href="functions.html#fulltext-boolean"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.2布尔全文搜索</font></font></a></span></dt><dt><span class="section"><a href="functions.html#fulltext-query-expansion"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.3使用查询扩展的全文搜索</font></font></a></span></dt><dt><span class="section"><a href="functions.html#fulltext-stopwords"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.4全文停用词</font></font></a></span></dt><dt><span class="section"><a href="functions.html#fulltext-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.5全文限制</font></font></a></span></dt><dt><span class="section"><a href="functions.html#fulltext-fine-tuning"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.6微调MySQL全文搜索</font></font></a></span></dt><dt><span class="section"><a href="functions.html#full-text-adding-collation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.7为全文索引添加排序规则</font></font></a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search-ngram"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.8 ngram全文分析器</font></font></a></span></dt><dt><span class="section"><a href="functions.html#fulltext-search-mecab"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.9 MeCab全文分析器插件</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091683603024"></a><a class="indexterm" name="idm140091683601536"></a><a class="indexterm" name="idm140091683600464"></a><a class="indexterm" name="idm140091683599392"></a><p><a name="function_match"></a>
      <a class="link" href="functions.html#function_match"><code class="literal">MATCH
      (<em class="replaceable"><code>col1</code></em>,<em class="replaceable"><code>col2</code></em>,...)
      AGAINST (<em class="replaceable"><code>expr</code></em>
      [<em class="replaceable"><code>search_modifier</code></em>])</code></a>
    </p><pre data-lang="sql" class="programlisting"><em class="replaceable"><code>search_modifier:</code></em><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
       在自然语言模式</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     | </font><font style="vertical-align: inherit;">具有查询扩展的自然语言模式</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     | </font><font style="vertical-align: inherit;">在布尔模式</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     | </font><font style="vertical-align: inherit;">随着扩展</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL支持全文索引和搜索：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL中的全文索引是类型的索引
           </font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          全文索引只能使用
           </font></font><a class="link" href="innodb-storage-engine.html" title="第15章InnoDB存储引擎"><code class="literal">InnoDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 MyISAM存储引擎"><code class="literal">MyISAM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格，并且只能用于创建</font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">MySQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供了一个内置的全文ngram解析器，支持中文，日文和韩文（CJK），以及一个可安装的日文版MeCab全文解析器插件。</font><font style="vertical-align: inherit;">解析差异在</font></font><a class="xref" href="functions.html#fulltext-search-ngram" title="12.9.8 ngram全文分析器"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.8节“ngram全文分析器”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="functions.html#fulltext-search-mecab" title="12.9.9 MeCab全文分析器插件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.9节“MeCab全文分析器插件”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中概述
           </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          甲</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引定义可以在被给予</font></font><a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE语法"><code class="literal">CREATE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的语句中创建表时，或者稍后使用添加
           </font></font><a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX语法"><code class="literal">CREATE INDEX</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于大型数据集，将数据加载到没有</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引</font><font style="vertical-align: inherit;">的表中，</font><font style="vertical-align: inherit;">然后在此之后创建索引</font><font style="vertical-align: inherit;">要快得多</font><font style="vertical-align: inherit;">，而不是将数据加载到具有现有</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引</font><font style="vertical-align: inherit;">的表中</font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH() ... AGAINST</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语法</font><font style="vertical-align: inherit;">执行全文搜索
       </font><font style="vertical-align: inherit;">。
      </font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">采用逗号分隔的列表来命名要搜索的列。
      </font></font><code class="literal">AGAINST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取要搜索的字符串，以及指示要执行的搜索类型的可选修饰符。</font><font style="vertical-align: inherit;">搜索字符串必须是在查询评估期间保持不变的字符串值。</font><font style="vertical-align: inherit;">例如，这排除了表列，因为每行可能不同。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有三种类型的全文搜索：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          自然语言搜索将搜索字符串解释为自然人类语言（自由文本中的短语）中的短语。</font><font style="vertical-align: inherit;">没有特殊运算符，但双引号（“）字符除外。</font></font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4全文停用词"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">词列表适用。有关</font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4&nbsp;Full-Text Stopwords"><font style="vertical-align: inherit;">禁用</font></a><font style="vertical-align: inherit;">词列表的更多信息，请参见</font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4&nbsp;Full-Text Stopwords"><font style="vertical-align: inherit;">第12.9.4节”全文</font></a><font style="vertical-align: inherit;">停用词
           </font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4&nbsp;Full-Text Stopwords"><font style="vertical-align: inherit;">“</font></a><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><code class="literal">IN NATURAL LANGUAGE MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出修饰符或者没有给出修饰符，则</font><font style="vertical-align: inherit;">全文搜索是自然语言搜索
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关更多信息，请参见
           </font></font><a class="xref" href="functions.html#fulltext-natural-language" title="12.9.1自然语言全文检索"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.1节“自然语言全文搜索”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          布尔搜索使用特殊查询语言的规则来解释搜索字符串。</font><font style="vertical-align: inherit;">该字符串包含要搜索的单词。</font><font style="vertical-align: inherit;">它还可以包含指定要求的运算符，以便在匹配的行中必须存在或不存在单词，或者它应该比通常更高或更低的权重。</font><font style="vertical-align: inherit;">搜索索引中省略了某些常用词（停用词），如果搜索字符串中存在，则不匹配。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">IN BOOLEAN MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修饰符指定一个布尔搜索。</font><font style="vertical-align: inherit;">有关更多信息，请参见
           </font></font><a class="xref" href="functions.html#fulltext-boolean" title="12.9.2布尔全文搜索"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.2节“布尔全文搜索”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          查询扩展搜索是自然语言搜索的修改。</font><font style="vertical-align: inherit;">搜索字符串用于执行自然语言搜索。</font><font style="vertical-align: inherit;">然后将搜索返回的最相关行中的单词添加到搜索字符串中，然后再次进行搜索。</font><font style="vertical-align: inherit;">查询返回第二次搜索中的行。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">IN NATURAL LANGUAGE MODE WITH
          QUERY EXPANSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">WITH QUERY
          EXPANSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修改指定查询扩展搜索。</font><font style="vertical-align: inherit;">有关更多信息，请参见
           </font></font><a class="xref" href="functions.html#fulltext-query-expansion" title="12.9.3使用查询扩展的全文搜索"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.3节“使用查询扩展的全文搜索”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询性能的</font><font style="vertical-align: inherit;">信息</font><font style="vertical-align: inherit;">，请参见</font></font><a class="xref" href="optimization.html#column-indexes" title="8.3.5列索引"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.3.5节“列索引”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关</font></font><code class="literal">InnoDB</code>
      <code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引的</font><font style="vertical-align: inherit;">更多信息</font><font style="vertical-align: inherit;">，请参见
       </font></font><a class="xref" href="innodb-storage-engine.html#innodb-fulltext-index" title="15.6.2.4 InnoDB FULLTEXT索引"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第15.6.2.4节“InnoDB FULLTEXT索引”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"></font><a class="xref" href="functions.html#fulltext-restrictions" title="12.9.5全文限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.5节“全文限制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
      中列出了对全文搜索的
       </font><a class="xref" href="functions.html#fulltext-restrictions" title="12.9.5&nbsp;Full-Text Restrictions"><font style="vertical-align: inherit;">约束</font></a><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该</font></font><a class="link" href="programs.html#myisam-ftdump" title="4.6.3 myisam_ftdump  - 显示全文索引信息"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisam_ftdump</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工具转储的内容</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文索引。</font><font style="vertical-align: inherit;">这可能有助于调试全文查询。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="programs.html#myisam-ftdump" title="4.6.3 myisam_ftdump  - 显示全文索引信息"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.6.3节“ </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisam_ftdump</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 显示全文索引信息”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="fulltext-natural-language"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.1自然语言全文检索</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        默认情况下或使用</font></font><code class="literal">IN NATURAL LANGUAGE
        MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修饰符，
         </font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数会针对</font></font><span class="firstterm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本集合</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行字符串的自然语言搜索
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">集合是</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引中</font><font style="vertical-align: inherit;">包含的一个或多个列的集合
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">搜索字符串作为参数给出</font></font><code class="literal">AGAINST()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于表中的每一行，</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回相关值; </font><font style="vertical-align: inherit;">也就是说，搜索字符串与</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表中</font><font style="vertical-align: inherit;">指定的列中该行中的文本之间的相似性度量</font><font style="vertical-align: inherit;">。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE articles (</code></strong>
          <strong class="userinput"><code>id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,</code></strong>
          <strong class="userinput"><code>title VARCHAR(200),</code></strong>
          <strong class="userinput"><code>body TEXT,</code></strong>
          <strong class="userinput"><code>FULLTEXT (title,body)</code></strong>
        <strong class="userinput"><code>) ENGINE=InnoDB;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.08秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO articles (title,body) VALUES</code></strong>
        <strong class="userinput"><code>('MySQL Tutorial','DBMS stands for DataBase ...'),</code></strong>
        <strong class="userinput"><code>('How To Use MySQL Well','After you went through a ...'),</code></strong>
        <strong class="userinput"><code>('Optimizing MySQL','In this tutorial we will show ...'),</code></strong>
        <strong class="userinput"><code>('1001 MySQL Tricks','1. Never run mysqld as root. 2. ...'),</code></strong>
        <strong class="userinput"><code>('MySQL vs. YourSQL','In the following database comparison ...'),</code></strong>
        <strong class="userinput"><code>('MySQL Security','When configured properly, MySQL ...');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，6行受影响（0.01秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：6个重复：0个警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM articles</code></strong>
        <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
        <strong class="userinput"><code>AGAINST ('database' IN NATURAL LANGUAGE MODE);</code></strong><font></font>
+----+-------------------+------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">标题| </font><font style="vertical-align: inherit;">身体|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+-------------------+------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">MySQL教程| </font><font style="vertical-align: inherit;">DBMS代表DataBase ... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">MySQL与YourSQL | </font><font style="vertical-align: inherit;">在以下数据库比较中...... |</font></font><font></font>
+----+-------------------+------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        默认情况下，搜索以不区分大小写的方式执行。</font><font style="vertical-align: inherit;">要执行区分大小写的全文搜索，请对索引列使用区分大小写或二进制排序规则。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">utf8mb4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        可以为</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">字符集的</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">分配整数
         </font></font><code class="literal">utf8mb4_0900_as_cs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><code class="literal">utf8mb4_bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使其对全文搜索区分大小写。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">使用时
         </font><font style="vertical-align: inherit;">，如前面所示的示例中所示，返回的行将首先自动排序，具有最高相关性。</font><font style="vertical-align: inherit;">相关性值是非负浮点数。</font><font style="vertical-align: inherit;">零相关意味着没有相似性。</font><font style="vertical-align: inherit;">相关性是根据行（文档）中的单词数，行中唯一单词的数量，集合中的单词总数以及包含特定单词的行数计算的。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          术语</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以与术语</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">互换使用</font><font style="vertical-align: inherit;">，并且两个术语都指行的索引部分。</font><font style="vertical-align: inherit;">术语</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">集合</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          指的是索引列并包含所有行。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要简单地计算匹配，您可以使用如下查询：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COUNT(*) FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' IN NATURAL LANGUAGE MODE);</code></strong><font></font>
+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">COUNT（*）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+</font></font><font></font>
|        2 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您可能会发现重写查询的速度更快，如下所示：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
    <strong class="userinput"><code>COUNT(IF(MATCH (title,body) AGAINST ('database' IN NATURAL LANGUAGE MODE), 1, NULL))</code></strong>
    <strong class="userinput"><code>AS count</code></strong>
    <strong class="userinput"><code>FROM articles;</code></strong><font></font>
+-------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">计数|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+</font></font><font></font>
|     2 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.03秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        第一个查询执行一些额外的工作（按相关性对结果进行排序），但也可以使用基于该</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">的索引查找
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果搜索匹配几行，索引查找可能会使第一个查询更快。</font><font style="vertical-align: inherit;">第二个查询执行全表扫描，如果搜索词存在于大多数行中，则可能比索引查找更快。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于自然语言全文搜索，</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数中</font><font style="vertical-align: inherit;">指定的列</font><font style="vertical-align: inherit;">必须与表中某些</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引中</font><font style="vertical-align: inherit;">包含的列相同</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于前面的查询，请注意</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数（</font></font><code class="literal">title</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）中指定的列与</font></font><code class="literal">article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        索引</font><font style="vertical-align: inherit;">定义中指定</font><font style="vertical-align: inherit;">的列</font><font style="vertical-align: inherit;">相同
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要</font><font style="vertical-align: inherit;">单独</font><font style="vertical-align: inherit;">搜索</font></font><code class="literal">title</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><code class="literal">body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单独</font><font style="vertical-align: inherit;">搜索</font><font style="vertical-align: inherit;">，可以</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为每列</font><font style="vertical-align: inherit;">创建单独的
         </font><font style="vertical-align: inherit;">索引。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您还可以执行布尔搜索或使用查询扩展进行搜索。</font></font><a class="xref" href="functions.html#fulltext-boolean" title="12.9.2布尔全文搜索"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.2节“布尔全文搜索”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="xref" href="functions.html#fulltext-query-expansion" title="12.9.3使用查询扩展的全文搜索"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.3节“使用查询扩展</font></font></a><font style="vertical-align: inherit;"><a class="xref" href="functions.html#fulltext-boolean" title="12.9.2&nbsp;Boolean Full-Text Searches"><font style="vertical-align: inherit;">的全文搜索”</font></a><font style="vertical-align: inherit;">中介绍了这些搜索类型
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用索引的全文搜索只能从</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        子句中</font><font style="vertical-align: inherit;">的单个表中命名列，</font><font style="vertical-align: inherit;">因为索引不能跨越多个表。</font><font style="vertical-align: inherit;">对于
         </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，可以在没有索引的情况下进行布尔搜索（尽管速度较慢），在这种情况下，可以从多个表中命名列。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        上面的示例是一个基本插图，显示了如何使用按</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相关性降低的顺序返回行</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">函数。</font><font style="vertical-align: inherit;">下一个示例显示了如何显式检索相关性值。</font><font style="vertical-align: inherit;">返回的行不是有序的，因为该
         </font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句既不包含</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也不</font><font style="vertical-align: inherit;">包含
         </font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        子句：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT id, MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('Tutorial' IN NATURAL LANGUAGE MODE) AS score</code></strong>
    <strong class="userinput"><code>FROM articles;</code></strong><font></font>
+----+---------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">得分|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+---------------------+</font></font><font></font>
|  1 | 0.22764469683170319 |<font></font>
|  2 |                   0 |<font></font>
|  3 | 0.22764469683170319 |<font></font>
|  4 |                   0 |<font></font>
|  5 |                   0 |<font></font>
|  6 |                   0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+---------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下示例更复杂。</font><font style="vertical-align: inherit;">查询返回相关性值，它还按相关性递减的顺序对行进行排序。</font><font style="vertical-align: inherit;">要实现此结果，请指定
         </font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">两次：一次在
         </font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表中，一次在
         </font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中。</font><font style="vertical-align: inherit;">这不会产生额外的开销，因为MySQL优化器注意到这两个
         </font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用是相同的，只调用一次全文搜索代码。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT id, body, MATCH (title,body) AGAINST</code></strong>
    <strong class="userinput"><code>('Security implications of running MySQL as root'</code></strong>
    <strong class="userinput"><code>IN NATURAL LANGUAGE MODE) AS score</code></strong>
    <strong class="userinput"><code>FROM articles WHERE MATCH (title,body) AGAINST</code></strong>
    <strong class="userinput"><code>('Security implications of running MySQL as root'</code></strong>
    <strong class="userinput"><code>IN NATURAL LANGUAGE MODE);</code></strong><font></font>
+----+-------------------------------------+-----------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">身体| </font><font style="vertical-align: inherit;">得分|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+-------------------------------------+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">1.永远不要以root身份运行mysqld。</font><font style="vertical-align: inherit;">2. ... | </font><font style="vertical-align: inherit;">1.5219271183014 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6 | </font><font style="vertical-align: inherit;">正确配置后，MySQL ... | </font><font style="vertical-align: inherit;">1.3114095926285 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+-------------------------------------+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        双引号（</font></font><code class="literal">"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）字符中包含的短语仅匹配</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字面上</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含短语的行</font><span class="emphasis"><em><font style="vertical-align: inherit;">，因为它是键入的</font></em></span><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">全文引擎将短语拆分为单词，并</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在单词</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">索引中</font><font style="vertical-align: inherit;">执行搜索</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">非单词字符不需要完全匹配：短语搜索只需要匹配包含与短语完全相同的单词并且顺序相同。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">"test
        phrase"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配</font></font><code class="literal">"test, phrase"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果短语不包含索引中的单词，则结果为空。</font><font style="vertical-align: inherit;">例如，如果所有单词都是停用词或短于索引单词的最小长度，则结果为空。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL </font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现将任何真实单词字符序列（字母，数字和下划线）视为单词。</font><font style="vertical-align: inherit;">该序列也可能包含撇号（</font></font><code class="literal">'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），但不能超过一行。</font><font style="vertical-align: inherit;">这意味着它</font></font><code class="literal">aaa'bbb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被视为一个词，但</font></font><code class="literal">aaa''bbb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被视为两个词。</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析器</font><font style="vertical-align: inherit;">剥离一个单词开头或结尾的撇号</font><font style="vertical-align: inherit;">;
        </font></font><code class="literal">'aaa'bbb'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将被解析为
         </font></font><code class="literal">aaa'bbb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        内置</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析器通过查找某些分隔符来确定单词的开始和结束位置; </font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（空格），
         </font></font><code class="literal">,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（逗号）和</font></font><code class="literal">.</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（句点）。</font><font style="vertical-align: inherit;">如果单词没有用分隔符分隔（例如，中文），则内置</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析器无法确定单词的开始或结束位置。</font><font style="vertical-align: inherit;">为了能够将这些语言中的单词或其他索引术语添加到</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用内置</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析器</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">索引
         </font><font style="vertical-align: inherit;">，您必须对它们进行预处理，以便它们由某个任意分隔符分隔。</font><font style="vertical-align: inherit;">或者，您可以创建</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用ngram解析器插件（中文，日文或韩文）或MeCab解析器插件（日文）的索引。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        可以编写一个替换内置全文解析器的插件。</font><font style="vertical-align: inherit;">有关详细信息，请参见</font></font><a class="xref" href="extending-mysql.html#plugin-api" title="29.2 MySQL插件API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第29.2节“MySQL插件API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如解析器插件源代码，请参阅</font></font><code class="filename">plugin/fulltext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL源代码分发</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">目录。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在全文搜索中会忽略某些单词：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            任何太短的单词都会被忽略。</font><font style="vertical-align: inherit;">通过全文搜索找到的默认最小单词长度是</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引的</font><font style="vertical-align: inherit;">三个字符</font><font style="vertical-align: inherit;">，或者四个字符</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">：您可以通过创建索引之前设置一个配置选项来控制截止
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            的配置选项</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引，或</font></font><a class="link" href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            为</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此行为不适用于
               </font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用ngram解析器的索引。</font><font style="vertical-align: inherit;">对于ngram解析器，令牌长度由</font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              选项</font><font style="vertical-align: inherit;">定义</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            禁用词列表中的单词将被忽略。</font><font style="vertical-align: inherit;">禁用词是诸如</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">some</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”之</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类的词</font><font style="vertical-align: inherit;">，它是如此常见以至于它被认为具有零语义值。</font><font style="vertical-align: inherit;">有一个内置的禁用词列表，但它可以被用户定义的列表覆盖。</font><font style="vertical-align: inherit;">对于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引和
             </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一些</font><font style="vertical-align: inherit;">，停用词列表和相关配置选项是不同
             </font><font style="vertical-align: inherit;">的。</font><font style="vertical-align: inherit;">停用词处理由配置选项来控制
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_enable_stopword"><code class="literal">innodb_ft_enable_stopword</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_server_stopword_table"><code class="literal">innodb_ft_server_stopword_table</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_user_stopword_table"><code class="literal">innodb_ft_user_stopword_table</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            用于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索的索引，并且
             </font></font><a class="link" href="server-administration.html#sysvar_ft_stopword_file"><code class="literal">ft_stopword_file</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于
             </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">那些。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        请参见</font></font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4全文停用词"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.4节“全文</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">停用词</font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4&nbsp;Full-Text Stopwords"><font style="vertical-align: inherit;">”</font></a><font style="vertical-align: inherit;">以查看默认的停用词列表以及如何更改它们。</font><font style="vertical-align: inherit;">可以按</font></font><a class="xref" href="functions.html#fulltext-fine-tuning" title="12.9.6微调MySQL全文搜索"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.6节“微调MySQL全文搜索”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述更改默认的最小字长
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        集合和查询中的每个正确单词都根据其在集合或查询中的重要性进行加权。</font><font style="vertical-align: inherit;">因此，许多文档中存在的单词具有较低的权重，因为它在该特定集合中具有较低的语义值。</font><font style="vertical-align: inherit;">相反，如果这个词很少见，它会获得更高的权重。</font><font style="vertical-align: inherit;">组合单词的权重以计算行的相关性。</font><font style="vertical-align: inherit;">这种技术最适合大型集合。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MyISAM限制
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于非常小的表，单词分布不能充分反映其语义值，并且此模型有时可能会对</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">上的搜索索引产生奇怪的结果
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，尽管</font><font style="vertical-align: inherit;">前面显示</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">表格的</font><font style="vertical-align: inherit;">每一行都有
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"></font><code class="literal">articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一词，但</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引中</font><font style="vertical-align: inherit;">的单词</font><font style="vertical-align: inherit;">搜索不会产生任何结果：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('MySQL' IN NATURAL LANGUAGE MODE);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空集（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          搜索结果为空，因为
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一词出现在至少50％的行中，因此被有效地视为一个停用词。</font><font style="vertical-align: inherit;">这种过滤技术更适用于大型数据集，您可能不希望结果集从1GB表中返回每隔一行，而不是小型数据集，因为它可能会导致流行术语的结果不佳。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当您第一次尝试全文搜索以查看其工作方式时，50％的阈值会让您感到惊讶，并使
           </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格更适合全文搜索的实验。</font><font style="vertical-align: inherit;">如果您创建一个
           </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表并仅在其中插入一行或两行文本，则文本中的每个单词都会出现在至少50％的行中。</font><font style="vertical-align: inherit;">因此，在表包含更多行之前，搜索不会返回任何结果。</font><font style="vertical-align: inherit;">需要绕过50％限制的用户可以在</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">上构建搜索索引
           </font><font style="vertical-align: inherit;">，或使用</font></font><a class="xref" href="functions.html#fulltext-boolean" title="12.9.2布尔全文搜索"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.2节“布尔全文搜索”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍的布尔搜索模式</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="fulltext-boolean"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.2布尔全文搜索</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091683418144"></a><a class="indexterm" name="idm140091683417104"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL可以使用</font></font><code class="literal">IN BOOLEAN MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修饰符</font><font style="vertical-align: inherit;">执行布尔全文搜索
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用此修饰符，某些字符在搜索字符串中的单词的开头或结尾处具有特殊含义。</font><font style="vertical-align: inherit;">在以下查询中，
         </font></font><code class="literal">+</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算符分别表示必须存在或不存在单词才能进行匹配。</font><font style="vertical-align: inherit;">因此，查询检索包含单词</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但
         </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含单词
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">YourSQL</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”的所有行</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM articles WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('+MySQL -YourSQL' IN BOOLEAN MODE);</code></strong><font></font>
+----+-----------------------+-------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">标题| </font><font style="vertical-align: inherit;">身体|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+-----------------------+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">MySQL教程| </font><font style="vertical-align: inherit;">DBMS代表DataBase ... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">如何使用MySQL井 </font><font style="vertical-align: inherit;">经过一段时间...... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">优化MySQL | </font><font style="vertical-align: inherit;">在本教程中，我们将展示... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">1001 MySQL技巧| </font><font style="vertical-align: inherit;">1.永远不要以root身份运行mysqld。</font><font style="vertical-align: inherit;">2. ... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6 | </font><font style="vertical-align: inherit;">MySQL安全| </font><font style="vertical-align: inherit;">正确配置后，MySQL ... |</font></font><font></font>
+----+-----------------------+-------------------------------------+<font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在实现此功能时，MySQL使用有时被称为</font></font><span class="firstterm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">隐含布尔逻辑</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的内容
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">+</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 代表 </font></font><code class="literal">AND</code>
            </p></li><li class="listitem"><p>
              <code class="literal">-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 代表 </font></font><code class="literal">NOT</code>
            </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              [ </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无操作员</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]暗示
              </font></font><code class="literal">OR</code>
</p></li></ul>
</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        布尔全文搜索具有以下特征：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            它们不会按相关性降低的顺序自动对行进行排序。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表需要
             </font><font style="vertical-align: inherit;">表达式的</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有列上的索引
             </font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来执行布尔查询。</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">即使没有</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引，</font><font style="vertical-align: inherit;">对</font><font style="vertical-align: inherit;">搜索索引的</font><font style="vertical-align: inherit;">布尔查询
             </font><font style="vertical-align: inherit;">也可以工作</font><font style="vertical-align: inherit;">，尽管以这种方式执行的搜索会非常慢。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            最小和最大字长全文参数适用于</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用内置</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析器和MeCab解析器插件</font><font style="vertical-align: inherit;">创建的索引</font><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            并
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_max_token_size"><code class="literal">innodb_ft_max_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            用于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引。
            </font></font><a class="link" href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
             </font></font><a class="link" href="server-administration.html#sysvar_ft_max_word_len"><code class="literal">ft_max_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            最小和最大字长全文参数不适用于</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用ngram解析器创建的索引。</font><font style="vertical-align: inherit;">ngram标记大小由</font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">定义
             </font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            停止字适用，通过控制
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_enable_stopword"><code class="literal">innodb_ft_enable_stopword</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_server_stopword_table"><code class="literal">innodb_ft_server_stopword_table</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_user_stopword_table"><code class="literal">innodb_ft_user_stopword_table</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引，并
             </font></font><a class="link" href="server-administration.html#sysvar_ft_stopword_file"><code class="literal">ft_stopword_file</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为
             </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">那些。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文搜索不支持在单个搜索词上使用多个运算符，如下例所示：</font></font><code class="literal">'++apple'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在单个搜索词上使用多个运算符会将语法错误返回到标准输出。</font><font style="vertical-align: inherit;">MyISAM全文搜索将成功处理相同的搜索，忽略除紧邻搜索词的运算符之外的所有运算符。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文搜索仅支持前导加号或减号。</font><font style="vertical-align: inherit;">例如，
             </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持
             </font></font><code class="literal">'+apple'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但不支持
             </font></font><code class="literal">'apple+'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">指定尾随加号或减号会导致</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">报告语法错误。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文搜索不支持使用带有通配符（</font></font><code class="literal">'+*'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），加号和减号组合（</font></font><code class="literal">'+-'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或带正号和减号组合（</font></font><code class="literal">'+-apple'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）的</font><font style="vertical-align: inherit;">前导加号</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些无效查询返回语法错误。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文搜索不支持</font></font><code class="literal">@</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在布尔</font><font style="vertical-align: inherit;">全文搜索中使用该</font><font style="vertical-align: inherit;">符号。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">@</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">符号保留供</font></font><code class="literal">@distance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            邻近搜索运算符使用。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            它们不使用适用于</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引</font><font style="vertical-align: inherit;">的50％阈值
             </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        布尔全文搜索功能支持以下运算符：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">+</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            前导或尾随加号表示该单词
             </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出现在返回的每一行中。</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只支持领先加号。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">-</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            前导或尾随减号表示该单词</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不得</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出现在任何返回的行中。</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只支持领先的减号。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            注意：</font></font><code class="literal">-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算符仅用于排除其他搜索项以其他方式匹配的行。</font><font style="vertical-align: inherit;">因此，仅包含前面的术语的布尔模式搜索
             </font></font><code class="literal">-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回空结果。</font><font style="vertical-align: inherit;">它不会返回</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除包含任何排除条款的行之外的所有行。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”</font></font></span>
          </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            （没有运营商）
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            默认情况下（当既未</font><font style="vertical-align: inherit;">指定</font><font style="vertical-align: inherit;">也</font></font><code class="literal">+</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未
             </font></font><code class="literal">-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定时），该单词是可选的，但包含它的行的等级更高。</font><font style="vertical-align: inherit;">这模仿了</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH() ...
            AGAINST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有</font></font><code class="literal">IN BOOLEAN
            MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修饰符</font><font style="vertical-align: inherit;">的行为</font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">@<em class="replaceable"><code>distance</code></em></code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此运算符</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅</font><font style="vertical-align: inherit;">适用于</font><font style="vertical-align: inherit;">表。</font><font style="vertical-align: inherit;">它测试两个或多个单词是否都在相互指定的距离内开始，用单词测量。</font><font style="vertical-align: inherit;">
            例如，</font><font style="vertical-align: inherit;">在</font><font style="vertical-align: inherit;">运算符</font><font style="vertical-align: inherit;">之前的双引号字符串中指定搜索词
            </font></font><code class="literal">@<em class="replaceable"><code>distance</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">MATCH(col1) AGAINST('"word1
            word2 word3" @8' IN BOOLEAN MODE)</code>
          </p></li><li class="listitem"><p>
            <code class="literal">&gt; &lt;</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            这两个运算符用于更改单词对分配给行的相关性值的贡献。</font><font style="vertical-align: inherit;">该
             </font></font><code class="literal">&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运营商的贡献增加以及</font></font><code class="literal">&lt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运营商降低它。</font><font style="vertical-align: inherit;">请参阅此列表后面的示例。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">( )</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            括号将单词组合成子表达式。</font><font style="vertical-align: inherit;">括号内的组可以嵌套。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">~</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            前导波浪号充当否定运算符，导致该词对该行相关性的贡献为负。</font><font style="vertical-align: inherit;">这对标记</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">噪音</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字</font><font style="vertical-align: inherit;">很有用</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">包含这样一个单词的行的评级低于其他行，但不会像</font></font><code class="literal">-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作员</font><font style="vertical-align: inherit;">那样完全排除
             </font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">*</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            星号用作截断（或通配符）运算符。</font><font style="vertical-align: inherit;">与其他运算符不同，它
             </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附加</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到要受影响的单词。</font><font style="vertical-align: inherit;">如果单词以</font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作符</font><font style="vertical-align: inherit;">前面的单词开头，则单词匹配
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果使用截断运算符指定了一个单词，则它不会从布尔查询中删除，即使它太短或是一个停用词。</font><font style="vertical-align: inherit;">无论一个字太短从确定
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            设置为</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，或
             </font></font><a class="link" href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对
             </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表。</font><font style="vertical-align: inherit;">这些选项不适用于</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用ngram解析器的索引。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            通配字被视为必须出现在一个或多个单词的开头的前缀。</font><font style="vertical-align: inherit;">如果最小字长为4，则搜索
             </font><font style="vertical-align: inherit;">
            可以返回比搜索更少的行
             </font><font style="vertical-align: inherit;">，因为第二个查询忽略了太短的搜索项
             </font><font style="vertical-align: inherit;">。
          </font></font><code class="literal">'+<em class="replaceable"><code>word</code></em> +the*'</code><font style="vertical-align: inherit;"></font><code class="literal">'+<em class="replaceable"><code>word</code></em> +the'</code><font style="vertical-align: inherit;"></font><code class="literal">the</code><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
            <code class="literal">"</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            双引号（</font></font><code class="literal">"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）字符中包含的短语仅匹配</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字面上</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含短语的行</font><span class="emphasis"><em><font style="vertical-align: inherit;">，因为它是键入的</font></em></span><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">全文引擎将短语拆分为单词，并</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在单词</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">索引中</font><font style="vertical-align: inherit;">执行搜索
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">非单词字符不需要完全匹配：短语搜索只需要匹配包含与短语完全相同的单词并且顺序相同。</font><font style="vertical-align: inherit;">例如，
             </font></font><code class="literal">"test phrase"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配</font></font><code class="literal">"test,
            phrase"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果短语不包含索引中的单词，则结果为空。</font><font style="vertical-align: inherit;">由于多种因素的组合，单词可能不在索引中：如果它们在文本中不存在，则是停用词，或者短于索引单词的最小长度。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下示例演示了一些使用布尔全文运算符的搜索字符串：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">'apple banana'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            查找包含两个单词中至少一个的行。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">'+apple +juice'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            查找包含两个单词的行。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">'+apple macintosh'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            查找包含单词</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apple</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”的</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行，但如果它们也包含</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macintosh</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”，</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则将行排名更高
             </font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">'+apple -macintosh'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            查找包含单词</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apple</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但不
             </font><font style="vertical-align: inherit;">包含</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macintosh</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”的行</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">'+apple ~macintosh'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            查找包含单词</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apple</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的行，但如果该行还包含单词</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macintosh</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则将其</font><span class="quote"><span class="quote"><font style="vertical-align: inherit;">评级</font></span></span><font style="vertical-align: inherit;">为低于不行的行。</font><font style="vertical-align: inherit;">这
             </font><font style="vertical-align: inherit;">比搜索</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更柔和</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"></font><code class="literal">'+apple
            -macintosh'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macintosh</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的存在
             </font><font style="vertical-align: inherit;">导致行根本不返回。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">'+apple +(&gt;turnover &lt;strudel)'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            查找包含单词</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apple</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">turnover</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apple</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">strudel</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（按任意顺序）的行，但排名</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apple turnover</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高于</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apple strudel</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">'apple*'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            查找包含诸如</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apple</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apples</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">applesauce</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">applet</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等字词的行</font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">'"some words"'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            查找包含具体字词行</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有些字</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（例如，包含的行</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的一些智慧的话</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一些干扰词</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">请注意，</font></font><code class="literal">"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            包含该短语的字符是分隔该短语的运算符字符。</font><font style="vertical-align: inherit;">它们不是包含搜索字符串本身的引号。
</font></font></p></li></ul>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="fulltext-boolean-innodb-relevancy-ranking"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InnoDB布尔模式搜索的相关性排名</font></font></h4>

</div>

</div>

</div>
<p>
          <a class="link" href="innodb-storage-engine.html" title="第15章InnoDB存储引擎"><code class="literal">InnoDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文搜索以</font></font><a class="ulink" href="http://sphinxsearch.com/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sphinx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文搜索引擎</font><font style="vertical-align: inherit;">为模型，所
           </font><font style="vertical-align: inherit;">使用的算法基于
           </font></font><a class="ulink" href="http://en.wikipedia.org/wiki/Okapi_BM25" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BM25</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          和
           </font></font><a class="ulink" href="http://en.wikipedia.org/wiki/TF-IDF" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF-IDF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          排名算法。</font><font style="vertical-align: inherit;">由于这些原因，
           </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔全文搜索的</font></font><a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 MyISAM存储引擎"><code class="literal">MyISAM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相关性排名</font><font style="vertical-align: inherit;">可能与</font><font style="vertical-align: inherit;">相关性排名</font><font style="vertical-align: inherit;">不同</font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">术语频率 - 逆文档频率</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          （</font></font><code class="literal">TF-IDF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）加权系统的变体来对给定全文搜索查询的文档的相关性进行排名。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">TF-IDF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权重是基于一个字如何频繁地出现在文档中，通过字如何频繁地出现在集合中的所有文件偏移。</font><font style="vertical-align: inherit;">换句话说，单词出现在文档中的频率越高，单词出现在文档集合中的频率越低，文档排名越高。
</font></font></p>
<h5><a name="idm140091683271072"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何计算相关性排名</font></font></h5>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          术语frequency（</font></font><code class="literal">TF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）值是单词在文档中出现的次数。</font></font><code class="literal">IDF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用以下公式计算单词</font><font style="vertical-align: inherit;">的逆文档频率（</font><font style="vertical-align: inherit;">）值，其中
           </font></font><code class="literal">total_records</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是集合中</font></font><code class="literal">matching_records</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的记录数，以及搜索项出现的记录数。
        </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {IDF} = log10（$ {total_records} / $ {matching_records}）  </font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当文档多次包含单词时，IDF值乘以TF值：
        </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {TF} * $ {IDF}</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用</font></font><code class="literal">TF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">IDF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值，使用以下公式计算文档的相关性排名：
        </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {rank} = $ {TF} * $ {IDF} * $ {IDF}</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该配方在以下实施例中说明。
</font></font></p>
<h5><a name="idm140091683260896"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单个单词搜索的相关性排名</font></font></h5>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此示例演示单字搜索的相关性排名计算。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; CREATE TABLE文章（</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
title VARCHAR（200），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主体，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FULLTEXT（标题，正文）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
）ENGINE = InnoDB;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（1.04秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; INSERT INTO文章（标题，正文）VALUES</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'MySQL Tutorial'，'这个数据库教程......'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（“如何使用MySQL”，“在你经历了......”之后），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'优化数据库'，'在此数据库教程中......'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'MySQL vs. YourSQL'，'比较数据库......'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'MySQL Security'，'配置正确，MySQL ......'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'数据库，数据库，数据库'，'数据库数据库'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'1001 MySQL Tricks'，'1。永远不要以root身份运行mysqld.2。......'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'MySQL全文索引'，'MySQL全文索引使用..'）;                  </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，8行受影响（0.06秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：8个重复：0个警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SELECT id，title，body，MATCH（title，body）AGAINST（'database'IN BOOLEAN MODE）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AS评分来自文章ORDER BY得分DESC;</font></font><font></font>
+----+------------------------------+-------------------------------------+---------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">标题| </font><font style="vertical-align: inherit;">身体| </font><font style="vertical-align: inherit;">得分|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+------------------------------+-------------------------------------+---------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6 | </font><font style="vertical-align: inherit;">数据库，数据库，数据库| </font><font style="vertical-align: inherit;">数据库数据库| </font><font style="vertical-align: inherit;">1.0886961221694946 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">优化您的数据库| </font><font style="vertical-align: inherit;">在这个数据库教程中...... | </font><font style="vertical-align: inherit;">0.36289870738983154 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">MySQL教程| </font><font style="vertical-align: inherit;">这个数据库教程...... | </font><font style="vertical-align: inherit;">0.18144935369491577 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">如何使用MySQL | </font><font style="vertical-align: inherit;">经过一段时间...... | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">MySQL与YourSQL | </font><font style="vertical-align: inherit;">比较数据库时... | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">MySQL安全| </font><font style="vertical-align: inherit;">正确配置后，MySQL ... | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">1001 MySQL技巧| </font><font style="vertical-align: inherit;">1.永远不要以root身份运行mysqld。</font><font style="vertical-align: inherit;">2. ... | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">MySQL全文索引| </font><font style="vertical-align: inherit;">MySQL全文索引使用.. | </font><font style="vertical-align: inherit;">0 |</font></font><font></font>
+----+------------------------------+-------------------------------------+---------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8行（0.00秒）</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          总共有8条记录，其中3条与</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索词</font><font style="vertical-align: inherit;">匹配
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">第一个记录（</font></font><code class="literal">id 6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）包含搜索词6次，相关性排名为
           </font></font><code class="literal">1.0886961221694946</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该等级值使用</font></font><code class="literal">TF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值6（
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索词在记录中出现6次
           </font></font><code class="literal">id 6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）和</font></font><code class="literal">IDF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值0.42596873216370745计算，其计算如下（其中8是记录总数，3是记录数）搜索词出现在：）：
        </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {IDF} = log10（8/3）= 0.42596873216370745</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后</font><font style="vertical-align: inherit;">
          将</font></font><code class="literal">TF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">IDF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值输入到排名公式中：
        </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {rank} = $ {TF} * $ {IDF} * $ {IDF}</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL命令行客户端中执行计算会返回排名值1.088696164686938。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; SELECT 6 * log10（8/3）* log10（8/3）;</font></font><font></font>
+-------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6 * log10（8/3）* log10（8/3）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font>
|       1.088696164686938 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font></pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            您可能会注意到在返回的排名值略有差异</font></font><code class="literal">SELECT ... MATCH ...
            AGAINST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句和MySQL命令行客户端（</font></font><code class="literal">1.0886961221694946</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对
             </font></font><code class="literal">1.088696164686938</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">不同之处在于整数和浮点数/双精度之间的转换是如何在内部执行的</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（以及相关的精度和舍入决策），以及它们如何在其他地方执行，例如在MySQL命令行客户端或其他类型的计算器中。
</font></font></p>
</div>
<h5><a name="idm140091683236912"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多字搜索的相关性排名</font></font></h5>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此示例演示了基于</font></font><code class="literal">articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前一示例中使用</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">表和数据</font><font style="vertical-align: inherit;">的多字全文搜索的相关性排名计算
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您搜索多个单词，则相关性排名值是每个单词的相关性排名值的总和，如下面的公式所示：
        </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ {rank} = $ {TF} * $ {IDF} * $ {IDF} + $ {TF} * $ {IDF} * $ {IDF}</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对两个术语执行搜索（'mysql tutorial'）会返回以下结果：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; SELECT id，title，body，MATCH（title，body）AGAINST（'mysql tutorial'IN BOOLEAN MODE）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    AS评分来自文章ORDER BY得分DESC;</font></font><font></font>
+----+------------------------------+-------------------------------------+----------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">标题| </font><font style="vertical-align: inherit;">身体| </font><font style="vertical-align: inherit;">得分|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+------------------------------+-------------------------------------+----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">MySQL教程| </font><font style="vertical-align: inherit;">这个数据库教程...... | </font><font style="vertical-align: inherit;">0.7405621409416199 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">优化您的数据库| </font><font style="vertical-align: inherit;">在这个数据库教程中...... | </font><font style="vertical-align: inherit;">0.3624762296676636 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">MySQL安全| </font><font style="vertical-align: inherit;">正确配置后，MySQL ... | </font><font style="vertical-align: inherit;">0.031219376251101494 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">8 | </font><font style="vertical-align: inherit;">MySQL全文索引| </font><font style="vertical-align: inherit;">MySQL全文索引使用.. | </font><font style="vertical-align: inherit;">0.031219376251101494 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">如何使用MySQL | </font><font style="vertical-align: inherit;">经过一段时间...... | </font><font style="vertical-align: inherit;">0.015609688125550747 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">MySQL与YourSQL | </font><font style="vertical-align: inherit;">比较数据库时... | </font><font style="vertical-align: inherit;">0.015609688125550747 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">1001 MySQL技巧| </font><font style="vertical-align: inherit;">1.永远不要以root身份运行mysqld。</font><font style="vertical-align: inherit;">2. ... | </font><font style="vertical-align: inherit;">0.015609688125550747 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6 | </font><font style="vertical-align: inherit;">数据库，数据库，数据库| </font><font style="vertical-align: inherit;">数据库数据库| </font><font style="vertical-align: inherit;">0 |</font></font><font></font>
+----+------------------------------+-------------------------------------+----------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8行（0.00秒）</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在第一个记录（</font></font><code class="literal">id 8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）中，'mysql'出现一次，'tutorial'出现两次。</font><font style="vertical-align: inherit;">'mysql'有六个匹配记录，'tutorial'有两个匹配记录。</font><font style="vertical-align: inherit;">当将这些值插入到多字搜索的排名公式中时，MySQL命令行客户端返回预期的排名值：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; SELECT（1 * log10（8/6）* log10（8/6））+（2 * log10（8/2）* log10（8/2））;</font></font><font></font>
+-------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">（1 * log10（8/6）* log10（8/6））+（2 * log10（8/2）* log10（8/2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------+</font></font><font></font>
|                                    0.7405621541938003 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font></pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"></font><code class="literal">SELECT ... MATCH ... AGAINST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在前面的示例中解释</font><font style="vertical-align: inherit;">
            了</font><font style="vertical-align: inherit;">语句和MySQL命令行客户端</font><font style="vertical-align: inherit;">返回的排名值的细微差别
             </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="fulltext-query-expansion"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.3使用查询扩展的全文搜索</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091683223680"></a><a class="indexterm" name="idm140091683222608"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        全文搜索支持查询扩展（特别是其变体</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">盲查询扩展</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">当搜索短语太短时，这通常很有用，这通常意味着用户依赖于全文搜索引擎所缺乏的隐含知识。</font><font style="vertical-align: inherit;">例如，搜索</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的用户
         </font><font style="vertical-align: inherit;">可能实际上意味着
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oracle</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DB2</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RDBMS</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">都是应该匹配</font><span class="quote"><font style="vertical-align: inherit;">“ </font></span><span class="quote"><span class="quote"><font style="vertical-align: inherit;">数据库</font></span></span><span class="quote"><font style="vertical-align: inherit;"> ”的</font></span><font style="vertical-align: inherit;">短语
        </font></font><span class="quote"><font style="vertical-align: inherit;"></font><span class="quote"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也应该归还。</font><font style="vertical-align: inherit;">这是隐含的知识。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        通过添加</font></font><code class="literal">WITH QUERY
        EXPANSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">IN NATURAL LANGUAGE MODE WITH
        QUERY EXPANSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跟随搜索短语</font><font style="vertical-align: inherit;">来启用盲查询扩展（也称为自动相关性反馈）</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它通过执行两次搜索来工作，其中第二次搜索的搜索短语是与来自第一次搜索的几个最高度相关的文档连接的原始搜索短语。</font><font style="vertical-align: inherit;">因此，如果其中一个文档包含单词
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">databases</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和单词</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则第二个搜索查找包含单词</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的文档，
         </font><font style="vertical-align: inherit;">即使它们不包含单词
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">database</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以下示例显示了这种差异：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' IN NATURAL LANGUAGE MODE);</code></strong><font></font>
+----+-------------------+------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">标题| </font><font style="vertical-align: inherit;">身体|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+-------------------+------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">MySQL教程| </font><font style="vertical-align: inherit;">DBMS代表DataBase ... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">MySQL与YourSQL | </font><font style="vertical-align: inherit;">在以下数据库比较中...... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+-------------------+------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM articles</code></strong>
    <strong class="userinput"><code>WHERE MATCH (title,body)</code></strong>
    <strong class="userinput"><code>AGAINST ('database' WITH QUERY EXPANSION);</code></strong><font></font>
+----+-----------------------+------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">标题| </font><font style="vertical-align: inherit;">身体|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+-----------------------+------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">MySQL与YourSQL | </font><font style="vertical-align: inherit;">在以下数据库比较中...... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">MySQL教程| </font><font style="vertical-align: inherit;">DBMS代表DataBase ... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">优化MySQL | </font><font style="vertical-align: inherit;">在本教程中，我们将展示... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6 | </font><font style="vertical-align: inherit;">MySQL安全| </font><font style="vertical-align: inherit;">正确配置后，MySQL ... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">如何使用MySQL井 </font><font style="vertical-align: inherit;">经过一段时间...... |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">1001 MySQL技巧| </font><font style="vertical-align: inherit;">1.永远不要以root身份运行mysqld。</font><font style="vertical-align: inherit;">2. ... |</font></font><font></font>
+----+-----------------------+------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        另一个例子是Georges Simenon关于Maigret的书，当用户不确定如何拼写
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maigret</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”时</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">搜索</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Megre和不情愿的证人</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只发现</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maigret和不情愿的见证人</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而没有查询扩展。</font><font style="vertical-align: inherit;">使用查询扩展进行搜索会</font><font style="vertical-align: inherit;">在第二遍中</font><font style="vertical-align: inherit;">找到所有带有</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maigret</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字样的书籍
         </font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由于盲查询扩展往往会通过返回非相关文档而显着增加噪声，因此仅在搜索短语较短时才使用它。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="fulltext-stopwords"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.4全文停用词</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091683201936"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        停止字被加载并使用服务器字符集和校对规则（该值搜索全文查询
         </font></font><a class="link" href="server-administration.html#sysvar_character_set_server"><code class="literal">character_set_server</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="server-administration.html#sysvar_collation_server"><code class="literal">collation_server</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量）。</font><font style="vertical-align: inherit;">假命中或遗漏如果停止字的文件或使用全文索引或搜索列有一个字符集或整理从不同的可能发生的禁用词查找</font></font><a class="link" href="server-administration.html#sysvar_character_set_server"><code class="literal">character_set_server</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="server-administration.html#sysvar_collation_server"><code class="literal">collation_server</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        禁用词查找的区分大小写取决于服务器排序规则。</font><font style="vertical-align: inherit;">例如，如果排序规则</font></font><code class="literal">utf8mb4_0900_ai_ci</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则查找</font><font style="vertical-align: inherit;">不区分大小写</font><font style="vertical-align: inherit;">，而如果排序规则为</font></font><code class="literal">utf8mb4_0900_as_cs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font><font style="vertical-align: inherit;">，则查找区分大小写
         </font></font><code class="literal">utf8mb4_bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#fulltext-stopwords-stopwords-for-innodb-search-indexes" title="InnoDB搜索索引的停用词"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InnoDB搜索索引的停用词</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-stopwords-stopwords-for-myisam-search-indexes" title="MyISAM搜索索引的停用词"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MyISAM搜索索引的停用词</font></font></a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="fulltext-stopwords-stopwords-for-innodb-search-indexes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InnoDB搜索索引的停用词</font></font></h4>

</div>

</div>

</div>
<p>
          <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有一个相对较短的默认停用词列表，因为来自技术，文学和其他来源的文档通常使用短词作为关键词或重要短语。</font><font style="vertical-align: inherit;">例如，您可能会搜索
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成为或不成为</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并期望获得合理的结果，而不是忽略所有这些单词。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要查看默认的</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">停用词列表，请查询该
           </font></font><a class="link" href="information-schema.html#innodb-ft-default-stopword-table" title="25.39.15 INFORMATION_SCHEMA INNODB_FT_DEFAULT_STOPWORD表"><code class="literal">INFORMATION_SCHEMA.INNODB_FT_DEFAULT_STOPWORD</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; SELECT * FROM INFORMATION_SCHEMA.INNODB_FT_DEFAULT_STOPWORD;</font></font><font></font>
+-------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">价值|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">关于|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一个|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">是|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">作为|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">在|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">是|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">通过|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">与|</font></font><font></font>
| de    |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">在|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">为|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">来自|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">如何|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">我|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">在|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">是|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">它|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">在|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">或者</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">那个|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">这个|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">到|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">是|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">什么|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">当|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">哪里|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">谁|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">将|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">与|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">和|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">www |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
36行（0.00秒）</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要为所有</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">定义自己的停用词列表
           </font><font style="vertical-align: inherit;">，请定义一个与表结构相同的
           </font></font><a class="link" href="information-schema.html#innodb-ft-default-stopword-table" title="25.39.15 INFORMATION_SCHEMA INNODB_FT_DEFAULT_STOPWORD表"><code class="literal">INNODB_FT_DEFAULT_STOPWORD</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，使用停用词填充它，并</font><font style="vertical-align: inherit;">
          在创建全文索引之前</font><font style="vertical-align: inherit;">将
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_server_stopword_table"><code class="literal">innodb_ft_server_stopword_table</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          选项的值设置为表单中的值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">停用词表必须有一个</font><font style="vertical-align: inherit;">名为的列</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以下示例演示如何为其创建和配置新的全局停用词表</font><font style="vertical-align: inherit;">。
        </font></font><code class="literal"><em class="replaceable"><code>db_name</code></em>/<em class="replaceable"><code>table_name</code></em></code><font style="vertical-align: inherit;"></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"></font><code class="literal">value</code><font style="vertical-align: inherit;"></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 创建一个新的停用词表</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; CREATE TABLE my_stopwords（value VARCHAR（30））ENGINE = INNODB;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 插入停用词（为简单起见，在此示例中使用单个停用词）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; INSERT INTO my_stopwords（value）VALUES（'Ishmael'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 创建表格</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; CREATE TABLE opening_lines（</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
opening_line TEXT（500），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作者VARCHAR（200），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
title VARCHAR（200）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
）ENGINE = InnoDB;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 将数据插入表中</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; INSERT INTO opening_lines（opening_line，author，title）VALUES</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'叫我以实玛利。'，'赫尔曼梅尔维尔'，'白鲸'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'尖叫声来到天空。'，'托马斯品钦'，'重力彩虹'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'我是一个看不见的人。'，'拉尔夫埃利森'，'看不见的男人'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'现在在哪里？谁现在？现在？'，'Samuel Beckett'，'The Unnamable'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'一见钟情。'，'约瑟夫海勒'，'Catch-22'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'所有这一切都发生了，或多或少。'，'Kurt Vonnegut'，'屠宰场五'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'达洛卫太太说她会自己买花。'，'弗吉尼亚伍尔夫'，'达洛卫夫人'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（'很高兴燃烧。'，'雷布拉德伯里'，'华氏451'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，8行受影响（0.00秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：8个重复：0个警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 将innodb_ft_server_stopword_table选项设置为新的停用词表</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SET GLOBAL innodb_ft_server_stopword_table ='test / my_stopwords';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 创建全文索引（如果未定义FTS_DOC_ID列，则重建表）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; CREATE FULLTEXT INDEX idx ON opening_lines（opening_line）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响，1警告（1.17秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：0重复：0警告：1</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过查询中的单词，验证指定的停用词（'Ishmael'）是否未出现
           </font></font><a class="link" href="information-schema.html#innodb-ft-index-table-table" title="25.39.18 INFORMATION_SCHEMA INNODB_FT_INDEX_TABLE表"><code class="literal">INFORMATION_SCHEMA.INNODB_FT_INDEX_TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            默认情况下，长度小于3个字符或长度大于84个字符的单词不会出现在
             </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文搜索索引中。</font><font style="vertical-align: inherit;">可以使用</font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_max_token_size"><code class="literal">innodb_ft_max_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            和
             </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            变量</font><font style="vertical-align: inherit;">配置最大和最小字长值
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此默认行为不适用于ngram解析器插件。</font><font style="vertical-align: inherit;">ngram标记大小由</font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">定义
             </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; SET GLOBAL innodb_ft_aux_table ='test / opening_lines';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SELECT word FROM INFORMATION_SCHEMA.INNODB_FT_INDEX_TABLE LIMIT 15;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">字|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">跨越|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">所有|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">烧伤|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">买|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">打电话</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">来了|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">dalloway |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">第一个|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">鲜花|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">发生了|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">她自己</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">看不见的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">少了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">爱|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">男人|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
15行（0.00秒）</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要逐个表创建停用词列表，请创建其他停用词表，并使用该
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_user_stopword_table"><code class="literal">innodb_ft_user_stopword_table</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          选项指定在创建全文索引之前要使用的停用词表。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="fulltext-stopwords-stopwords-for-myisam-search-indexes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MyISAM搜索索引的停用词</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          停止字文件被加载并使用搜索
           </font></font><code class="literal">latin1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果
           </font></font><code class="literal">character_set_server</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
           </font></font><code class="literal">ucs2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">utf16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">utf16le</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或</font></font><code class="literal">utf32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="indexterm" name="idm140091683151680"></a>

          <a class="indexterm" name="idm140091683150192"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

          要覆盖MyISAM表的默认禁用词列表，请设置</font></font><a class="link" href="server-administration.html#sysvar_ft_stopword_file"><code class="literal">ft_stopword_file</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量。</font><font style="vertical-align: inherit;">（请参见</font></font><a class="xref" href="server-administration.html#server-system-variables" title="5.1.8服务器系统变量"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.8节“服务器系统变量”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）变量值应该是包含禁用词列表的文件的路径名，或者是用于禁用禁用词过滤的空字符串。</font><font style="vertical-align: inherit;">除非给出绝对路径名以指定其他目录，否则服务器将在数据目录中查找该文件。</font><font style="vertical-align: inherit;">更改此变量的值或停用词文件的内容后，重新启动服务器并重建</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          禁用词列表是自由格式的，将停用词与任何非字母数字字符（如换行符，空格或逗号）分隔开来。</font><font style="vertical-align: inherit;">例外是下划线字符（</font></font><code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）和单个撇号（</font></font><code class="literal">'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），它们被视为单词的一部分。</font><font style="vertical-align: inherit;">禁用词列表的字符集是服务器的默认字符集; </font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="charset.html#charset-server" title="10.3.2服务器字符集和校对"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.3.2节“服务器字符集和排序规则”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下列表显示了</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引</font><font style="vertical-align: inherit;">的默认停用词
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在MySQL源代码分发中，您可以在</font></font><code class="filename">storage/myisam/ft_static.c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件中</font><font style="vertical-align: inherit;">找到此列表
           </font><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个能够达到以上的能力</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
之后事后实际上相应</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
再次反对并非全部允许</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
几乎已经允许了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
虽然总是在其中</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在一个和另一个中</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论如何任何人都有</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论如何，在任</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
适当的是不在身边</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
旁边问一下相关的问题</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
很可能成为了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因为变得变得过去了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
之前在相信之前</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了最好的以外旁边</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
两者之间的短暂而且</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过c'mon c来了可以</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不能不能导致原因</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
某些肯定会明显改变co</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，com来了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
考虑考虑包含含有</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相应的可能当前不能</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
绝对描述尽管没有</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不同的做不做</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不要在期间完成</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
每个教育，例如八个</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
其他地方尤其如此</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
等等甚至每一个</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
每个人每个人到处都是</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
确切的例子，除了很少</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第五个前五个跟随</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前是前者</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
进一步得到四个</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
得到给予放弃</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
走了就走了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
问候几乎没有发生</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
已经没有了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，他是你的帮助</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
她此后来到这里</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，她自己嗨</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
希望他自己也好好相待</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是我怎么会这样</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果我被忽略了，我就是这样</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
确实很快就会出现这种情况</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
表明内部表示内部</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相反，进入内心则不是</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它就是它的全部</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本身只是保持不变</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
知道最近才知道</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
后来后者至少少了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以免让我们喜欢</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可能看起来很小看</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有限公司可能很多</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我的意思同时只是可能</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更重要的是，大部分都是</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我必须说出自己的名字</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接近几乎必要的需要</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不需要从来没有新的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来的九个没有人没有</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
没有人，通常也没有</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在没有什么新奇的了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
经常哦好的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一次就好了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仅限于或其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
其他人应该是我们的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们在外面整体而言</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
特别是每个人都有</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大概请加上可能</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可能提供que相当qv</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相当合情合理</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论如何相对分别</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
右说同样的说法</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
说第二个说第二</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
看起来似乎看似似乎</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
看到自我明智的发送</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
认真严肃的七个应该</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
她应该不应该六岁</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所以有些人不知何故有人</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有时某种程度上某些地方</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
很抱歉指定指定</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仍然是这样的肯定</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
采取倾向      </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
感谢谢谢</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这就是他们的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他们自己然后从那里开始</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从那以后就有了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
其中就有这些他们</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他们是他们，他们是他们认为的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第三，彻底彻底那些</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
虽然三穿过整个过程</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此也在一起</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
朝向真正尝试的尝试</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尝试两次尝试两次</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不幸的是，除非不可能</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在我们身上使用</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常使用有用的用途</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
价值各种非常通过即</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vs想要的不是</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的方式我们就是这样</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们很受欢迎</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不是什么时候什么都没有</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论何时何地何地何地</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
而其中，无论何处何地</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无论是谁，谁</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
谁是谁谁谁谁</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为什么愿意和</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在没有不会怀疑的情况下</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不会是你还是你</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
你是你，你是你的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
你自己零        </font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="fulltext-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.5全文限制</font></font></h3>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅</font><font style="vertical-align: inherit;">
            支持</font></font><a class="link" href="innodb-storage-engine.html" title="第15章InnoDB存储引擎"><code class="literal">InnoDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 MyISAM存储引擎"><code class="literal">MyISAM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格</font><font style="vertical-align: inherit;">的全文搜索
             </font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            分区表不支持全文搜索。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="partitioning.html#partitioning-limitations" title="23.6分区的限制和限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第23.6节“分区的限制和限制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            全文搜索可以与大多数多字节字符集一起使用。</font><font style="vertical-align: inherit;">例外情况是，对于Unicode，
             </font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用字符集，但不能使用</font></font><code class="literal">ucs2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集。</font><font style="vertical-align: inherit;">虽然
             </font><font style="vertical-align: inherit;">无法使用列上的</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引
             </font></font><code class="literal">ucs2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但您可以</font></font><code class="literal">IN BOOLEAN MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对</font></font><code class="literal">ucs2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有此类索引</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">搜索
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            该言论</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也适用于
             </font></font><code class="literal">utf8mb4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并为言论
             </font></font><code class="literal">ucs2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也适用于
             </font></font><code class="literal">utf16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">utf16le</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><code class="literal">utf32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            中文和日文等表意语言没有单词分隔符。</font><font style="vertical-align: inherit;">因此，内置全文本解析器</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无法确定单词在这些语言和其他此类语言中的开始和结束位置</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持中文，日文和韩文（CJK）的基于字符的ngram全文解析器，以及支持日语的基于单词的MeCab解析器插件，用于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            表</font><font style="vertical-align: inherit;">一起使用</font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            虽然支持在单个表中使用多个字符集，但</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引中的</font><font style="vertical-align: inherit;">所有列都
             </font><font style="vertical-align: inherit;">必须使用相同的字符集和排序规则。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            该</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列列表必须完全在一些列的列表匹配
             </font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的表索引的定义，除非这</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
             </font></font><code class="literal">IN BOOLEAN MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个
             </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表。</font><font style="vertical-align: inherit;">对于
             </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，布尔模式搜索可以在非索引列上完成，尽管它们可能很慢。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            参数</font></font><code class="literal">AGAINST()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是在查询评估期间保持不变的字符串值。</font><font style="vertical-align: inherit;">例如，这排除了表列，因为每行可能不同。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            索引提示对于</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            搜索而言比对非</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索</font><font style="vertical-align: inherit;">更有限</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="optimization.html#index-hints" title="8.9.4索引提示"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.9.4节“索引提示”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有DML操作（</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）与全文索引以事务处理涉及列提交时间。</font><font style="vertical-align: inherit;">例如，对于</font></font><code class="literal">INSERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            操作，插入的字符串被标记化并分解成单个单词。</font><font style="vertical-align: inherit;">然后，在提交事务时，将单个单词添加到全文索引表中。</font><font style="vertical-align: inherit;">因此，全文搜索仅返回已提交的数据。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            '％'字符不是全文搜索支持的通配符。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="fulltext-fine-tuning"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.6微调MySQL全文搜索</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL的全文搜索功能几乎没有用户可调参数。</font><font style="vertical-align: inherit;">如果您有MySQL源代码分发，则可以对全文搜索行为施加更多控制，因为某些更改需要修改源代码。</font><font style="vertical-align: inherit;">请参见
         </font></font><a class="xref" href="installing.html#source-installation" title="2.9从源安装MySQL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.9节“从源安装MySQL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        仔细调整全文搜索的有效性。</font><font style="vertical-align: inherit;">在大多数情况下修改默认行为实际上会降低有效性。</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非您知道自己在做什么，否则不要更改MySQL源代码</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        必须在服务器启动时设置本节中描述的大多数全文变量。</font><font style="vertical-align: inherit;">需要重新启动服务器才能更改它们; </font><font style="vertical-align: inherit;">它们在服务器运行时无法修改。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        某些变量更改要求您重建</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表中</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">索引。</font><font style="vertical-align: inherit;">有关这样做的说明将在本节后面给出。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#fulltext-word-length" title="配置最小和最大字长"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置最小和最大字长</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-natural-language-threshold" title="配置自然语言搜索阈值"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置自然语言搜索阈值</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-modify-boolean-operators" title="修改布尔全文搜索运算符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修改布尔全文搜索运算符</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-modify-character-set" title="字符集修改"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集修改</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-rebuild-innodb-indexes" title="重建InnoDB全文索引"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重建InnoDB全文索引</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-optimize" title="优化InnoDB全文索引"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">优化InnoDB全文索引</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#fulltext-rebuild-myisam-indexes" title="重建MyISAM全文索引"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重建MyISAM全文索引</font></font></a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="fulltext-word-length"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置最小和最大字长</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要索引词的最小和最大长度由被定义
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_max_token_size"><code class="literal">innodb_ft_max_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于
           </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引，以及
           </font></font><a class="link" href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与
           </font></font><a class="link" href="server-administration.html#sysvar_ft_max_word_len"><code class="literal">ft_max_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于
           </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">人。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            最小和最大字长全文参数不适用于</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用ngram解析器创建的索引。</font><font style="vertical-align: inherit;">ngram标记大小由</font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">定义
             </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          更改任何这些选项后，重建
           </font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引以使更改生效。</font><font style="vertical-align: inherit;">例如，要使两个字符的单词可搜索，您可以将以下行放在选项文件中：
        </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的[mysqld]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
innodb_ft_min_token_size = 2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的ft_min_word_len = 2</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          然后重新启动服务器并重建
           </font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引。</font><font style="vertical-align: inherit;">对于
           </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格，请注意有关</font><font style="vertical-align: inherit;">重建</font><font style="vertical-align: inherit;">全文索引</font><font style="vertical-align: inherit;">的说明中</font><font style="vertical-align: inherit;">有关</font></font><a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk  -  MyISAM表维护实用程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisamchk的</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注释
           </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="fulltext-natural-language-threshold"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置自然语言搜索阈值</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引，自然语言搜索的50％阈值由所选的特定加权方案确定。</font><font style="vertical-align: inherit;">要禁用它，请在以下位置查找以下行
           </font></font><code class="filename">storage/myisam/ftdefs.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define GWS_IN_USE GWS_PROB
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将该行更改为：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define GWS_IN_USE GWS_FREQ
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          然后重新编译MySQL。</font><font style="vertical-align: inherit;">在这种情况下，无需重建索引。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            通过进行此更改，会</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">严重</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
            降低MySQL为</font></font><a class="link" href="functions.html#function_match"><code class="literal">MATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            函数</font><font style="vertical-align: inherit;">提供足够相关值的能力</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果你真的需要搜索这样的常用词，那么最好使用</font></font><code class="literal">IN
            BOOLEAN MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相反的</font><font style="vertical-align: inherit;">搜索</font><font style="vertical-align: inherit;">，而不是观察50％的阈值。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="fulltext-modify-boolean-operators"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修改布尔全文搜索运算符</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要更改用于对</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">进行布尔全文搜索的运算符
           </font><font style="vertical-align: inherit;">，请设置
           </font></font><a class="link" href="server-administration.html#sysvar_ft_boolean_syntax"><code class="literal">ft_boolean_syntax</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量。</font><font style="vertical-align: inherit;">（</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有等效设置。）可以在服务器运行时更​​改此变量，但必须具有足以设置全局系统变量的权限（请参见
           </font></font><a class="xref" href="server-administration.html#system-variable-privileges" title="5.1.9.1系统变量权限"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.9.1节“系统变量权限”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">在这种情况下，不需要重建索引。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="fulltext-modify-character-set"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集修改</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于内置的全文本解析器，您可以通过多种方式更改被视为单词字符的字符集，如以下列表中所述。</font><font style="vertical-align: inherit;">进行修改后，重建包含任何</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引的</font><font style="vertical-align: inherit;">每个表的</font><font style="vertical-align: inherit;">索引。</font><font style="vertical-align: inherit;">假设您要将连字符（' - '）视为单词字符。</font><font style="vertical-align: inherit;">使用以下方法之一：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              修改MySQL源：在
               </font></font><code class="filename">storage/innobase/handler/ha_innodb.cc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （for </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或in
               </font></font><code class="filename">storage/myisam/ftdefs.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（for
               </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）中，查看
               </font></font><code class="literal">true_word_char()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">misc_word_char()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宏。</font><font style="vertical-align: inherit;">添加
               </font></font><code class="literal">'-'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到其中一个宏并重新编译MySQL。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              修改字符集文件：这不需要重新编译。</font><font style="vertical-align: inherit;">的</font></font><code class="literal">true_word_char()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              宏使用</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符类型</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表来从其他字符区分字母和数字。</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可以</font></font><code class="literal">&lt;ctype&gt;&lt;map&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在其中一个字符集XML文件中</font><font style="vertical-align: inherit;">编辑</font><font style="vertical-align: inherit;">数组</font><font style="vertical-align: inherit;">的内容，
               </font><font style="vertical-align: inherit;">以指定它
               </font></font><code class="literal">'-'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字母”。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后使用给定的</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引</font><font style="vertical-align: inherit;">字符集
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关</font></font><code class="literal">&lt;ctype&gt;&lt;map&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数组格式的信息，请参见</font></font><a class="xref" href="charset.html#character-arrays" title="10.12.1字符定义数组"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.12.1节“字符定义数组”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为索引列使用的字符集添加新的排序规则，并更改列以使用该排序规则。</font><font style="vertical-align: inherit;">有关添加排序</font></font><a class="xref" href="charset.html#adding-collation" title="10.13为字符集添加排序规则"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规则的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般信息，请参见</font><a class="xref" href="charset.html#adding-collation" title="10.13&nbsp;Adding a Collation to a Character Set"><font style="vertical-align: inherit;">第10.13节“将排序规则添加到字符集”</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关特定于全文索引的示例，请参见
               </font></font><a class="xref" href="functions.html#full-text-adding-collation" title="12.9.7为全文索引添加排序规则"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.7节“为全文索引添加归类”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="fulltext-rebuild-innodb-indexes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重建InnoDB全文索引</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为使更改生效，</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          索引必须修改以下任何全文索引变量后重建：
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
          </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_max_token_size"><code class="literal">innodb_ft_max_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
          </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_server_stopword_table"><code class="literal">innodb_ft_server_stopword_table</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
          </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_user_stopword_table"><code class="literal">innodb_ft_user_stopword_table</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
          </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_enable_stopword"><code class="literal">innodb_ft_enable_stopword</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
          </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">修改
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_max_token_size"><code class="literal">innodb_ft_max_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要重新启动服务器。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要重建</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引的
           </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，使用
           </font></font><a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与
           </font></font><code class="literal">DROP INDEX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">ADD INDEX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          选项删除并重新创建每个索引。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="fulltext-optimize"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">优化InnoDB全文索引</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE语法"><code class="literal">OPTIMIZE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在具有全文索引的表上</font><font style="vertical-align: inherit;">
          运行会</font><font style="vertical-align: inherit;">重建全文索引，删除已删除的文档ID并在可能的情况下合并同一个单词的多个条目。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要优化全文索引，请启用
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_optimize_fulltext_only"><code class="literal">innodb_optimize_fulltext_only</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          并运行</font></font><code class="literal">OPTIMIZE TABLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; set GLOBAL innodb_optimize_fulltext_only = ON;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; OPTIMIZE TABLE opening_lines;</font></font><font></font>
+--------------------+----------+----------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">表| </font><font style="vertical-align: inherit;">Op | </font><font style="vertical-align: inherit;">Msg_type | </font><font style="vertical-align: inherit;">Msg_text |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+----------+----------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">test.opening_lines | </font><font style="vertical-align: inherit;">优化| </font><font style="vertical-align: inherit;">状态| </font><font style="vertical-align: inherit;">好的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+----------+----------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.01秒）    </font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要避免大型表上的全文索引的冗长重建时间，可以使用该
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_num_word_optimize"><code class="literal">innodb_ft_num_word_optimize</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          选项分阶段执行优化。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">innodb_ft_num_word_optimize</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项定义每次</font></font><a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE语法"><code class="literal">OPTIMIZE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行时</font><font style="vertical-align: inherit;">优化的单词数
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认设置为2000，这意味着每次</font></font><a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE语法"><code class="literal">OPTIMIZE
          TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行</font><font style="vertical-align: inherit;">时</font><font style="vertical-align: inherit;">都会</font><font style="vertical-align: inherit;">优化2000个字</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">后续
           </font></font><a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE语法"><code class="literal">OPTIMIZE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作从前一</font></font><a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE语法"><code class="literal">OPTIMIZE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作结束的</font><font style="vertical-align: inherit;">地方继续
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="fulltext-rebuild-myisam-indexes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重建MyISAM全文索引</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果修改影响索引（</font></font><a class="link" href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="server-administration.html#sysvar_ft_max_word_len"><code class="literal">ft_max_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="server-administration.html#sysvar_ft_stopword_file"><code class="literal">ft_stopword_file</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">的全文变量</font><font style="vertical-align: inherit;">，或者更改了停用词文件本身，则必须</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在进行更改并重新启动服务器后</font><font style="vertical-align: inherit;">重建
           </font><font style="vertical-align: inherit;">索引。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要重建</font><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">的</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引，只需
           </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行
           </font></font><code class="literal">QUICK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复操作即可：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>REPAIR TABLE <em class="replaceable"><code>tbl_name</code></em> QUICK;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者，如上所述使用</font></font><a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          。</font><font style="vertical-align: inherit;">在某些情况下，这可能比修复操作更快。
        </font></font></p><p><font style="vertical-align: inherit;"></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须修复</font><font style="vertical-align: inherit;">
          包含任何</font><font style="vertical-align: inherit;">索引的</font><font style="vertical-align: inherit;">每个表，</font><font style="vertical-align: inherit;">如刚才所示。</font><font style="vertical-align: inherit;">否则，对表的查询可能会产生不正确的结果，对表的修改将导致服务器将表视为损坏并需要修复。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果使用</font></font><a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk  -  MyISAM表维护实用程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisamchk</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行修改</font></font><code class="literal">MyISAM </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表索引</font><font style="vertical-align: inherit;">的操作</font><font style="vertical-align: inherit;">（例如修复或分析），则</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的全文参数值（最小字长，最大字长和停用词文件</font><font style="vertical-align: inherit;">）
           </font><font style="vertical-align: inherit;">重建索引
           </font><font style="vertical-align: inherit;">，除非您另行指定。</font><font style="vertical-align: inherit;">这可能导致查询失败。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          出现此问题的原因是这些参数仅由服务器知道。</font><font style="vertical-align: inherit;">它们不存储在</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          索引文件中。</font><font style="vertical-align: inherit;">为了避免这个问题，如果你已经修改服务器所使用的最小或最大字长或停止字文件值，指定相同的
           </font></font><a class="link" href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="server-administration.html#sysvar_ft_max_word_len"><code class="literal">ft_max_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及
           </font></font><a class="link" href="server-administration.html#sysvar_ft_stopword_file"><code class="literal">ft_stopword_file</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对价值观
           </font></font><a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk  -  MyISAM表维护实用程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisamchk的</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，你使用
           </font></font><a class="link" href="programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的mysqld</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，如果您将最小字长设置为3，则可以使用</font></font><a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk  -  MyISAM表维护实用程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisamchk</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复表，
           </font><font style="vertical-align: inherit;">如下所示：
        </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisamchk --recover --ft_min_word_len = 3 </font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.MYI
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了确保</font></font><a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk  -  MyISAM表维护实用程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisamchk的</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和服务器使用相同的值进行全文参数，将每一项都在</font></font><code class="literal">[mysqld]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">[myisamchk]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项文件的部分：
        </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的[mysqld]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的ft_min_word_len = 3</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[myisamchk的]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的ft_min_word_len = 3</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          到使用替代</font></font><a class="link" href="programs.html#myisamchk" title="4.6.4 myisamchk  -  MyISAM表维护实用程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisamchk的</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于
           </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表索引修改是使用</font></font><a class="link" href="sql-syntax.html#repair-table" title="13.7.3.5 REPAIR TABLE语法"><code class="literal">REPAIR TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#analyze-table" title="13.7.3.1 ANALYZE TABLE语法"><code class="literal">ANALYZE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#optimize-table" title="13.7.3.4 OPTIMIZE TABLE语法"><code class="literal">OPTIMIZE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。</font><font style="vertical-align: inherit;">这些语句由服务器执行，服务器知道要使用的正确的全文参数值。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="full-text-adding-collation"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.7为全文索引添加排序规则</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节介绍如何使用内置全文本解析器为全文搜索添加新的排序规则。</font><font style="vertical-align: inherit;">样本排序规则类似，</font></font><code class="literal">latin1_swedish_ci</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但将</font></font><code class="literal">'-'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符视为字母而不是标点符号，以便将其编入索引为单词字符。</font><font style="vertical-align: inherit;">有关添加排序</font></font><a class="xref" href="charset.html#adding-collation" title="10.13为字符集添加排序规则"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规则的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般信息，请参见</font><a class="xref" href="charset.html#adding-collation" title="10.13&nbsp;Adding a Collation to a Character Set"><font style="vertical-align: inherit;">第10.13节“向字符集添加排序规则”</font></a><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">假设您已阅读并熟悉所涉及的文件。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要为全文索引添加排序规则，请使用以下过程。</font><font style="vertical-align: inherit;">此处的说明为简单字符集</font></font><a class="xref" href="charset.html#adding-collation" title="10.13为字符集添加排序规则"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了排序规则</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如
         </font><a class="xref" href="charset.html#adding-collation" title="10.13&nbsp;Adding a Collation to a Character Set"><font style="vertical-align: inherit;">第10.13节“向字符集添加排序规则”中所述</font></a><font style="vertical-align: inherit;">，可以使用描述字符集属性的配置文件创建。</font><font style="vertical-align: inherit;">对于Unicode等复杂字符集，使用描述字符集属性的C源文件创建排序规则。
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            为</font></font><code class="filename">Index.xml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font><font style="vertical-align: inherit;">添加排序规则</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">归类ID必须未使用，因此如果已在系统上使用该ID，请选择不同于1000的值。
          </font></font></p><pre data-lang="xml" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;charset name =“latin1”&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;collat​​ion name =“latin1_fulltext_ci”id =“1000”/&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;/字符集&gt;</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            声明文件中排序规则的排序顺序
             </font></font><code class="filename">latin1.xml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，订单可以从</font></font><code class="literal">latin1_swedish_ci</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下位置</font><font style="vertical-align: inherit;">复制
             </font><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="xml" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;collat​​ion name =“latin1_fulltext_ci”&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;地图&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
60 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
50 51 52 53 54 55 56 57 58 59 5A 7B 7C 7D 7E 7F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
80 81 82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
90 91 92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A0 A1 A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
B0 B1 B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
41 41 41 41 5C 5B 5C 43 45 45 45 45 49 49 49 49</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
44 4E 4F 4F 4F 4F 5D D7 D8 55 55 55 59 59 DE DF</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
41 41 41 41 5C 5B 5C 43 45 45 45 45 49 49 49 49</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
44 4E 4F 4F 4F 4F 5D F7 D8 55 55 55 59 59 FF</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;/地图&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;/核对&gt;</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            修改</font></font><code class="literal">ctype</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数组
             </font></font><code class="filename">latin1.xml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">将对应于0x2D（这是</font></font><code class="literal">'-'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符</font><font style="vertical-align: inherit;">的代码
             </font><font style="vertical-align: inherit;">）的值从10（标点符号）更改为01（大写字母）。</font><font style="vertical-align: inherit;">在下面的数组中，这是第四行中的元素，第三行中的元素。
          </font></font></p><pre data-lang="xml" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;CTYPE&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;地图&gt;</font></font><font></font>
00<font></font>
20 20 20 20 20 20 20 20 20 28 28 28 28 28 20 20<font></font>
20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20<font></font>
48 10 10 10 10 10 10 10 10 10 10 10 10 <em class="replaceable"><code>01</code></em> 10 10<font></font>
84 84 84 84 84 84 84 84 84 84 10 10 10 10 10 10<font></font>
10 81 81 81 81 81 81 01 01 01 01 01 01 01 01 01<font></font>
01 01 01 01 01 01 01 01 01 01 01 10 10 10 10 10<font></font>
10 82 82 82 82 82 82 02 02 02 02 02 02 02 02 02<font></font>
02 02 02 02 02 02 02 02 02 02 02 10 10 10 10 20<font></font>
10 00 10 02 10 10 10 10 10 10 01 10 01 00 01 00<font></font>
00 10 10 10 10 10 10 10 10 10 02 10 02 00 02 01<font></font>
48 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10<font></font>
10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10<font></font>
01 01 01 01 01 01 01 01 01 01 01 01 01 01 01 01<font></font>
01 01 01 01 01 01 01 10 01 01 01 01 01 01 01 02<font></font>
02 02 02 02 02 02 02 02 02 02 02 02 02 02 02 02<font></font>
02 02 02 02 02 02 02 10 02 02 02 02 02 02 02 02<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;/地图&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;/ CTYPE&gt;</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            重启服务器。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要使用新的排序规则，请将其包含在要使用它的列的定义中：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>DROP TABLE IF EXISTS t1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.13秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
    <strong class="userinput"><code>a TEXT CHARACTER SET latin1 COLLATE latin1_fulltext_ci,</code></strong>
    <strong class="userinput"><code>FULLTEXT INDEX(a)</code></strong>
    <strong class="userinput"><code>) ENGINE=InnoDB;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.47秒）</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            测试排序规则以验证连字符是否被视为单词字符：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t1 VALUEs ('----'),('....'),('abcd');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，3行受影响（0.22秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：3个重复：0个警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM t1 WHERE MATCH a AGAINST ('----' IN BOOLEAN MODE);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font>
| ---- |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre></li></ol>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="fulltext-search-ngram"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.8 ngram全文分析器</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        内置的MySQL全文解析器使用单词之间的空格作为分隔符来确定单词的开始和结束位置，这在使用不使用单词分隔符的表意语言时是一个限制。</font><font style="vertical-align: inherit;">为了解决这个限制，MySQL提供了一个支持中文，日文和韩文（CJK）的ngram全文解析器。</font><font style="vertical-align: inherit;">ngram全文解析器支持与</font></font><a class="link" href="innodb-storage-engine.html" title="第15章InnoDB存储引擎"><code class="literal">InnoDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font><font style="vertical-align: inherit;">一起使用</font></font><a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 MyISAM存储引擎"><code class="literal">MyISAM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL还为日语提供了一个MeCab全文解析器插件，它将文档标记为有意义的单词。</font><font style="vertical-align: inherit;">有关更多信息，请参见</font></font><a class="xref" href="functions.html#fulltext-search-mecab" title="12.9.9 MeCab全文分析器插件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.9节“MeCab全文分析器插件”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ngram是</font></font><em class="replaceable"><code>n</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自给定文本序列的</font><font style="vertical-align: inherit;">连续
         </font><font style="vertical-align: inherit;">字符序列。</font><font style="vertical-align: inherit;">ngram解析器将一系列文本标记为连续的</font></font><em class="replaceable"><code>n</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符</font><font style="vertical-align: inherit;">序列</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，您可以</font><font style="vertical-align: inherit;">使用ngram全文解析器将</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abcd</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标记</font><font style="vertical-align: inherit;">为不同的值</font></font><em class="replaceable"><code>n</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n = 1：'a'，'b'，'c'，'d'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
n = 2：'ab'，'bc'，'cd'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
n = 3：'abc'，'bcd'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
n = 4：'abcd'</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ngram全文解析器是一个内置的服务器插件。</font><font style="vertical-align: inherit;">与其他内置服务器插件一样，它在服务器启动时自动加载。
      </font></font></p><p><font style="vertical-align: inherit;"></font><a class="xref" href="functions.html#fulltext-search" title="12.9全文搜索功能"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9节“全文搜索功能”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        描述的全文搜索语法
         </font><font style="vertical-align: inherit;">适用于ngram解析器插件。</font><font style="vertical-align: inherit;">本节将介绍解析行为的差异。</font><font style="vertical-align: inherit;">全文相关的配置选项，除了最小和最大字长选项（</font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_max_token_size"><code class="literal">innodb_ft_max_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="server-administration.html#sysvar_ft_max_word_len"><code class="literal">ft_max_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）也适用。
</font></font></p>
<h4><a name="idm140091682900992"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置ngram令牌大小</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ngram解析器的默认ngram标记大小为2（bigram）。</font><font style="vertical-align: inherit;">例如，如果令牌大小为2，则ngram解析器将字符串</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abc def</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析</font><font style="vertical-align: inherit;">为四个令牌：
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ef</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ngram标记大小可使用</font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置选项</font><font style="vertical-align: inherit;">进行
         </font><font style="vertical-align: inherit;">配置，该选项的最小值为1，最大值为10。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        通常，</font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置为要搜索的最大标记的大小。</font><font style="vertical-align: inherit;">如果您只打算搜索单个字符，请设置
         </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为1.较小的令牌大小会产生较小的全文搜索索引和较快的搜索。</font><font style="vertical-align: inherit;">如果您需要搜索由多个字符组成的单词，请相应地进行设置
         </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">， “ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生日快乐</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><span lang="zh-cn" class="phrase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生日快乐</font></font></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简体中国，在
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><span lang="zh-cn" class="phrase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生日</font></font></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生日</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><span lang="zh-cn" class="phrase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">快乐</font></font></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻译为</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">快乐</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要搜索这些双字符单词，请设置</font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        为2或更高的值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        作为只读变量，
         </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只能设置为启动字符串或配置文件的一部分：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            启动字符串：
          </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqld --ngram_token_size = 2</font></font></pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            配置文件：
          </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的[mysqld]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ngram_token_size = 2</font></font></pre></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下面的最小和最大字长配置选项被忽略的</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是使用NGRAM解析器指标：
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_max_token_size"><code class="literal">innodb_ft_max_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="server-administration.html#sysvar_ft_max_word_len"><code class="literal">ft_max_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<h4><a name="idm140091682873680"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建使用ngram解析器的FULLTEXT索引</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要创建</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个使用NGRAM解析器指数，指定</font></font><code class="literal">WITH PARSER ngram</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用
         </font></font><a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE语法"><code class="literal">CREATE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX语法"><code class="literal">CREATE INDEX</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下示例演示如何使用</font></font><code class="literal">ngram</code> <code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引</font><font style="vertical-align: inherit;">创建表
         </font><font style="vertical-align: inherit;">，插入示例数据（简体中文文本）以及在</font></font><a class="link" href="information-schema.html#innodb-ft-index-cache-table" title="25.39.17 INFORMATION_SCHEMA INNODB_FT_INDEX_CACHE表"><code class="literal">INFORMATION_SCHEMA.INNODB_FT_INDEX_CACHE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        表中</font><font style="vertical-align: inherit;">查看标记化数据
         </font><font style="vertical-align: inherit;">。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; USE测试;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; CREATE TABLE文章（</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      title VARCHAR（200），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      主体，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      FULLTEXT（标题，正文）与PARSER ngram</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ）ENGINE = InnoDB CHARACTER SET utf8mb4;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SET NAMES utf8mb4;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INSERT INTO文章（标题，正文）价值观</font></font><font></font>
    ('数据库管理','在本教程中我将向你展示如何管理数据库'),<font></font>
    ('数据库应用开发','学习开发数据库应用程序');<font></font>
    <font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SET GLOBAL innodb_ft_aux_table =“test / articles”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SELECT * FROM INFORMATION_SCHEMA.INNODB_FT_INDEX_CACHE ORDER BY doc_id，position;</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要向</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现有表</font><font style="vertical-align: inherit;">添加</font><font style="vertical-align: inherit;">索引，可以使用</font></font><a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX语法"><code class="literal">CREATE INDEX</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE TABLE文章（</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      title VARCHAR（200），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      主体</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     ）ENGINE = InnoDB CHARACTER SET utf8;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ALTER TABLE文章ADD FULLTEXT INDEX ft_index（title，body）WITH PARSER ngram;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃ 要么：</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE FULLTEXT INDEX ft_index ON PARSER ngram上的文章（标题，正文）;</font></font><font></font>
</pre>
<h4><a name="idm140091682856800"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ngram Parser空间处理</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ngram解析器在解析时消除了空格。</font><font style="vertical-align: inherit;">例如：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab cd</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被解析为</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cd</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span>
          </p></li><li class="listitem"><p>
            <span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a bc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被解析为</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span>
</p></li></ul>
</div>
<h4><a name="idm140091682851552"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ngram分析器停用词处理</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        内置的MySQL全文解析器将单词与禁用词列表中的条目进行比较。</font><font style="vertical-align: inherit;">如果单词等于禁用词列表中的条目，则该单词将从索引中排除。</font><font style="vertical-align: inherit;">对于ngram解析器，以不同方式执行停用词处理。</font><font style="vertical-align: inherit;">ngram解析器排除令牌，而不是排除与禁用词列表中的条目相等的令牌
        </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">停用词的</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，假设
        </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size=2</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a，b</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的文档</font><font style="vertical-align: inherit;">被解析为</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        和</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，b</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果逗号（</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）被定义为停用词，则两者都是</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，b</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从索引中排除，因为它们包含逗号。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        默认情况下，ngram解析器使用默认的停用词列表，其中包含英语停用词列表。</font><font style="vertical-align: inherit;">对于适用于中文，日文或韩文的禁用词列表，您必须创建自己的。</font><font style="vertical-align: inherit;">有关创建</font></font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4全文停用词"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">词列表的信息，请参见</font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4&nbsp;Full-Text Stopwords"><font style="vertical-align: inherit;">第12.9.4节“全文</font></a><font style="vertical-align: inherit;">停用词
         </font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4&nbsp;Full-Text Stopwords"><font style="vertical-align: inherit;">”</font></a><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        长度大于</font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被忽略的</font><font style="vertical-align: inherit;">停用词
         </font><font style="vertical-align: inherit;">。
</font></font></p>
<h4><a name="idm140091682842512"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ngram Parser术语搜索</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自然语言模式</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索，搜索项将转换为ngram项的并集。</font><font style="vertical-align: inherit;">例如，字符串</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（假设
         </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size=2</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）将转换为</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab bc”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">给定两个文档，一个包含</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而另一个包含
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，搜索词</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab bc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配两个文档。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔模式搜索</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，搜索项将转换为ngram短语搜索。</font><font style="vertical-align: inherit;">例如，字符串'abc'（假设
         </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size=2</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）将转换为' </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab bc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '。</font><font style="vertical-align: inherit;">给定两个文档，一个包含'ab'而另一个包含'abc'，搜索短语' </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab bc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '仅匹配包含'abc'的文档。
</font></font></p>
<h4><a name="idm140091682834112"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ngram Parser通配符搜索</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        由于</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ngram索引仅包含</font><font style="vertical-align: inherit;">ngrams </font><font style="vertical-align: inherit;">，并且不包含有关术语开头的信息，因此通配符搜索可能会返回意外结果。</font><font style="vertical-align: inherit;">以下行为适用于使用ngram </font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索索引的</font><font style="vertical-align: inherit;">通配符搜索
         </font><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果通配符搜索的前缀术语短于ngram令牌大小，则查询将返回包含以前缀术语开头的ngram令牌的所有索引行。</font><font style="vertical-align: inherit;">例如，假设
             </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size=2</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a *</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将返回以</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开头的所有行
             </font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果通配符搜索的前缀术语长于ngram令牌大小，则前缀术语将转换为ngram短语，并忽略通配符运算符。</font><font style="vertical-align: inherit;">例如，假设
             </font></font><a class="link" href="server-administration.html#sysvar_ngram_token_size"><code class="literal">ngram_token_size=2</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ABC</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> * ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符搜索被转换为
            </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AB BC</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<h4><a name="idm140091682824592"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ngram Parser短语搜索</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        短语搜索转换为ngram短语搜索。</font><font style="vertical-align: inherit;">例如，搜索短语</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被转换为
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab bc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其返回包含</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab bc</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”的</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        搜索短语</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abc def</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被转换为
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab bc de ef</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其返回包含</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abc def</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ab bc de ef</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”的</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">不返回</font><font style="vertical-align: inherit;">包含</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abcdef</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”的</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="fulltext-search-mecab"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.9.9 MeCab全文分析器插件</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        内置的MySQL全文解析器使用单词之间的空格作为分隔符来确定单词的开始和结束位置，这在使用不使用单词分隔符的表意语言时是一个限制。</font><font style="vertical-align: inherit;">为了解决日语的这种限制，MySQL提供了一个MeCab全文解析器插件。</font><font style="vertical-align: inherit;">MeCab全文解析器插件支持与</font></font><a class="link" href="innodb-storage-engine.html" title="第15章InnoDB存储引擎"><code class="literal">InnoDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font><font style="vertical-align: inherit;">一起使用
         </font></font><a class="link" href="storage-engines.html#myisam-storage-engine" title="16.2 MyISAM存储引擎"><code class="literal">MyISAM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL还提供了一个支持日语的ngram全文解析器插件。</font><font style="vertical-align: inherit;">有关更多信息，请参见
           </font></font><a class="xref" href="functions.html#fulltext-search-ngram" title="12.9.8 ngram全文分析器"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9.8节“ngram全文分析器”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MeCab全文解析器插件是日语的全文解析器插件，可将一系列文本标记为有意义的单词。</font><font style="vertical-align: inherit;">例如，MeCab将</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><span lang="ja" class="phrase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベース管理</font></font></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        （</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库管理</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">标记
         </font><font style="vertical-align: inherit;">为
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><span lang="ja" class="phrase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベース</font></font></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        （</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）和
         </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><span lang="ja" class="phrase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理</font></font></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        （</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">相比之下，
         </font></font><a class="link" href="functions.html#fulltext-search-ngram" title="12.9.8 ngram全文分析器"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ngram</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文解析器将文本标记为连续的</font></font><em class="replaceable"><code>n</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符</font><font style="vertical-align: inherit;">序列
         </font><font style="vertical-align: inherit;">，其中
        </font></font><em class="replaceable"><code>n</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 表示1到10之间的数字。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除了将文本标记为有意义的单词之外，MeCab索引通常小于ngram索引，并且MeCab全文搜索通常更快。</font><font style="vertical-align: inherit;">一个缺点是，与ngram全文解析器相比，MeCab全文本解析器可能需要更长的时间来标记文档。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        中描述的全文搜索语法
        </font></font><a class="xref" href="functions.html#fulltext-search" title="12.9全文搜索功能"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.9节“全文搜索功能”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适用于MeCab解析器插件。</font><font style="vertical-align: inherit;">本节将介绍解析行为的差异。</font><font style="vertical-align: inherit;">全文相关的配置选项也适用。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关MeCab解析器的其他信息，请参阅
        </font></font><a class="ulink" href="http://taku910.github.io/mecab/" target="_top"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Github上</font><a class="ulink" href="http://taku910.github.io/mecab/" target="_top"><font style="vertical-align: inherit;"> MeCab：Yet Another Speech-of-Speech和Morphological Analyzer</font></a><font style="vertical-align: inherit;">项目。
</font></font></p>
<h4><a name="idm140091682803152"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装MeCab Parser插件</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MeCab解析器插件需要 </font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在受支持的Fedora，Debian和Ubuntu平台上（系统</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">版本太旧的</font><font style="vertical-align: inherit;">Ubuntu 12.04除外</font><font style="vertical-align: inherit;">），</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果安装到默认位置</font><font style="vertical-align: inherit;">，MySQL会动态链接到系统
         </font><font style="vertical-align: inherit;">安装。</font><font style="vertical-align: inherit;">在其他受支持的类Unix平台上，
         </font></font><code class="filename">libmecab.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">静态链接
         </font></font><code class="filename">libpluginmecab.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，位于MySQL插件目录中。</font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含在MySQL二进制文件中，位于
         </font></font><code class="filename"><em class="replaceable"><code>MYSQL_HOME</code></em>\lib\mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您可以安装</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用本机包管理实用程序（在Fedora，Debian和Ubuntu上），也可以</font><font style="vertical-align: inherit;">从源代码</font><font style="vertical-align: inherit;">构建</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用。</font><font style="vertical-align: inherit;">有关安装</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用本机程序包管理实用程序的信息，请参阅
         </font></font><a class="link" href="functions.html#install-mecab-binary" title="从二进制分发安装MeCab（可选）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从二进制分发安装MeCab（可选）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果你想建立
         </font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        从源代码，请参阅
        </font></font><a class="link" href="functions.html#build-mecab-from-source" title="从源安装MeCab（可选）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建MeCab（可选）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在Windows上，</font></font><code class="filename">libmecab.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在MySQL </font></font><code class="filename">bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录中</font><font style="vertical-align: inherit;">找到</font><font style="vertical-align: inherit;">。
        </font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位于
         </font></font><code class="filename"><em class="replaceable"><code>MYSQL_HOME</code></em>/lib/mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要安装和配置MeCab解析器插件，请执行以下步骤：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在MySQL配置文件中，将</font></font><a class="link" href="server-administration.html#sysvar_mecab_rc_file"><code class="literal">mecab_rc_file</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置选项</font><font style="vertical-align: inherit;">设置为配置文件
             </font><font style="vertical-align: inherit;">的位置，该</font></font><code class="literal">mecabrc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            文件是MeCab的配置文件。</font><font style="vertical-align: inherit;">如果您使用的是随MySQL分发的MeCab软件包，则该</font></font><code class="literal">mecabrc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件位于
             </font></font><code class="filename">MYSQL_HOME/lib/mecab/etc/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的[mysqld]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
松mecabrc文件= MYSQL_HOME / LIB /仲裁处的/ etc / mecabrc</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            该</font></font><code class="literal">loose</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前缀是一个
             </font></font><a class="link" href="programs.html#option-modifiers" title="4.2.2.4程序选项修饰符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项修改</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在</font></font><a class="link" href="server-administration.html#sysvar_mecab_rc_file"><code class="literal">mecab_rc_file</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装MeCaB解析器插件之前，MySQL无法识别</font><font style="vertical-align: inherit;">该
             </font><font style="vertical-align: inherit;">选项，但必须在尝试安装MeCaB解析器插件之前设置该选项。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">loose</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前缀允许你重启MySQL没有遇到错误的，由于无法识别的变量。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果您使用自己的MeCab安装，或者从源构建MeCab，则</font></font><code class="filename">mecabrc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            配置文件</font><font style="vertical-align: inherit;">的位置</font><font style="vertical-align: inherit;">可能会有所不同。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关MySQL配置文件及其位置的信息，请参见</font></font><a class="xref" href="programs.html#option-files" title="4.2.2.2使用选项文件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.2.2.2节“使用选项文件”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            同样在MySQL配置文件中，将最小令牌大小设置为1或2，这是建议与MeCab解析器一起使用的值。</font><font style="vertical-align: inherit;">对于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，最小令牌大小由</font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_min_token_size"><code class="literal">innodb_ft_min_token_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            配置选项</font><font style="vertical-align: inherit;">定义
             </font><font style="vertical-align: inherit;">，其默认值为3.对于
             </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，最小令牌大小由定义</font></font><a class="link" href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其默认值为4。
          </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的[mysqld]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
innodb_ft_min_token_size = 1</font></font></pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            修改</font></font><code class="filename">mecabrc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置文件以指定要使用的字典。</font><font style="vertical-align: inherit;">在
             </font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与MySQL二进制分布包包括三个字典（</font></font><code class="literal">ipadic_euc-jp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><code class="literal">ipadic_sjis</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
             </font></font><code class="literal">ipadic_utf-8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><code class="filename">mecabrc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与MySQL一起打包</font><font style="vertical-align: inherit;">的
             </font><font style="vertical-align: inherit;">配置文件包含和输入类似于以下内容：
          </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dicdir = / path / to / mysql / lib / mecab / lib / mecab / dic / ipadic_euc-jp</font></font></pre><p><font style="vertical-align: inherit;"></font><code class="filename">ipadic_utf-8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，</font><font style="vertical-align: inherit;">
            要使用</font><font style="vertical-align: inherit;">字典，请按如下所示修改条目：
          </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dictdir = </font></font><em class="replaceable"><code>MYSQL_HOME</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ lib / mecab / dic / ipadic_utf-8</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果您使用自己的MeCab安装或从源代码构建了MeCab </font></font><code class="literal">dicdir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            ，则</font></font><code class="filename">mecabrc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件中</font><font style="vertical-align: inherit;">的默认</font><font style="vertical-align: inherit;">条目</font><font style="vertical-align: inherit;">将不同，字典及其位置也将不同。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              安装MeCab解析器插件后，您可以使用</font></font><a class="link" href="server-administration.html#statvar_mecab_charset"><code class="literal">mecab_charset</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态变量来查看与MeCab一起使用的字符集。</font><font style="vertical-align: inherit;">MySQL二进制文件提供的三个MeCab词典支持以下字符集。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  该</font></font><code class="literal">ipadic_euc-jp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">词典支持</font></font><code class="literal">ujis</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><code class="literal">eucjpms</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  该</font></font><code class="literal">ipadic_sjis</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">词典支持</font></font><code class="literal">sjis</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><code class="literal">cp932</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  该</font></font><code class="literal">ipadic_utf-8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">词典支持</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><code class="literal">utf8mb4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集。
</font></font></p></li></ul>
</div>
<p>
              <a class="link" href="server-administration.html#statvar_mecab_charset"><code class="literal">mecab_charset</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅报告第一个支持的字符集。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">ipadic_utf-8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字典支持</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">utf8mb4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
              </font></font><a class="link" href="server-administration.html#statvar_mecab_charset"><code class="literal">mecab_charset</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">始终报告</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何时使用此词典。
</font></font></p>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            重启MySQL。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            安装MeCab解析器插件：
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            MeCab解析器插件使用</font></font><a class="link" href="sql-syntax.html#install-plugin" title="13.7.4.4安装PLUGIN语法"><code class="literal">INSTALL PLUGIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语法</font><font style="vertical-align: inherit;">安装
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">插件名称是</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，共享库名称是</font></font><code class="filename">libpluginmecab.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关安装插件的其他信息，请参见
             </font></font><a class="xref" href="server-administration.html#plugin-loading" title="5.6.1安装和卸载插件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.6.1节“安装和卸载插件”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INSTALL PLUGIN mecab SONAME'libpluginmecab.so';
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            安装完成后，MeCab解析器插件会在每次正常的MySQL重启时加载。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            验证是否使用该</font></font><a class="link" href="sql-syntax.html#show-plugins" title="13.7.6.25 SHOW PLUGINS语法"><code class="literal">SHOW PLUGINS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">加载了MeCab解析器插件
             </font><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; SHOW PLUGINS;</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            一个</font></font><code class="literal">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插件应该出现在插件列表。
</font></font></p></li></ol>
</div>
<h4><a name="idm140091682723664"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建使用MeCab Parser的FULLTEXT索引</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要创建</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个使用仲裁处解析器指数，指定</font></font><code class="literal">WITH PARSER ngram</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用
         </font></font><a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE语法"><code class="literal">CREATE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX语法"><code class="literal">CREATE INDEX</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        此示例演示如何创建带有</font></font><code class="literal">mecab</code> <code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引</font><font style="vertical-align: inherit;">的表
         </font><font style="vertical-align: inherit;">，插入示例数据以及在</font></font><a class="link" href="information-schema.html#innodb-ft-index-cache-table" title="25.39.17 INFORMATION_SCHEMA INNODB_FT_INDEX_CACHE表"><code class="literal">INFORMATION_SCHEMA.INNODB_FT_INDEX_CACHE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        表中</font><font style="vertical-align: inherit;">查看标记化数据
         </font><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; USE测试;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; CREATE TABLE文章（</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      title VARCHAR（200），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      主体，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      FULLTEXT（标题，正文）与PARSER mecab</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ）ENGINE = InnoDB CHARACTER SET utf8;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SET NAMES utf8;</font></font><font></font>
    <font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; INSERT INTO文章（标题，正文）VALUES</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    （'数据库管理'，'在本教程中我将向您展示如何管理数据库'），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    （'数据库应用程序开发'，'学习开发数据库应用程序'）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SET GLOBAL innodb_ft_aux_table =“test / articles”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SELECT * FROM INFORMATION_SCHEMA.INNODB_FT_INDEX_CACHE ORDER BY doc_id，position;</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要向</font></font><code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现有表</font><font style="vertical-align: inherit;">添加</font><font style="vertical-align: inherit;">索引，可以使用</font></font><a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="sql-syntax.html#create-index" title="13.1.15 CREATE INDEX语法"><code class="literal">CREATE INDEX</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE TABLE文章（</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      title VARCHAR（200），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      主体</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     ）ENGINE = InnoDB CHARACTER SET utf8;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ALTER TABLE文章ADD FULLTEXT INDEX ft_index（标题，正文）WITH PARSER mecab;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃ 要么：</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE FULLTEXT INDEX ft_index ON PARSER mecab上的文章（标题，正文）;</font></font></pre>
<h4><a name="idm140091682706608"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MeCab Parser空间处理</font></font></h4>
<p>
        The MeCab parser uses spaces as separators in query strings. For
        example, the MeCab parser tokenizes
        <span lang="ja" class="phrase">データベース管理</span> as
        <span lang="ja" class="phrase">データベース</span> and
        <span lang="ja" class="phrase">管理</span>.
</p>
<h4><a name="idm140091682703280"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MeCab Parser Stopword处理</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        默认情况下，MeCab解析器使用默认的停用词列表，其中包含一个简短的英语停用词列表。</font><font style="vertical-align: inherit;">对于适用于日语的禁用词列表，您必须创建自己的。</font><font style="vertical-align: inherit;">有关创建</font></font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4全文停用词"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">词列表的信息，请参见</font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4&nbsp;Full-Text Stopwords"><font style="vertical-align: inherit;">第12.9.4节“全文</font></a><font style="vertical-align: inherit;">停用词
         </font><a class="xref" href="functions.html#fulltext-stopwords" title="12.9.4&nbsp;Full-Text Stopwords"><font style="vertical-align: inherit;">”</font></a><font style="vertical-align: inherit;">。
</font></font></p>
<h4><a name="idm140091682701216"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MeCab Parser术语搜索</font></font></h4>
<p>
        For natural language mode search, the search term is converted
        to a union of tokens. For example,
        <span lang="ja" class="phrase">データベース管理</span> is converted
        to <span lang="ja" class="phrase">データベース 管理</span>.
      </p><pre data-lang="sql" class="programlisting">SELECT COUNT(*) FROM articles WHERE MATCH(title,body) AGAINST('データベース管理' IN NATURAL LANGUAGE MODE);</pre><p>
        For boolean mode search, the search term is converted to a
        search phrase. For example,
        <span lang="ja" class="phrase">データベース管理</span> is converted
        to <span lang="ja" class="phrase">データベース 管理</span>.
</p><pre data-lang="sql" class="programlisting">SELECT COUNT(*) FROM articles WHERE MATCH(title,body) AGAINST('データベース管理' IN BOOLEAN MODE);</pre>
<h4><a name="idm140091682694352"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MeCab Parser通配符搜索</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        通配符搜索项不是标记化的。</font><font style="vertical-align: inherit;">对前缀</font><span lang="ja" class="phrase"><font style="vertical-align: inherit;">数据库管理</font></span><font style="vertical-align: inherit;">执行
         </font></font><span lang="ja" class="phrase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库管理*</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索
         </font><font style="vertical-align: inherit;">。
</font></font><span lang="ja" class="phrase"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT COUNT（*）FROM articles WHERE MATCH（title，body）AGAINST（'データベース*'在BOOLEAN MODE中）;</font></font></pre>
<h4><a name="idm140091682690608"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MeCab Parser短语搜索</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        短语被标记化。例如，
         </font></font><span lang="ja" class="phrase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库管理</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被标记化为</font></font><span lang="ja" class="phrase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库管理</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p><pre data-lang="sql" class="programlisting">SELECT COUNT(*) FROM articles WHERE MATCH(title,body) AGAINST('"データベース管理"' IN BOOLEAN MODE);</pre>
<h4><a name="install-mecab-binary"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从二进制分发安装MeCab（可选）</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节介绍如何</font><font style="vertical-align: inherit;">使用本机程序包管理实用程序</font><font style="vertical-align: inherit;">安装</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        和</font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用二进制分发。</font><font style="vertical-align: inherit;">例如，在Fedora上，您可以使用Yum来执行安装：
      </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yum mecab-devel</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在Debian或Ubuntu上，您可以执行APT安装：
      </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apt-get install mecab</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
apt-get install mecab-ipadic</font></font></pre>
<h4><a name="build-mecab-from-source"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从源安装MeCab（可选）</font></font></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果你想建立</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从源代码，下面提供了基本安装步骤。</font><font style="vertical-align: inherit;">有关其他信息，请参阅MeCab文档。
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            下载的tar.gz包</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            ，并</font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从
             </font></font><a class="ulink" href="http://taku910.github.io/mecab/#download" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://taku910.github.io/mecab/#download</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">截至2016年2月，最新的套餐是
             </font></font><code class="filename">mecab-0.996.tar.gz</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><code class="filename">mecab-ipadic-2.7.0-20070801.tar.gz</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            安装</font></font><code class="filename">mecab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要zxfv mecab-0.996.tar</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cd mecab-0.996</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。/配置</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
做检查</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
make install</font></font></pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            安装</font></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要zxfv mecab-ipadic-2.7.0-20070801.tar</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cd mecab-ipadic-2.7.0-20070801</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。/配置</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
make install</font></font></pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用</font></font><a class="link" href="installing.html#option_cmake_with_mecab"><code class="option">WITH_MECAB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CMake选项</font><font style="vertical-align: inherit;">编译MySQL
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果已安装
             </font><font style="vertical-align: inherit;">，
             </font><font style="vertical-align: inherit;">则将</font></font><a class="link" href="installing.html#option_cmake_with_mecab"><code class="option">WITH_MECAB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项
             </font><font style="vertical-align: inherit;">设置为</font><font style="vertical-align: inherit;">默认位置。
          </font></font><code class="literal">system</code><font style="vertical-align: inherit;"></font><code class="filename">mecab</code><font style="vertical-align: inherit;"></font><code class="filename">mecab-ipadic</code><font style="vertical-align: inherit;"></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-DWITH_MECAB =系统</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果定义了自定义安装目录，请设置
             </font></font><a class="link" href="installing.html#option_cmake_with_mecab"><code class="option">WITH_MECAB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为自定义目录。</font><font style="vertical-align: inherit;">例如：
</font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-DWITH_MECAB = /路径/到/仲裁处</font></font></pre></li></ol>
</div>

</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="cast-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.10演员函数和运算符</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091682657856"></a><a class="indexterm" name="idm140091682656816"></a><a class="indexterm" name="idm140091682655744"></a><a class="indexterm" name="idm140091682654256"></a><a class="indexterm" name="idm140091682653184"></a>
<div class="table">
<a name="idm140091682651696"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.14强制转换函数和运算符</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists cast functions and operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将字符串转换为二进制字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将值转换为特定类型
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将值转换为特定类型
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      转换函数和运算符可以将值从一种数据类型转换为另一种数据类型。
    </font></font></p><p>
      <a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with
       </font></font><code class="literal">USING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句提供了一种在不同字符集之间转换数据的方法：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">转换（</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><em class="replaceable"><code>transcoding_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在MySQL中，转码名称与相应的字符集名称相同。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      例子：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT CONVERT（_latin1'Müller'使用utf8）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INSERT INTO utf8_table（utf8_column）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    SELECT CONVERT（latin1_column USING utf8）FROM latin1_table;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您也可以</font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不
       </font><font style="vertical-align: inherit;">使用</font></font><code class="literal">USING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在不同字符集之间转换字符串：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CONVERT（</font></font><em class="replaceable"><code>string</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，CHAR [（</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）] CHARACTER SET </font></font><em class="replaceable"><code>charset_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CAST（</font></font><em class="replaceable"><code>string</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AS CHAR [（</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）] CHARACTER SET </font></font><em class="replaceable"><code>charset_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      例子：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT CONVERT（'test'，CHAR CHARACTER SET utf8）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT CAST（'test'AS CHAR CHARACTER SET utf8）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果指定</font><font style="vertical-align: inherit;">刚刚显示，则生成的字符集和排序规则是
       </font><font style="vertical-align: inherit;">默认排序规则</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果省略
       </font><font style="vertical-align: inherit;">，结果字符集和校对规则由定义
       </font><font style="vertical-align: inherit;">和
       </font><font style="vertical-align: inherit;">决定默认的连接字符集和校对系统变量（参见</font><a class="xref" href="charset.html#charset-connection" title="10.4&nbsp;Connection Character Sets and Collations"><font style="vertical-align: inherit;">第10.4节，“连接字符集和校对”</font></a><font style="vertical-align: inherit;">）。
    </font></font><code class="literal">CHARACTER SET
      <em class="replaceable"><code>charset_name</code></em></code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>charset_name</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>charset_name</code></em><font style="vertical-align: inherit;"></font><code class="literal">CHARACTER SET
      <em class="replaceable"><code>charset_name</code></em></code><font style="vertical-align: inherit;"></font><a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a><font style="vertical-align: inherit;"></font><a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a><font style="vertical-align: inherit;"></font><a class="xref" href="charset.html#charset-connection" title="10.4连接字符集和排序规则"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"></font><code class="literal">COLLATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">call中</font><font style="vertical-align: inherit;">不允许</font><font style="vertical-align: inherit;">
      使用</font><font style="vertical-align: inherit;">子句
       </font><font style="vertical-align: inherit;">，但可以将其应用于函数结果。</font><font style="vertical-align: inherit;">例如，这是合法的：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT CAST（'test'AS CHAR CHARACTER SET utf8）COLLATE utf8_bin;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      但这是非法的：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT CAST（'test'AS CHAR CHARACTER SET utf8 COLLATE utf8_bin）;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通常，您不能以不</font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      区分大小写的方式</font><font style="vertical-align: inherit;">比较</font><font style="vertical-align: inherit;">值或其他二进制字符串，因为二进制字符串使用的</font></font><code class="literal">binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集</font><font style="vertical-align: inherit;">与</font><font style="vertical-align: inherit;">字母集的概念没有排序。</font><font style="vertical-align: inherit;">要执行不区分大小写的比较，请使用
       </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数将值转换为非二进制字符串。</font><font style="vertical-align: inherit;">比较结果字符串使用其排序规则。</font><font style="vertical-align: inherit;">例如，如果转换结果字符集具有不区分大小写的排序规则，则
       </font></font><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作不区分大小写：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT'A' LIKE CONVERT（</font></font><em class="replaceable"><code>blob_col</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用latin1）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  来自</font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要使用其他字符集，请</font></font><code class="literal">latin1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在前面的语句中</font><font style="vertical-align: inherit;">替换其名称
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要为转换后的字符串指定特定排序规则，请</font></font><code class="literal">COLLATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用后</font><font style="vertical-align: inherit;">使用
       </font><font style="vertical-align: inherit;">子句
       </font><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择'A'LIKE CONVERT（</font></font><em class="replaceable"><code>blob_col</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用latin1）COLLATE latin1_german1_ci</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  来自</font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
</font></font></pre><p>
      <a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
       </font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以更普遍地用于比较以不同字符集表示的字符串。</font><font style="vertical-align: inherit;">例如，这些字符串的比较会导致错误，因为它们具有不同的字符集：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @s1 = _latin1 'abc', @s2 = _latin2 'abc';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT @s1 = @s2;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ERROR 1267（HY000）：非法混合排序（latin1_swedish_ci，IMPLICIT）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
和（latin2_general_ci，IMPLICIT）用于操作'='</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将其中一个字符串转换为与另一个字符集兼容的字符集可以使比较无错误地发生：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @s1 = CONVERT(@s2 USING latin1);</code></strong><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@ s1 = CONVERT（@ s2使用latin1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
|                               1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      为字符串常量，另一种方式来指定字符集是使用字符集导引器（</font></font><code class="literal">_latin1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><code class="literal">_latin2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前面的例子中是导引器的实例）。</font><font style="vertical-align: inherit;">与转换函数（例如
       </font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
       </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将字符串从一个字符集转换为另一个字符集）不同，介绍人将字符串文字指定为具有特定字符集，不涉及转换。</font><font style="vertical-align: inherit;">有关更多信息，请参见
       </font></font><a class="xref" href="charset.html#charset-introducer" title="10.3.8字符集介绍人"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.3.8节“字符集介绍”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      字符集转换在二进制字符串的字母转换之前也很有用。
      </font></font><a class="link" href="functions.html#function_lower"><code class="literal">LOWER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而
       </font></font><a class="link" href="functions.html#function_upper"><code class="literal">UPPER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当直接应用到二进制字符串，因为大小写的概念不适是无效的。</font><font style="vertical-align: inherit;">要执行二进制字符串的字母转换，首先将其转换为非二进制字符串：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @str = BINARY 'New York';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT LOWER(@str), LOWER(CONVERT(@str USING utf8mb4));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LOWER（@str）| </font><font style="vertical-align: inherit;">LOWER（CONVERT（@str使用utf8mb4））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">纽约| </font><font style="vertical-align: inherit;">纽约|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果使用</font></font><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font><font style="vertical-align: inherit;">转换索引列
       </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则MySQL可能无法有效地使用索引。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      转换函数对于在</font></font><a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE语法"><code class="literal">CREATE TABLE ...
      SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中</font><font style="vertical-align: inherit;">创建具有特定类型的列非常有用
       </font><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>CREATE TABLE new_table SELECT CAST('2000-01-01' AS DATE) AS c1;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SHOW CREATE TABLE new_table\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
       表：new_table</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建表：CREATE TABLE`new_table`（</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  `c1`日期DEFAULT NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
）ENGINE = InnoDB DEFAULT CHARSET = utf8mb4</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      强制转换函数可用于按</font></font><a class="link" href="data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">词汇顺序</font><font style="vertical-align: inherit;">对</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">进行排序
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通常，</font></font><a class="link" href="data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用内部数值</font><font style="vertical-align: inherit;">对</font><font style="vertical-align: inherit;">列进行</font><font style="vertical-align: inherit;">排序</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">将值转换
       </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为词汇排序的结果：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择</font></font><em class="replaceable"><code>enum_col</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自</font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CAST的订单（</font></font><em class="replaceable"><code>enum_col</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为CHAR）;
</font></font></pre><p>
      <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您将其用作更复杂表达式的一部分，也会更改结果，例如
       </font></font><a class="link" href="functions.html#function_concat"><code class="literal">CONCAT('Date: ',CAST(NOW() AS
      DATE))</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于时间值，几乎不需要使用
       </font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以不同格式提取数据。</font><font style="vertical-align: inherit;">相反，使用功能，例如
       </font></font><a class="link" href="functions.html#function_extract"><code class="literal">EXTRACT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="functions.html#function_time-format"><code class="literal">TIME_FORMAT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="functions.html#date-and-time-functions" title="12。7日期和时间函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.7节“日期和时间函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要将字符串转换为数字，除了在数字上下文中使用字符串值之外，通常只需要执行任何操作：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 1+'1';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
       - &gt; 2</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于十六进制和位文字也是如此，默认情况下是二进制字符串：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT X'41', X'41'+0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'A'，65</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT b'1100001', b'1100001'+0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'a'，97</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      算术运算中使用的字符串在表达式求值期间转换为浮点数。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      字符串上下文中使用的数字将转换为字符串：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CONCAT('hello you ',2);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'你好2'</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关将数字隐式转换为字符串的信息，请参见</font></font><a class="xref" href="functions.html#type-conversion" title="12.2表达式评估中的类型转换"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.2节“表达式</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">求值中的</font><a class="xref" href="functions.html#type-conversion" title="12.2&nbsp;Type Conversion in Expression Evaluation"><font style="vertical-align: inherit;">类型转换”</font></a><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL支持带有符号和无符号64位值的算术。</font><font style="vertical-align: inherit;">对于</font><font style="vertical-align: inherit;">其中一个操作数是无符号整数的</font><font style="vertical-align: inherit;">数字运算符（例如
       </font></font><a class="link" href="functions.html#operator_plus"><code class="literal">+</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="functions.html#operator_minus"><code class="literal">-</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），默认情况下结果是无符号的（参见</font></font><a class="xref" href="functions.html#arithmetic-functions" title="12.6.1算术运算符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.6.1节“算术运算符”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">要覆盖它，请使用</font></font><code class="literal">SIGNED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><code class="literal">UNSIGNED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      cast运算符分别将值转换为有符号或无符号的64位整数。
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 1 - 2;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; -1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CAST(1 - 2 AS UNSIGNED);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 18446744073709551615</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CAST(CAST(1 - 2 AS UNSIGNED) AS SIGNED);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; -1</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果任一操作数是浮点值，则结果为浮点值，并且不受前述规则的影响。</font><font style="vertical-align: inherit;">（在此上下文中，</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列值被视为浮点值。）
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CAST(1 AS UNSIGNED) - 2.0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; -1.0</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      SQL模式会影响转换操作的结果（请参见
       </font></font><a class="xref" href="server-administration.html#sql-mode" title="5.1.11服务器SQL模式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.11节“服务器SQL模式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">例子：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          用于将</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">零</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日期字符串转换为日期，
           </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
           </font><font style="vertical-align: inherit;">在</font><font style="vertical-align: inherit;">启用S​​QL模式</font><font style="vertical-align: inherit;">时</font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并生成警告
           </font></font><a class="link" href="server-administration.html#sqlmode_no_zero_date"><code class="literal">NO_ZERO_DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于整数减法，如果</font></font><a class="link" href="server-administration.html#sqlmode_no_unsigned_subtraction"><code class="literal">NO_UNSIGNED_SUBTRACTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用</font><font style="vertical-align: inherit;">了
           </font><font style="vertical-align: inherit;">SQL模式，即使任何操作数未签名，也会对减法结果进行签名。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下列表描述了可用的强制转换函数和运算符：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_binary"></a><p>
          <a class="indexterm" name="idm140091682517088"></a>

          <a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a>
          <em class="replaceable"><code>expr</code></em>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的</font></font><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作者将所表达为二进制字符串。</font><font style="vertical-align: inherit;">一种常见的用法
           </font></font><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是强制字符串比较逐字节而不是逐字符地完成，实际上变为区分大小写。</font><font style="vertical-align: inherit;">该
           </font></font><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运营商还导致比较尾随空格是显著。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 'a' = 'A';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BINARY 'a' = 'A';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 'a' = 'a ';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BINARY 'a' = 'a ';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          相比之下，</font></font><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">影响整个操作; </font><font style="vertical-align: inherit;">它可以在任一操作数之前给出，但结果相同。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了将字符串表达式转换为二进制字符串，这些结构是等效的：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二元</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
铸造（</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为二进制）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CONVERT（</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用二进制）
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果值是字符串文字，则可以将其指定为二进制字符串，而不使用</font></font><code class="literal">_binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集介绍器</font><font style="vertical-align: inherit;">执行任何转换
           </font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 'a' = 'A';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT _binary 'a' = 'A';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关介绍人的信息，请参见
           </font></font><a class="xref" href="charset.html#charset-introducer" title="10.3.8字符集介绍人"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.3.8节“字符集介绍人”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式中</font><font style="vertical-align: inherit;">
          的</font><font style="vertical-align: inherit;">运算符与</font></font><code class="literal">BINARY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符列定义中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">属性的</font><font style="vertical-align: inherit;">效果不同
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用该</font></font><code class="literal">BINARY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">定义的字符列将
           </font><font style="vertical-align: inherit;">分配表默认字符集和该字符集的binary（</font></font><code class="literal">_bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）排序规则。</font><font style="vertical-align: inherit;">每个非二进制字符集都有一个</font></font><code class="literal">_bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">排序规则。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集</font><font style="vertical-align: inherit;">的二进制排序规则</font><font style="vertical-align: inherit;">是</font></font><code class="literal">utf8_bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此如果表默认字符集是</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则这两个列定义是等效的：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CHAR（10）二进制</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CHAR（10）CHARACTER SET utf8 COLLATE utf8_bin</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用</font></font><code class="literal">CHARACTER SET binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中的定义</font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">柱导致列与相应的二进制字符串的数据类型进行处理。</font><font style="vertical-align: inherit;">例如，以下两对定义是等效的：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CHAR（10）CHARACTER SET二进制</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BINARY（10）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VARCHAR（10）CHARACTER SET二进制</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VARBINARY（10）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TEXT CHARACTER SET二进制</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BLOB</font></font><font></font>
</pre></li><li class="listitem"><a name="function_cast"></a><p>
          <a class="indexterm" name="idm140091682477376"></a>

          <a class="link" href="functions.html#function_cast"><code class="literal">CAST(<em class="replaceable"><code>expr</code></em> AS
          <em class="replaceable"><code>type</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数接受任何类型的表达式并生成指定类型的结果值，类似于
           </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关更多信息，请参阅的说明
           </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 是标准的SQL语法。
        </font></font></p></li><li class="listitem"><a name="function_convert"></a><p>
          <a class="indexterm" name="idm140091682463440"></a>

          <a class="link" href="functions.html#function_convert"><code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em>,<em class="replaceable"><code>type</code></em>)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em>
          USING <em class="replaceable"><code>transcoding_name</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数采用任何类型的表达式并生成指定类型的结果值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里</font><font style="vertical-align: inherit;">
          对</font><font style="vertical-align: inherit;">语法的</font><font style="vertical-align: inherit;">讨论
           </font><font style="vertical-align: inherit;">也适用于
           </font><font style="vertical-align: inherit;">，这是等价的。
        </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT(<em class="replaceable"><code>expr</code></em>,
          <em class="replaceable"><code>type</code></em>)</code></a><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST(<em class="replaceable"><code>expr</code></em> AS
          <em class="replaceable"><code>type</code></em>)</code></a><font style="vertical-align: inherit;"></font></p><p>
          <a class="link" href="functions.html#function_convert"><code class="literal">CONVERT(... USING ...)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是标准的SQL语法。</font><font style="vertical-align: inherit;">ODBC </font></font><code class="literal">USING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">形式的</font><font style="vertical-align: inherit;">非</font><font style="vertical-align: inherit;">形式
           </font></font><a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用
           </font></font><code class="literal">USING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不同的字符集之间转换数据。</font><font style="vertical-align: inherit;">在MySQL中，转码名称与相应的字符集名称相同。</font><font style="vertical-align: inherit;">例如，此语句将</font></font><code class="literal">'abc'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认字符集中</font><font style="vertical-align: inherit;">的字符串转换为</font><font style="vertical-align: inherit;">字符集中的相应字符串
           </font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT CONVERT（'abc'使用utf8）;
</font></font></pre><p>
          <a class="link" href="functions.html#function_convert"><code class="literal">CONVERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不带
           </font></font><code class="literal">USING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
           </font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用表达式和</font></font><em class="replaceable"><code>type</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定结果类型</font><font style="vertical-align: inherit;">的
           </font><font style="vertical-align: inherit;">值。</font></font><em class="replaceable"><code>type</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许</font><font style="vertical-align: inherit;">这些</font><font style="vertical-align: inherit;">值：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">BINARY[(<em class="replaceable"><code>N</code></em>)]</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              生成具有</font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据类型</font><font style="vertical-align: inherit;">的字符串
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">如何影响比较的说明，</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11.4.2节“BINARY和VARBINARY类型”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出</font><font style="vertical-align: inherit;">了可选长度
               </font><font style="vertical-align: inherit;">，则
               </font><font style="vertical-align: inherit;">
              会使强制转换使用不超过
               </font><font style="vertical-align: inherit;">参数的字节。</font><font style="vertical-align: inherit;">短于</font><font style="vertical-align: inherit;">字节的</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">用</font><font style="vertical-align: inherit;">字节</font><font style="vertical-align: inherit;">填充</font><font style="vertical-align: inherit;">到长度为
               </font><font style="vertical-align: inherit;">。
            </font></font><code class="literal">BINARY(<em class="replaceable"><code>N</code></em>)</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><code class="literal">0x00</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
              <code class="literal">CHAR[(<em class="replaceable"><code>N</code></em>)]
              [<em class="replaceable"><code>charset_info</code></em>]</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              生成具有</font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据类型</font><font style="vertical-align: inherit;">的字符串
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出</font><font style="vertical-align: inherit;">了可选长度</font><font style="vertical-align: inherit;">，则
               </font><font style="vertical-align: inherit;">
              会使强制转换使用不超过
               </font><font style="vertical-align: inherit;">参数的字符。</font><font style="vertical-align: inherit;">对于短于</font><font style="vertical-align: inherit;">字符的</font><font style="vertical-align: inherit;">值，不会出现填充
               </font><font style="vertical-align: inherit;">。
            </font></font><code class="literal">CHAR(<em class="replaceable"><code>N</code></em>)</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果没有</font></font><em class="replaceable"><code>charset_info</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句，则
               </font></font><code class="literal">CHAR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成具有默认字符集的字符串。</font><font style="vertical-align: inherit;">要明确指定字符集，</font></font><em class="replaceable"><code>charset_info</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许使用</font><font style="vertical-align: inherit;">以下</font><font style="vertical-align: inherit;">值：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">CHARACTER SET
                  <em class="replaceable"><code>charset_name</code></em></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：生成具有给定字符集的字符串。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">ASCII</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：简写
                   </font></font><code class="literal">CHARACTER SET latin1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">UNICODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：简写
                   </font></font><code class="literal">CHARACTER SET ucs2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在所有情况下，字符串都具有字符集的默认排序规则。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">DATE</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              产生</font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">价值。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">DATETIME</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              产生</font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">价值。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">DECIMAL[(<em class="replaceable"><code>M</code></em>[,<em class="replaceable"><code>D</code></em>])]</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              产生</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">价值。</font><font style="vertical-align: inherit;">如果给出了可选</font><font style="vertical-align: inherit;">值</font></font><em class="replaceable"><code>M</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><em class="replaceable"><code>D</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，则它们指定最大位数（精度）和小数点后面的位数（刻度）。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">DOUBLE</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              产生</font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果。</font><font style="vertical-align: inherit;">在MySQL 8.0.17中添加。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              FLOAT [（</font></font><em class="replaceable"><code>P</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）]
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><em class="replaceable"><code>P</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未指定</font><font style="vertical-align: inherit;">precision </font><font style="vertical-align: inherit;">，则生成类型的结果
               </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
               </font></font><em class="replaceable"><code>P</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供并且0 &lt;= &lt;&lt;
               </font></font><em class="replaceable"><code>P</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= 24，则结果为类型</font></font><code class="literal">FLOAT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果25 &lt;=
               </font></font><em class="replaceable"><code>P</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;= 53，则结果为类型</font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">REAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
               </font></font><em class="replaceable"><code>P</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;0或
               </font></font><em class="replaceable"><code>P</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; 53，则返回错误。</font><font style="vertical-align: inherit;">在MySQL 8.0.17中添加。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">JSON</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              产生</font></font><a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">价值。</font><font style="vertical-align: inherit;">有关在</font></font><a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他类型</font><font style="vertical-align: inherit;">之间转换值的规则的详细信息
               </font><font style="vertical-align: inherit;">，请参阅
               </font></font><a class="xref" href="data-types.html#json-comparison" title="JSON值的比较和排序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON值的比较和排序</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">NCHAR[(<em class="replaceable"><code>N</code></em>)]</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              喜欢</font></font><code class="literal">CHAR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但会产生一个带有国家字符集的字符串。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="charset.html#charset-national" title="10.3.7国家字符集"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.3.7节“国家字符集”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              与之</font><font style="vertical-align: inherit;">
              不同</font></font><code class="literal">CHAR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">NCHAR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不允许指定尾随字符集信息。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REAL</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              生成类型的结果
               </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">REAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这实际上是
               </font></font><code class="literal">FLOAT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果
               </font></font><code class="literal">REAL_AS_FLOAT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用了SQL模式; </font><font style="vertical-align: inherit;">否则结果是类型
               </font></font><code class="literal">DOUBLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">SIGNED [INTEGER]</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              生成有符号整数值。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">TIME</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              产生</font></font><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">价值。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">UNSIGNED [INTEGER]</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              生成无符号整数值。
</font></font></p></li></ul>
</div>
</li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="xml-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.11 XML函数</font></font></h2>

</div>

</div>

</div>

<div class="table">
<a name="idm140091682365664"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.15 XML函数</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists XML functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用XPath表示法从XML字符串中提取值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回替换的XML片段
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节讨论MySQL中的XML和相关功能。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        通过使用该</font><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">调用它们，</font><font style="vertical-align: inherit;">可以</font><font style="vertical-align: inherit;">
        在</font></font><a class="link" href="programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump  - 数据库备份程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqldump</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端中
         </font><font style="vertical-align: inherit;">从MySQL获取XML格式的输出
         </font></font><a class="link" href="programs.html#option_mysql_xml"><code class="option">--xml</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
         </font></font><a class="xref" href="programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行客户端"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.5.1节“ </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  MySQL命令行客户端”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a class="xref" href="programs.html#mysqldump" title="4.5.4 mysqldump  - 数据库备份程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.5.4节“ </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqldump</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 数据库备份程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      提供了两个提供基本XPath 1.0（XML路径语言，版本1.0）功能的函数。</font><font style="vertical-align: inherit;">本节稍后将提供有关XPath语法和用法的一些基本信息; </font><font style="vertical-align: inherit;">但是，对这些主题的深入讨论超出了本手册的范围，您应该参考
       </font></font><a class="ulink" href="http://www.w3.org/TR/xpath" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XML Path Language（XPath）1.0标准</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来获取确切的信息。</font><font style="vertical-align: inherit;">对于那些</font></font><a class="ulink" href="http://www.zvon.org/xxl/XPathTutorial/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">刚接触XPath</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或希望了解基础知识的人来说，一个有用的资源是</font><a class="ulink" href="http://www.zvon.org/xxl/XPathTutorial/" target="_top"><font style="vertical-align: inherit;">Zvon.org XPath教程</font></a><font style="vertical-align: inherit;">，它有多种语言版本。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些功能仍处于开发阶段。</font><font style="vertical-align: inherit;">我们将继续改进MySQL 8.0及更高版本中XML和XPath功能的这些和其他方面。</font><font style="vertical-align: inherit;">您可以在</font></font><a class="ulink" href="https://forums.mysql.com/list.php?44" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL XML用户论坛中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">讨论这些内容，询问有关它们的问题，并从中获得其他用户的帮助</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      与这些函数一起使用的XPath表达式支持用户变量和本地存储的程序变量。</font><font style="vertical-align: inherit;">用户变量检查不足; </font><font style="vertical-align: inherit;">强烈检查存储程序本地的变量（另见Bug＃26518）：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户变量（弱检查）。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            不检查</font><font style="vertical-align: inherit;">
            使用语法的变量
             </font><font style="vertical-align: inherit;">（即用户变量）。</font><font style="vertical-align: inherit;">如果变量类型错误或之前未分配值，则服务器不会发出警告或错误。</font><font style="vertical-align: inherit;">这也意味着用户对任何印刷错误负全部责任，因为如果（例如）</font><font style="vertical-align: inherit;">在</font><font style="vertical-align: inherit;">预期的</font><font style="vertical-align: inherit;">地方使用，
             </font><font style="vertical-align: inherit;">则</font><font style="vertical-align: inherit;">不会发出警告
             </font><font style="vertical-align: inherit;">。
          </font></font><code class="literal">$@<em class="replaceable"><code>variable_name</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">$@myvariable</code><font style="vertical-align: inherit;"></font><code class="literal">$@myvariable</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @xml = '&lt;a&gt;&lt;b&gt;X&lt;/b&gt;&lt;b&gt;Y&lt;/b&gt;&lt;/a&gt;';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SET @i =1, @j = 2;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @i, ExtractValue(@xml, '//b[$@i]');</code></strong><font></font>
+------+--------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@i | </font><font style="vertical-align: inherit;">ExtractValue（@xml，'// b [$ @ i]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">X |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @j, ExtractValue(@xml, '//b[$@j]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@j | </font><font style="vertical-align: inherit;">ExtractValue（@xml，'// b [$ @ j]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">Y |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @k, ExtractValue(@xml, '//b[$@k]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@k | </font><font style="vertical-align: inherit;">ExtractValue（@xml，'// b [$ @ k]'）|</font></font><font></font>
+------+--------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储程序中的变量（强检查）。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用语法的变量
             </font><font style="vertical-align: inherit;">
            可以在存储程序中调用时声明并与这些函数一起使用。</font><font style="vertical-align: inherit;">这些变量对于定义它们的存储程序是本地的，并且强烈检查类型和值。
          </font></font><code class="literal">$<em class="replaceable"><code>variable_name</code></em></code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>DELIMITER |</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>CREATE PROCEDURE myproc ()</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>BEGIN</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>DECLARE i INT DEFAULT 1;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;   </font></font><strong class="userinput"><code>DECLARE xml VARCHAR(25) DEFAULT '&lt;a&gt;X&lt;/a&gt;&lt;a&gt;Y&lt;/a&gt;&lt;a&gt;Z&lt;/a&gt;';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>WHILE i &lt; 4 DO</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>SELECT xml, i, ExtractValue(xml, '//a[$i]');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>SET i = i+1;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>END WHILE;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>END |</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>DELIMITER ;</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>CALL myproc();</code></strong><font></font>
+--------------------------+---+------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">xml | </font><font style="vertical-align: inherit;">我| </font><font style="vertical-align: inherit;">ExtractValue（xml，'// a [$ i]'）|</font></font><font></font>
+--------------------------+---+------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">&lt;a&gt; X &lt;/a&gt; &lt;a&gt; Y &lt;/a&gt; &lt;a&gt; Z &lt;/a&gt; | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">X |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+---+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+---+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">xml | </font><font style="vertical-align: inherit;">我| </font><font style="vertical-align: inherit;">ExtractValue（xml，'// a [$ i]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+---+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">&lt;a&gt; X &lt;/a&gt; &lt;a&gt; Y &lt;/a&gt; &lt;a&gt; Z &lt;/a&gt; | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">Y |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+---+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+---+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">xml | </font><font style="vertical-align: inherit;">我| </font><font style="vertical-align: inherit;">ExtractValue（xml，'// a [$ i]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+---+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">&lt;a&gt; X &lt;/a&gt; &lt;a&gt; Y &lt;/a&gt; &lt;a&gt; Z &lt;/a&gt; | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">Z |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+---+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.01秒）</font></font><font></font>
</pre><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在作为参数传入的存储例程中的XPath表达式中使用的变量也需要进行强检查。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      包含用户变量或存储程序本地变量的表达式必须另外（符号除外）符合包含XPath 1.0规范中给出的变量的XPath表达式的规则。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        用于存储XPath表达式的用户变量被视为空字符串。</font><font style="vertical-align: inherit;">因此，无法将XPath表达式存储为用户变量。</font><font style="vertical-align: inherit;">（Bug＃32911）
</font></font></p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_extractvalue"></a><p>
          <a class="indexterm" name="idm140091682310496"></a>

          <a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue(<em class="replaceable"><code>xml_frag</code></em>,
          <em class="replaceable"><code>xpath_expr</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接受两个字符串参数，一个XML标记片段
           </font></font><em class="replaceable"><code>xml_frag</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和一个XPath表达式
           </font></font><em class="replaceable"><code>xpath_expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（也称为
           </font></font><span class="firstterm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定位器</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）; </font><font style="vertical-align: inherit;">它返回</font></font><code class="literal">CDATA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一个文本节点</font><font style="vertical-align: inherit;">的text（</font><font style="vertical-align: inherit;">），该节点是XPath表达式匹配的元素的子元素。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用此功能相当于使用</font></font><em class="replaceable"><code>xpath_expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后添加</font><font style="vertical-align: inherit;">执行匹配</font></font><code class="literal">/text()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">换句话说，
           </font></font><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue('&lt;a&gt;&lt;b&gt;Sakila&lt;/b&gt;&lt;/a&gt;',
          '/a/b')</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
           </font></font><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue('&lt;a&gt;&lt;b&gt;Sakila&lt;/b&gt;&lt;/a&gt;',
          '/a/b/text()')</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">产生相同的结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果找到多个匹配，则返回每个匹配元素的第一个子文本节点的内容（按照匹配的顺序）作为单个空格分隔的字符串。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果没有为表达式找到匹配的文本节点（包括隐式</font></font><code class="literal">/text()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">） - 无论</font><font style="vertical-align: inherit;">出于</font><font style="vertical-align: inherit;">何种原因，只要
           </font></font><em class="replaceable"><code>xpath_expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效，并且
           </font></font><em class="replaceable"><code>xml_frag</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由正确嵌套和关闭的元素组成 - 返回空字符串。</font><font style="vertical-align: inherit;">没有区分空元素的匹配和根本没有匹配。</font><font style="vertical-align: inherit;">这是设计的。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您需要确定是否未找到匹配元素</font></font><em class="replaceable"><code>xml_frag</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font><font style="vertical-align: inherit;">找到</font><font style="vertical-align: inherit;">此类元素但未包含子文本节点，则应测试使用XPath </font></font><code class="literal">count()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">的表达式的结果
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，这两个语句都返回一个空字符串，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', '/a/b');</code></strong><font></font>
+-------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; &lt;b /&gt; &lt;/a&gt;'，'/ a / b'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font>
|                                     |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', '/a/b');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; &lt;c /&gt; &lt;/a&gt;'，'/ a / b'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                                     |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          但是，您可以使用以下内容确定是否确实存在匹配元素：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b/&gt;&lt;/a&gt;', 'count(/a/b)');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; &lt;b /&gt; &lt;/a&gt;'，'count（/ a / b）'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font>
| 1                                   |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;c/&gt;&lt;/a&gt;', 'count(/a/b)');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; &lt;c /&gt; &lt;/a&gt;'，'count（/ a / b）'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font>
| 0                                   |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.01秒）</font></font><font></font>
</pre>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p>
            <a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅返回
             </font></font><code class="literal">CDATA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且不返回可能包含在匹配标记内的任何标记，也不返回任何内容（请参阅</font></font><code class="literal">val1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            以下示例中</font><font style="vertical-align: inherit;">返回的结果</font><font style="vertical-align: inherit;">）。
</font></font></p>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '/a') AS val1,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '/a/b') AS val2,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '//b') AS val3,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;/a&gt;', '/b') AS val4,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>  ExtractValue('&lt;a&gt;ccc&lt;b&gt;ddd&lt;/b&gt;&lt;b&gt;eee&lt;/b&gt;&lt;/a&gt;', '//b') AS val5;</code></strong><font></font>
<font></font>
+------+------+------+------+---------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">val1 | </font><font style="vertical-align: inherit;">val2 | </font><font style="vertical-align: inherit;">val3 | </font><font style="vertical-align: inherit;">val4 | </font><font style="vertical-align: inherit;">val5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+------+------+---------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ccc | </font><font style="vertical-align: inherit;">ddd | </font><font style="vertical-align: inherit;">ddd | </font><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">ddd eee |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+------+------+---------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数使用当前的SQL排序规则进行比较</font></font><code class="literal">contains()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，执行与其他字符串函数（例如</font></font><a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">相同的排序规则聚合
           </font><font style="vertical-align: inherit;">，同时考虑其参数的排序规则的强制性; </font><font style="vertical-align: inherit;">有关此行为的规则的说明，</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="charset.html#charset-collation-coercibility" title="10.8.4表达式中的整理强制性"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.8.4节“表达式中的校对强制性”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          （以前，二进制 - 即始终使用区分大小写的比较。）
        </font></font></p><p>
          <code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>xml_frag</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含未正确嵌套或关闭的元素，则会</font><font style="vertical-align: inherit;">返回
           </font><font style="vertical-align: inherit;">，并生成警告，如下例所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; c &lt;/a&gt; &lt;b'，'// a'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排，1警告（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW WARNINGS\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  等级：警告</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   代码：1525</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
消息：XML值不正确：'第1行pos 11处的解析错误：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
         END-OF-INPUT意外（'&gt;'想要''</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a');</code></strong><font></font>
+-------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; c &lt;/a&gt; &lt;b /&gt;'，'// a'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre></li><li class="listitem"><a name="function_updatexml"></a><p>
          <a class="indexterm" name="idm140091682261728"></a>

          <a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML(<em class="replaceable"><code>xml_target</code></em>,
          <em class="replaceable"><code>xpath_expr</code></em>,
          <em class="replaceable"><code>new_xml</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数将XML标记的给定片段的单个部分替换为</font></font><em class="replaceable"><code>xml_target</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新的XML片段</font></font><em class="replaceable"><code>new_xml</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后返回更改的XML。</font></font><em class="replaceable"><code>xml_target</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替换</font><font style="vertical-align: inherit;">的部分
           </font><font style="vertical-align: inherit;">与</font></font><em class="replaceable"><code>xpath_expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          用户提供</font><font style="vertical-align: inherit;">的XPath表达式匹配</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果未</font></font><em class="replaceable"><code>xpath_expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到</font><font style="vertical-align: inherit;">表达式匹配
           </font><font style="vertical-align: inherit;">，或者找到多个匹配项，则该函数返回原始
           </font></font><em class="replaceable"><code>xml_target</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XML片段。</font><font style="vertical-align: inherit;">所有三个参数都应该是字符串。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/a', '&lt;e&gt;fff&lt;/e&gt;') AS val1,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/b', '&lt;e&gt;fff&lt;/e&gt;') AS val2,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '//b', '&lt;e&gt;fff&lt;/e&gt;') AS val3,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/a/d', '&lt;e&gt;fff&lt;/e&gt;') AS val4,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  UpdateXML('&lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;', '/a/d', '&lt;e&gt;fff&lt;/e&gt;') AS val5</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>\G</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
val1：&lt;e&gt; fff &lt;/ e&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
val2：&lt;a&gt; &lt;b&gt; ccc &lt;/ b&gt; &lt;d&gt; &lt;/ d&gt; &lt;/a&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
val3：&lt;a&gt; &lt;e&gt; fff &lt;/ e&gt; &lt;d&gt; &lt;/ d&gt; &lt;/a&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
val4：&lt;a&gt; &lt;b&gt; ccc &lt;/ b&gt; &lt;e&gt; fff &lt;/ e&gt; &lt;/a&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
val5：&lt;a&gt; &lt;d&gt; &lt;/ d&gt; &lt;b&gt; ccc &lt;/ b&gt; &lt;d&gt; &lt;/ d&gt; &lt;/a&gt;</font></font><font></font>
</pre></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        深入讨论XPath语法和用法超出了本手册的范围。</font><font style="vertical-align: inherit;">有关确切信息，</font><font style="vertical-align: inherit;">请参阅
         </font></font><a class="ulink" href="http://www.w3.org/TR/xpath" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XML Path Language（XPath）1.0规范</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于那些</font></font><a class="ulink" href="http://www.zvon.org/xxl/XPathTutorial/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">刚接触XPath</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或希望重新学习基础知识的人来说，一个有用的资源是
         </font><a class="ulink" href="http://www.zvon.org/xxl/XPathTutorial/" target="_top"><font style="vertical-align: inherit;">Zvon.org XPath教程</font></a><font style="vertical-align: inherit;">，该</font><a class="ulink" href="http://www.zvon.org/xxl/XPathTutorial/" target="_top"><font style="vertical-align: inherit;">教程</font></a><font style="vertical-align: inherit;">有多种语言版本。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一些基本XPath表达式的描述和示例如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">/<em class="replaceable"><code>tag</code></em></code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          匹配</font><font style="vertical-align: inherit;">if和仅
           </font><font style="vertical-align: inherit;">匹配
           </font><font style="vertical-align: inherit;">根元素。
        </font></font><code class="literal">&lt;<em class="replaceable"><code>tag</code></em>/&gt;</code><font style="vertical-align: inherit;"></font><code class="literal">&lt;<em class="replaceable"><code>tag</code></em>/&gt;</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          示例：</font></font><code class="literal">/a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配，
           </font></font><code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为它匹配最外层（根）标记。</font><font style="vertical-align: inherit;">它与内部</font></font><em class="replaceable"><code>a</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元素</font><font style="vertical-align: inherit;">不匹配
           </font><font style="vertical-align: inherit;">，
           </font></font><code class="literal">&lt;b&gt;&lt;a/&gt;&lt;/b&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为在这个实例中它是另一个元素的子元素。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">/<em class="replaceable"><code>tag1</code></em>/<em class="replaceable"><code>tag2</code></em></code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当且仅当它是子</font><font style="vertical-align: inherit;">元素</font><font style="vertical-align: inherit;">时才
           </font><font style="vertical-align: inherit;">
          匹配
           </font><font style="vertical-align: inherit;">，并且
           </font><font style="vertical-align: inherit;">是根元素。
        </font></font><code class="literal">&lt;<em class="replaceable"><code>tag2</code></em>/&gt;</code><font style="vertical-align: inherit;"></font><code class="literal">&lt;<em class="replaceable"><code>tag1</code></em>/&gt;</code><font style="vertical-align: inherit;"></font><code class="literal">&lt;<em class="replaceable"><code>tag1</code></em>/&gt;</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          示例：</font></font><code class="literal">/a/b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配</font></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XML片段</font><font style="vertical-align: inherit;">中的
           </font><font style="vertical-align: inherit;">元素，
           </font></font><code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为它是根元素的子元素</font></font><em class="replaceable"><code>a</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它没有匹配，
           </font></font><code class="literal">&lt;b&gt;&lt;a/&gt;&lt;/b&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为在这种情况下，</font></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是根元素（因此没有其他元素的子元素）。</font><font style="vertical-align: inherit;">XPath表达式也没有匹配
           </font></font><code class="literal">&lt;a&gt;&lt;c&gt;&lt;b/&gt;&lt;/c&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">在这里，</font></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个后代
           </font></font><em class="replaceable"><code>a</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但实际上并不是一个孩子
           </font></font><em class="replaceable"><code>a</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该构造可扩展到三个或更多个元素。</font><font style="vertical-align: inherit;">例如，XPath表达式</font></font><code class="literal">/a/b/c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          匹配</font></font><em class="replaceable"><code>c</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段</font><font style="vertical-align: inherit;">中的</font><font style="vertical-align: inherit;">元素
           </font></font><code class="literal">&lt;a&gt;&lt;b&gt;&lt;c/&gt;&lt;/b&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">//<em class="replaceable"><code>tag</code></em></code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          匹配任何实例
           </font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">&lt;<em class="replaceable"><code>tag</code></em>&gt;</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          示例：</font></font><code class="literal">//a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配</font></font><em class="replaceable"><code>a</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下任何一项</font><font style="vertical-align: inherit;">中的
           </font><font style="vertical-align: inherit;">元素：
           </font></font><code class="literal">&lt;a&gt;&lt;b&gt;&lt;c/&gt;&lt;/b&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
          </font></font><code class="literal">&lt;c&gt;&lt;a&gt;&lt;b/&gt;&lt;/a&gt;&lt;/b&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
          </font></font><code class="literal">&lt;c&gt;&lt;b&gt;&lt;a/&gt;&lt;/b&gt;&lt;/c&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <code class="literal">//</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以结合使用
           </font></font><code class="literal">/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">//a/b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          匹配</font></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任一片段</font><font style="vertical-align: inherit;">中的</font><font style="vertical-align: inherit;">元素</font></font><code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或
           </font></font><code class="literal">&lt;c&gt;&lt;a&gt;&lt;b/&gt;&lt;/a&gt;&lt;/c&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <code class="literal">//<em class="replaceable"><code>tag</code></em></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相当于
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一个常见的错误是将此与此混淆
             </font><font style="vertical-align: inherit;">，尽管后一种表达式实际上可能导致非常不同的结果，如下所示：
          </font></font><code class="literal">/descendant-or-self::*/<em class="replaceable"><code>tag</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">/descendant-or-self::<em class="replaceable"><code>tag</code></em></code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @xml = '&lt;a&gt;&lt;b&gt;&lt;c&gt;w&lt;/c&gt;&lt;b&gt;x&lt;/b&gt;&lt;d&gt;y&lt;/d&gt;z&lt;/b&gt;&lt;/a&gt;';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @xml;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@xml |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">&lt;a&gt; &lt;b&gt; &lt;c&gt; w &lt;/ c&gt; &lt;b&gt; x &lt;/ b&gt; &lt;d&gt; y &lt;/ d&gt; z &lt;/ b&gt; &lt;/a&gt; |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(@xml, '//b[1]');</code></strong><font></font>
+------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（@xml，'// b [1]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">xz |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(@xml, '//b[2]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（@xml，'// b [2]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font>
|                              |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::*/b[1]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（@xml，'/ descendant-or-self :: * / b [1]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">xz |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.06秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::*/b[2]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（@xml，'/ descendant-or-self :: * / b [2]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font>
|                                                   |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::b[1]');</code></strong><font></font>
+-------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（@xml，'/ descendant-or-self :: b [1]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">来自|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(@xml, '/descendant-or-self::b[2]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（@xml，'/ descendant-or-self :: b [2]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">x |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的</font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作者充当
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的任何元素相匹配。</font><font style="vertical-align: inherit;">例如，表达式</font></font><code class="literal">/*/b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配</font></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任一XML片段</font><font style="vertical-align: inherit;">中的
           </font><font style="vertical-align: inherit;">元素</font></font><code class="literal">&lt;a&gt;&lt;b/&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">&lt;c&gt;&lt;b/&gt;&lt;/c&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，表达式不会在片段中产生匹配，
           </font></font><code class="literal">&lt;b&gt;&lt;a/&gt;&lt;/b&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为它
           </font></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是某个其他元素的子元素。</font><font style="vertical-align: inherit;">通配符可以在任何位置使用：表达式</font></font><code class="literal">/*/b/*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将匹配</font></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本身不是根元素</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">元素的</font><font style="vertical-align: inherit;">任何子
           </font><font style="vertical-align: inherit;">元素。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您可以使用</font></font><code class="literal">|</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）运算符</font><font style="vertical-align: inherit;">匹配任何几个定位器
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，表达式
           </font></font><code class="literal">//b|//c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配</font><font style="vertical-align: inherit;">
          XML目标</font><font style="vertical-align: inherit;">中的所有
           </font><font style="vertical-align: inherit;">元素</font></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><em class="replaceable"><code>c</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元素。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          还可以基于其一个或多个属性的值来匹配元素。</font><font style="vertical-align: inherit;">这是使用语法完成的
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，表达式</font><font style="vertical-align: inherit;">
          匹配</font><font style="vertical-align: inherit;">片段</font><font style="vertical-align: inherit;">中的第二个</font><font style="vertical-align: inherit;">元素</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要匹配
           </font><span class="emphasis"><em><font style="vertical-align: inherit;">任何</font></em></span><font style="vertical-align: inherit;">元素
           </font><font style="vertical-align: inherit;">，请使用XPath表达式
           </font><font style="vertical-align: inherit;">。
        </font></font><code class="literal"><em class="replaceable"><code>tag</code></em>[@<em class="replaceable"><code>attribute</code></em>="<em class="replaceable"><code>value</code></em>"]</code><font style="vertical-align: inherit;"></font><code class="literal">//b[@id="idB"]</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"></font><code class="literal">&lt;a&gt;&lt;b id="idA"/&gt;&lt;c/&gt;&lt;b
          id="idB"/&gt;&lt;/a&gt;</code><font style="vertical-align: inherit;"></font><span class="emphasis"><em><font style="vertical-align: inherit;"></font></em></span><font style="vertical-align: inherit;"></font><code class="literal"><em class="replaceable"><code>attribute</code></em>="<em class="replaceable"><code>value</code></em>"</code><font style="vertical-align: inherit;"></font><code class="literal">//*[<em class="replaceable"><code>attribute</code></em>="<em class="replaceable"><code>value</code></em>"]</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要过滤多个属性值，只需连续使用多个属性比较子句。</font><font style="vertical-align: inherit;">例如，表达式</font></font><code class="literal">//b[@c="x"][@d="y"]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配</font></font><code class="literal">&lt;b c="x" d="y"/&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给定XML片段中任何位置出现</font><font style="vertical-align: inherit;">的元素</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要查找相同属性与多个值中的任何一个匹配的元素，可以使用</font></font><code class="literal">|</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算</font><font style="vertical-align: inherit;">符连接的多个定位
           </font><font style="vertical-align: inherit;">符。</font><font style="vertical-align: inherit;">例如，要匹配</font></font><em class="replaceable"><code>b</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其</font></font><em class="replaceable"><code>c</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性具有值23或17的</font><font style="vertical-align: inherit;">所有
           </font><font style="vertical-align: inherit;">元素
           </font><font style="vertical-align: inherit;">，请使用表达式
           </font></font><code class="literal">//b[@c="23"]|//b[@c="17"]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您也可以使用逻辑</font></font><code class="literal">or</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算符来实现此目的：
           </font></font><code class="literal">//b[@c="23" or @c="17"]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"></font><code class="literal">or</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和/
             </font><font style="vertical-align: inherit;">
            之间的区别</font></font><code class="literal">|</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">or</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接条件，同时</font></font><code class="literal">|</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接结果集。
</font></font></p>
</div>
</li></ul>
</div>
<p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XPath限制。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些函数支持的XPath语法目前受到以下限制：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"></font><code class="literal">'/a/b[@c=@d]'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font><font style="vertical-align: inherit;">
          节点集到节点集的比较（例如
           </font><font style="vertical-align: inherit;">）。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          支持所有标准XPath比较运算符。</font><font style="vertical-align: inherit;">（缺陷号22823）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          相对定位符表达式在根节点的上下文中解析。</font><font style="vertical-align: inherit;">例如，请考虑以下查询和结果：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>'&lt;a&gt;&lt;b c="1"&gt;X&lt;/b&gt;&lt;b c="2"&gt;Y&lt;/b&gt;&lt;/a&gt;',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>'a/b'</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>) AS result;</code></strong><font></font>
+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">结果|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">XY |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.03秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在这种情况下，定位器</font></font><code class="literal">a/b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析为
           </font></font><code class="literal">/a/b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          谓词中也支持相对定位器。</font><font style="vertical-align: inherit;">在以下示例中，</font></font><code class="literal">d[../@c="1"]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析为</font></font><code class="literal">/a/b[@c="1"]/d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;       </font></font><strong class="userinput"><code>'&lt;a&gt;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;         </font></font><strong class="userinput"><code>&lt;b c="1"&gt;&lt;d&gt;X&lt;/d&gt;&lt;/b&gt;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;         </font></font><strong class="userinput"><code>&lt;b c="2"&gt;&lt;d&gt;X&lt;/d&gt;&lt;/b&gt;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;       </font></font><strong class="userinput"><code>&lt;/a&gt;',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;       </font></font><strong class="userinput"><code>'a/b/d[../@c="1"]')</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>AS result;</code></strong><font></font>
+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">结果|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">X |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不允许使用以表达式为前缀的定位符作为标量值（包括变量引用，文字，数字和标量函数调用），并且它们的使用会导致错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><code class="literal">::</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font><font style="vertical-align: inherit;">
          将</font><font style="vertical-align: inherit;">运算符与节点类型结合使用，例如：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::comment()</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::text()</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::processing-instructions()</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>axis</code></em>::node()</code>
</p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          但是，支持名称测试（例如
           </font><font style="vertical-align: inherit;">
          和</font><font style="vertical-align: inherit;">），如以下示例所示：
        </font></font><code class="literal"><em class="replaceable"><code>axis</code></em>::<em class="replaceable"><code>name</code></em></code><font style="vertical-align: inherit;"></font><code class="literal"><em class="replaceable"><code>axis</code></em>::*</code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::b');</code></strong><font></font>
+-------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; &lt;b&gt; x &lt;/ b&gt; &lt;c&gt; y &lt;/ c&gt; &lt;/a&gt;'，'/ a / child :: b'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">x |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.02秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;&lt;b&gt;x&lt;/b&gt;&lt;c&gt;y&lt;/c&gt;&lt;/a&gt;','/a/child::*');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; &lt;b&gt; x &lt;/ b&gt; &lt;c&gt; y &lt;/ c&gt; &lt;/a&gt;'，'/ a / child :: *'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">xy |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.01秒）</font></font><font></font>
</pre></li><li class="listitem"><p>
          <span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向上和向下</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">导航是不是在情况下，路径会导致支持</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上面</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的根元素。</font><font style="vertical-align: inherit;">也就是说，您不能使用与给定元素的祖先的后代匹配的表达式，其中当前元素的一个或多个祖先也是根元素的祖先（参见Bug＃16321）。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不支持以下XPath函数，或者已指出已知问题：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">id()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">lang()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">local-name()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">name()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">namespace-uri()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">normalize-space()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">starts-with()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">string()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">substring-after()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">substring-before()</code>
            </p></li><li class="listitem"><p>
              <code class="literal">translate()</code>
</p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不支持以下轴：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">following-sibling</code>
            </p></li><li class="listitem"><p>
              <code class="literal">following</code>
            </p></li><li class="listitem"><p>
              <code class="literal">preceding-sibling</code>
            </p></li><li class="listitem"><p>
              <code class="literal">preceding</code>
</p></li></ul>
</div>
</li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      XPath表达式作为参数传递，
       </font></font><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
       </font></font><a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能</font></font><code class="literal">:</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在元素选择器中</font><font style="vertical-align: inherit;">包含冒号字符（</font><font style="vertical-align: inherit;">），这使得它们可以使用带有XML命名空间符号的标记。</font><font style="vertical-align: inherit;">例如：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @xml = '&lt;a&gt;111&lt;b:c&gt;222&lt;d&gt;333&lt;/d&gt;&lt;e:f&gt;444&lt;/e:f&gt;&lt;/b:c&gt;&lt;/a&gt;';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(@xml, '//e:f');</code></strong><font></font>
+-----------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（@xml，'// e：f'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------+</font></font><font></font>
| 444                         |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT UpdateXML(@xml, '//b:c', '&lt;g:h&gt;555&lt;/g:h&gt;');</code></strong><font></font>
+--------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">UpdateXML（@xml，'// b：c'，'&lt;g：h&gt; 555 &lt;/ g：h&gt;'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">&lt;a&gt; 111 &lt;g：h&gt; 555 &lt;/ g：h&gt; &lt;/a&gt; |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这在某些方面类似于</font></font><a class="ulink" href="http://xalan.apache.org/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache Xalan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和其他一些解析器</font><font style="vertical-align: inherit;">所允许的
       </font><font style="vertical-align: inherit;">，并且比要求命名空间声明或使用</font></font><code class="literal">namespace-uri()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      和</font></font><code class="literal">local-name()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">要简单得多</font><font style="vertical-align: inherit;">。
    </font></font></p><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误处理。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于这两个</font></font><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，使用的XPath定位器必须有效和要搜索的XML必须由被正确地嵌套和关闭元件。</font><font style="vertical-align: inherit;">如果定位器无效，则会生成错误：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font><span class="errortext"><font style="vertical-align: inherit;">ERROR 1105（HY000）：XPATH语法错误：'＆a'</font></span></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '/&amp;a');</code></strong>
<span class="errortext"><font style="vertical-align: inherit;"></font></span>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果</font></font><em class="replaceable"><code>xml_frag</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不包含正确嵌套和关闭的元素，
       </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则返回并生成警告，如下例所示：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b', '//a');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; c &lt;/a&gt; &lt;b'，'// a'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排，1警告（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW WARNINGS\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  等级：警告</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   代码：1525</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
消息：XML值不正确：'第1行pos 11处的解析错误：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
         END-OF-INPUT意外（'&gt;'想要''</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue('&lt;a&gt;c&lt;/a&gt;&lt;b/&gt;', '//a');</code></strong><font></font>
+-------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ExtractValue（'&lt;a&gt; c &lt;/a&gt; &lt;b /&gt;'，'// a'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        用作第三个参数替换XML到
         </font></font><a class="link" href="functions.html#function_updatexml"><code class="literal">UpdateXML()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被
         </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查，以确定是否它仅由被正确地嵌套和关闭元件。
</font></font></p>
</div>
<p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XPath注入。&nbsp;</font></font></b>
        <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当恶意代码被引入系统以获得对特权和数据的未授权访问时，就会发生</font></font><span class="firstterm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码注入</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它基于利用开发人员对用户输入数据的类型和内容所做的假设。</font><font style="vertical-align: inherit;">XPath在这方面也不例外。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      可能发生这种情况的常见情况是应用程序通过将登录名和密码的组合与XML文件中的组合进行匹配来处理授权，使用类似这样的XPath表达式：
    </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">// user [login / text（）='neapolitan'和password / text（）='1c3cr34m'] / attribute :: id
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这是与此类似的SQL语句的XPath：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT id FROM users WHERE login ='neapolitan'AND password''1c3cr34m';
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用XPath的PHP应用程序可能会像这样处理登录过程：
    </font></font></p><pre data-lang="php" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;？PHP</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  $ file =“users.xml”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  $ login = $ POST [“login”];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  $ password = $ POST [“password”];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  $ xpath =“// user [login / text（）= $ login and password / text（）= $ password] / attribute :: id”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（file_exists（$ file））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    $ xml = simplexml_load_file（$ file）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if（$ result = $ xml-&gt; xpath（$ xpath））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      echo“您现在以用户$ result [0]身份登录。”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      echo“登录名或密码无效。”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    退出（“无法打开$ file。”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
？&gt;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      不对输入执行检查。</font><font style="vertical-align: inherit;">这意味着恶意用户可以</font><font style="vertical-align: inherit;">通过输入</font><font style="vertical-align: inherit;">登录名和密码</font><font style="vertical-align: inherit;">来</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">短路</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">测试
       </font></font><code class="literal">' or 1=1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，从而得到</font></font><code class="varname">$xpath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如下所示的评估：
    </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">// user [login / text（）=''或1 = 1和password / text（）=''或1 = 1] / attribute :: id
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      由于方括号内的表达式始终求值为</font></font><code class="literal">true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此它实际上与此对应，它与</font><font style="vertical-align: inherit;">XML文档</font></font><code class="literal">id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中每个</font></font><code class="literal">user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元素</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">属性
       </font><font style="vertical-align: inherit;">相匹配</font><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">//用户/属性:: ID
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      可以绕过这种特定攻击的一种方法是简单地引用要在插值中插入的变量名</font></font><code class="literal">$xpath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，强制将从Web表单传递的值转换为字符串：
    </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ xpath =“// user [login / text（）='$ login'和password / text（）='$ password'] / attribute :: id”;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这与通常建议用于防止SQL注入攻击的策略相同。</font><font style="vertical-align: inherit;">通常，您应该遵循的用于防止XPath注入攻击的实践与防止SQL注入相同：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从未接受过应用程序中用户的未经测试的数据。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检查所有用户提交的数据类型; </font><font style="vertical-align: inherit;">拒绝或转换错误类型的数据
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          测试超出范围值的数值数据; </font><font style="vertical-align: inherit;">截断，舍入或拒绝超出范围的值。</font><font style="vertical-align: inherit;">测试非法字符的字符串，并将其删除或拒绝包含它们的输入。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请勿输出可能为未经授权的用户提供可用于危害系统的线索的显式错误消息; </font><font style="vertical-align: inherit;">请将这些记录到文件或数据库表中。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      正如SQL注入攻击可用于获取有关数据库模式的信息一样，XPath注入也可用于遍历XML文件以揭示其结构，如Amit Klein的论文
       </font></font><a class="ulink" href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blind XPath Injection</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（PDF文件，46KB）中所述。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      检查发送回客户端的输出也很重要。</font><font style="vertical-align: inherit;">考虑一下当我们使用MySQL </font></font><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">时会发生什么
       </font><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT ExtractValue(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>LOAD_FILE('users.xml'),</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'//user[login/text()="" or 1=1 and password/text()="" or 1=1]/attribute::id'</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>) AS id;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
| 00327 13579 02403 42354 28570 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.01秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      因为</font></font><a class="link" href="functions.html#function_extractvalue"><code class="literal">ExtractValue()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将多个匹配作为单个空格分隔的字符串返回，所以此注入攻击将包含在</font></font><code class="filename">users.xml</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font><font style="vertical-align: inherit;">内的每个有效ID
       </font><font style="vertical-align: inherit;">作为单行输出提供。</font><font style="vertical-align: inherit;">作为额外的安全措施，您还应该在将输出返回给用户之前对其进行测试。</font><font style="vertical-align: inherit;">这是一个简单的例子：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT @id = ExtractValue(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>LOAD_FILE('users.xml'),</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'//user[login/text()="" or 1=1 and password/text()="" or 1=1]/attribute::id'</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT IF(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>INSTR(@id, ' ') = 0,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>@id,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'Unable to retrieve user ID')</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>AS singleID;</code></strong><font></font>
+----------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">singleID |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">无法检索用户ID |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通常，安全地向用户返回数据的准则与接受用户输入的准则相同。</font><font style="vertical-align: inherit;">这些可以概括为：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          始终测试输出数据的类型和允许值。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          永远不允许未经授权的用户查看可能提供有关可能用于利用它的应用程序的信息的错误消息。
</font></font></p></li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="bit-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.12位功能和操作符</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091682033008"></a><a class="indexterm" name="idm140091682031552"></a><a class="indexterm" name="idm140091682030064"></a><a class="indexterm" name="idm140091682028992"></a><a class="indexterm" name="idm140091682027920"></a><a class="indexterm" name="idm140091682026416"></a><a class="indexterm" name="idm140091682024960"></a><a class="indexterm" name="idm140091682023888"></a>
<div class="table">
<a name="idm140091682022816"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.16位功能和操作符</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists bit functions and operators."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_bit-count"><code class="literal">BIT_COUNT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回设置的位数
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      按位AND
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      按位反转
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      按位OR
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      按位异或
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      左移
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      右转
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      位的函数和操作包括
       </font></font><a class="link" href="functions.html#function_bit-count"><code class="literal">BIT_COUNT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
       </font></font><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（该</font></font><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚集函数描述在</font></font><a class="xref" href="functions.html#group-by-functions" title="12.20.1聚合（GROUP BY）功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20.1，“集合（GROUP BY）函数描述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）在此之前的MySQL 8.0，所需的比特的函数和操作
       </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位整数）的参数和返回的</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，因此他们有最大范围为64位。</font><font style="vertical-align: inherit;">非</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在执行操作之前</font><font style="vertical-align: inherit;">被转换为</font><font style="vertical-align: inherit;">可能发生截断。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在MySQL 8.0中，位函数和运算符允许二进制字符串类型参数（</font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型）并返回类似的值，这使它们能够获取参数并生成大于64位的返回值。</font><font style="vertical-align: inherit;">非二进制字符串参数将</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">像以前一样</font><font style="vertical-align: inherit;">转换为</font><font style="vertical-align: inherit;">并进行处理。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这种行为改变的含义是二进制字符串参数的位操作可能在MySQL 8.0中产生与5.7中不同的结果。</font><font style="vertical-align: inherit;">有关如何准备在MySQL 5.7为MySQL 5.7和8.0之间的潜在的不兼容信息，请参见
       </font></font><a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/bit-functions.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位函数和操作符</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，在
       </font></font><a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的5.7参考手册</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-5-7" title="MySQL 8.0之前的位操作"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL 8.0之前的位操作</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-8-0" title="MySQL 8.0中的位操作"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL 8.0中的位操作</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-binary-string-examples" title="二进制字符串位操作示例"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二进制字符串位操作示例</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-and-or-xor" title="按位AND，OR和XOR运算"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按位AND，OR和XOR运算</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-complement-shift" title="按位补充和移位操作"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按位补充和移位操作</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-bit-count" title="BIT_COUNT（）操作"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BIT_COUNT（）操作</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-bit-aggregate" title="BIT_AND（），BIT_OR（）和BIT_XOR（）操作"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BIT_AND（），BIT_OR（）和BIT_XOR（）操作</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-literal-handling" title="十六进制文字，位文字和NULL文字的特殊处理"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">十六进制文字，位文字和NULL文字的特殊处理</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#bit-operations-incompatibilities" title="与MySQL 5.7的位操作不兼容"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与MySQL 5.7的位操作不兼容</font></font></a></p></li></ul>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="bit-operations-5-7"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL 8.0之前的位操作</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL 8.0之前的位操作只处理无符号的64位整数参数和结果值（即无符号
         </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值）。</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要时</font><font style="vertical-align: inherit;">转换其他类型的参数
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例子：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此语句对数字文字进行操作，视为无符号64位整数：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 127 | 128, 128 &lt;&lt; 2, BIT_COUNT(15);</code></strong><font></font>
+-----------+----------+---------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">127 | </font><font style="vertical-align: inherit;">128 | </font><font style="vertical-align: inherit;">128 &lt;&lt; 2 | </font><font style="vertical-align: inherit;">BIT_COUNT（15）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+----------+---------------+</font></font><font></font>
|       255 |      512 |             4 |<font></font>
+-----------+----------+---------------+<font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在执行与第一个语句相同的操作并生成相同的结果之前，</font><font style="vertical-align: inherit;">
            此语句对字符串参数（</font></font><code class="literal">'127'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to
             </font></font><code class="literal">127</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等）</font><font style="vertical-align: inherit;">执行to-number转换</font><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT '127' | '128', '128' &lt;&lt; 2, BIT_COUNT('15');</code></strong><font></font>
+---------------+------------+-----------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">'127'| </font><font style="vertical-align: inherit;">'128'| </font><font style="vertical-align: inherit;">'128'&lt;&lt; 2 | </font><font style="vertical-align: inherit;">BIT_COUNT（'15'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------+------------+-----------------+</font></font><font></font>
|           255 |        512 |               4 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------+------------+-----------------+</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此语句将十六进制文字用于位操作参数。</font><font style="vertical-align: inherit;">默认情况下，MySQL将十六进制文字视为二进制字符串，但在数字上下文中将它们计算为数字（请参见
             </font></font><a class="xref" href="language-structure.html#hexadecimal-literals" title="9.1.4十六进制文字"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9.1.4节“十六进制文字”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">在MySQL 8.0之前，数字上下文包括位操作。</font><font style="vertical-align: inherit;">例子：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT X'7F' | X'80', X'80' &lt;&lt; 2, BIT_COUNT(X'0F');</code></strong><font></font>
+---------------+------------+------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">X'7F'| </font><font style="vertical-align: inherit;">X'80'| </font><font style="vertical-align: inherit;">X'80'&lt;&lt; 2 | </font><font style="vertical-align: inherit;">BIT_COUNT（X'0F'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------+------------+------------------+</font></font><font></font>
|           255 |        512 |                4 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------+------------+------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            位操作中位值文字的处理类似于十六进制文字（即数字）。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="bit-operations-8-0"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL 8.0中的位操作</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL 8.0扩展位操作以直接处理二进制字符串参数（无需转换）并生成二进制字符串结果。</font><font style="vertical-align: inherit;">（非整数或二进制字符串的参数仍然像以前一样转换为整数。）此扩展通过以下方式增强位操作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在长于64位的值上可以进行位操作。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对更自然地表示为二进制字符串而不是整数的值执行位操作更容易。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        例如，考虑UUID值和IPv6地址，它们具有如下所示的人类可读文本格式：
      </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UUID：6ccd780c-baba-1026-9564-5b8c656024db</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPv6：fe80 :: 219：d1ff：fe91：1a72</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以这些格式操作文本字符串是很麻烦的。</font><font style="vertical-align: inherit;">另一种方法是将它们转换为没有分隔符的固定长度的二进制字符串。</font></font><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        并且</font></font><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个产生一个数据类型的值</font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY(16)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，一个16字节（128位）长的二进制字符串。</font><font style="vertical-align: inherit;">以下语句说明了这一点（</font></font><code class="literal">HEX()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于生成可显示的值）：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(UUID_TO_BIN('6ccd780c-baba-1026-9564-5b8c656024db'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（UUID_TO_BIN（'6ccd780c-baba-1026-9564-5b8c656024db'））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6CCD780CBABA102695645B8C656024DB |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(INET6_ATON('fe80::219:d1ff:fe91:1a72'));</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（INET6_ATON（'fe80 :: 219：d1ff：fe91：1a72'））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">FE800000000000000219D1FFFE911A72 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些二进制值可以通过位操作轻松操作，以执行诸如从UUID值中提取时间戳或提取IPv6地址的网络和主机部分等操作。</font><font style="vertical-align: inherit;">（例如，请参阅本讨论的后面部分。）
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该计为二进制字符串参数包括列值，例程参数，局部变量和用户定义的变量具有一个二进制串类型：
         </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或的一个
         </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        那么十六进制文字和位文字呢？</font><font style="vertical-align: inherit;">回想一下，默认情况下这些是MySQL中的二进制字符串，但是数字上下文中的数字。</font><font style="vertical-align: inherit;">它们如何处理MySQL 8.0中的位操作？</font><font style="vertical-align: inherit;">MySQL是否继续在数字上下文中评估它们，就像MySQL 8.0之前一样？</font><font style="vertical-align: inherit;">或做位操作评估它们作为二进制字符串，现在二进制字符串可以办理</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本地</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，无需转换？
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        答：通常使用十六进制文字或位文字指定位操作的参数，意图表示数字，因此当所有位参数都是十六进制或位文字时，MySQL继续在数值上下文中评估位操作，以实现向后兼容性。</font><font style="vertical-align: inherit;">如果您需要将评估作为二进制字符串，那么很容易实现：使用</font></font><code class="literal">_binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">至少一个文字</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">介绍人。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            这些位操作将十六进制文字和位文字计算为整数：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT X'40' | X'01', b'11110001' &amp; b'01001111';</code></strong><font></font>
+---------------+---------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">X'40'| </font><font style="vertical-align: inherit;">X'01'| </font><font style="vertical-align: inherit;">b'11110001'＆b'01001111'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------+---------------------------+</font></font><font></font>
|            65 |                        65 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------+---------------------------+</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            由于</font></font><code class="literal">_binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍人的</font><font style="vertical-align: inherit;">原因，这些位操作将十六进制文字和位文字评估为二进制字符串
             </font><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT _binary X'40' | X'01', b'11110001' &amp; _binary b'01001111';</code></strong><font></font>
+-----------------------+-----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">_binary X'40'| </font><font style="vertical-align: inherit;">X'01'| </font><font style="vertical-align: inherit;">b'11110001'＆_binary b'01001111'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">A | </font><font style="vertical-align: inherit;">A |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+-----------------------------------+</font></font><font></font>
</pre></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        尽管两个语句中的位操作产生的数值为65，但第二个语句在二进制字符串上下文中运行，其中65为ASCII
         </font></font><code class="literal">A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在数值计算上下文中，十六进制文字和位文字参数的允许值最多为64位，结果也是如此。</font><font style="vertical-align: inherit;">相反，在二进制字符串评估上下文中，允许的参数（和结果）可以超过64位：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT _binary X'4040404040404040' | X'0102030405060708';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">_binary X'4040404040404040'| </font><font style="vertical-align: inherit;">X'0102030405060708'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ABCDEFGH |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有几种方法可以在位操作中引用十六进制文字或位文字来引起二进制字符串评估：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_binary </font></font><em class="replaceable"><code>literal</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BINARY </font></font><em class="replaceable"><code>literal</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CAST（</font></font><em class="replaceable"><code>literal</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为二进制）
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        生成十六进制文字或位文字的二进制字符串评估的另一种方法是将它们分配给用户定义的变量，这会导致变量具有二进制字符串类型：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @v1 = X'40', @v2 = X'01', @v3 = b'11110001', @v4 = b'01001111';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT @v1 | @v2, @v3 &amp; @v4;</code></strong><font></font>
+-----------+-----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@ v1 | </font><font style="vertical-align: inherit;">@ v2 | </font><font style="vertical-align: inherit;">@ v3＆@ v4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+-----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">A | </font><font style="vertical-align: inherit;">A |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+-----------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在二进制字符串上下文中，按位操作参数必须具有相同的长度或发生
         </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_operands_size"><code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        错误：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT _binary X'40' | X'0001';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ERROR 3513（HY000）：按位的二进制操作数</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
运营商必须具有相同的长度</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要满足等长要求，请使用前导零位填充较短的值，或者如果较长的值以前导零位开头并且可接受较短的结果值，请将它们剥离：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT _binary X'0040' | X'0001';</code></strong><font></font>
+---------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">_binary X'0040'| </font><font style="vertical-align: inherit;">X'0001'|</font></font><font></font>
+---------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">A |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT _binary X'40' | X'01';</code></strong><font></font>
+-----------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">_binary X'40'| </font><font style="vertical-align: inherit;">X'01'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">A |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        填充或汽提也可以使用的功能，例如来实现</font></font><a class="link" href="functions.html#function_lpad"><code class="literal">LPAD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="functions.html#function_rpad"><code class="literal">RPAD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="functions.html#function_substr"><code class="literal">SUBSTR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
         </font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，表达式参数不再是所有文字而
         </font></font><code class="literal">_binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变得不必要。</font><font style="vertical-align: inherit;">例子：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LPAD(X'40', 2, X'00') | X'0001';</code></strong><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LPAD（X'40'，2，X'00'）| </font><font style="vertical-align: inherit;">X'0001'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">A |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT X'40' | SUBSTR(X'0001', 2, 1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">X'40'| </font><font style="vertical-align: inherit;">SUBSTR（X'0001'，2,1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">A |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="bit-operations-binary-string-examples"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二进制字符串位操作示例</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下示例说明如何使用位操作来提取UUID值的一部分，在本例中为时间戳和IEEE 802节点号。</font><font style="vertical-align: inherit;">该技术需要每个提取部分的位掩码。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        将文本UUID转换为相应的16字节二进制值，以便可以使用二进制字符串上下文中的位操作来操作它：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @uuid = UUID_TO_BIN('6ccd780c-baba-1026-9564-5b8c656024db');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT HEX(@uuid);</code></strong><font></font>
+----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（@uuid）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6CCD780CBABA102695645B8C656024DB |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        构造值的时间戳和节点号部分的位掩码。</font><font style="vertical-align: inherit;">时间戳包括前三个部分（64位，位0到63），节点号是最后一部分（48位，位80到127）：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ts_mask = CAST(X'FFFFFFFFFFFFFFFF' AS BINARY(16));</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @node_mask = CAST(X'FFFFFFFFFFFF' AS BINARY(16)) &gt;&gt; 80;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT HEX(@ts_mask);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（@ts_mask）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">FFFFFFFFFFFFFFFF0000000000000000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(@node_mask);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（@node_mask）|</font></font><font></font>
+----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">00000000000000000000FFFFFFFFFFFF |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><code class="literal">CAST(... AS BINARY(16))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能用在这里，因为掩模必须是相同的长度作为对它们所施加的UUID值。</font><font style="vertical-align: inherit;">使用其他函数将掩码填充到所需长度可以产生相同的结果：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @ ts_mask = RPAD（X'FFFFFFFFFFFFFFFF'，16，X'00'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @node_mask = LPAD（X'FFFFFFFFFFFF'，16，X'00'）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用掩码来提取时间戳和节点号部分：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(@uuid &amp; @ts_mask) AS 'timestamp part';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">时间戳部分|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。</font><font style="vertical-align: inherit;">6CCD780CBABA10260000000000000000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(@uuid &amp; @node_mask) AS 'node part';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">节点部分|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">000000000000000000005B8C656024DB |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        前面的示例使用这些位操作：right shift（</font></font><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）和按位AND（</font></font><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
          <a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取一个标志，导致在生成的二进制UUID值中进行一些位重新排列。</font><font style="vertical-align: inherit;">如果使用该标志，请相应地修改提取掩码。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        下一个示例使用位操作来提取IPv6地址的网络和主机部分。</font><font style="vertical-align: inherit;">假设网络部分的长度为80位。</font><font style="vertical-align: inherit;">然后主机部分的长度为128-80 = 48位。</font><font style="vertical-align: inherit;">要提取地址的网络和主机部分，将其转换为二进制字符串，然后在二进制字符串上下文中使用位操作。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        将文本IPv6地址转换为相应的二进制字符串：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @ip = INET6_ATON('fe80::219:d1ff:fe91:1a72');</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以位为单位定义网络长度：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @net_len = 80;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        通过向左或向右移动全1地址来构造网络和主机掩码。</font><font style="vertical-align: inherit;">要做到这一点，请从地址开始
         </font></font><code class="literal">::</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这是所有零的简写，正如您可以通过将其转换为二进制字符串所示：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(INET6_ATON('::')) AS 'all zeros';</code></strong><font></font>
+----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">全零|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
| 00000000000000000000000000000000 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要生成互补值（全1），请使用
         </font></font><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        运算符反转位：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(~INET6_ATON('::')) AS 'all ones';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">所有的|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        向左或向右移动全1值以生成网络和主机掩码：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @net_mask = ~INET6_ATON('::') &lt;&lt; (128 - @net_len);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SET @host_mask = ~INET6_ATON('::') &gt;&gt; @net_len;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        显示掩码以验证它们是否覆盖了地址的正确部分：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT INET6_NTOA(@net_mask) AS 'network mask';</code></strong><font></font>
+----------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">网络掩码|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ffff：ffff：ffff：ffff：ffff :: |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT INET6_NTOA(@host_mask) AS 'host mask';</code></strong><font></font>
+------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">主机面具|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">:: ffff：255.255.255.255 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        提取并显示地址的网络和主机部分：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @net_part = @ip &amp; @net_mask;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @host_part = @ip &amp; @host_mask;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT INET6_NTOA(@net_part) AS 'network part';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">网络部分|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">fe80 :: 219：0：0：0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT INET6_NTOA(@host_part) AS 'host part';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">主持人部分|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">:: d1ff：fe91：1a72 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        前面的示例使用这些位操作：Complement（</font></font><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），left shift（</font></font><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）和按位AND（</font></font><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        其余的讨论提供了有关每组位操作的参数处理的详细信息，有关位操作中字面值处理的更多信息，以及MySQL 8.0和旧MySQL版本之间潜在的不兼容性。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="bit-operations-and-or-xor"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按位AND，OR和XOR运算</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于</font></font><a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位操作，结果类型取决于参数是作为二进制字符串还是数字计算：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            当参数具有二进制字符串类型时，会发生二进制字符串评估，并且其中至少有一个不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            文字。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数转换为无符号64位整数。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            二进制字符串求值会生成与参数长度相同的二进制字符串。</font><font style="vertical-align: inherit;">如果参数长度不等，
             </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_operands_size"><code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            则会发生错误。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        数值评估的例子：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 64 | 1, X'40' | X'01';</code></strong><font></font>
+--------+---------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">64 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">X'40'| </font><font style="vertical-align: inherit;">X'01'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+---------------+</font></font><font></font>
|     65 |            65 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+---------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        二进制字符串评估的示例：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT _binary X'40' | X'01';</code></strong><font></font>
+-----------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">_binary X'40'| </font><font style="vertical-align: inherit;">X'01'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">A |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @var1 = X'40', @var2 = X'01';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT @var1 | @var2;</code></strong><font></font>
+---------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@ var1 | </font><font style="vertical-align: inherit;">@ var2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">A |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------+</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="bit-operations-complement-shift"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按位补充和移位操作</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于</font></font><a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        位操作，结果类型取决于bit参数是否被计算为二进制字符串或数字：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            当bit参数具有二进制字符串类型且不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字</font><font style="vertical-align: inherit;">时，会发生二进制字符串评估</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数转换为无符号的64位整数。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            二进制字符串评估生成与bit参数长度相同的二进制字符串。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于移位操作，无论参数类型如何，在值结束时移位的位都会在没有警告的情况下丢失。</font><font style="vertical-align: inherit;">特别是，如果移位计数大于或等于位参数中的位数，则结果中的所有位都为0。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        数值评估的例子：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ~0, 64 &lt;&lt; 2, X'40' &lt;&lt; 2;</code></strong><font></font>
+----------------------+---------+------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">〜0 | </font><font style="vertical-align: inherit;">64 &lt;&lt; 2 | </font><font style="vertical-align: inherit;">X'40'&lt;&lt; 2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+---------+------------+</font></font><font></font>
| 18446744073709551615 |     256 |        256 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+---------+------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        二进制字符串评估的示例：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(_binary X'1111000022220000' &gt;&gt; 16);</code></strong><font></font>
+----------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（_binary X'1111000022220000'&gt;&gt; 16）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font>
| 0000111100002222                       |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(_binary X'1111000022220000' &lt;&lt; 16);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（_binary X'1111000022220000'&lt;&lt; 16）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font>
| 0000222200000000                       |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @var1 = X'F0F0F0F0';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT HEX(~@var1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（〜@ var1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">0F0F0F0F |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="bit-operations-bit-count"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BIT_COUNT（）操作</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><a class="link" href="functions.html#function_bit-count"><code class="literal">BIT_COUNT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数始终返回无符号的64位整数，或者</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果参数为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIT_COUNT(127);</code></strong><font></font>
+----------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">BIT_COUNT（127）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------+</font></font><font></font>
|              7 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIT_COUNT(b'010101'), BIT_COUNT(_binary b'010101');</code></strong><font></font>
+----------------------+------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">BIT_COUNT（b'010101'）| </font><font style="vertical-align: inherit;">BIT_COUNT（_binary b'010101'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+------------------------------+</font></font><font></font>
|                    3 |                            3 |<font></font>
+----------------------+------------------------------+<font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="bit-operations-bit-aggregate"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BIT_AND（），BIT_OR（）和BIT_XOR（）操作</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于</font></font><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位的功能，结果类型取决于该函数的参数值是否被评价为二进制字符串或数字：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            当参数值具有二进制字符串类型且参数不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            文字</font><font style="vertical-align: inherit;">时，会发生二进制字符串评估</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数值转换为无符号64位整数。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            二进制字符串评估生成与参数值长度相同的二进制字符串。</font><font style="vertical-align: inherit;">如果参数值具有不相等的长度，
             </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_operands_size"><code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            则会发生错误。</font><font style="vertical-align: inherit;">如果参数大小超过511个字节，
             </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_aggregate_operands_size"><code class="literal">ER_INVALID_BITWISE_AGGREGATE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            则会发生错误。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p>
        <code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非所有值都是，否则值不会影响结果</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，结果是一个中性值，其长度与参数值的长度相同（所有位1表示
         </font></font><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，所有位0表示
         </font></font><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
         </font></font><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        例：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (group_id INT, a VARBINARY(6));</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES (1, NULL);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES (1, NULL);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES (2, NULL);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES (2, X'1234');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES (2, X'FF34');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT HEX(BIT_AND(a)), HEX(BIT_OR(a)), HEX(BIT_XOR(a))</code></strong>
       <strong class="userinput"><code>FROM t GROUP BY group_id;</code></strong><font></font>
+-----------------+----------------+-----------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（BIT_AND（a））| </font><font style="vertical-align: inherit;">HEX（BIT_OR（a））| </font><font style="vertical-align: inherit;">HEX（BIT_XOR（a））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+----------------+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">FFFFFFFFFFFF | </font><font style="vertical-align: inherit;">000000000000 | </font><font style="vertical-align: inherit;">000000000000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1234 | </font><font style="vertical-align: inherit;">FF34 | </font><font style="vertical-align: inherit;">ED00 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+----------------+-----------------+</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="bit-operations-literal-handling"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">十六进制文字，位文字和NULL文字的特殊处理</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        为了向后兼容，当所有位参数都是十六进制文字，位文字或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字</font><font style="vertical-align: inherit;">时，MySQL 8.0会在数值上下文中评估位操作</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">也就是说，如果所有位参数都是非简化的十六进制文字，位文字或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        文字</font><font style="vertical-align: inherit;">，则对二进制字符串位参数的位操作不使用二进制字符串求值</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（如果这些文字是使用</font></font><code class="literal">_binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍人，
         </font></font><a class="link" href="functions.html#operator_binary"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作符或其他明确指定为二进制字符串的方式</font><font style="vertical-align: inherit;">编写的，则不适用于此类文字</font><font style="vertical-align: inherit;">。）
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        刚刚描述的文字处理与MySQL 8.0之前的处理相同。</font><font style="vertical-align: inherit;">例子：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            这些位操作在数值上下文中计算文字并生成</font></font><code class="literal">BIGINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b'0001'| </font><font style="vertical-align: inherit;">b'0010'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
X'0008'&lt;&lt; 8</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            这些位操作</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在数值上下文中计算并生成</font></font><code class="literal">BIGINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            具有</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结果</font><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL和NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NULL &gt;&gt; 4</font></font><font></font>
</pre></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在MySQL 8.0中，您可以通过明确指示至少一个参数是二进制字符串，使这些操作评估二进制字符串上下文中的参数：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_binary b'0001'| </font><font style="vertical-align: inherit;">b'0010'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
_binary X'0008'&lt;&lt; 8</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BINARY NULL＆NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BINARY NULL &gt;&gt; 4</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        最后两个表达式的结果
         </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与没有
         </font></font><code class="literal">BINARY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算符一样，但结果的数据类型是二进制字符串类型而不是整数类型。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="bit-operations-incompatibilities"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与MySQL 5.7的位操作不兼容</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        因为位操作可以在MySQL 8.0中本地处理二进制字符串参数，所以某些表达式在MySQL 8.0中产生的结果与在5.7中不同。</font><font style="vertical-align: inherit;">需要注意的五个有问题的表达类型是：
      </font></font></p><pre data-lang="sql" class="programlisting"><em class="replaceable"><code>nonliteral_binary</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{＆| </font><font style="vertical-align: inherit;">^} </font><font style="vertical-align: inherit;">  {＆| </font><font style="vertical-align: inherit;">^} </font><font style="vertical-align: inherit;">{&lt;&lt; &gt;&gt;} </font><font style="vertical-align: inherit;">
〜</font><font style="vertical-align: inherit;">（</font><font style="vertical-align: inherit;">）
</font></font><em class="replaceable"><code>binary</code></em>
<em class="replaceable"><code>binary</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>nonliteral_binary</code></em>
<em class="replaceable"><code>nonliteral_binary</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>anything</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>nonliteral_binary</code></em>
<em class="replaceable"><code>AGGR_BIT_FUNC</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>nonliteral_binary</code></em><font style="vertical-align: inherit;"></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些表达式</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在MySQL 5.7中</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">，在8.0中</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">二进制字符串。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        符号说明：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">{ <em class="replaceable"><code>op1</code></em>
            <em class="replaceable"><code>op2</code></em> ... }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：适用于给定表达式类型的运算符列表。
          </font></font></p></li><li class="listitem"><p>
            <em class="replaceable"><code>binary</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：任何类型的二进制字符串参数，包括十六进制文字，位文字或
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字。
          </font></font></p></li><li class="listitem"><p>
            <em class="replaceable"><code>nonliteral_binary</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：一个参数，它是二进制字符串值，而不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字。
          </font></font></p></li><li class="listitem"><p>
            <em class="replaceable"><code>AGGR_BIT_FUNC</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：一个聚集函数，它位值参数：
             </font></font><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关如何准备在MySQL 5.7为MySQL 5.7和8.0之间的潜在的不兼容信息，请参见
         </font></font><a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/bit-functions.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位函数和操作符</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，在
         </font></font><a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的5.7参考手册</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下列表描述了可用的位功能和运算符：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="operator_bitwise-or"></a><p>
            <a class="indexterm" name="idm140091681721648"></a>

            <a class="indexterm" name="idm140091681720576"></a>

            <a class="link" href="functions.html#operator_bitwise-or"><code class="literal">|</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            按位OR。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果类型取决于参数是作为二进制字符串还是数字计算：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                当参数具有二进制字符串类型时，会发生二进制字符串评估，并且其中至少有一个不是十六进制文字，位字面值或
                 </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数转换为无符号64位整数。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                二进制字符串求值会生成与参数长度相同的二进制字符串。</font><font style="vertical-align: inherit;">如果参数长度不等，
                 </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_operands_size"><code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关更多信息，请参阅本节中的介绍性讨论。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 29 | 15;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 31</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT _binary X'40404040' | X'01020304';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'ABCD'</font></font><font></font>
</pre></li><li class="listitem"><a name="operator_bitwise-and"></a><p>
            <a class="indexterm" name="idm140091681704848"></a>

            <a class="indexterm" name="idm140091681703760"></a>

            <a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            按位AND。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果类型取决于参数是作为二进制字符串还是数字计算：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                当参数具有二进制字符串类型时，会发生二进制字符串评估，并且其中至少有一个不是十六进制文字，位字面值或
                 </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数转换为无符号64位整数。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                二进制字符串求值会生成与参数长度相同的二进制字符串。</font><font style="vertical-align: inherit;">如果参数长度不等，
                 </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_operands_size"><code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关更多信息，请参阅本节中的介绍性讨论。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 29 &amp; 15;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 13</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(_binary X'FF' &amp; b'11110000');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'F0'</font></font><font></font>
</pre></li><li class="listitem"><a name="operator_bitwise-xor"></a><p>
            <a class="indexterm" name="idm140091681688032"></a>

            <a class="indexterm" name="idm140091681686960"></a>

            <a class="link" href="functions.html#operator_bitwise-xor"><code class="literal">^</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            按位异或。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果类型取决于参数是作为二进制字符串还是数字计算：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                当参数具有二进制字符串类型时，会发生二进制字符串评估，并且其中至少有一个不是十六进制文字，位字面值或
                 </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数转换为无符号64位整数。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                二进制字符串求值会生成与参数长度相同的二进制字符串。</font><font style="vertical-align: inherit;">如果参数长度不等，
                 </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_operands_size"><code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关更多信息，请参阅本节中的介绍性讨论。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 1 ^ 1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 1 ^ 0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 11 ^ 3;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 8</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(_binary X'FEDC' ^ X'1111');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'EFCD'</font></font><font></font>
</pre></li><li class="listitem"><a name="operator_left-shift"></a><p>
            <a class="indexterm" name="idm140091681669872"></a>

            <a class="link" href="functions.html#operator_left-shift"><code class="literal">&lt;&lt;</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            将longlong（</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）数字或二进制字符串向左</font><font style="vertical-align: inherit;">移位</font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果类型取决于bit参数是否被计算为二进制字符串或数字：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                当bit参数具有二进制字符串类型且不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                文字</font><font style="vertical-align: inherit;">时，会发生二进制字符串评估</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数转换为无符号的64位整数。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                二进制字符串评估生成与bit参数长度相同的二进制字符串。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            无论参数类型如何，在没有警告的情况下，在值结束时移位的位都会丢失。</font><font style="vertical-align: inherit;">特别是，如果移位计数大于或等于位参数中的位数，则结果中的所有位都为0。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关更多信息，请参阅本节中的介绍性讨论。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 1 &lt;&lt; 2;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 4</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(_binary X'00FF00FF00FF' &lt;&lt; 8);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'FF00FF00FF00'</font></font><font></font>
</pre></li><li class="listitem"><a name="operator_right-shift"></a><p>
            <a class="indexterm" name="idm140091681653792"></a>

            <a class="link" href="functions.html#operator_right-shift"><code class="literal">&gt;&gt;</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            将longlong（</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）数字或二进制字符串向右</font><font style="vertical-align: inherit;">移位</font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果类型取决于bit参数是否被计算为二进制字符串或数字：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                当bit参数具有二进制字符串类型且不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                文字</font><font style="vertical-align: inherit;">时，会发生二进制字符串评估</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数转换为无符号的64位整数。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                二进制字符串评估生成与bit参数长度相同的二进制字符串。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            无论参数类型如何，在没有警告的情况下，在值结束时移位的位都会丢失。</font><font style="vertical-align: inherit;">特别是，如果移位计数大于或等于位参数中的位数，则结果中的所有位都为0。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关更多信息，请参阅本节中的介绍性讨论。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 4 &gt;&gt; 2;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(_binary X'00FF00FF00FF' &gt;&gt; 8);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'0000FF00FF00'</font></font><font></font>
</pre></li><li class="listitem"><a name="operator_bitwise-invert"></a><p>
            <a class="indexterm" name="idm140091681637744"></a>

            <a class="link" href="functions.html#operator_bitwise-invert"><code class="literal">~</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            反转所有位。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果类型取决于bit参数是否被计算为二进制字符串或数字：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                当bit参数具有二进制字符串类型且不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                文字</font><font style="vertical-align: inherit;">时，会发生二进制字符串评估</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数转换为无符号的64位整数。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                二进制字符串评估生成与bit参数长度相同的二进制字符串。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关更多信息，请参阅本节中的介绍性讨论。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 5 &amp; ~1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 4</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(~X'0000FFFF1111EEEE');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'FFFF0000EEEE1111'</font></font><font></font>
</pre></li><li class="listitem"><a name="function_bit-count"></a><p>
            <a class="indexterm" name="idm140091681623712"></a>

            <a class="link" href="functions.html#function_bit-count"><code class="literal">BIT_COUNT(<em class="replaceable"><code>N</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回参数中设置的位数，
             </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为无符号的64位整数，或者</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是否为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIT_COUNT(64), BIT_COUNT(BINARY 64);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1,7</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIT_COUNT('64'), BIT_COUNT(_binary '64');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1,7</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIT_COUNT(X'40'), BIT_COUNT(_binary X'40');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1,1</font></font><font></font>
</pre></li></ul>
</div>

</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="encryption-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.13加密和压缩功能</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091681611520"></a><a class="indexterm" name="idm140091681610480"></a>
<div class="table">
<a name="idm140091681608992"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.17加密功能</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists encryption functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用AES解密
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用AES加密
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-decrypt"><code class="literal">ASYMMETRIC_DECRYPT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用私钥或公钥解密密文
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-derive"><code class="literal">ASYMMETRIC_DERIVE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从非对称密钥导出对称密钥
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用私钥或公钥加密明文
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-sign"><code class="literal">ASYMMETRIC_SIGN()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从摘要生成签名
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-verify"><code class="literal">ASYMMETRIC_VERIFY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      验证签名是否与摘要匹配
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_compress"><code class="literal">COMPRESS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将结果作为二进制字符串返回
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      创建私钥
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-pub-key"><code class="literal">CREATE_ASYMMETRIC_PUB_KEY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      创建公钥
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      生成共享DH密钥
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-digest"><code class="literal">CREATE_DIGEST()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从字符串生成摘要
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_decode"><code class="literal">DECODE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      解码使用ENCODE（）加密的字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_des-decrypt"><code class="literal">DES_DECRYPT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      解密一个字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_des-encrypt"><code class="literal">DES_ENCRYPT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      加密字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_encode"><code class="literal">ENCODE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      编码一个字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_encrypt"><code class="literal">ENCRYPT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      加密字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      计算MD5校验和
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      计算并返回密码字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回一个随机字节向量
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">SHA()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      计算SHA-1 160位校验和
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      计算SHA-2校验和
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_statement-digest"><code class="literal">STATEMENT_DIGEST()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      计算语句摘要哈希值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_statement-digest-text"><code class="literal">STATEMENT_DIGEST_TEXT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      计算规范化语句摘要
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uncompress"><code class="literal">UNCOMPRESS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      解压缩压缩的字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uncompressed-length"><code class="literal">UNCOMPRESSED_LENGTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      压缩前返回字符串的长度
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_validate-password-strength"><code class="literal">VALIDATE_PASSWORD_STRENGTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      确定密码的强度
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      许多加密和压缩函数返回结果可能包含任意字节值的字符串。</font><font style="vertical-align: inherit;">如果你想存储这些结果，使用与一列
       </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二进制字符串数据类型。</font><font style="vertical-align: inherit;">这将避免可能会更改数据值的尾随空格删除或字符集转换的潜在问题，例如，如果使用非二进制字符串数据类型（</font><font style="vertical-align: inherit;">，
       </font><font style="vertical-align: inherit;">）</font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font><font style="vertical-align: inherit;">则可能会出现此问题</font><font style="vertical-align: inherit;">。
    </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一些加密函数返回ASCII字符的字符串：
       </font></font><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_sha1"><code class="literal">SHA()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_statement-digest"><code class="literal">STATEMENT_DIGEST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="functions.html#function_statement-digest-text"><code class="literal">STATEMENT_DIGEST_TEXT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它们的返回值是一个字符串，它具有由</font><font style="vertical-align: inherit;">系统变量</font></font><a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">确定的字符集和排序规则
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">除非字符集是，否则这是非二进制字符串
       </font></font><code class="literal">binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果应用程序存储来自诸如</font></font><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回十六进制数字字符串的</font><font style="vertical-align: inherit;">函数的值，
       </font><font style="vertical-align: inherit;">则可以通过将十六进制表示转换为二进制</font></font><a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">将结果存储在
       </font><font style="vertical-align: inherit;">
      列中</font><font style="vertical-align: inherit;">来获得更有效的存储和比较
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每对十六进制数字需要二进制形式的一个字节，因此值</font><font style="vertical-align: inherit;">取决于十六进制字符串的长度。</font><font style="vertical-align: inherit;">值为16，</font><font style="vertical-align: inherit;">值为20
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于
       </font><font style="vertical-align: inherit;">，
       </font><font style="vertical-align: inherit;">范围从28到32，具体取决于指定结果的所需位长度的参数。
    </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY(<em class="replaceable"><code>N</code></em>)</code></a><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code></a><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将十六进制字符串存储在</font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">的大小惩罚
       </font><font style="vertical-align: inherit;">至少为两次，如果该值存储在使用该</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集</font><font style="vertical-align: inherit;">的列中</font><font style="vertical-align: inherit;">（每个字符使用4个字节）</font><font style="vertical-align: inherit;">，则最多为八次
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">存储字符串还会导致比较较慢，因为值较大且需要考虑字符集排序规则。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      假设应用程序将</font></font><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符串值</font><font style="vertical-align: inherit;">存储
       </font><font style="vertical-align: inherit;">在
       </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR(32)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE TABLE md5_tbl（md5_val CHAR（32），...）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INSERT INTO md5_tbl（md5_val，...）VALUES（MD5（'abcdef'），...）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以十六进制字符串转换为更紧凑的形式，修改使用应用程序</font></font><a class="link" href="functions.html#function_unhex"><code class="literal">UNHEX()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并
       </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY(16)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为如下：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE TABLE md5_tbl（md5_val BINARY（16），...）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INSERT INTO md5_tbl（md5_val，...）VALUES（UNHEX（MD5（'abcdef'）），...）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      应该准备应用程序来处理非常罕见的情况，即散列函数为两个不同的输入值产生相同的值。</font><font style="vertical-align: inherit;">使冲突可检测的一种方法是使哈希列成为主键。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        已知对MD5和SHA-1算法的利用。</font><font style="vertical-align: inherit;">您可能希望考虑使用本节中描述的另一种单向加密函数，例如
         </font></font><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除非使用SSL连接，否则作为加密函数参数提供的密码或其他敏感值将以明文形式发送到MySQL服务器。</font><font style="vertical-align: inherit;">此外，这些值将出现在它们所写的任何MySQL日志中。</font><font style="vertical-align: inherit;">为避免这些类型的暴露，应用程序可以在将敏感值发送到服务器之前加密客户端上的敏感值。</font><font style="vertical-align: inherit;">相同的考虑因素适用于加密密钥。</font><font style="vertical-align: inherit;">为了避免暴露这些，应用程序可以使用存储过程来加密和解密服务器端的值。
</font></font></p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_aes-decrypt"></a><p>
          <a class="indexterm" name="idm140091681466000"></a>

          <a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT(<em class="replaceable"><code>crypt_str</code></em>,<em class="replaceable"><code>key_str</code></em>[,<em class="replaceable"><code>init_vector</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能使用官方AES（高级加密标准）算法解密数据。</font><font style="vertical-align: inherit;">有关更多信息，请参阅的说明</font></font><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可选的初始化向量参数，
           </font></font><em class="replaceable"><code>init_vector</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用
           </font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的语句对于基于语句的复制不安全。
        </font></font></p></li><li class="listitem"><a name="function_aes-encrypt"></a><p>
          <a class="indexterm" name="idm140091681453712"></a>

          <a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>key_str</code></em>[,<em class="replaceable"><code>init_vector</code></em>])</code></a>
        </p><p>
          <a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
           </font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用官方的AES（高级加密标准）算法实现数据的加密和解密，该算法以前称为
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rijndael”。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> AES标准允许各种密钥长度。</font><font style="vertical-align: inherit;">默认情况下，这些函数实现具有128位密钥长度的AES。</font><font style="vertical-align: inherit;">可以使用196或256位的密钥长度，如稍后所述。</font><font style="vertical-align: inherit;">密钥长度是性能和安全性之间的权衡。
        </font></font></p><p>
          <a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用密钥字符串</font><font style="vertical-align: inherit;">加密</font><font style="vertical-align: inherit;">字符串
           </font></font><em class="replaceable"><code>key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并返回包含加密输出的二进制字符串。
          </font><font style="vertical-align: inherit;">使用密钥字符串</font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解密加密</font></font><em class="replaceable"><code>crypt_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的字符串</font></font><em class="replaceable"><code>key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并返回原始明文字符串。</font><font style="vertical-align: inherit;">如果任一函数参数是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则函数返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的</font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>crypt_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数可以是任何长度，并且填充被自动添加到
           </font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所以它是所要求的基于块的算法，如AES的块的倍数。</font><font style="vertical-align: inherit;">此</font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font><font style="vertical-align: inherit;">将自动删除此填充
           </font><font style="vertical-align: inherit;">。</font></font><em class="replaceable"><code>crypt_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用以下公式计算</font><font style="vertical-align: inherit;">长度</font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="clike" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 *（trunc（</font></font><em class="replaceable"><code>string_length</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 16）+ 1）
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于128位密钥长度，将密钥传递给</font></font><em class="replaceable"><code>key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">的最安全方法</font><font style="vertical-align: inherit;">是创建一个真正随机的128位值并将其作为二进制值传递。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插入到t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VALUES（1，AES_ENCRYPT（'text'，UNHEX（'F3229A0B371ED2D9441B830D21A390C3'）））;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          密码短语可用于通过对密码短语进行散列来生成AES密钥。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插入到t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VALUES（1，AES_ENCRYPT（'text'，UNHEX（SHA2（'我的秘密密码'，512））））;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不要直接传递密码或密码
           </font></font><em class="replaceable"><code>crypt_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，先将其哈希。</font><font style="vertical-align: inherit;">此文档的早期版本建议使用前一种方法，但不再推荐使用此方法，因为此处显示的示例更安全。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测到无效数据或填充不正确，则返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，</font><font style="vertical-align: inherit;">如果输入数据或密钥无效</font><font style="vertical-align: inherit;">，则可能
           </font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值（可能是垃圾）。
        </font></font></p><p>
          <a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
           </font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许控制块加密模式并采用可选的
           </font></font><em class="replaceable"><code>init_vector</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初始化向量参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              所述</font></font><a class="link" href="server-administration.html#sysvar_block_encryption_mode"><code class="literal">block_encryption_mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              系统变量控制用于基于块的加密算法的模式。</font><font style="vertical-align: inherit;">其默认值为
               </font></font><code class="literal">aes-128-ecb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，表示使用密钥长度128位和ECB模式进行加密。</font><font style="vertical-align: inherit;">有关此变量的允许值的说明，请参见
               </font></font><a class="xref" href="server-administration.html#server-system-variables" title="5.1.8服务器系统变量"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.8节“服务器系统变量”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              可选</font></font><em class="replaceable"><code>init_vector</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              参数为需要它的块加密模式提供初始化向量。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于需要可选</font></font><em class="replaceable"><code>init_vector</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数的</font><font style="vertical-align: inherit;">模式
           </font><font style="vertical-align: inherit;">，它必须是16个字节或更长（忽略超过16个字节）。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>init_vector</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缺少</font><font style="vertical-align: inherit;">则会发生错误</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于不需要的模式</font></font><em class="replaceable"><code>init_vector</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，将忽略该</font><font style="vertical-align: inherit;">模式，
           </font><font style="vertical-align: inherit;">并在指定时生成警告。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以通过调用生成用于初始化向量的随机字节串
           </font></font><a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES(16)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于需要初始化向量的加密模式，必须使用相同的向量进行加密和解密。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET block_encryption_mode = 'aes-256-cbc';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @key_str = SHA2('My secret passphrase',512);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @init_vector = RANDOM_BYTES(16);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @crypt_str = AES_ENCRYPT('text',@key_str,@init_vector);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT AES_DECRYPT(@crypt_str,@key_str,@init_vector);</code></strong><font></font>
+-----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">AES_DECRYPT（@ crypt_str，@ key_str，@ init_vector）|</font></font><font></font>
+-----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">文字|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下表列出了每种允许的块加密模式，支持它的SSL库以及是否需要初始化向量参数。
</font></font></p>
<div class="informaltable">
<table summary="The permitted encryption modes, the SSL libraries that support each mode, and whether the initialization vector argument is required for the mode."><colgroup><col width="30%"><col width="35%"><col width="35%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块加密模式</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持模式的SSL库</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初始化向量必需</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">欧洲央行</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSSL，wolfSSL</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CBC</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSSL，wolfSSL</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CFB1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSSL的</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CFB8</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSSL的</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CFB128</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSSL的</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OFB</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSSL的</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对基于语句的复制</font><font style="vertical-align: inherit;">
          使用
           </font></font><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不安全的语句。
        </font></font></p></li><li class="listitem"><a name="function_compress"></a><p>
          <a class="indexterm" name="idm140091681372480"></a>

          <a class="link" href="functions.html#function_compress"><code class="literal">COMPRESS(<em class="replaceable"><code>string_to_compress</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          压缩字符串并将结果作为二进制字符串返回。</font><font style="vertical-align: inherit;">这个函数要求MySQL已经用压缩库编译，如</font></font><code class="literal">zlib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，返回值始终为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">压缩后的字符串可以解压缩
           </font></font><a class="link" href="functions.html#function_uncompress"><code class="literal">UNCOMPRESS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LENGTH(COMPRESS(REPEAT('a',1000)));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 21</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LENGTH(COMPRESS(''));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LENGTH(COMPRESS('a'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 13</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LENGTH(COMPRESS(REPEAT('a',16)));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 15</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          压缩的字符串内容按以下方式存储：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              空字符串存储为空字符串。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              非空字符串存储为未压缩字符串的4字节长度（低字节优先），后跟压缩字符串。</font><font style="vertical-align: inherit;">如果字符串以空格结尾，</font></font><code class="literal">.</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会添加</font><font style="vertical-align: inherit;">一个额外的</font><font style="vertical-align: inherit;">字符，以避免在结果存储在</font><font style="vertical-align: inherit;">列</font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中时</font><font style="vertical-align: inherit;">对端空间
               </font><font style="vertical-align: inherit;">修剪的问题
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（然而，使用非二进制字符串数据类型如
               </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不建议存储压缩字符串无论如何，因为可能会发生字符集转换。使用
               </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二进制字符串列来代替。）
</font></font></p></li></ul>
</div>
</li><li class="listitem"><a name="function_decode"></a><p>
          <a class="indexterm" name="idm140091681346752"></a>

          <a class="link" href="functions.html#function_decode"><code class="literal">DECODE(<em class="replaceable"><code>crypt_str</code></em>,<em class="replaceable"><code>pass_str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.3中删除了此功能。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          考虑使用</font></font><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          而</font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是。
        </font></font></p></li><li class="listitem"><a name="function_des-decrypt"></a><p>
          <a class="indexterm" name="idm140091681336176"></a>

          <a class="link" href="functions.html#function_des-decrypt"><code class="literal">DES_DECRYPT(<em class="replaceable"><code>crypt_str</code></em>[,<em class="replaceable"><code>key_str</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.3中删除了此功能。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          考虑使用</font></font><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          而</font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是。
        </font></font></p></li><li class="listitem"><a name="function_des-encrypt"></a><p>
          <a class="indexterm" name="idm140091681325600"></a>

          <a class="link" href="functions.html#function_des-encrypt"><code class="literal">DES_ENCRYPT(<em class="replaceable"><code>str</code></em>[,{<em class="replaceable"><code>key_num</code></em>|<em class="replaceable"><code>key_str</code></em>}])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.3中删除了此功能。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          考虑使用</font></font><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          而</font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是。
        </font></font></p></li><li class="listitem"><a name="function_encode"></a><p>
          <a class="indexterm" name="idm140091681314544"></a>

          <a class="link" href="functions.html#function_encode"><code class="literal">ENCODE(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>pass_str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.3中删除了此功能。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          考虑使用</font></font><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          而</font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是。
        </font></font></p></li><li class="listitem"><a name="function_encrypt"></a><p>
          <a class="indexterm" name="idm140091681304000"></a>

          <a class="link" href="functions.html#function_encrypt"><code class="literal">ENCRYPT(<em class="replaceable"><code>str</code></em>[,<em class="replaceable"><code>salt</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.3中删除了此功能。</font><font style="vertical-align: inherit;">对于单向散列，请考虑使用</font></font><a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_md5"></a><p>
          <a class="indexterm" name="idm140091681295072"></a>

          <a class="link" href="functions.html#function_md5"><code class="literal">MD5(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          计算字符串的MD5 128位校验和。</font><font style="vertical-align: inherit;">该值以32个十六进制数字的字符串形式返回，或者
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，返回值可以用作散列键。</font><font style="vertical-align: inherit;">请参阅本节开头的有关有效存储哈希值的说明。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值是连接字符集中的字符串。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果启用了FIPS模式，则
           </font></font><code class="function">MD5()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="security.html#fips-mode" title="6.5 FIPS支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.5节“FIPS支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT MD5('testing');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'ae2b1fca515949e5d54fb22b8ed95575'</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这是</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA Data Security，Inc。MD5消息摘要算法”。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”</font></font></span>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参阅本节开头的有关MD5算法的说明。
        </font></font></p></li><li class="listitem"><a name="function_password"></a><p>
          <a class="indexterm" name="idm140091681279184"></a>

          <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.11中删除了此功能。
        </font></font></p></li><li class="listitem"><a name="function_random-bytes"></a><p>
          <a class="indexterm" name="idm140091681271248"></a>

          <a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES(<em class="replaceable"><code>len</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数返回</font></font><em class="replaceable"><code>len</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用SSL库的随机数生成器生成</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">随机字节</font><font style="vertical-align: inherit;">的二进制字符串
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">允许的值</font></font><em class="replaceable"><code>len</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围为1到1024.对于该范围之外的值，将
           </font></font><a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成警告并返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于为</font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">提供初始化向量
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要在该上下文中使用，</font></font><em class="replaceable"><code>len</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须至少为16.允许更大的值，但忽略超过16的字节。
        </font></font></p><p>
          <a class="link" href="functions.html#function_random-bytes"><code class="literal">RANDOM_BYTES()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成一个随机值，使其结果不确定。</font><font style="vertical-align: inherit;">因此，使用此函数的语句对于基于语句的复制是不安全的。
        </font></font></p></li><li class="listitem"><a name="function_sha1"></a><p>
          <a class="indexterm" name="idm140091681253856"></a>

          <a class="indexterm" name="idm140091681252784"></a>

          <a class="link" href="functions.html#function_sha1"><code class="literal">SHA1(<em class="replaceable"><code>str</code></em>)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_sha1"><code class="literal">SHA(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          计算字符串的SHA-1 160位校验和，如RFC 3174（安全散列算法）中所述。</font><font style="vertical-align: inherit;">该值以40个十六进制数字的字符串形式返回，或者
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此函数的一种可能用途是作为哈希键。</font><font style="vertical-align: inherit;">请参阅本节开头的有关有效存储哈希值的说明。
          </font></font><a class="link" href="functions.html#function_sha1"><code class="literal">SHA()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是的同义词</font></font><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值是连接字符集中的字符串。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT SHA1('abc');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'a9993e364706816aba3e25717850c26c9cd0d89d'</font></font><font></font>
</pre><p>
          <a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以认为是加密更安全的等价物
           </font></font><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，请参阅本节开头的有关MD5和SHA-1算法的说明。
        </font></font></p></li><li class="listitem"><a name="function_sha2"></a><p>
          <a class="indexterm" name="idm140091681233200"></a>

          <a class="link" href="functions.html#function_sha2"><code class="literal">SHA2(<em class="replaceable"><code>str</code></em>,
          <em class="replaceable"><code>hash_length</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          计算SHA-2系列散列函数（SHA-224，SHA-256，SHA-384和SHA-512）。</font><font style="vertical-align: inherit;">第一个参数是要散列的明文字符串。</font><font style="vertical-align: inherit;">第二个参数表示结果的所需位长度，其值必须为224,256,384,512或0（相当于256）。</font><font style="vertical-align: inherit;">如果任一参数是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者哈希长度不是允许值之一，则返回值为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，函数结果是包含所需位数的散列值。</font><font style="vertical-align: inherit;">请参阅本节开头的有关有效存储哈希值的说明。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值是连接字符集中的字符串。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT SHA2('abc', 224);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'23097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7'</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          仅当MySQL已配置SSL支持时，此功能才有效。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="security.html#encrypted-connections" title="6.3使用加密连接"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.3节“使用加密连接”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_sha2"><code class="literal">SHA2()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以认为加密比</font></font><a class="link" href="functions.html#function_md5"><code class="literal">MD5()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font><font style="vertical-align: inherit;">更安全
           </font></font><a class="link" href="functions.html#function_sha1"><code class="literal">SHA1()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_statement-digest"></a><p>
          <a class="link" href="functions.html#function_statement-digest"><code class="literal">STATEMENT_DIGEST(<em class="replaceable"><code>statement</code></em>)</code></a>
        </p><a class="indexterm" name="idm140091681212864"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将SQL语句作为字符串，将语句摘要哈希值作为连接字符集中的字符串返回，或者</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">相关
           </font></font><a class="link" href="functions.html#function_statement-digest-text"><code class="literal">STATEMENT_DIGEST_TEXT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数返回规范化语句摘要。</font><font style="vertical-align: inherit;">有关</font></font><a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="26.10性能模式语句摘要和抽样"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句摘要的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">信息，请参见
           </font><a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="26.10性能模式语句摘要和抽样"><font style="vertical-align: inherit;">第26.10节“性能模式语句摘要和采样”</font></a><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这两个函数都使用MySQL解析器来解析语句。</font><font style="vertical-align: inherit;">如果解析失败，则会发生错误。</font><font style="vertical-align: inherit;">仅当语句作为文字字符串提供时，错误消息才包含解析错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该 </font></font><a class="link" href="server-administration.html#sysvar_max_digest_length"><code class="literal">max_digest_length</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量决定用于计算归一化的语句消化提供给这些功能的最大字节数。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @stmt = 'SELECT * FROM mytable WHERE cola = 10 AND colb = 20';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT STATEMENT_DIGEST(@stmt);</code></strong><font></font>
+------------------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">STATEMENT_DIGEST（@stmt）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3bb95eeade896657c4526e74ff2a2862039d0a0fe8a9e7155b5fe492cbd78387 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT STATEMENT_DIGEST_TEXT(@stmt);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">STATEMENT_DIGEST_TEXT（@stmt）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">SELECT * FROM`mytable` WHERE`cola` =？</font><font style="vertical-align: inherit;">AND`colb` =？</font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_statement-digest-text"></a><p>
          <a class="link" href="functions.html#function_statement-digest-text"><code class="literal">STATEMENT_DIGEST_TEXT(<em class="replaceable"><code>statement</code></em>)</code></a>
        </p><a class="indexterm" name="idm140091681194560"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将SQL语句作为字符串给出，将规范化的语句摘要作为连接字符集中的字符串返回，或者</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关其他讨论和示例，请参阅相关</font></font><a class="link" href="functions.html#function_statement-digest"><code class="literal">STATEMENT_DIGEST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font><font style="vertical-align: inherit;">的说明
           </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_uncompress"></a><p>
          <a class="indexterm" name="idm140091681187200"></a>

          <a class="link" href="functions.html#function_uncompress"><code class="literal">UNCOMPRESS(<em class="replaceable"><code>string_to_uncompress</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          解压缩由</font></font><a class="link" href="functions.html#function_compress"><code class="literal">COMPRESS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">压缩的字符串
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果参数不是压缩值，则结果为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这个函数要求MySQL已经用压缩库编译，如
           </font></font><code class="literal">zlib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，返回值始终为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT UNCOMPRESS(COMPRESS('any string'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'任何字符串'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT UNCOMPRESS('any string');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; NULL</font></font><font></font>
</pre></li><li class="listitem"><a name="function_uncompressed-length"></a><p>
          <a class="indexterm" name="idm140091681173296"></a>

          <a class="link" href="functions.html#function_uncompressed-length"><code class="literal">UNCOMPRESSED_LENGTH(<em class="replaceable"><code>compressed_string</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回压缩字符串压缩之前的长度。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT UNCOMPRESSED_LENGTH(COMPRESS(REPEAT('a',30)));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 30</font></font><font></font>
</pre></li><li class="listitem"><a name="function_validate-password-strength"></a><p>
          <a class="indexterm" name="idm140091681163744"></a>

          <a class="link" href="functions.html#function_validate-password-strength"><code class="literal">VALIDATE_PASSWORD_STRENGTH(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定表示明文密码的参数，此函数返回一个整数以指示密码的强度。</font><font style="vertical-align: inherit;">返回值的范围从0（弱）到100（强）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          密码评估由
           </font><font style="vertical-align: inherit;">组件</font></font><a class="link" href="functions.html#function_validate-password-strength"><code class="literal">VALIDATE_PASSWORD_STRENGTH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成</font></font><code class="literal">validate_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果未安装该组件，则该函数始终返回0.有关安装的信息
           </font></font><code class="literal">validate_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请参见
           </font></font><a class="xref" href="security.html#validate-password" title="6.4.3密码验证组件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.4.3节“密码验证组件”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要检查或配置影响密码测试的参数，请检查或设置由其实现的系统变量
           </font></font><code class="literal">validate_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="security.html#validate-password-options-variables" title="6.4.3.2密码验证选项和变量"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.4.3.2节“密码验证选项和变量”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          密码经过越来越严格的测试，返回值反映了满足哪些测试，如下表所示。</font><font style="vertical-align: inherit;">此外，如果</font></font><a class="link" href="security.html#sysvar_validate_password.check_user_name"><code class="literal">validate_password.check_user_name</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          启用</font><font style="vertical-align: inherit;">了
           </font><font style="vertical-align: inherit;">系统变量且密码与用户名匹配，则
           </font></font><a class="link" href="functions.html#function_validate-password-strength"><code class="literal">VALIDATE_PASSWORD_STRENGTH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          无论如何</font></font><code class="literal">validate_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置</font><font style="vertical-align: inherit;">其他</font><font style="vertical-align: inherit;">系统变量，都</font><font style="vertical-align: inherit;">返回0
           </font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="informaltable">
<table summary="Password tests of the VALIDATE_PASSWORD_STRENGTH() function and the values returned by each password test."><colgroup><col width="60%"><col width="20%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密码测试</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回报价值</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">长度&lt;4</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">长度≥4且&lt;
                </font></font><a class="link" href="security.html#sysvar_validate_password.length"><code class="literal">validate_password.length</code></a></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">满足政策1（</font></font><code class="literal">LOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></td>
              <td>50</td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">满足政策2（</font></font><code class="literal">MEDIUM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></td>
              <td>75</td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">满足政策3（</font></font><code class="literal">STRONG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></td>
              <td>100</td>
</tr></tbody></table>
</div>
</li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="locking-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.14锁定功能</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091681126800"></a><a class="indexterm" name="idm140091681125728"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍用于操作用户级锁的函数。
</font></font></p>
<div class="table">
<a name="idm140091681123760"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.18锁定功能</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists locking functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      获取命名锁
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-free-lock"><code class="literal">IS_FREE_LOCK()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      命名锁是否免费
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-used-lock"><code class="literal">IS_USED_LOCK()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      命名锁是否正在使用; </font><font style="vertical-align: inherit;">返回连接标识符，如果为true
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_release-all-locks"><code class="literal">RELEASE_ALL_LOCKS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      释放所有当前命名的锁
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      释放命名锁
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_get-lock"></a><p>
          <a class="indexterm" name="idm140091681097856"></a>

          <a class="indexterm" name="idm140091681096784"></a>

          <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK(<em class="replaceable"><code>str</code></em>,<em class="replaceable"><code>timeout</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          尝试</font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用超时
           </font></font><em class="replaceable"><code>timeout</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秒</font><font style="vertical-align: inherit;">获取具有字符串给定名称的锁
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">负值
           </font></font><em class="replaceable"><code>timeout</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示无限超时。</font><font style="vertical-align: inherit;">锁是独家的。</font><font style="vertical-align: inherit;">由一个会话持有，其他会话无法获得同名的锁。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果成功获得锁，</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果尝试超时（例如，由于另一个客户端已先前锁定的名称），或者</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误（比如内存溢出或线程与被杀
           </font></font><a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin  - 管理MySQL服务器的客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中mysqladmin杀</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过执行</font></font><a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或隐式地在会话终止时（正常或异常），</font><font style="vertical-align: inherit;">显式释放
           </font><font style="vertical-align: inherit;">
          获得的锁</font><font style="vertical-align: inherit;">。</font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在事务提交或回滚时</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">不会释放</font><font style="vertical-align: inherit;">获得的锁</font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用元数据锁定（MDL）子系统实现。</font><font style="vertical-align: inherit;">可以获取多个同时锁定，
           </font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且不释放任何现有锁定。</font><font style="vertical-align: inherit;">例如，假设您执行以下语句：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT GET_LOCK（'lock1'，10）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT GET_LOCK（'lock2'，10）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT RELEASE_LOCK（'lock2'）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT RELEASE_LOCK（'lock1'）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          第二个</font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取第二个锁，两个
           </font></font><a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用返回1（成功）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          甚至可以为给定会话获取同名的多个锁。</font><font style="vertical-align: inherit;">在获取会话释放其名称的所有锁之前，其他会话无法获取具有该名称的锁。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          获取的唯一命名锁定
           </font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出现在Performance Schema </font></font><a class="link" href="performance-schema.html#metadata-locks-table" title="26.12.12.3 metadata_locks表"><code class="literal">metadata_locks</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表中。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">OBJECT_TYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">柱说，
           </font></font><code class="literal">USER LEVEL LOCK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">OBJECT_NAME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表示锁名。</font><font style="vertical-align: inherit;">在为</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同一</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名称</font><font style="vertical-align: inherit;">获取多个锁的情况下
           </font><font style="vertical-align: inherit;">，只有名称的第一个锁在</font></font><a class="link" href="performance-schema.html#metadata-locks-table" title="26.12.12.3 metadata_locks表"><code class="literal">metadata_locks</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表中</font><font style="vertical-align: inherit;">注册一行
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">名称的后续锁定会增加锁定中的计数器，但不会获取其他元数据锁定。</font></font><a class="link" href="performance-schema.html#metadata-locks-table" title="26.12.12.3 metadata_locks表"><code class="literal">metadata_locks</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">释放名称上的最后一个锁实例时，将删除锁</font><font style="vertical-align: inherit;">的
           </font><font style="vertical-align: inherit;">行。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          获取多个锁的能力意味着客户端之间可能存在死锁。</font><font style="vertical-align: inherit;">发生这种情况时，服务器会选择一个调用者并终止其锁定获取请求并显示
           </font></font><a class="link" href="error-handling.html#error_er_user_lock_deadlock"><code class="literal">ER_USER_LOCK_DEADLOCK</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误。</font><font style="vertical-align: inherit;">此错误不会导致事务回滚。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL对64个字符的锁名称强制执行最大长度。
        </font></font></p><p>
          <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于实现应用程序锁定或模拟记录锁定。</font><font style="vertical-align: inherit;">名称在服务器范围内被锁定。</font><font style="vertical-align: inherit;">如果名称已在一个会话中锁定，</font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          阻止另一个会话请求具有相同名称的锁。</font><font style="vertical-align: inherit;">这使得同意给定锁定名称的客户端能够使用该名称执行协作建议锁定。</font><font style="vertical-align: inherit;">但请注意，它还使不在合作客户端集合中的客户端能够无意或有意地锁定名称，从而阻止任何合作客户端锁定该名称。</font><font style="vertical-align: inherit;">降低这种可能性的一种方法是使用特定于数据库或特定于应用程序的锁名称。</font><font style="vertical-align: inherit;">例如，使用表单</font></font><em class="replaceable"><code>db_name.str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或的
           </font><font style="vertical-align: inherit;">锁名称
           </font></font><em class="replaceable"><code>app_name.str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果多个客户端正在等待锁定，则它们将获取它的顺序是未定义的。</font><font style="vertical-align: inherit;">应用程序不应假设客户端将按照发出锁定请求的顺序获取锁定。
        </font></font></p><p>
          <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于基于语句的复制是不安全的。</font><font style="vertical-align: inherit;">如果在</font></font><a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为时使用此功能，则会记录警告
           </font></font><code class="literal">STATEMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            由于能够获取多个命名锁，因此单个语句可以获取大量锁。</font><font style="vertical-align: inherit;">例如：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INSERT INTO ...从G1中选择GET_LOCK（t1.col_name）;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            这些类型的陈述可能会产生某些不利影响。</font><font style="vertical-align: inherit;">例如，如果语句部分失败并回滚，则仍然存在获取到失败点的锁。</font><font style="vertical-align: inherit;">如果意图是在插入的行和获取的锁之间存在对应关系，则不会满足该意图。</font><font style="vertical-align: inherit;">此外，如果按特定顺序授予锁定很重要，请注意结果集顺序可能会有所不同，具体取决于优化程序选择的执行计划。</font><font style="vertical-align: inherit;">由于这些原因，最好将应用程序限制为每个语句的单个锁定获取调用。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不同的锁定接口可用作插件服务或一组用户定义的函数。</font><font style="vertical-align: inherit;">与由</font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相关函数</font><font style="vertical-align: inherit;">提供的接口不同，此接口提供锁名称空间和不同的读写锁
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关详细信息，请参见</font></font><a class="xref" href="extending-mysql.html#locking-service" title="29.3.1锁定服务"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第29.3.1节“锁定服务”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_is-free-lock"></a><p>
          <a class="indexterm" name="idm140091681046032"></a>

          <a class="link" href="functions.html#function_is-free-lock"><code class="literal">IS_FREE_LOCK(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检查命名的锁是否</font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以自由使用（即未锁定）。</font><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果锁是免费的（没有人正在使用的锁），</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果锁处于使用中，并且
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误（例如，一个不正确的参数）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数对于基于语句的复制不安全。</font><font style="vertical-align: inherit;">如果在</font></font><a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为时使用此功能，则会记录警告
           </font></font><code class="literal">STATEMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_is-used-lock"></a><p>
          <a class="indexterm" name="idm140091681033648"></a>

          <a class="link" href="functions.html#function_is-used-lock"><code class="literal">IS_USED_LOCK(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检查命名的锁是否</font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          正在使用（即锁定）。</font><font style="vertical-align: inherit;">如果是，则返回持有锁的客户端会话的连接标识符。</font><font style="vertical-align: inherit;">否则，它返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数对于基于语句的复制不安全。</font><font style="vertical-align: inherit;">如果在</font></font><a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为时使用此功能，则会记录警告
           </font></font><code class="literal">STATEMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_release-all-locks"></a><p>
          <a class="indexterm" name="idm140091681022560"></a>

          <a class="link" href="functions.html#function_release-all-locks"><code class="literal">RELEASE_ALL_LOCKS()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          释放当前会话持有的所有命名锁，并返回释放的锁数（如果没有则返回0）
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数对于基于语句的复制不安全。</font><font style="vertical-align: inherit;">如果在</font></font><a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为时使用此功能，则会记录警告
           </font></font><code class="literal">STATEMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_release-lock"></a><p>
          <a class="indexterm" name="idm140091681013152"></a>

          <a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          释放由</font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获得
           </font><font style="vertical-align: inherit;">的字符串命名的锁
           </font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果锁被释放，
           </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果锁不是由该线程（在这种情况下，锁定不会被释放）成立，
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果不存在命名的锁。</font><font style="vertical-align: inherit;">如果从未通过调用获得锁定</font></font><a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者之前已经释放</font><font style="vertical-align: inherit;">锁定，则锁定不存在
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="sql-syntax.html#do" title="13.2.3 DO语法"><code class="literal">DO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明使用方便</font></font><a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="sql-syntax.html#do" title="13.2.3 DO语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.2.3节“DO语法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数对于基于语句的复制不安全。</font><font style="vertical-align: inherit;">如果在</font></font><a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为时使用此功能，则会记录警告
           </font></font><code class="literal">STATEMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="information-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.15信息功能</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091680995600"></a><a class="indexterm" name="idm140091680994528"></a>
<div class="table">
<a name="idm140091680993040"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.19信息功能</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists information functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      反复执行表达式
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_charset"><code class="literal">CHARSET()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回参数的字符集
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_coercibility"><code class="literal">COERCIBILITY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回字符串参数的归类强制性值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_collation"><code class="literal">COLLATION()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回字符串参数的排序规则
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回连接的连接ID（线程ID）
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-role"><code class="literal">CURRENT_ROLE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回当前活动角色
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">CURRENT_USER</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      经过身份验证的用户名和主机名
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回默认（当前）数据库名称
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于带有LIMIT子句的SELECT，返回的行数没有LIMIT子句
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_icu-version"><code class="literal">ICU_VERSION()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      ICU库版本
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      最后一次INSERT的AUTOINCREMENT列的值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_roles-graphml"><code class="literal">ROLES_GRAPHML()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回表示内存角色子图的GraphML文档
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      行数已更新
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_schema"><code class="literal">SCHEMA()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      DATABASE（）的同义词
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_session-user"><code class="literal">SESSION_USER()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      USER（）的同义词
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_system-user"><code class="literal">SYSTEM_USER()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      USER（）的同义词
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      客户端提供的用户名和主机名
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_version"><code class="literal">VERSION()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回表示MySQL服务器版本的字符串
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_benchmark"></a><p>
          <a class="indexterm" name="idm140091680924352"></a>

          <a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK(<em class="replaceable"><code>count</code></em>,<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          重复</font><font style="vertical-align: inherit;">执行表达式</font></font><em class="replaceable"><code>count</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次数。</font><font style="vertical-align: inherit;">它可用于计算MySQL处理表达式的速度。</font><font style="vertical-align: inherit;">结果值始终为</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">预期用途来自</font></font><a class="link" href="programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端，它报告查询执行时间：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BENCHMARK(1000000,AES_ENCRYPT('hello','goodbye'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">BENCHMARK（1000000，AES_ENCRYPT（'你好'，'再见'））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font>
|                                                 0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（4.74秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          报告的时间是客户端的已用时间，而不是服务器端的CPU时间。</font><font style="vertical-align: inherit;">建议</font></font><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多次</font><font style="vertical-align: inherit;">执行
           </font><font style="vertical-align: inherit;">，并根据服务器计算机的负载程度来解释结果。
        </font></font></p><p>
          <a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 用于测量标量表达式的运行时性能，这对您使用它和解释结果的方式有一些重要的影响：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              只能使用标量表达式。</font><font style="vertical-align: inherit;">虽然表达式可以是子查询，但它必须返回单个列，最多只返回一行。</font><font style="vertical-align: inherit;">例如，</font></font><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK(10, (SELECT * FROM
              t))</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果表</font></font><code class="literal">t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              具有多个列或多个行</font><font style="vertical-align: inherit;">，
               </font><font style="vertical-align: inherit;">则会失败</font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              执行</font><font style="vertical-align: inherit;">语句
               </font><font style="vertical-align: inherit;">时间与执行所
               </font><font style="vertical-align: inherit;">涉及的开销量不同。</font><font style="vertical-align: inherit;">这两个具有非常不同的执行配置文件，您不应期望它们花费相同的时间。</font><font style="vertical-align: inherit;">前者涉及解析器，优化器，表锁定和运行时评估
               </font><font style="vertical-align: inherit;">时间。</font><font style="vertical-align: inherit;">后者仅涉及运行时评估
              </font></font><code class="literal">SELECT
              <em class="replaceable"><code>expr</code></em></code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><code class="literal">SELECT BENCHMARK(<em class="replaceable"><code>N</code></em>,
              <em class="replaceable"><code>expr</code></em>)</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次，和所有其他组件只有一次。</font><font style="vertical-align: inherit;">已经分配的内存结构被重用，并且运行时优化（例如已经针对聚合函数评估的结果的本地缓存）可以改变结果。</font></font><a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，</font><font style="vertical-align: inherit;">使用
               </font><font style="vertical-align: inherit;">通过给予该组件更多权重并消除</font><font style="vertical-align: inherit;">
              由网络，解析器，优化器等引入</font><font style="vertical-align: inherit;">的</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">噪声</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来测量运行时组件的性能</font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><a name="function_charset"></a><p>
          <a class="indexterm" name="idm140091680895712"></a>

          <a class="link" href="functions.html#function_charset"><code class="literal">CHARSET(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回字符串参数的字符集。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CHARSET('abc');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'utf8'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CHARSET(CONVERT('abc' USING latin1));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'latin1'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CHARSET(USER());</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'utf8'</font></font><font></font>
</pre></li><li class="listitem"><a name="function_coercibility"></a><p>
          <a class="indexterm" name="idm140091680884704"></a>

          <a class="link" href="functions.html#function_coercibility"><code class="literal">COERCIBILITY(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回字符串参数的排序规则强制性值。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COERCIBILITY('abc' COLLATE utf8_swedish_ci);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COERCIBILITY(USER());</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COERCIBILITY('abc');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 4</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COERCIBILITY(1000);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 5</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值具有下表中显示的含义。</font><font style="vertical-align: inherit;">较低的值具有较高的优先级。
</font></font></p>
<div class="informaltable">
<table summary="Collation coercibility return values, the meaning of each value, and an example of each."><colgroup><col width="15%"><col width="15%"><col width="70%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可压缩性</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含义</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">0</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明确的整理</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值与</font></font><code class="literal">COLLATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">1</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有整理</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有不同排序规则的字符串的连接</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">2</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">隐式整理</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列值，存储的例程参数或局部变量</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">3</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统常数</font></font></td>
              <td><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 回报价值</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">4</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COERCIBLE</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字字符串</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">5</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数字</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数值或时间价值</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">5</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可忽略的</font></font></td>
              <td><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 或者来自的表达式
                </font></font><code class="literal">NULL</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关更多信息，请参见
           </font></font><a class="xref" href="charset.html#charset-collation-coercibility" title="10.8.4表达式中的整理强制性"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.8.4节“表达式中的校对强制性”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_collation"></a><p>
          <a class="indexterm" name="idm140091680834992"></a>

          <a class="link" href="functions.html#function_collation"><code class="literal">COLLATION(<em class="replaceable"><code>str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回字符串参数的排序规则。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COLLATION('abc');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'utf8_general_ci'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COLLATION(_utf8mb4'abc');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'utf8mb4_0900_ai_ci'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COLLATION(_latin1'abc');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'latin1_swedish_ci'</font></font><font></font>
</pre></li><li class="listitem"><a name="function_connection-id"></a><p>
          <a class="indexterm" name="idm140091680823904"></a>

          <a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回连接的连接ID（线程ID）。</font><font style="vertical-align: inherit;">每个连接都具有在当前连接的客户端集中唯一的ID。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回
           </font></font><a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值</font></font><code class="literal">ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font></font><a class="link" href="information-schema.html#processlist-table" title="25.19 INFORMATION_SCHEMA PROCESSLIST表"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表中的</font></font><code class="literal">Id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列，
           </font></font><a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST语法"><code class="literal">SHOW PROCESSLIST</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输出</font></font><code class="literal">PROCESSLIST_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列和Performance Schema </font></font><a class="link" href="performance-schema.html#threads-table" title="26.12.17.5线程表"><code class="literal">threads</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">列中
           </font><font style="vertical-align: inherit;">显示的值类型相同</font><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CONNECTION_ID();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 23786</font></font><font></font>
</pre></li><li class="listitem"><a name="function_current-role"></a><p>
          <a class="indexterm" name="idm140091680806448"></a>

          <a class="link" href="functions.html#function_current-role"><code class="literal">CURRENT_ROLE()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符串，其中包含当前会话的当前活动角色，以逗号分隔，或者</font></font><code class="literal">NONE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有。</font><font style="vertical-align: inherit;">该值反映了</font></font><a class="link" href="server-administration.html#sysvar_sql_quote_show_create"><code class="literal">sql_quote_show_create</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">的设置
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          假设帐户被授予如下角色：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GRANT'r1'，'r2'到'u1'@'localhost';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将DEFAULT ROLE ALL设置为'u1'@'localhost';</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在会话中</font></font><code class="literal">u1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，初始
           </font></font><a class="link" href="functions.html#function_current-role"><code class="literal">CURRENT_ROLE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值指定默认帐户角色。</font><font style="vertical-align: inherit;">使用以下</font></font><a class="link" href="sql-syntax.html#set-role" title="13.7.1.11 SET ROLE语法"><code class="literal">SET
          ROLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更改：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CURRENT_ROLE();</code></strong><font></font>
+-------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CURRENT_ROLE（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">`r1` @`％`，`r2` @`％`|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SET ROLE 'r1'; SELECT CURRENT_ROLE();</code></strong><font></font>
+----------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CURRENT_ROLE（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">`r1` @`％`|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_current-user"></a><p>
          <a class="indexterm" name="idm140091680788960"></a>

          <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回服务器用于验证当前客户端的MySQL帐户的用户名和主机名组合。</font><font style="vertical-align: inherit;">此帐户确定您的访问权限。</font><font style="vertical-align: inherit;">返回值是</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字符集中</font><font style="vertical-align: inherit;">的字符串</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值的值</font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以与值不同
           </font></font><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT USER();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'davida @ localhost'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM mysql.user;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1044：用户''@ localhost'拒绝访问</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数据库'mysql'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CURRENT_USER();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'@localhost'</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该示例说明尽管客户端指定了用户名</font></font><code class="literal">davida</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（由</font></font><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">的值指示</font><font style="vertical-align: inherit;">），但服务器使用匿名用户帐户对客户端进行身份验证（如</font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的空用户名部分所示
           </font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">可能出现的一种方式是授权表中没有列出帐户</font></font><code class="literal">davida</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在存储的程序或视图中，
           </font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回定义对象的用户的帐户（由其
           </font></font><code class="literal">DEFINER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值指定），除非使用该</font></font><code class="literal">SQL SECURITY INVOKER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特征进行</font><font style="vertical-align: inherit;">定义
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在后一种情况下，</font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回对象的调用者。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          触发器和事件没有选项来定义</font></font><code class="literal">SQL
          SECURITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特征，因此对于这些对象，
           </font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回定义对象的用户的帐户。</font><font style="vertical-align: inherit;">要返回调用者，请使用</font></font><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="functions.html#function_session-user"><code class="literal">SESSION_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下语句支持使用该
           </font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数代替受影响的用户或定义者的名称（以及可能的主机）; </font><font style="vertical-align: inherit;">在这种情况下，
           </font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据需要扩展：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.5 DROP USER语法"><code class="literal">DROP USER</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.7 RENAME USER语法"><code class="literal">RENAME USER</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#grant" title="13.7.1.6 GRANT语法"><code class="literal">GRANT</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#revoke" title="13.7.1.8 REVOKE语法"><code class="literal">REVOKE</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#create-function" title="13.1.14 CREATE FUNCTION语法"><code class="literal">CREATE FUNCTION</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#create-procedure" title="13.1.17创建过程和创建函数语法"><code class="literal">CREATE PROCEDURE</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#create-trigger" title="13.1.22 CREATE TRIGGER语法"><code class="literal">CREATE TRIGGER</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#create-event" title="13.1.13 CREATE EVENT语法"><code class="literal">CREATE EVENT</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#create-view" title="13.1.23创建视图语法"><code class="literal">CREATE VIEW</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#alter-event" title="13.1.3 ALTER EVENT语法"><code class="literal">ALTER EVENT</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#alter-view" title="13.1.11 ALTER VIEW语法"><code class="literal">ALTER VIEW</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#set-password" title="13.7.1.10 SET PASSWORD语法"><code class="literal">SET PASSWORD</code></a>
</p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关此扩展</font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对复制</font><font style="vertical-align: inherit;">的影响的信息
           </font><font style="vertical-align: inherit;">，请参见
           </font></font><a class="xref" href="replication.html#replication-features-current-user" title="17.4.1.8 CURRENT_USER（）的复制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.4.1.8节“CURRENT_USER（）的复制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_database"></a><p>
          <a class="indexterm" name="idm140091680728848"></a>

          <a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集中</font><font style="vertical-align: inherit;">的字符串形式返回默认（当前）数据库名称
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果没有默认数据库，则</font></font><a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在存储例程中，默认数据库是与例程关联的数据库，该数据库不一定与调用上下文中的默认数据库相同。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT DATABASE();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'测试'</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果没有默认数据库，则
           </font></font><a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_found-rows"></a><p>
          <a class="indexterm" name="idm140091680714512"></a>

          <a class="indexterm" name="idm140091680713440"></a>

          <a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a>
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            该</font></font><code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询修改和相应的</font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            功能已被弃用例如MySQL 8.0.17，并会在将来的MySQL版本中删除。</font><font style="vertical-align: inherit;">作为替代，考虑执行您的查询
             </font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后使用</font></font><a class="link" href="functions.html#function_count"><code class="literal">COUNT(*)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和不
             </font><font style="vertical-align: inherit;">使用第二个查询
             </font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来确定是否有其他行。</font><font style="vertical-align: inherit;">例如，而不是这些查询：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT SQL_CALC_FOUND_ROWS * FROM </font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WHERE id&gt; 100 LIMIT 10;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT FOUND_ROWS（）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            改为使用这些查询：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT * FROM </font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WHERE id&gt; 100 LIMIT 10;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT COUNT（*）WHERE id&gt; 100;</font></font><font></font>
</pre><p>
            <a class="link" href="functions.html#function_count"><code class="literal">COUNT(*)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受到某些优化。
            </font></font><code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">导致某些优化被禁用。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句可能包括一个</font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款，限制服务器返回给客户端的行数。</font><font style="vertical-align: inherit;">在某些情况下，需要知道语句在没有的</font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">情况下</font><font style="vertical-align: inherit;">返回了多少行</font><font style="vertical-align: inherit;">，但是没有再次运行语句。</font><font style="vertical-align: inherit;">要获取此行计数，请</font></font><code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中</font><font style="vertical-align: inherit;">包含一个</font><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">，然后</font><font style="vertical-align: inherit;">在
           </font><font style="vertical-align: inherit;">以后调用</font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font><font style="vertical-align: inherit;">
    - &gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT SQL_CALC_FOUND_ROWS * FROM <em class="replaceable"><code>tbl_name</code></em></code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>WHERE id &gt; 100 LIMIT 10;</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>SELECT FOUND_ROWS();</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          第二个</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个数字，表示如果</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有该</font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">，第一个</font><font style="vertical-align: inherit;">将返回的</font><font style="vertical-align: inherit;">行数
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          最近成功的</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中</font><font style="vertical-align: inherit;">没有该</font><font style="vertical-align: inherit;">选项，则
           </font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回该</font><font style="vertical-align: inherit;">语句
           </font><font style="vertical-align: inherit;">返回的结果集中的行数。</font><font style="vertical-align: inherit;">如果语句包含</font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句，则
           </font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回最多行数。</font><font style="vertical-align: inherit;">例如，
           </font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果语句包含</font></font><code class="literal">LIMIT
          10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font><font style="vertical-align: inherit;">，则分别返回10或60 </font></font><code class="literal">LIMIT 50, 10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可用的行计数
           </font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是暂时的，并且不会在语句后面的</font></font><code class="literal">SELECT SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">之后可用
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果您需要稍后参考该值，请将其保存：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT SQL_CALC_FOUND_ROWS * FROM ... ;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SET @rows = FOUND_ROWS();</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您正在使用</font></font><code class="literal">SELECT
          SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL必须计算完整结果集中的行数。</font><font style="vertical-align: inherit;">但是，这比没有再次运行查询要快</font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因为结果集不需要发送到客户端。
        </font></font></p><p>
          <code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在您想要限制查询返回的行数的情况下非常有用，但是在不再次运行查询的情况下也可以确定完整结果集中的行数。</font><font style="vertical-align: inherit;">一个示例是一个Web脚本，它显示一个分页显示，其中包含指向显示搜索结果其他部分的页面的链接。</font><font style="vertical-align: inherit;">使用
           </font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以确定结果的其余部分需要多少其他页面。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">
          的使用</font></font><code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复杂性</font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比简单</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">更复杂</font><font style="vertical-align: inherit;">，因为</font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能出现在多个地方</font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它可以应用于</font><font style="vertical-align: inherit;">整个结果</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中的</font><font style="vertical-align: inherit;">单个</font><font style="vertical-align: inherit;">语句，</font><font style="vertical-align: inherit;">也可以应用于</font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全局
           </font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果。
        </font></font></p><p><font style="vertical-align: inherit;"></font><code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for
           </font><font style="vertical-align: inherit;">
          的意图</font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是它应该返回没有全局返回的行计数
           </font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用的条件
           </font></font><code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有
           </font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该</font></font><code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字必须出现在第一个</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              的</font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              仅当</font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION ALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用时</font><font style="vertical-align: inherit;">
              ，值</font><font style="vertical-align: inherit;">才是精确的
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果</font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不
               </font></font><code class="literal">ALL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用，则会发生重复删除，其值
               </font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅为近似值。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果no </font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中存在</font><font style="vertical-align: inherit;">no </font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">SQL_CALC_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则忽略</font><font style="vertical-align: inherit;">该
               </font><font style="vertical-align: inherit;">函数并返回创建的临时表中的行数以进行处理
               </font></font><a class="link" href="sql-syntax.html#union" title="13.2.10.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          除了此处描述的情况之外，行为
           </font></font><a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是未定义的（例如，其值在
           </font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句失败后出现错误）。
</font></font></p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p>
            <a class="link" href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用基于语句的复制不能可靠地复制。</font><font style="vertical-align: inherit;">使用基于行的复制自动复制此功能。
</font></font></p>
</div>
</li><li class="listitem"><a name="function_icu-version"></a><p>
          <a class="link" href="functions.html#function_icu-version"><code class="literal">ICU_VERSION()</code></a>
        </p><a class="indexterm" name="idm140091680622800"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          用于支持正则表达式操作的Unicode国际组件（ICU）库的版本（请参见
           </font></font><a class="xref" href="functions.html#regexp" title="12.5.2正则表达式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.5.2节“正则表达式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">此功能主要用于测试用例。
        </font></font></p></li><li class="listitem"><a name="function_last-insert-id"></a><p>
          <a class="indexterm" name="idm140091680617568"></a>

          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果没有参数，则
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个
           </font></font><code class="literal">BIGINT UNSIGNED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位）值，表示</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于最近执行的</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">而</font><font style="vertical-align: inherit;">成功为</font><font style="vertical-align: inherit;">列添加
           </font><font style="vertical-align: inherit;">的第一个自动生成的值</font><font style="vertical-align: inherit;">。</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有成功插入行，则</font><font style="vertical-align: inherit;">值
           </font><font style="vertical-align: inherit;">保持不变。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用参数，
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回无符号整数。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例如，在插入生成</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的行之后
           </font><font style="vertical-align: inherit;">，您可以获得如下值：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 195</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当前正在执行的语句不会影响其值
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">假设您</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用一个语句</font><font style="vertical-align: inherit;">生成一个</font><font style="vertical-align: inherit;">值，然后</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在多行</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中</font><font style="vertical-align: inherit;">引用
           </font><font style="vertical-align: inherit;">，该行将行</font><font style="vertical-align: inherit;">插入到具有自己</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的表中
           </font><font style="vertical-align: inherit;">。</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二个陈述中</font><font style="vertical-align: inherit;">的价值
           </font><font style="vertical-align: inherit;">将保持稳定; </font><font style="vertical-align: inherit;">它的第二行和后一行的值不受先前行插入的影响。</font><font style="vertical-align: inherit;">（但是，如果将参考混合到
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font><font style="vertical-align: inherit;">，则效果未定义。）
        </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果前一个语句返回错误，则值为
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">undefined。</font><font style="vertical-align: inherit;">对于事务表，如果语句由于错误而回滚，则值为
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">undefined。</font><font style="vertical-align: inherit;">对于手动
           </font></font><a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION，COMMIT和ROLLBACK语法"><code class="literal">ROLLBACK</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其值</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不会恢复到事务之前的值; </font><font style="vertical-align: inherit;">它仍然保持原样
           </font></font><a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION，COMMIT和ROLLBACK语法"><code class="literal">ROLLBACK</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在存储例程（过程或函数）或触发器</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的主体内</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">更改的</font><font style="vertical-align: inherit;">值与</font><font style="vertical-align: inherit;">在这些对象的主体外执行的语句</font><font style="vertical-align: inherit;">的
           </font><font style="vertical-align: inherit;">更改方式相同。</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下语句可以看出</font><font style="vertical-align: inherit;">存储的例程或触发器对其值的影响
           </font><font style="vertical-align: inherit;">取决于例程的类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果存储过程执行更改值的语句，则更改的值</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将由过程调用之后的语句看到。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于更改值的存储函数和触发器，当函数或触发器结束时，将恢复该值，因此后续语句将不会看到更改的值。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          生成的ID在</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个连接的基础上</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在服务器中维护
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这意味着函数返回给定客户端的</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><span class="emphasis"><em><font style="vertical-align: inherit;">是为该客户端</font></em></span><font style="vertical-align: inherit;">影响</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最新语句生成</font><font style="vertical-align: inherit;">的第一个
           </font><font style="vertical-align: inherit;">值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此值不受其他客户端的影响，即使它们生成
           </font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自己的值。</font><font style="vertical-align: inherit;">此行为可确保每个客户端都可以检索自己的ID，而无需关心其他客户端的活动，也无需锁定或事务。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果将</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">设置</font><font style="vertical-align: inherit;">为非</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">魔术</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值（即，不是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和不是</font><font style="vertical-align: inherit;">
          的值），</font><font style="vertical-align: inherit;">则不会更改
           </font><font style="vertical-align: inherit;">值
           </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果您将使用一个多行
             </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的语句，
             </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回所产生的价值</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一次</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插入的行</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这样做的原因是可以轻松地重现</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与其他服务器</font><font style="vertical-align: inherit;">相同的
             </font><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例如：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>USE test;</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (</code></strong>
       <strong class="userinput"><code>id INT AUTO_INCREMENT NOT NULL PRIMARY KEY,</code></strong>
       <strong class="userinput"><code>name VARCHAR(10) NOT NULL</code></strong>
       <strong class="userinput"><code>);</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES (NULL, 'Bob');</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM t;</code></strong><font></font>
+----+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">名字|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">鲍勃|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LAST_INSERT_ID（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
|                1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES</code></strong>
       <strong class="userinput"><code>(NULL, 'Mary'), (NULL, 'Jane'), (NULL, 'Lisa');</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">id | </font><font style="vertical-align: inherit;">名字|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">鲍勃|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">玛丽|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">简|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">添加|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LAST_INSERT_ID（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
|                2 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          虽然第二个</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          语句插入了三个新行</font></font><code class="literal">t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是为这些行中的第一行生成的ID是
           </font></font><code class="literal">2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且这个值是由</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">返回的
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果使用</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT
          IGNORE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且忽略该行，则
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保持与当前值保持不变（如果连接尚未成功</font></font><code class="literal">INSERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">则返回0
           </font><font style="vertical-align: inherit;">），对于非事务表，</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">计数器不会递增。</font><font style="vertical-align: inherit;">对于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><a class="link" href="innodb-storage-engine.html#sysvar_innodb_autoinc_lock_mode"><code class="literal">innodb_autoinc_lock_mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置为</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font><font style="vertical-align: inherit;">，则
           </font><font style="vertical-align: inherit;">计数器会递增
           </font></font><code class="literal">2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如以下示例所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>USE test;</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @@innodb_autoinc_lock_mode;</code></strong><font></font>
+----------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@@ innodb_autoinc_lock_mode |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font>
|                          1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE `t` (</code></strong>
       <strong class="userinput"><code>`id` INT(11) NOT NULL AUTO_INCREMENT,</code></strong>
       <strong class="userinput"><code>`val` INT(11) DEFAULT NULL,</code></strong>
       <strong class="userinput"><code>PRIMARY KEY (`id`),</code></strong>
       <strong class="userinput"><code>UNIQUE KEY `i1` (`val`)</code></strong>
       <strong class="userinput"><code>) ENGINE=InnoDB DEFAULT CHARSET=latin1;</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃插入两行</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t (val) VALUES (1),(2);</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#with auto_increment_offset = 1，插入行</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃结果AUTO_INCREMENT值为3</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW CREATE TABLE t\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
       表：t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建表：CREATE TABLE`t`（</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  `id` int（11）NOT NULL AUTO_INCREMENT，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  `val` int（11）DEFAULT NULL，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  PRIMARY KEY（`id`），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  独特的钥匙`i1`（`val`）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
）ENGINE = InnoDB AUTO_INCREMENT = 3 DEFAULT CHARSET = latin1</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃LAST_INSERT_ID（）返回第一个自动生成的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为AUTO_INCREMENT列成功插入的#value</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LAST_INSERT_ID（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
|                1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃尝试插入重复行失败但忽略错误   </font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT IGNORE INTO t (val) VALUES (1),(2);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：2个重复：2个警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#with innodb_autoinc_lock_mode = 1，AUTO_INCREMENT计数器</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于忽略的行，＃递增</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW CREATE TABLE t\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
       表：t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建表：CREATE TABLE`t`（</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  `id` int（11）NOT NULL AUTO_INCREMENT，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  `val` int（11）DEFAULT NULL，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  PRIMARY KEY（`id`），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  独特的钥匙`i1`（`val`）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
）ENGINE = InnoDB AUTO_INCREMENT = 5 DEFAULT CHARSET = latin1</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#LAST_INSERT_ID未更改，因为前一个插入不成功</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LAST_INSERT_ID（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关更多信息，请参见
           </font></font><a class="xref" href="innodb-storage-engine.html#innodb-auto-increment-handling" title="15.6.1.4 InnoDB中的AUTO_INCREMENT处理"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第15.6.1.4节“InnoDB中的AUTO_INCREMENT处理”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="indexterm" name="idm140091680523392"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

          如果</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为参数给出，则参数
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值由函数返回，并记住作为要返回的下一个值
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这可以用来模拟序列：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              创建一个表来保存序列计数器并初始化它：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>CREATE TABLE sequence (id INT NOT NULL);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>INSERT INTO sequence VALUES (0);</code></strong>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用该表生成如下序列号：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>UPDATE sequence SET id=LAST_INSERT_ID(id+1);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT LAST_INSERT_ID();</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该</font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句递增序列计数器并使下一次调用</font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回更新的值。</font><font style="vertical-align: inherit;">该
               </font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句检索该值。</font><font style="vertical-align: inherit;">在
               </font></font><a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C API函数也可以用于获取价值。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.7.7.38节“mysql_insert_id（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您可以在不调用的情况下生成序列
           </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但以这种方式使用函数的实用程序是ID值在服务器中作为最后自动生成的值进行维护。</font><font style="vertical-align: inherit;">它是多用户安全的，因为多个客户端可以发出</font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句并使用</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句（或
           </font></font><a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">获取自己的序列值
           </font><font style="vertical-align: inherit;">，而不会影响或受到生成其自己的序列值的其他客户端的影响。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请注意，</font></font><a class="link" href="connectors-apis.html#mysql-insert-id" title="28.7.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅在</font><font style="vertical-align: inherit;">语句</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">之后更新</font><font style="vertical-align: inherit;">，因此</font><font style="vertical-align: inherit;">
          在执行其他SQL语句（如</font><font style="vertical-align: inherit;">或）
           </font><font style="vertical-align: inherit;">之后，
           </font><font style="vertical-align: inherit;">无法使用C API函数来检索值
           </font><font style="vertical-align: inherit;">。
        </font></font><a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><a name="function_roles-graphml"></a><p>
          <a class="indexterm" name="idm140091680488144"></a>

          <a class="link" href="functions.html#function_roles-graphml"><code class="literal">ROLES_GRAPHML()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含表示内存角色子图的GraphML文档</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">字符串。</font><font style="vertical-align: inherit;">该
           </font></font><a class="link" href="security.html#priv_role-admin"><code class="literal">ROLE_ADMIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特权才能看到的内容</font></font><code class="literal">&lt;graphml&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元素。</font><font style="vertical-align: inherit;">否则，结果只显示一个空元素：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ROLES_GRAPHML();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ROLES_GRAPHML（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">&lt;？xml version =“1.0”encoding =“UTF-8”？&gt; &lt;graphml /&gt; |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_row-count"></a><p>
          <a class="indexterm" name="idm140091680476352"></a>

          <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a>
        </p><p>
          <code class="literal">ROW_COUNT()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 返回一个值，如下所示：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              DDL语句：0。这适用于诸如</font></font><a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE语法"><code class="literal">CREATE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或的
               </font><font style="vertical-align: inherit;">语句
               </font></font><a class="link" href="sql-syntax.html#drop-table" title="13.1.32 DROP TABLE语法"><code class="literal">DROP TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              除</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下之外的</font><font style="vertical-align: inherit;">DML语句
               </font><font style="vertical-align: inherit;">：受影响的行数。</font><font style="vertical-align: inherit;">这适用于报表等
               </font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（如前），但现在还声明，如</font></font><a class="link" href="sql-syntax.html#alter-table" title="13.1.9 ALTER TABLE语法"><code class="literal">ALTER
              TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a class="link" href="sql-syntax.html#load-data" title="13.2.7 LOAD DATA语法"><code class="literal">LOAD
              DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：如果语句返回结果集，则返回-1;如果不返回，则返回</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受影响</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的行数
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，for
               </font></font><code class="literal">SELECT * FROM t1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回-1。</font><font style="vertical-align: inherit;">For
               </font><font style="vertical-align: inherit;">，
               </font><font style="vertical-align: inherit;">返回写入文件的行数。
            </font></font><code class="literal">SELECT * FROM t1 INTO OUTFILE
              '<em class="replaceable"><code>file_name</code></em>'</code><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL语法"><code class="literal">SIGNAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 陈述：0。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，默认情况下受影响的行值是实际更改的行数。</font><font style="vertical-align: inherit;">如果</font><font style="vertical-align: inherit;">在连接到</font><a class="link" href="programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;">mysqld</font></strong></span></a><font style="vertical-align: inherit;">时</font><font style="vertical-align: inherit;">指定了
           </font></font><code class="literal">CLIENT_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志
           </font><font style="vertical-align: inherit;">，则受影响的行值是</font><span class="quote"><font style="vertical-align: inherit;">“ </font></span><span class="quote"><span class="quote"><font style="vertical-align: inherit;">找到</font></span></span><span class="quote"><font style="vertical-align: inherit;"> ”</font></span><font style="vertical-align: inherit;">的行数</font><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">也就是说，与</font><font style="vertical-align: inherit;">条款</font><font style="vertical-align: inherit;">相匹配</font><font style="vertical-align: inherit;">。
        </font></font><a class="link" href="connectors-apis.html#mysql-real-connect" title="28.7.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"></font><a class="link" href="programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;"></font></strong></span></a><font style="vertical-align: inherit;"></font><span class="quote"><font style="vertical-align: inherit;"></font><span class="quote"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><a class="link" href="sql-syntax.html#replace" title="13.2.9 REPLACE语法"><code class="literal">REPLACE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，如果新行替换旧行，则affected-rows值为2，因为在这种情况下，在删除副本后插入了一行。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于
           </font></font><a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE语法"><code class="literal">INSERT
          ... ON DUPLICATE KEY UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，如果将行作为新行插入，则每行的受影响行值为1;如果更新现有行，则为2，如果现有行设置为其当前值，则为0。</font><font style="vertical-align: inherit;">如果指定
           </font></font><code class="literal">CLIENT_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志，则如果将现有行设置为其当前值，则affected-rows值为1（不为0）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值类似于</font></font><a class="link" href="connectors-apis.html#mysql-affected-rows" title="28.7.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C API函数中</font><font style="vertical-align: inherit;">的值
           </font><font style="vertical-align: inherit;">以及</font></font><a class="link" href="programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          客户端在语句执行后显示</font><font style="vertical-align: inherit;">的行计数</font><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES(1),(2),(3);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，3行受影响（0.00秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：3个重复：0个警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ROW_COUNT();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ROW_COUNT（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
|           3 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>DELETE FROM t WHERE i IN(1,2);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，2行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ROW_COUNT();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ROW_COUNT（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
|           2 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p>
            <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用基于语句的复制不能可靠地复制。</font><font style="vertical-align: inherit;">使用基于行的复制自动复制此功能。
</font></font></p>
</div>
</li><li class="listitem"><a name="function_schema"></a><p>
          <a class="indexterm" name="idm140091680424336"></a>

          <a class="link" href="functions.html#function_schema"><code class="literal">SCHEMA()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能是其同义词
           </font></font><a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_session-user"></a><p>
          <a class="indexterm" name="idm140091680416336"></a>

          <a class="link" href="functions.html#function_session-user"><code class="literal">SESSION_USER()</code></a>
        </p><p>
          <a class="link" href="functions.html#function_session-user"><code class="literal">SESSION_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是...的同义词
           </font></font><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_system-user"></a><p>
          <a class="indexterm" name="idm140091680407088"></a>

          <a class="link" href="functions.html#function_system-user"><code class="literal">SYSTEM_USER()</code></a>
        </p><p>
          <a class="link" href="functions.html#function_system-user"><code class="literal">SYSTEM_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是...的同义词
           </font></font><a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            该</font></font><a class="link" href="functions.html#function_system-user"><code class="literal">SYSTEM_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能与</font></font><a class="link" href="security.html#priv_system-user"><code class="literal">SYSTEM_USER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            特权不同。</font><font style="vertical-align: inherit;">前者返回当前的MySQL帐户名。</font><font style="vertical-align: inherit;">后者区分系统用户和常规用户帐户类别（请参见
             </font></font><a class="xref" href="security.html#account-categories" title="6.2.11帐户类别"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.2.11节“帐户类别”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
</font></font></p>
</div>
</li><li class="listitem"><a name="function_user"></a><p>
          <a class="indexterm" name="idm140091680393696"></a>

          <a class="link" href="functions.html#function_user"><code class="literal">USER()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集中</font><font style="vertical-align: inherit;">的字符串形式返回当前MySQL用户名和主机名</font><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT USER();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'davida @ localhost'</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该值表示您在连接到服务器时指定的用户名，以及您连接的客户端主机。</font><font style="vertical-align: inherit;">该值可以不同于
           </font></font><a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_version"></a><p>
          <a class="indexterm" name="idm140091680382000"></a>

          <a class="link" href="functions.html#function_version"><code class="literal">VERSION()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回表示MySQL服务器版本的字符串。</font><font style="vertical-align: inherit;">该字符串使用</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集。</font><font style="vertical-align: inherit;">除版本号外，该值可能还有一个后缀。</font><font style="vertical-align: inherit;">见的描述
           </font></font><a class="link" href="server-administration.html#sysvar_version"><code class="literal">version</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在系统变量
           </font></font><a class="xref" href="server-administration.html#server-system-variables" title="5.1.8服务器系统变量"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.8节，“服务器系统变量”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数对于基于语句的复制不安全。</font><font style="vertical-align: inherit;">如果在</font></font><a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为时使用此功能，则会记录警告
           </font></font><code class="literal">STATEMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT VERSION();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'8.0.18-standard'</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="spatial-analysis-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16空间分析功能</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#spatial-function-reference"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.1空间函数参考</font></font></a></span></dt><dt><span class="section"><a href="functions.html#spatial-function-argument-handling"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.2空间函数的参数处理</font></font></a></span></dt><dt><span class="section"><a href="functions.html#gis-wkt-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.3从WKT值创建几何值的函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#gis-wkb-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.4从WKB值创建几何值的函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#gis-mysql-specific-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.5创建几何值的特定于MySQL的函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#gis-format-conversion-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.6几何格式转换函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#gis-property-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7几何属性函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#spatial-operator-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.8空间算子函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.9测试几何对象之间空间关系的函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#spatial-geohash-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.10空间Geohash函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#spatial-geojson-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.11空间GeoJSON函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#spatial-convenience-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.12空间便利函数</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL提供了对空间数据执行各种操作的功能。</font><font style="vertical-align: inherit;">这些功能可以根据它们执行的操作类型分为几个主要类别：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以各种格式创建几何的函数（WKT，WKB，内部）
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在格式之间转换几何的函数
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        访问几何的定性或定量属性的函数
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        描述两个几何之间关系的函数
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        从现有几何创建新几何的函数
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    有关MySQL支持使用空间数据的一般背景，请参见</font></font><a class="xref" href="data-types.html#spatial-types" title="11.5空间数据类型"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11.5节“空间数据类型”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="spatial-function-reference"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.1空间函数参考</font></font></h3>
</div>
</div>
</div>
<a class="indexterm" name="idm140091680360064"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      下表列出了每个空间函数，并提供了每个空间函数的简短描述。
</font></font></p>
<div class="table">
<a name="idm140091680358480"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.20空间函数</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists all spatial functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从几何构造几何集合
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从几何构造几何集合
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_linestring"><code class="literal">LineString()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从Point值构造LineString
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrcontains"><code class="literal">MBRContains()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何的MBR是否包含另一个几何的MBR
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrcoveredby"><code class="literal">MBRCoveredBy()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个MBR是否被另一个MBR覆盖
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrcovers"><code class="literal">MBRCovers()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个MBR是否涵盖另一个MBR
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrdisjoint"><code class="literal">MBRDisjoint()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个几何形状的MBR是否不相交
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrequals"><code class="literal">MBREquals()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个几何的MBR是否相等
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrintersects"><code class="literal">MBRIntersects()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个几何的MBR是否相交
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbroverlaps"><code class="literal">MBROverlaps()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个几何的MBR是否重叠
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrtouches"><code class="literal">MBRTouches()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两种几何形状的MBR是否接触
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_mbrwithin"><code class="literal">MBRWithin()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何的MBR是否在另一个几何的MBR内
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_multilinestring"><code class="literal">MultiLineString()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从LineString值构造MultiLineString
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_multipoint"><code class="literal">MultiPoint()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从Point值构造MultiPoint
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_multipolygon"><code class="literal">MultiPolygon()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从Polygon值构造MultiPolygon
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_point"><code class="literal">Point()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从坐标构造点
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_polygon"><code class="literal">Polygon()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从LineString参数构造多边形
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回Polygon或MultiPolygon区域
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-asbinary"><code class="literal">ST_AsBinary()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_AsWKB()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从内部几何格式转换为WKB
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-asgeojson"><code class="literal">ST_AsGeoJSON()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从几何体生成GeoJSON对象
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsText()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_AsWKT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从内部几何格式转换为WKT
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回距离几何体的给定距离内的点的几何
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      为ST_Buffer（）生成策略选项
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-centroid"><code class="literal">ST_Centroid()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回质心作为一个点
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-contains"><code class="literal">ST_Contains()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何是否包含另一个
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-convexhull"><code class="literal">ST_ConvexHull()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回几何体的凸包
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-crosses"><code class="literal">ST_Crosses()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何是否与另一个几何相交
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-difference"><code class="literal">ST_Difference()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个几何的返回点集差异
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-dimension"><code class="literal">ST_Dimension()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      几何尺寸
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-disjoint"><code class="literal">ST_Disjoint()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何是否与另一个几何脱节
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何与另一个几何的距离
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-distance-sphere"><code class="literal">ST_Distance_Sphere()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个几何形状之间的最小地球距离
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-endpoint"><code class="literal">ST_EndPoint()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      LineString的终点
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回几何的MBR
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-equals"><code class="literal">ST_Equals()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何是否与另一个几何相等
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-exteriorring"><code class="literal">ST_ExteriorRing()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回Polygon的外环
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geohash"><code class="literal">ST_GeoHash()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      产生geohash值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomcollfromtext"><code class="literal">ST_GeomCollFromText()</code>, <code class="literal">ST_GeometryCollectionFromText()</code>, <code class="literal">ST_GeomCollFromTxt()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKT返回几何集合
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomcollfromwkb"><code class="literal">ST_GeomCollFromWKB()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_GeometryCollectionFromWKB()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKB返回几何集合
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geometryn"><code class="literal">ST_GeometryN()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从几何集合中返回第N个几何
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geometrytype"><code class="literal">ST_GeometryType()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回几何类型的名称
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomfromgeojson"><code class="literal">ST_GeomFromGeoJSON()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从GeoJSON对象生成几何
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_GeometryFromText()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKT返回几何
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-geomfromwkb"><code class="literal">ST_GeomFromWKB()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_GeometryFromWKB()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKB返回几何
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-interiorringn"><code class="literal">ST_InteriorRingN()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回Polygon的第N个内环
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-intersection"><code class="literal">ST_Intersection()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回点设置两个几何的交集
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-intersects"><code class="literal">ST_Intersects()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何是否与另一个相交
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-isclosed"><code class="literal">ST_IsClosed()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      几何是否封闭且简单
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-isempty"><code class="literal">ST_IsEmpty()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      占位符功能
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-issimple"><code class="literal">ST_IsSimple()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      几何是否简单
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-isvalid"><code class="literal">ST_IsValid()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      几何是否有效
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-latfromgeohash"><code class="literal">ST_LatFromGeoHash()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从geohash值返回纬度
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-latitude"><code class="literal">ST_Latitude()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回Point的纬度
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-length"><code class="literal">ST_Length()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回LineString的长度
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-linefromtext"><code class="literal">ST_LineFromText()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_LineStringFromText()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKT构造LineString
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-linefromwkb"><code class="literal">ST_LineFromWKB()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_LineStringFromWKB()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKB构造LineString
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-longfromgeohash"><code class="literal">ST_LongFromGeoHash()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从geohash值返回经度
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-longitude"><code class="literal">ST_Longitude()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回Point的经度
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-makeenvelope"><code class="literal">ST_MakeEnvelope()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两点左右的矩形
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mlinefromtext"><code class="literal">ST_MLineFromText()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_MultiLineStringFromText()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKT构造MultiLineString
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mlinefromwkb"><code class="literal">ST_MLineFromWKB()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_MultiLineStringFromWKB()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKB构造MultiLineString
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mpointfromtext"><code class="literal">ST_MPointFromText()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_MultiPointFromText()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKT构造MultiPoint
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mpointfromwkb"><code class="literal">ST_MPointFromWKB()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_MultiPointFromWKB()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKB构造MultiPoint
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mpolyfromtext"><code class="literal">ST_MPolyFromText()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_MultiPolygonFromText()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKT构造MultiPolygon
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-mpolyfromwkb"><code class="literal">ST_MPolyFromWKB()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_MultiPolygonFromWKB()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKB构造MultiPolygon
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-numgeometries"><code class="literal">ST_NumGeometries()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回几何集合中的几何数量
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-numinteriorrings"><code class="literal">ST_NumInteriorRing()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_NumInteriorRings()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回多边形内圈的数量
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-numpoints"><code class="literal">ST_NumPoints()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回LineString中的点数
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-overlaps"><code class="literal">ST_Overlaps()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何是否与另一个重叠
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-pointfromgeohash"><code class="literal">ST_PointFromGeoHash()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将geohash值转换为POINT值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-pointfromtext"><code class="literal">ST_PointFromText()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKT构建点
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-pointfromwkb"><code class="literal">ST_PointFromWKB()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKB构造点
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-pointn"><code class="literal">ST_PointN()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从LineString返回第N个点
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-polyfromtext"><code class="literal">ST_PolyFromText()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_PolygonFromText()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKT构造多边形
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-polyfromwkb"><code class="literal">ST_PolyFromWKB()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code class="literal">ST_PolygonFromWKB()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从WKB构造多边形
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-simplify"><code class="literal">ST_Simplify()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回简化几何
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回几何的空间参考系统ID
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-startpoint"><code class="literal">ST_StartPoint()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      LineString的起始点
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-swapxy"><code class="literal">ST_SwapXY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      交换X / Y坐标的返回参数
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-symdifference"><code class="literal">ST_SymDifference()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回点设置两个几何的对称差异
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-touches"><code class="literal">ST_Touches()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何是否接触另一个
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      变换几何的坐标
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-union"><code class="literal">ST_Union()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回点集两个几何的并集
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回验证的几何体
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-within"><code class="literal">ST_Within()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个几何是否在另一个之内
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-x"><code class="literal">ST_X()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回Point的X坐标
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_st-y"><code class="literal">ST_Y()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回Point的Y坐标
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="spatial-function-argument-handling"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.2空间函数的参数处理</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      空间值或几何具有</font></font><a class="xref" href="data-types.html#gis-class-geometry" title="11.5.2.2几何类"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11.5.2.2节“几何类”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述的属性
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以下讨论列出了一般空间函数参数处理特征。</font><font style="vertical-align: inherit;">特定函数或函数组可能具有其他参数处理特性，如发生这些函数描述的部分所述。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      空间函数仅针对有效几何值定义。
    </font></font></p><a class="indexterm" name="idm140091680054224"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      几何的空间参考标识符（SRID）标识定义几何的坐标空间。</font><font style="vertical-align: inherit;">在MySQL中，SRID值是与几何值关联的整数。</font><font style="vertical-align: inherit;">最大可用SRID值为2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -1。</font><font style="vertical-align: inherit;">如果给出更大的值，则仅使用低32位。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      SRID 0表示无限平坦的笛卡尔平面，其轴没有单位。</font><font style="vertical-align: inherit;">要确保SRID 0行为，请使用SRID 0创建几何值。如果未指定SRID，则SRID 0是新几何值的默认值。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      任何空间函数生成的几何值都会继承几何参数的SRID。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      采用多个几何参数的空间函数要求这些参数具有相同的SRID值（即，低32位中的相同值）。</font><font style="vertical-align: inherit;">假设相等的SRID，空间函数在执行相等检查后不对它们执行任何操作; </font><font style="vertical-align: inherit;">使用笛卡尔坐标（SRID 0）隐式处理几何值。</font><font style="vertical-align: inherit;">如果空间函数返回
       </font></font><a class="link" href="error-handling.html#error_er_gis_different_srids"><code class="literal">ER_GIS_DIFFERENT_SRIDS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则意味着几何参数并非都具有相同的SRID。</font><font style="vertical-align: inherit;">您必须修改它们以具有相同的SRID。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该</font></font><a class="ulink" href="http://www.opengeospatial.org" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开放地理空间联盟</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准则要求输入多边形已经被关闭，因此未闭合的多边形拒绝为无效，而不是被关闭。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      空几何集合处理如下：可以将空WKT输入几何集合指定为
       </font></font><code class="literal">'GEOMETRYCOLLECTION()'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这也是由生成空几何集合的空间操作产生的输出WKT。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在解析嵌套几何集合期间，集合被展平，其基本组件用于各种GIS操作以计算结果。</font><font style="vertical-align: inherit;">这为用户提供了额外的灵活性，因为不必担心几何数据的唯一性。</font><font style="vertical-align: inherit;">嵌套几何集合可以从嵌套的GIS函数调用生成，而不必首先显式展平。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="gis-wkt-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.3从WKT值创建几何值的函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些函数将知名文本（WKT）表示和可选的空间参考系统标识符（SRID）作为参数。</font><font style="vertical-align: inherit;">它们返回相应的几何体。</font><font style="vertical-align: inherit;">有关WKT格式的说明，请参阅</font></font><a class="xref" href="data-types.html#gis-wkt-format" title="熟知文本（WKT）格式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">熟知文本（WKT）格式</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中的函数检测笛卡尔或地理空间参照系（SRS）中的参数，并返回适合SRS的结果。
    </font></font></p><p>
      <a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接受任何几何类型的WKT值作为其第一个参数。</font><font style="vertical-align: inherit;">其他函数提供特定于类型的构造函数，用于构造每种几何类型的几何值。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      诸如
       </font></font><a class="link" href="functions.html#function_st-mpointfromtext"><code class="literal">ST_MPointFromText()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接受WKT格式的</font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">表示的</font><font style="vertical-align: inherit;">函数允许值内的各个点被括号括起来。</font><font style="vertical-align: inherit;">例如，以下两个函数调用都是有效的：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ST_MPointFromText（'MULTIPOINT（1 1,2 2,3 3）'）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ST_MPointFromText（'MULTIPOINT（（1 1），（2 2），（3 3））'）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      比如函数</font></font><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      接受WKT几何集合参数了解双方开放地理信息系统</font></font><code class="literal">'GEOMETRYCOLLECTION EMPTY'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准语法和MySQL的</font></font><code class="literal">'GEOMETRYCOLLECTION()'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      非标准语法。</font><font style="vertical-align: inherit;">如函数
       </font></font><a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsWKT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      产生WKT值产生</font></font><code class="literal">'GEOMETRYCOLLECTION
      EMPTY'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准语法：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @s1 = ST_GeomFromText('GEOMETRYCOLLECTION()');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @s2 = ST_GeomFromText('GEOMETRYCOLLECTION EMPTY');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsWKT(@s1), ST_AsWKT(@s2);</code></strong><font></font>
+--------------------------+--------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsWKT（@ s1）| </font><font style="vertical-align: inherit;">ST_AsWKT（@ s2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+--------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">GEOMETRYCOLLECTION EMPTY | </font><font style="vertical-align: inherit;">GEOMETRYCOLLECTION EMPTY |</font></font><font></font>
+--------------------------+--------------------------+<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何几何参数是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者不是语法上格式良好的几何，或者如果SRID参数是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          默认情况下，地理坐标（纬度，经度）按几何参数的空间参考系统指定的顺序进行解释。</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以给出</font><font style="vertical-align: inherit;">可选
           </font><font style="vertical-align: inherit;">参数来覆盖默认轴顺序。</font></font><code class="option">options</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由逗号分隔列表组成
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">唯一</font><font style="vertical-align: inherit;">允许的值</font><font style="vertical-align: inherit;">是
           </font><font style="vertical-align: inherit;">，允许值为
           </font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">和
           </font><font style="vertical-align: inherit;">（默认值）。
        </font></font><code class="literal"><em class="replaceable"><code>key</code></em>=<em class="replaceable"><code>value</code></em></code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>key</code></em><font style="vertical-align: inherit;"></font><code class="literal">axis-order</code><font style="vertical-align: inherit;"></font><code class="literal">lat-long</code><font style="vertical-align: inherit;"></font><code class="literal">long-lat</code><font style="vertical-align: inherit;"></font><code class="literal">srid-defined</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
           </font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数无效，则会发生错误以指示原因。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果SRID参数引用未定义的空间参考系统（SRS），
           </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于地理SRS几何参数，如果任何参数的经度或纬度超出范围，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果经度值不在范围（-180,180）内，
               </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果纬度值不在[-90,90]范围内，
               </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          显示的范围以度为单位。</font><font style="vertical-align: inherit;">如果SRS使用其他单位，则该范围使用其单位中的相应值。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些函数可用于从WKT值创建几何：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-geomcollfromtext"></a><p>
          <a class="indexterm" name="idm140091679998816"></a>

          <a class="indexterm" name="idm140091679997776"></a>

          <a class="link" href="functions.html#function_st-geomcollfromtext"><code class="literal">ST_GeomCollFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>,
          <a class="link" href="functions.html#function_st-geomcollfromtext"><code class="literal">ST_GeometryCollectionFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>,
          <a class="link" href="functions.html#function_st-geomcollfromtext"><code class="literal">ST_GeomCollFromTxt(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">GeometryCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKT表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g = "MULTILINESTRING((10 10, 11 11), (9 9, 10 10))";</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_GeomCollFromText(@g));</code></strong><font></font>
+--------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_GeomCollFromText（@g））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MULTILINESTRING（（10 10,11 11），（9 9,10 10））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-geomfromtext"></a><p>
          <a class="indexterm" name="idm140091679979792"></a>

          <a class="indexterm" name="idm140091679978720"></a>

          <a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeometryFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用其WKT表示和SRID构造任何类型的几何值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-linefromtext"></a><p>
          <a class="indexterm" name="idm140091679967744"></a>

          <a class="indexterm" name="idm140091679966672"></a>

          <a class="link" href="functions.html#function_st-linefromtext"><code class="literal">ST_LineFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-linefromtext"><code class="literal">ST_LineStringFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKT表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-mlinefromtext"></a><p>
          <a class="indexterm" name="idm140091679955008"></a>

          <a class="indexterm" name="idm140091679953936"></a>

          <a class="link" href="functions.html#function_st-mlinefromtext"><code class="literal">ST_MLineFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-mlinefromtext"><code class="literal">ST_MultiLineStringFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKT表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-mpointfromtext"></a><p>
          <a class="indexterm" name="idm140091679942240"></a>

          <a class="indexterm" name="idm140091679941168"></a>

          <a class="link" href="functions.html#function_st-mpointfromtext"><code class="literal">ST_MPointFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-mpointfromtext"><code class="literal">ST_MultiPointFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKT表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-mpolyfromtext"></a><p>
          <a class="indexterm" name="idm140091679929504"></a>

          <a class="indexterm" name="idm140091679928432"></a>

          <a class="link" href="functions.html#function_st-mpolyfromtext"><code class="literal">ST_MPolyFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-mpolyfromtext"><code class="literal">ST_MultiPolygonFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKT表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-pointfromtext"></a><p>
          <a class="indexterm" name="idm140091679916816"></a>

          <a class="link" href="functions.html#function_st-pointfromtext"><code class="literal">ST_PointFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKT表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-pointfromtext"><code class="literal">ST_PointFromText()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-polyfromtext"></a><p>
          <a class="indexterm" name="idm140091679906512"></a>

          <a class="indexterm" name="idm140091679905440"></a>

          <a class="link" href="functions.html#function_st-polyfromtext"><code class="literal">ST_PolyFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-polyfromtext"><code class="literal">ST_PolygonFromText(<em class="replaceable"><code>wkt</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKT表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="gis-wkb-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.4从WKB值创建几何值的函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些函数将参数a作为
       </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含已知二进制（WKB）表示的参数，并且可选地包含空间参考系统标识符（SRID）。</font><font style="vertical-align: inherit;">它们返回相应的几何体。</font><font style="vertical-align: inherit;">有关WKB格式的说明，请参见</font></font><a class="xref" href="data-types.html#gis-wkb-format" title="众所周知的二进制（WKB）格式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">熟知二进制（WKB）格式</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中的函数检测笛卡尔或地理空间参照系（SRS）中的参数，并返回适合SRS的结果。
    </font></font></p><p>
      <a class="link" href="functions.html#function_st-geomfromwkb"><code class="literal">ST_GeomFromWKB()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接受任何几何类型的WKB值作为其第一个参数。</font><font style="vertical-align: inherit;">其他函数提供特定于类型的构造函数，用于构造每种几何类型的几何值。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在MySQL 8.0之前，这些函数还接受了</font></font><a class="xref" href="functions.html#gis-mysql-specific-functions" title="12.16.5创建几何值的特定于MySQL的函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.16.5节“创建几何值的MySQL特定函数”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的函数返回的几何对象
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">不再允许使用几何参数并产生错误。</font><font style="vertical-align: inherit;">要将调用从使用几何参数迁移到使用WKB参数，请遵循以下准则：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          重写结构，如</font></font><code class="literal">ST_GeomFromWKB(Point(0,
          0))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为</font></font><code class="literal">Point(0, 0)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          重写诸如</font></font><code class="literal">ST_GeomFromWKB(Point(0,
          0), 4326)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as </font></font><code class="literal">ST_SRID(Point(0, 0),
          4326)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">ST_GeomFromWKB(ST_AsWKB(Point(0,
          0)), 4326)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。之类的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果是WKB或SRID参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          默认情况下，地理坐标（纬度，经度）按几何参数的空间参考系统指定的顺序进行解释。</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以给出</font><font style="vertical-align: inherit;">可选
           </font><font style="vertical-align: inherit;">参数来覆盖默认轴顺序。</font></font><code class="option">options</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由逗号分隔列表组成
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">唯一</font><font style="vertical-align: inherit;">允许的值</font><font style="vertical-align: inherit;">是
           </font><font style="vertical-align: inherit;">，允许值为
           </font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">和
           </font><font style="vertical-align: inherit;">（默认值）。
        </font></font><code class="literal"><em class="replaceable"><code>key</code></em>=<em class="replaceable"><code>value</code></em></code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>key</code></em><font style="vertical-align: inherit;"></font><code class="literal">axis-order</code><font style="vertical-align: inherit;"></font><code class="literal">lat-long</code><font style="vertical-align: inherit;"></font><code class="literal">long-lat</code><font style="vertical-align: inherit;"></font><code class="literal">srid-defined</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
           </font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数无效，则会发生错误以指示原因。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果SRID参数引用未定义的空间参考系统（SRS），
           </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于地理SRS几何参数，如果任何参数的经度或纬度超出范围，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果经度值不在范围（-180,180）内，
               </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果纬度值不在[-90,90]范围内，
               </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          显示的范围以度为单位。</font><font style="vertical-align: inherit;">如果SRS使用其他单位，则该范围使用其单位中的相应值。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些函数可用于从WKB值创建几何：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-geomcollfromwkb"></a><p>
          <a class="indexterm" name="idm140091679857456"></a>

          <a class="indexterm" name="idm140091679856384"></a>

          <a class="link" href="functions.html#function_st-geomcollfromwkb"><code class="literal">ST_GeomCollFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-geomcollfromwkb"><code class="literal">ST_GeometryCollectionFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">GeometryCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKB表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-geomfromwkb"></a><p>
          <a class="indexterm" name="idm140091679844736"></a>

          <a class="indexterm" name="idm140091679843664"></a>

          <a class="link" href="functions.html#function_st-geomfromwkb"><code class="literal">ST_GeomFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-geomfromwkb"><code class="literal">ST_GeometryFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用其WKB表示和SRID构造任何类型的几何值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-linefromwkb"></a><p>
          <a class="indexterm" name="idm140091679832864"></a>

          <a class="indexterm" name="idm140091679831792"></a>

          <a class="link" href="functions.html#function_st-linefromwkb"><code class="literal">ST_LineFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-linefromwkb"><code class="literal">ST_LineStringFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKB表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-mlinefromwkb"></a><p>
          <a class="indexterm" name="idm140091679820144"></a>

          <a class="indexterm" name="idm140091679819072"></a>

          <a class="link" href="functions.html#function_st-mlinefromwkb"><code class="literal">ST_MLineFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-mlinefromwkb"><code class="literal">ST_MultiLineStringFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKB表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-mpointfromwkb"></a><p>
          <a class="indexterm" name="idm140091679807376"></a>

          <a class="indexterm" name="idm140091679806304"></a>

          <a class="link" href="functions.html#function_st-mpointfromwkb"><code class="literal">ST_MPointFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-mpointfromwkb"><code class="literal">ST_MultiPointFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKB表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-mpolyfromwkb"></a><p>
          <a class="indexterm" name="idm140091679794640"></a>

          <a class="indexterm" name="idm140091679793568"></a>

          <a class="link" href="functions.html#function_st-mpolyfromwkb"><code class="literal">ST_MPolyFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-mpolyfromwkb"><code class="literal">ST_MultiPolygonFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKB表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-pointfromwkb"></a><p>
          <a class="indexterm" name="idm140091679781968"></a>

          <a class="link" href="functions.html#function_st-pointfromwkb"><code class="literal">ST_PointFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKB表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-pointfromwkb"><code class="literal">ST_PointFromWKB()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p></li><li class="listitem"><a name="function_st-polyfromwkb"></a><p>
          <a class="indexterm" name="idm140091679771696"></a>

          <a class="indexterm" name="idm140091679770624"></a>

          <a class="link" href="functions.html#function_st-polyfromwkb"><code class="literal">ST_PolyFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-polyfromwkb"><code class="literal">ST_PolygonFromWKB(<em class="replaceable"><code>wkb</code></em>[,
          <em class="replaceable"><code>srid</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其WKB表示和SRID </font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些函数处理它们的参数，如本节的介绍中所述。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="gis-mysql-specific-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.5创建几何值的特定于MySQL的函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL提供了一组有用的非标准函数来创建几何值。</font><font style="vertical-align: inherit;">本节中描述的函数是OpenGIS规范的MySQL扩展。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些函数从WKB值或几何对象作为参数生成几何对象。</font><font style="vertical-align: inherit;">如果任何参数不是正确对象类型的正确WKB或几何表示，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      例如，您可以将几何返回值
       </font></font><a class="link" href="functions.html#function_point"><code class="literal">Point()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接插入到
       </font></font><code class="literal">POINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INSERT INTO t1（pt_col）VALUES（Point（1,2））;
</font></font></pre>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_geomcollection"></a><p>
          <a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection(<em class="replaceable"><code>g</code></em>
          [, <em class="replaceable"><code>g</code></em>] ...)</code></a>
        </p><a class="indexterm" name="idm140091679749136"></a><p><font style="vertical-align: inherit;"></font><code class="literal">GeomCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据几何参数</font><font style="vertical-align: inherit;">
          构造一个</font><font style="vertical-align: inherit;">值。
        </font></font></p><p>
          <a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 返回参数中包含的所有适当几何，即使存在不支持的几何体也是如此。
        </font></font></p><p>
          <a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许不带参数作为创建空几何的方法。</font><font style="vertical-align: inherit;">此外，诸如
           </font></font><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接受WKT几何集合参数的函数同时理解OpenGIS
           </font></font><code class="literal">'GEOMETRYCOLLECTION EMPTY'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准语法和MySQL </font></font><code class="literal">'GEOMETRYCOLLECTION()'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          非标准语法。
        </font></font></p><p>
          <a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font></font><a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是具有</font></font><a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首选功能的</font><font style="vertical-align: inherit;">同义词
           </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_geometrycollection"></a><p>
          <a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection(<em class="replaceable"><code>g</code></em>
          [, <em class="replaceable"><code>g</code></em>] ...)</code></a>
        </p><a class="indexterm" name="idm140091679730512"></a><p><font style="vertical-align: inherit;"></font><code class="literal">GeomCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据几何参数</font><font style="vertical-align: inherit;">
          构造一个</font><font style="vertical-align: inherit;">值。
        </font></font></p><p>
          <a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 返回参数中包含的所有适当几何，即使存在不支持的几何体也是如此。
        </font></font></p><p>
          <a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许不带参数作为创建空几何的方法。</font><font style="vertical-align: inherit;">此外，诸如
           </font></font><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接受WKT几何集合参数的函数同时理解OpenGIS
           </font></font><code class="literal">'GEOMETRYCOLLECTION EMPTY'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准语法和MySQL </font></font><code class="literal">'GEOMETRYCOLLECTION()'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          非标准语法。
        </font></font></p><p>
          <a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font></font><a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是具有</font></font><a class="link" href="functions.html#function_geomcollection"><code class="literal">GeomCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首选功能的</font><font style="vertical-align: inherit;">同义词
           </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_linestring"></a><p>
          <a class="link" href="functions.html#function_linestring"><code class="literal">LineString(<em class="replaceable"><code>pt</code></em>
          [, <em class="replaceable"><code>pt</code></em>] ...)</code></a>
        </p><a class="indexterm" name="idm140091679711936"></a><p><font style="vertical-align: inherit;"></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据许多</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或WKB </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数</font><font style="vertical-align: inherit;">
          构造一个</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果参数的数量小于2，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_multilinestring"></a><p>
          <a class="link" href="functions.html#function_multilinestring"><code class="literal">MultiLineString(<em class="replaceable"><code>ls</code></em>
          [, <em class="replaceable"><code>ls</code></em>] ...)</code></a>
        </p><a class="indexterm" name="idm140091679701552"></a><p><font style="vertical-align: inherit;"></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或WKB
           </font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值
           </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_multipoint"></a><p>
          <a class="link" href="functions.html#function_multipoint"><code class="literal">MultiPoint(<em class="replaceable"><code>pt</code></em>
          [, <em class="replaceable"><code>pt2</code></em>] ...)</code></a>
        </p><a class="indexterm" name="idm140091679692096"></a><p><font style="vertical-align: inherit;"></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或WKB </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数</font><font style="vertical-align: inherit;">
          构造</font><font style="vertical-align: inherit;">值
           </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_multipolygon"></a><p>
          <a class="link" href="functions.html#function_multipolygon"><code class="literal">MultiPolygon(<em class="replaceable"><code>poly</code></em>
          [, <em class="replaceable"><code>poly</code></em>] ...)</code></a>
        </p><a class="indexterm" name="idm140091679682560"></a><p><font style="vertical-align: inherit;"></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据一组</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或WKB
           </font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">
          构造一个</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_point"></a><p>
          <a class="link" href="functions.html#function_point"><code class="literal">Point(<em class="replaceable"><code>x</code></em>,
          <em class="replaceable"><code>y</code></em>)</code></a>
        </p><a class="indexterm" name="idm140091679673120"></a><p><font style="vertical-align: inherit;"></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用其坐标</font><font style="vertical-align: inherit;">
          构造a </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_polygon"></a><p>
          <a class="link" href="functions.html#function_polygon"><code class="literal">Polygon(<em class="replaceable"><code>ls</code></em> [,
          <em class="replaceable"><code>ls</code></em>] ...)</code></a>
        </p><a class="indexterm" name="idm140091679665152"></a><p><font style="vertical-align: inherit;"></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据许多</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或WKB
           </font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">
          构造一个</font><font style="vertical-align: inherit;">值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果任何参数不表示</font></font><code class="literal">LinearRing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（即，不是封闭且简单</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="gis-format-conversion-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.6几何格式转换函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL支持本节中列出的函数，用于将几何值从内部几何格式转换为WKT或WKB格式，或者用于交换X和Y坐标的顺序。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      还有将字符串从WKT或WKB格式转换为内部几何格式的函数。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="functions.html#gis-wkt-functions" title="12.16.3从WKT值创建几何值的函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.16.3节“从WKT值创建几何值的函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="xref" href="functions.html#gis-wkb-functions" title="12.16.4从WKB值创建几何值的函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.16.4节“从WKB值创建几何值的函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      比如函数</font></font><a class="link" href="functions.html#function_st-geomfromtext"><code class="literal">ST_GeomFromText()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      接受WKT几何集合参数了解双方开放地理信息系统</font></font><code class="literal">'GEOMETRYCOLLECTION EMPTY'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准语法和MySQL的</font></font><code class="literal">'GEOMETRYCOLLECTION()'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      非标准语法。</font><font style="vertical-align: inherit;">生成空几何集合的另一种方法是通过</font></font><a class="link" href="functions.html#function_geometrycollection"><code class="literal">GeometryCollection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不带参数</font><font style="vertical-align: inherit;">调用
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如函数
       </font></font><a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsWKT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      产生WKT值产生</font></font><code class="literal">'GEOMETRYCOLLECTION
      EMPTY'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准语法：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @s1 = ST_GeomFromText('GEOMETRYCOLLECTION()');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @s2 = ST_GeomFromText('GEOMETRYCOLLECTION EMPTY');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsWKT(@s1), ST_AsWKT(@s2);</code></strong><font></font>
+--------------------------+--------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsWKT（@ s1）| </font><font style="vertical-align: inherit;">ST_AsWKT（@ s2）|</font></font><font></font>
+--------------------------+--------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">GEOMETRYCOLLECTION EMPTY | </font><font style="vertical-align: inherit;">GEOMETRYCOLLECTION EMPTY |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+--------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsWKT(GeomCollection());</code></strong><font></font>
+----------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsWKT（GeomCollection（））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">GEOMETRYCOLLECTION EMPTY |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何几何参数不是语法上格式良好的几何体，
           </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何几何参数位于未定义的空间参照系中，则轴将按照它们在几何图形中出现的顺序输出，并发出
           </font></font><a class="link" href="error-handling.html#error_er_warn_srs_not_found_axis_order"><code class="literal">ER_WARN_SRS_NOT_FOUND_AXIS_ORDER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          警告。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          默认情况下，地理坐标（纬度，经度）按几何参数的空间参考系统指定的顺序进行解释。</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以给出</font><font style="vertical-align: inherit;">可选
           </font><font style="vertical-align: inherit;">参数来覆盖默认轴顺序。</font></font><code class="option">options</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由逗号分隔列表组成
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">唯一</font><font style="vertical-align: inherit;">允许的值</font><font style="vertical-align: inherit;">是
           </font><font style="vertical-align: inherit;">，允许值为
           </font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">和
           </font><font style="vertical-align: inherit;">（默认值）。
        </font></font><code class="literal"><em class="replaceable"><code>key</code></em>=<em class="replaceable"><code>value</code></em></code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>key</code></em><font style="vertical-align: inherit;"></font><code class="literal">axis-order</code><font style="vertical-align: inherit;"></font><code class="literal">lat-long</code><font style="vertical-align: inherit;"></font><code class="literal">long-lat</code><font style="vertical-align: inherit;"></font><code class="literal">srid-defined</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
           </font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数无效，则会发生错误以指示原因。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些函数可用于格式转换或坐标交换：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-asbinary"></a><p>
          <a class="link" href="functions.html#function_st-asbinary"><code class="literal">ST_AsBinary(<em class="replaceable"><code>g</code></em>
          [, <em class="replaceable"><code>options</code></em>])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-asbinary"><code class="literal">ST_AsWKB(<em class="replaceable"><code>g</code></em>
          [, <em class="replaceable"><code>options</code></em>])</code></a>
        </p><a class="indexterm" name="idm140091679615728"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将内部几何格式的值转换为其WKB表示并返回二进制结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数返回值具有应用于几何参数的空间参考系统指定的顺序的地理坐标（纬度，经度）。</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以给出</font><font style="vertical-align: inherit;">可选</font><font style="vertical-align: inherit;">参数来覆盖默认轴顺序。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-asbinary"><code class="literal">ST_AsBinary()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
           </font></font><a class="link" href="functions.html#function_st-asbinary"><code class="literal">ST_AsWKB()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          按照本节的介绍中的描述处理它们的参数。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g = ST_LineFromText('LINESTRING(0 5,5 10,10 15)', 4326);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromWKB(ST_AsWKB(@g)));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_GeomFromWKB（ST_AsWKB（@g）））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（5 0,10 5,15 10）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromWKB(ST_AsWKB(@g, 'axis-order=long-lat')));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_GeomFromWKB（ST_AsWKB（@ g，'axis-order = long-lat'）））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（0 5,5 10,10 15）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromWKB(ST_AsWKB(@g, 'axis-order=lat-long')));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_GeomFromWKB（ST_AsWKB（@ g，'axis-order = lat-long'）））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（5 0,10 5,15 10）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-astext"></a><p>
          <a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsText(<em class="replaceable"><code>g</code></em> [,
          <em class="replaceable"><code>options</code></em>])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsWKT(<em class="replaceable"><code>g</code></em>
          [, <em class="replaceable"><code>options</code></em>])</code></a>
        </p><a class="indexterm" name="idm140091679596272"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将内部几何格式的值转换为其WKT表示形式并返回字符串结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数返回值具有应用于几何参数的空间参考系统指定的顺序的地理坐标（纬度，经度）。</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以给出</font><font style="vertical-align: inherit;">可选</font><font style="vertical-align: inherit;">参数来覆盖默认轴顺序。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsText()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
           </font></font><a class="link" href="functions.html#function_st-astext"><code class="literal">ST_AsWKT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          按照本节的介绍中的描述处理它们的参数。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g = 'LineString(1 1,2 2,3 3)';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromText(@g));</code></strong><font></font>
+--------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_GeomFromText（@g））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（1 1,2 2,3 3）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值的</font><font style="vertical-align: inherit;">
          输出</font><font style="vertical-align: inherit;">包括每个点周围的括号。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromText(@mp));</code></strong><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_GeomFromText（@mp））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MULTIPOINT（（1 1），（2 2），（3 3））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-swapxy"></a><p>
          <a class="link" href="functions.html#function_st-swapxy"><code class="literal">ST_SwapXY(<em class="replaceable"><code>g</code></em>)</code></a>
        </p><a class="indexterm" name="idm140091679579216"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          接受内部几何格式的参数，交换几何中每个坐标对的X和Y值，并返回结果。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-swapxy"><code class="literal">ST_SwapXY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g = ST_LineFromText('LINESTRING(0 5,5 10,10 15)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(@g);</code></strong><font></font>
+----------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（@g）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（0 5,5 10,10 15）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_SwapXY(@g));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_SwapXY（@g））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（5 0,10 5,15 10）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="gis-property-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7几何属性函数</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#gis-general-property-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.1一般几何属性函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#gis-point-property-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.2点属性函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#gis-linestring-property-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.3 LineString和MultiLineString属性函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#gis-polygon-property-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.4多边形和多边形属性函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#gis-geometrycollection-property-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.5 GeometryCollection属性函数</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      属于该组的每个函数都将几何值作为其参数，并返回几何的一些定量或定性属性。</font><font style="vertical-align: inherit;">某些函数限制其参数类型。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数的几何类型不正确，则</font><font style="vertical-align: inherit;">返回此类函数</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，</font><font style="vertical-align: inherit;">如果对象类型既不是</font><font style="vertical-align: inherit;">也不</font><font style="vertical-align: inherit;">是
       </font><font style="vertical-align: inherit;">，则
       </font></font><a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回polygon函数
       </font><font style="vertical-align: inherit;">。
</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="gis-general-property-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.1一般几何属性函数</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节中列出的函数不限制其参数并接受任何类型的几何值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数不是语法上格式良好的几何体，
             </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数具有引用未定义空间参考系统（SRS）的SRID值，
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何SRID参数不在32位无符号整数的范围内，
             </font></font><a class="link" href="error-handling.html#error_er_data_out_of_range"><code class="literal">ER_DATA_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何SRID参数引用未定义的SRS，
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些函数可用于获取几何属性：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-dimension"></a><p>
            <a class="link" href="functions.html#function_st-dimension"><code class="literal">ST_Dimension(<em class="replaceable"><code>g</code></em>)</code></a>
          </p><a class="indexterm" name="idm140091679542912"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回几何值的固有尺寸
             </font></font><em class="replaceable"><code>g</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">尺寸可以是-1,0,1或2.这些值的含义在
             </font></font><a class="xref" href="data-types.html#gis-class-geometry" title="11.5.2.2几何类"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11.5.2.2节“几何类”中给出</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-dimension"><code class="literal">ST_Dimension()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_Dimension(ST_GeomFromText('LineString(1 1,2 2)'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Dimension（ST_GeomFromText（'LineString（1 1,2 2）'））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------------+</font></font><font></font>
|                                                    1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-envelope"></a><p>
            <a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope(<em class="replaceable"><code>g</code></em>)</code></a>
          </p><a class="indexterm" name="idm140091679530544"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回几何值的最小边界矩形（MBR）</font></font><em class="replaceable"><code>g</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">结果将返回</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为由边界框的角点定义</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POLYGON（（MINX MINY，MAXX MINY，MAXX MAXY，MINX MAXY，MINX MINY））
</font></font></pre><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Envelope(ST_GeomFromText('LineString(1 1,2 2)')));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Envelope（ST_GeomFromText（'LineString（1 1,2 2）'）））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">POLYGON（（1 1,2 1,2 2,1 2,1 1））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果参数是点或垂直或水平线段，则</font></font><a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回点或线段作为其MBR，而不是返回无效多边形：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Envelope(ST_GeomFromText('LineString(1 1,1 2)')));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Envelope（ST_GeomFromText（'LineString（1 1,1 2）'）））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（1 1,1 2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------+</font></font><font></font>
</pre><p>
            <a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何具有地理空间参考系统（SRS）的SRID值，
                 </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_geographic_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><a name="function_st-geometrytype"></a><p>
            <a class="link" href="functions.html#function_st-geometrytype"><code class="literal">ST_GeometryType(<em class="replaceable"><code>g</code></em>)</code></a>
          </p><a class="indexterm" name="idm140091679510896"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回二进制字符串，指示几何实例所属的几何类型的名称
             </font></font><em class="replaceable"><code>g</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该名称对应于一个可实例化的
             </font></font><code class="literal">Geometry</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子类。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-geometrytype"><code class="literal">ST_GeometryType()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_GeometryType(ST_GeomFromText('POINT(1 1)'));</code></strong><font></font>
+------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_GeometryType（ST_GeomFromText（'POINT（1 1）'））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-isempty"></a><p>
            <a class="link" href="functions.html#function_st-isempty"><code class="literal">ST_IsEmpty(<em class="replaceable"><code>g</code></em>)</code></a>
          </p><a class="indexterm" name="idm140091679498624"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此函数是占位符，对于空几何集合值返回1，否则返回0。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            唯一有效的空几何体以空几何集合值的形式表示。</font><font style="vertical-align: inherit;">MySQL不支持GIS </font></font><code class="literal">EMPTY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等</font></font><code class="literal">POINT
            EMPTY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-isempty"><code class="literal">ST_IsEmpty()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p></li><li class="listitem"><a name="function_st-issimple"></a><p>
            <a class="link" href="functions.html#function_st-issimple"><code class="literal">ST_IsSimple(<em class="replaceable"><code>g</code></em>)</code></a>
          </p><a class="indexterm" name="idm140091679487968"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>g</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            根据ISO </font></font><em class="citetitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL / MM第3部分：空间</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准</font><font style="vertical-align: inherit;">，几何值</font><font style="vertical-align: inherit;">很简单，</font><font style="vertical-align: inherit;">则返回1 </font><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="functions.html#function_st-issimple"><code class="literal">ST_IsSimple()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数不简单，则返回0。
          </font></font></p><p><font style="vertical-align: inherit;"></font><a class="xref" href="data-types.html#opengis-geometry-model" title="11.5.2 OpenGIS几何模型"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11.5.2节“OpenGIS几何模型”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
            给出的可实例化几何类的描述</font><font style="vertical-align: inherit;">包括导致类实例被分类为不简单的特定条件。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-issimple"><code class="literal">ST_IsSimple()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何体具有经度或纬度超出范围的地理SRS，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    如果任何经度参数不在范围（-180,180）内，
                     </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    则会发生错误。
                  </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    如果任何纬度参数不在[-90,90]范围内，
                     </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                显示的范围以度为单位。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><a name="function_st-srid"></a><p>
            <a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID(<em class="replaceable"><code>g</code></em>[,
            <em class="replaceable"><code>srid</code></em>])</code></a>
          </p><a class="indexterm" name="idm140091679468512"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用表示有效几何对象的单个参数
             </font></font><em class="replaceable"><code>g</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个整数，指示与之关联的空间参考系统（SRS）的ID </font></font><em class="replaceable"><code>g</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用表示有效SRID值的可选第二个参数，</font></font><a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回与其第一个参数具有相同类型的对象，其SRID值等于第二个参数。</font><font style="vertical-align: inherit;">这只设置对象的SRID值; </font><font style="vertical-align: inherit;">它不执行任何坐标值的转换。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                对于单参数语法，
                 </font></font><a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">即使它引用未定义的SRS，也会返回几何SRID。</font><font style="vertical-align: inherit;">一个
                 </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会发生错误。
</font></font></p></li></ul>
</div>
<p>
            <a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID(<em class="replaceable"><code>g</code></em>,
            <em class="replaceable"><code>target_srid</code></em>)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
             </font><font style="vertical-align: inherit;">不同如下：
</font></font><a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform(<em class="replaceable"><code>g</code></em>,
            <em class="replaceable"><code>target_srid</code></em>)</code></a><font style="vertical-align: inherit;"></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 更改几何SRID值而不转换其坐标。
              </font></font></p></li><li class="listitem"><p>
                <a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 除了更改其SRID值之外，还会转换几何坐标。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g = ST_GeomFromText('LineString(1 1,2 2)', 0);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_SRID(@g);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_SRID（@g）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
|           0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @g = ST_SRID(@g, 4326);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_SRID(@g);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_SRID（@g）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
|        4326 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            通过传递</font></font><a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于创建空间值的MySQL特定函数之一的结果以及SRID值，</font><font style="vertical-align: inherit;">可以在特定SRID中创建几何</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @ g1 = ST_SRID（Point（1,1），4326）;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            但是，该方法在SRID 0中创建几何，然后将其强制转换为SRID 4326（WGS 84）。</font><font style="vertical-align: inherit;">一个更好的选择是使用正确的空间参考系统创建几何体。</font><font style="vertical-align: inherit;">例如：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @ g1 = ST_PointFromText（'POINT（1 1）'，4326）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ g1 = ST_GeomFromText（'POINT（1 1）'，4326）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            双参数形式
             </font></font><a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于纠正或更改具有不正确SRID的几何的SRS等任务非常有用。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="gis-point-property-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.2点属性函数</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        A </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由X和Y坐标组成，可以分别使用
         </font></font><a class="link" href="functions.html#function_st-x"><code class="literal">ST_X()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="functions.html#function_st-y"><code class="literal">ST_Y()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数获得。</font><font style="vertical-align: inherit;">这些函数还允许使用可选的第二个参数来指定X或Y坐标值，在这种情况下，函数结果是</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自第一个参数</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">对象，其中相应的坐标被修改为等于第二个参数。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有地理空间参考系统（SRS）的对象，可以分别使用</font></font><a class="link" href="functions.html#function_st-longitude"><code class="literal">ST_Longitude()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="functions.html#function_st-latitude"><code class="literal">ST_Latitude()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">获得经度和纬度
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些函数还允许指定经度或纬度值的可选第二个参数，在这种情况下，函数结果是</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一个参数中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">对象，其经度或纬度被修改为等于第二个参数。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数是有效几何但不是
             </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象，
             </font></font><a class="link" href="error-handling.html#error_er_unexpected_geometry_type"><code class="literal">ER_UNEXPECTED_GEOMETRY_TYPE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数不是语法上格式良好的几何体，
             </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数具有引用未定义空间参考系统（SRS）的SRID值，
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果提供了一种X或Y坐标的参数和值是</font></font><code class="literal">-inf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">+inf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
             </font></font><code class="literal">NaN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，一个
             </font></font><a class="link" href="error-handling.html#error_er_data_out_of_range"><code class="literal">ER_DATA_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果经度或纬度参数超出范围，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果任何经度参数不在范围（-180,180）内，
                 </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果任何纬度参数不在[-90,90]范围内，
                 </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            显示的范围以度为单位。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些函数可用于获取点属性：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-latitude"></a><p>
            <a class="link" href="functions.html#function_st-latitude"><code class="literal">ST_Latitude(<em class="replaceable"><code>p</code></em>
            [, <em class="replaceable"><code>new_latitude_val</code></em>])</code></a>
          </p><a class="indexterm" name="idm140091679396160"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用表示</font><font style="vertical-align: inherit;">
            具有地理空间参照系（SRS）</font><font style="vertical-align: inherit;">的有效</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">的单个参数
             </font></font><em class="replaceable"><code>p</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_st-latitude"><code class="literal">ST_Latitude()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将纬度值</font></font><em class="replaceable"><code>p</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为双精度数返回。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用表示有效纬度值的可选第二个参数，</font></font><a class="link" href="functions.html#function_st-latitude"><code class="literal">ST_Latitude()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回一个</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象，如第一个参数，其纬度等于第二个参数。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-latitude"><code class="literal">ST_Latitude()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理其参数，如本节的介绍中所述，另外如果</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对象有效但没有地理SRS，
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_geographic"><code class="literal">ER_SRS_NOT_GEOGRAPHIC</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @pt = ST_GeomFromText('POINT(45 90)', 4326);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_Latitude(@pt);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Latitude（@pt）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
|               45 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Latitude(@pt, 10));</code></strong><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Latitude（@ ct，10））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（10 90）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此功能已在MySQL 8.0.12中添加。
          </font></font></p></li><li class="listitem"><a name="function_st-longitude"></a><p>
            <a class="link" href="functions.html#function_st-longitude"><code class="literal">ST_Longitude(<em class="replaceable"><code>p</code></em>
            [, <em class="replaceable"><code>new_longitude_val</code></em>])</code></a>
          </p><a class="indexterm" name="idm140091679374384"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用表示</font><font style="vertical-align: inherit;">
            具有地理空间参照系（SRS）</font><font style="vertical-align: inherit;">的有效</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">的单个参数
             </font></font><em class="replaceable"><code>p</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_st-longitude"><code class="literal">ST_Longitude()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将经度值</font></font><em class="replaceable"><code>p</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为双精度数返回。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用表示有效经度值的可选第二个参数，
             </font></font><a class="link" href="functions.html#function_st-longitude"><code class="literal">ST_Longitude()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个
             </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象，如第一个参数，其经度等于第二个参数。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-longitude"><code class="literal">ST_Longitude()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理其参数，如本节的介绍中所述，另外如果</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对象有效但没有地理SRS，
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_geographic"><code class="literal">ER_SRS_NOT_GEOGRAPHIC</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @pt = ST_GeomFromText('POINT(45 90)', 4326);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_Longitude(@pt);</code></strong><font></font>
+-------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Longitude（@pt）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+</font></font><font></font>
|                90 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Longitude(@pt, 10));</code></strong><font></font>
+----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Longitude（@pt，10））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（45 10）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此功能已在MySQL 8.0.12中添加。
          </font></font></p></li><li class="listitem"><a name="function_st-x"></a><p>
            <a class="link" href="functions.html#function_st-x"><code class="literal">ST_X(<em class="replaceable"><code>p</code></em>[,
            <em class="replaceable"><code>new_x_val</code></em>])</code></a>
          </p><a class="indexterm" name="idm140091679352720"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用表示有效</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象
             </font><font style="vertical-align: inherit;">的单个参数
             </font></font><em class="replaceable"><code>p</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_st-x"><code class="literal">ST_X()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将X坐标值</font></font><em class="replaceable"><code>p</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为双精度数返回。</font><font style="vertical-align: inherit;">从MySQL 8.0.12开始，X坐标被认为是指</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间参照系（SRS）定义</font><font style="vertical-align: inherit;">中首先出现的轴</font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用可选的第二个参数，
             </font></font><a class="link" href="functions.html#function_st-x"><code class="literal">ST_X()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个
             </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象，如第一个参数，其X坐标等于第二个参数。</font><font style="vertical-align: inherit;">从MySQL 8.0.12开始，如果</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象具有地理SRS，则第二个参数必须在经度或纬度值的适当范围内。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-x"><code class="literal">ST_X()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_X(Point(56.7, 53.34));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_X（Point（56.7,53.34））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+</font></font><font></font>
|                     56.7 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_X(Point(56.7, 53.34), 10.5));</code></strong><font></font>
+-------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_X（Point（56.7,53.34），10.5））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（10.5 53.34）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-y"></a><p>
            <a class="link" href="functions.html#function_st-y"><code class="literal">ST_Y(<em class="replaceable"><code>p</code></em>[,
            <em class="replaceable"><code>new_y_val</code></em>])</code></a>
          </p><a class="indexterm" name="idm140091679333152"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用表示有效</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象
             </font><font style="vertical-align: inherit;">的单个参数
             </font></font><em class="replaceable"><code>p</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_st-y"><code class="literal">ST_Y()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将Y坐标值</font></font><em class="replaceable"><code>p</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为双精度数返回。</font><font style="vertical-align: inherit;">从MySQL 8.0.12开始，Y坐标被认为是指</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间参照系（SRS）定义</font><font style="vertical-align: inherit;">中第二个出现的轴</font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用可选的第二个参数，
             </font></font><a class="link" href="functions.html#function_st-y"><code class="literal">ST_Y()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个
             </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象，如第一个参数，其Y坐标等于第二个参数。</font><font style="vertical-align: inherit;">从MySQL 8.0.12开始，如果</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象具有地理SRS，则第二个参数必须在经度或纬度值的适当范围内。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-y"><code class="literal">ST_Y()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_Y(Point(56.7, 53.34));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Y（Point（56.7,53.34））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+</font></font><font></font>
|                    53.34 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Y(Point(56.7, 53.34), 10.5));</code></strong><font></font>
+-------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Y（Point（56.7,53.34），10.5））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（56.7 10.5）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="gis-linestring-property-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.3 LineString和MultiLineString属性函数</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        A </font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由...组成
        </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可以提取a的特定点</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，计算它包含的点数或获取其长度。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节中的某些功能也适用于
        </font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何参数是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或任何几何参数是空几何，则返回值为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数不是语法上格式良好的几何体，
             </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数具有引用未定义空间参考系统（SRS）的SRID值，
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些函数可用于获取线串属性：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-endpoint"></a><p>
            <a class="indexterm" name="idm140091679299680"></a>

            <a class="link" href="functions.html#function_st-endpoint"><code class="literal">ST_EndPoint(<em class="replaceable"><code>ls</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font><font style="vertical-align: inherit;">的端点</font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-endpoint"><code class="literal">ST_EndPoint()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_EndPoint(ST_GeomFromText(@ls)));</code></strong><font></font>
+----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_EndPoint（ST_GeomFromText（@ls）））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（3 3）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-isclosed"></a><p>
            <a class="indexterm" name="idm140091679286080"></a>

            <a class="link" href="functions.html#function_st-isclosed"><code class="literal">ST_IsClosed(<em class="replaceable"><code>ls</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_st-isclosed"><code class="literal">ST_IsClosed()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关闭</font><font style="vertical-align: inherit;">则返回1
             </font><font style="vertical-align: inherit;">（即，它
             </font></font><a class="link" href="functions.html#function_st-startpoint"><code class="literal">ST_StartPoint()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="functions.html#function_st-endpoint"><code class="literal">ST_EndPoint()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值相同）。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于一个</font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_st-isclosed"><code class="literal">ST_IsClosed()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则返回1，如果
             </font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是封闭的（即，
             </font></font><a class="link" href="functions.html#function_st-startpoint"><code class="literal">ST_StartPoint()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="functions.html#function_st-endpoint"><code class="literal">ST_EndPoint()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是彼此相同</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的
             </font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-isclosed"><code class="literal">ST_IsClosed()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果返回0
             </font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是不封闭的，而
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-isclosed"><code class="literal">ST_IsClosed()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何具有地理空间参考系统（SRS）的SRID值，
                 </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_geographic_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ls1 = 'LineString(1 1,2 2,3 3,2 2)';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SET @ls2 = 'LineString(1 1,2 2,3 3,1 1)';</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_IsClosed(ST_GeomFromText(@ls1));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_IsClosed（ST_GeomFromText（@ ls1））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                                  0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_IsClosed(ST_GeomFromText(@ls2));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_IsClosed（ST_GeomFromText（@ ls2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font>
|                                  1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SET @ls3 = 'MultiLineString((1 1,2 2,3 3),(4 4,5 5))';</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_IsClosed(ST_GeomFromText(@ls3));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_IsClosed（ST_GeomFromText（@ ls3））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                                  0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-length"></a><p>
            <a class="indexterm" name="idm140091679252576"></a>

            <a class="link" href="functions.html#function_st-length"><code class="literal">ST_Length(<em class="replaceable"><code>ls</code></em>
            [, <em class="replaceable"><code>unit</code></em>])</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回一个双精度数字，表示</font><font style="vertical-align: inherit;">其关联空间参照系</font><font style="vertical-align: inherit;">中的</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font><font style="vertical-align: inherit;">的长度</font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的长度
             </font><font style="vertical-align: inherit;">等于其元素长度的总和。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-length"><code class="literal">ST_Length()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 计算结果如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                在笛卡尔SRS中</font><font style="vertical-align: inherit;">有效</font><font style="vertical-align: inherit;">，则返回值是几何的笛卡尔长度。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何</font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在笛卡尔SRS </font><font style="vertical-align: inherit;">中是有效的
                 </font><font style="vertical-align: inherit;">，则返回值是其元素的笛卡尔长度的总和。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                在地理SRS中</font><font style="vertical-align: inherit;">有效</font><font style="vertical-align: inherit;">，则返回值是该SRS中几何的大地长度（以米为单位）。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何</font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在地理SRS中</font><font style="vertical-align: inherit;">有效
                 </font><font style="vertical-align: inherit;">，则返回值是该SRS中其元素的大地长度之和（以米为单位）。
</font></font></p></li></ul>
</div>
<p>
            <a class="link" href="functions.html#function_st-length"><code class="literal">ST_Length()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何不是</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                或者</font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，返回值是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何在几何上无效，则结果是未定义的长度（即，它可以是任何数字），或者发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果长度计算结果是
                 </font></font><code class="literal">+inf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则发生
                 </font></font><a class="link" href="error-handling.html#error_er_data_out_of_range"><code class="literal">ER_DATA_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何体具有经度或纬度超出范围的地理SRS，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    如果任何经度参数不在范围（-180,180）内，
                     </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    则会发生错误。
                  </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    如果任何纬度参数不在[-90,90]范围内，
                     </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                显示的范围以度为单位。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 8.0.16开始，
             </font></font><a class="link" href="functions.html#function_st-length"><code class="literal">ST_Length()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许使用可选</font></font><em class="replaceable"><code>unit</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数来指定返回长度值的线性单位。</font><font style="vertical-align: inherit;">这些规则适用于：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果指定了单元但MySQL不支持，
                 </font></font><a class="link" href="error-handling.html#error_er_unit_not_found"><code class="literal">ER_UNIT_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果指定了支持的线性单位且SRID为0，
                 </font></font><a class="link" href="error-handling.html#error_er_geometry_in_unknown_length_unit"><code class="literal">ER_GEOMETRY_IN_UNKNOWN_LENGTH_UNIT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果指定了受支持的线性单位且SRID不为0，则结果为该单位。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果未指定单位，则结果以几何的SRS为单位，无论是笛卡尔坐标还是地理坐标。</font><font style="vertical-align: inherit;">目前，所有MySQL SRS都以米为单位表示。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果在</font></font><code class="literal">INFORMATION_SCHEMA</code>
            <a class="link" href="information-schema.html#st-units-of-measure-table" title="25.29 INFORMATION_SCHEMA ST_UNITS_OF_MEASURE表"><code class="literal">ST_UNITS_OF_MEASURE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表中</font><font style="vertical-align: inherit;">找到，则支持单位
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="information-schema.html#st-units-of-measure-table" title="25.29 INFORMATION_SCHEMA ST_UNITS_OF_MEASURE表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第25.29节“INFORMATION_SCHEMA ST_UNITS_OF_MEASURE表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ls = ST_GeomFromText('LineString(1 1,2 2,3 3)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_Length(@ls);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Length（@ls）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+</font></font><font></font>
| 2.8284271247461903 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @mls = ST_GeomFromText('MultiLineString((1 1,2 2,3 3),(4 4,5 5))');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_Length(@mls);</code></strong><font></font>
+-------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Length（@mls）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+</font></font><font></font>
| 4.242640687119286 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @ls = ST_GeomFromText('LineString(1 1,2 2,3 3)', 4326);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_Length(@ls);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Length（@ls）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+</font></font><font></font>
| 313701.9623204328 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_Length(@ls, 'metre');</code></strong><font></font>
+-------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Length（@ls，'meter'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font>
|       313701.9623204328 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_Length(@ls, 'foot');</code></strong><font></font>
+------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Length（@ls，'foot'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+</font></font><font></font>
|     1029205.9131247795 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-numpoints"></a><p>
            <a class="indexterm" name="idm140091679197264"></a>

            <a class="link" href="functions.html#function_st-numpoints"><code class="literal">ST_NumPoints(<em class="replaceable"><code>ls</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回的数量</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中的对象</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-numpoints"><code class="literal">ST_NumPoints()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_NumPoints(ST_GeomFromText(@ls));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_NumPoints（ST_GeomFromText（@ls））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font>
|                                  3 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-pointn"></a><p>
            <a class="indexterm" name="idm140091679183792"></a>

            <a class="link" href="functions.html#function_st-pointn"><code class="literal">ST_PointN(<em class="replaceable"><code>ls</code></em>,
            <em class="replaceable"><code>N</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">个
             </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中
             </font></font><code class="literal">Linestring</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">点数从1开始编号。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-pointn"><code class="literal">ST_PointN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_PointN(ST_GeomFromText(@ls),2));</code></strong><font></font>
+----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_PointN（ST_GeomFromText（@ls），2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（2 2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-startpoint"></a><p>
            <a class="indexterm" name="idm140091679169344"></a>

            <a class="link" href="functions.html#function_st-startpoint"><code class="literal">ST_StartPoint(<em class="replaceable"><code>ls</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">那是的起点</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font></font><em class="replaceable"><code>ls</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-startpoint"><code class="literal">ST_StartPoint()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ls = 'LineString(1 1,2 2,3 3)';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_StartPoint(ST_GeomFromText(@ls)));</code></strong><font></font>
+------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_StartPoint（ST_GeomFromText（@ls）））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（1 1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="gis-polygon-property-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.4多边形和多边形属性函数</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节中的函数返回</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或的</font><font style="vertical-align: inherit;">属性
        </font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何参数是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或任何几何参数是空几何，则返回值为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数不是语法上格式良好的几何体，
             </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数具有引用未定义空间参考系统（SRS）的SRID值，
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于采用多个几何参数的函数，如果这些参数不具有相同的SRID，
             </font></font><a class="link" href="error-handling.html#error_er_gis_different_srids"><code class="literal">ER_GIS_DIFFERENT_SRIDS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些函数可用于获取多边形属性：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-area"></a><p>
            <a class="indexterm" name="idm140091679139504"></a>

            <a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area({<em class="replaceable"><code>poly</code></em>|<em class="replaceable"><code>mpoly</code></em>})</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回一个双精度数字，表示</font><font style="vertical-align: inherit;">在其空间参照系中测量</font><font style="vertical-align: inherit;">的</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">的区域
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 8.0.13开始，</font></font><a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            按照本节的介绍中的描述处理其参数，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何在几何上无效，则结果是未定义区域（即，它可以是任何数字），或者发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何有效但不是
                 </font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象，
                 </font></font><a class="link" href="error-handling.html#error_er_unexpected_geometry_type"><code class="literal">ER_UNEXPECTED_GEOMETRY_TYPE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在笛卡尔SRS </font><font style="vertical-align: inherit;">中是有效的</font><font style="vertical-align: inherit;">，则结果是多边形的笛卡尔区域。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何</font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在笛卡尔SRS </font><font style="vertical-align: inherit;">中是有效的
                 </font><font style="vertical-align: inherit;">，则结果是多边形的笛卡尔面积的总和。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在地理SRS中</font><font style="vertical-align: inherit;">有效</font><font style="vertical-align: inherit;">，则结果是该SRS中多边形的大地测量区域，以平方米为单位。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何</font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在地理SRS中</font><font style="vertical-align: inherit;">有效
                 </font><font style="vertical-align: inherit;">，则结果是该SRS中多边形的大地面积总和，以平方米为单位。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果导致区域计算
                 </font></font><code class="literal">+inf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则发生
                 </font></font><a class="link" href="error-handling.html#error_er_data_out_of_range"><code class="literal">ER_DATA_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何体具有经度或纬度超出范围的地理SRS，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    如果任何经度参数不在范围（-180,180）内，
                     </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    则会发生错误。
                  </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    如果任何纬度参数不在[-90,90]范围内，
                     </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                显示的范围以度为单位。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在MySQL 8.0.13之前，
             </font></font><a class="link" href="functions.html#function_st-area"><code class="literal">ST_Area()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按照本节的介绍中的描述处理其参数，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                对于维度0或1的参数，结果为0。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何为空，则返回值为0而不是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                对于几何集合，结果是所有组件的面积值的总和。</font><font style="vertical-align: inherit;">如果几何集合为空，则其区域返回为0。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何具有地理空间参考系统（SRS）的SRID值，
                 </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_geographic_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>'Polygon((0 0,0 3,3 0,0 0),(1 1,1 2,2 1,1 1))';</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>SELECT ST_Area(ST_GeomFromText(@poly));</code></strong><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Area（ST_GeomFromText（@poly））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
|                               4 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SET @mpoly =</code></strong>
       <strong class="userinput"><code>'MultiPolygon(((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1)))';</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>SELECT ST_Area(ST_GeomFromText(@mpoly));</code></strong><font></font>
+----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Area（ST_GeomFromText（@mpoly））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
|                                8 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-centroid"></a><p>
            <a class="indexterm" name="idm140091679092928"></a>

            <a class="link" href="functions.html#function_st-centroid"><code class="literal">ST_Centroid({<em class="replaceable"><code>poly</code></em>|<em class="replaceable"><code>mpoly</code></em>})</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">的数学质心
             </font><font style="vertical-align: inherit;">作为
             </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">结果不能保证在</font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此函数通过计算集合中最高维度的组件的质心点来处理几何集合。</font><font style="vertical-align: inherit;">这样的成分被提取并制作成单个</font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为质心计算。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-centroid"><code class="literal">ST_Centroid()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                返回值是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数为空几何集合的附加条件。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果几何具有地理空间参考系统（SRS）的SRID值，
                 </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_geographic_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>ST_GeomFromText('POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7,5 5))');</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>SELECT ST_GeometryType(@poly),ST_AsText(ST_Centroid(@poly));</code></strong><font></font>
+------------------------+--------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_GeometryType（@poly）| </font><font style="vertical-align: inherit;">ST_AsText（ST_Centroid（@poly））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">POLYGON | </font><font style="vertical-align: inherit;">要点（4.958333333333333 4.958333333333333）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+--------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-exteriorring"></a><p>
            <a class="indexterm" name="idm140091679069216"></a>

            <a class="link" href="functions.html#function_st-exteriorring"><code class="literal">ST_ExteriorRing(<em class="replaceable"><code>poly</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            值的</font><font style="vertical-align: inherit;">外环</font></font><em class="replaceable"><code>poly</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为a
             </font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-exteriorring"><code class="literal">ST_ExteriorRing()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>SELECT ST_AsText(ST_ExteriorRing(ST_GeomFromText(@poly)));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_ExteriorRing（ST_GeomFromText（@ poly）））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（0 0,0 3,3 3,3 0,0 0）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-interiorringn"></a><p>
            <a class="indexterm" name="idm140091679054720"></a>

            <a class="link" href="functions.html#function_st-interiorringn"><code class="literal">ST_InteriorRingN(<em class="replaceable"><code>poly</code></em>,
            <em class="replaceable"><code>N</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了个内环</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font></font><em class="replaceable"><code>poly</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为
             </font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">戒指从1开始编号。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-interiorringn"><code class="literal">ST_InteriorRingN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>SELECT ST_AsText(ST_InteriorRingN(ST_GeomFromText(@poly),1));</code></strong><font></font>
+-------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_InteriorRingN（ST_GeomFromText（@ poly），1））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（1 1,1 2,2 2,2 1,1 1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-numinteriorrings"></a><p>
            <a class="indexterm" name="idm140091679039280"></a>

            <a class="indexterm" name="idm140091679038208"></a>

            <a class="link" href="functions.html#function_st-numinteriorrings"><code class="literal">ST_NumInteriorRing(<em class="replaceable"><code>poly</code></em>)</code></a>,
            <a class="link" href="functions.html#function_st-numinteriorrings"><code class="literal">ST_NumInteriorRings(<em class="replaceable"><code>poly</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回内部环的数量
             </font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font></font><em class="replaceable"><code>poly</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-numinteriorrings"><code class="literal">ST_NumInteriorRing()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            和 </font></font><a class="link" href="functions.html#function_st-numinteriorrings"><code class="literal">ST_NuminteriorRings()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
            按照本节的介绍中的描述处理它们的参数。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SET @poly =</code></strong>
       <strong class="userinput"><code>'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>SELECT ST_NumInteriorRings(ST_GeomFromText(@poly));</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_NumInteriorRings（ST_GeomFromText（@poly））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
|                                           1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="gis-geometrycollection-property-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.7.5 GeometryCollection属性函数</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些函数返回</font></font><code class="literal">GeometryCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值的</font><font style="vertical-align: inherit;">属性
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何参数是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或任何几何参数是空几何，则返回值为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数不是语法上格式良好的几何体，
             </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数具有引用未定义空间参考系统（SRS）的SRID值，
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些函数可用于获取几何集合属性：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-geometryn"></a><p>
            <a class="indexterm" name="idm140091679008208"></a>

            <a class="link" href="functions.html#function_st-geometryn"><code class="literal">ST_GeometryN(<em class="replaceable"><code>gc</code></em>,
            <em class="replaceable"><code>N</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font><font style="vertical-align: inherit;">值
             </font><font style="vertical-align: inherit;">中的</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第th个几何
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">几何图形从1开始编号。
          </font></font><code class="literal">GeometryCollection</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>gc</code></em><font style="vertical-align: inherit;"></font></p><p>
            <a class="link" href="functions.html#function_st-geometryn"><code class="literal">ST_GeometryN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @gc = 'GeometryCollection(Point(1 1),LineString(2 2, 3 3))';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_GeometryN(ST_GeomFromText(@gc),1));</code></strong><font></font>
+-------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_GeometryN（ST_GeomFromText（@gc），1））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（1 1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-numgeometries"></a><p>
            <a class="indexterm" name="idm140091678994320"></a>

            <a class="link" href="functions.html#function_st-numgeometries"><code class="literal">ST_NumGeometries(<em class="replaceable"><code>gc</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回几何数量
             </font></font><code class="literal">GeometryCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
             </font></font><em class="replaceable"><code>gc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-numgeometries"><code class="literal">ST_NumGeometries()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @gc = 'GeometryCollection(Point(1 1),LineString(2 2, 3 3))';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_NumGeometries(ST_GeomFromText(@gc));</code></strong><font></font>
+----------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_NumGeometries（ST_GeomFromText（@gc））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font>
|                                      2 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="spatial-operator-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.8空间算子函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      OpenGIS提出了许多可以生成几何的函数。</font><font style="vertical-align: inherit;">它们旨在实现空间运算符。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些函数支持所有参数类型组合，但根据</font><a class="ulink" href="http://www.opengeospatial.org" target="_top"><font style="vertical-align: inherit;">Open Geospatial Consortium</font></a><font style="vertical-align: inherit;">不适用的参数类型组合除外
      </font></font><a class="ulink" href="http://www.opengeospatial.org" target="_top"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规范</font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何几何参数不是语法上格式良好的几何体，
           </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何几何参数具有引用未定义空间参考系统（SRS）的SRID值，
           </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于采用多个几何参数的函数，如果这些参数不具有相同的SRID，
           </font></font><a class="link" href="error-handling.html#error_er_gis_different_srids"><code class="literal">ER_GIS_DIFFERENT_SRIDS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何geometry参数具有地理SRS的SRID值，
           </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_geographic_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些空间操作员功能可用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-buffer"></a><p>
          <a class="indexterm" name="idm140091678963824"></a>

          <a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer(<em class="replaceable"><code>g</code></em>,
          <em class="replaceable"><code>d</code></em>[,
          <em class="replaceable"><code>strategy1</code></em>[,
          <em class="replaceable"><code>strategy2</code></em>[,
          <em class="replaceable"><code>strategy3</code></em>]]])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个几何图形，表示距几何体值的距离</font></font><em class="replaceable"><code>g</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小于或等于距离的</font><font style="vertical-align: inherit;">所有点</font></font><em class="replaceable"><code>d</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果geometry参数为空，则
           </font></font><a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回空几何。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果距离为0，则
           </font></font><a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回几何参数不变：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @pt = ST_GeomFromText('POINT(0 0)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Buffer(@pt, 0));</code></strong><font></font>
+------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Buffer（@pt，0））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">POINT（0 0）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font>
</pre><p>
          <a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持负距离</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，以及包含</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值的</font><font style="vertical-align: inherit;">几何集合</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">结果可能是空几何。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在distance参数后最多允许三个可选的策略参数。</font><font style="vertical-align: inherit;">策略影响缓冲计算。</font><font style="vertical-align: inherit;">这些参数是</font></font><a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">生成的字节字符串值
           </font><font style="vertical-align: inherit;">，用于点，连接和结束策略：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              点策略适用于</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">几何。</font><font style="vertical-align: inherit;">如果未指定点策略，则默认为
               </font></font><a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy('point_circle',
              32)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              加入策略适用于</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
               </font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">几何形状。</font><font style="vertical-align: inherit;">如果未指定连接策略，则默认为
               </font></font><a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy('join_round',
              32)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              最终策略适用于</font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">几何。</font><font style="vertical-align: inherit;">如果未指定结束策略，则默认为
               </font></font><a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy('end_round',
              32)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以指定每种类型的最多一种策略，并且可以以任何顺序给出它们。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用于为负的距离</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
               </font></font><code class="literal">MultiLineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值，而对于不包含任何几何形状的集合
               </font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值时，
               </font></font><a class="link" href="error-handling.html#error_er_wrong_arguments"><code class="literal">ER_WRONG_ARGUMENTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会出现误差。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果指定了给定类型的多个策略，
               </font></font><a class="link" href="error-handling.html#error_er_wrong_arguments"><code class="literal">ER_WRONG_ARGUMENTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @pt = ST_GeomFromText('POINT(0 0)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @pt_strategy = ST_Buffer_Strategy('point_square');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Buffer(@pt, 2, @pt_strategy));</code></strong><font></font>
+--------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Buffer（@pt，2，@ ts_strategy））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">POLYGON（（ -  2 -2,2 -2,2 2，-2 2，-2 -2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font>
</pre><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ls = ST_GeomFromText('LINESTRING(0 0,0 5,5 5)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @end_strategy = ST_Buffer_Strategy('end_flat');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @join_strategy = ST_Buffer_Strategy('join_round', 10);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Buffer(@ls, 5, @end_strategy, @join_strategy))</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Buffer（@ls，5，@ end_strategy，@ join_strategy））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">POLYGON（（5 5,5 10,0 10，-3.5355339059327373 8.535533905932738，|</font></font><font></font>
| -5 5,-5 0,0 0,5 0,5 5))                                       |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-buffer-strategy"></a><p>
          <a class="indexterm" name="idm140091678906784"></a>

          <a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy(<em class="replaceable"><code>strategy</code></em>[,
          <em class="replaceable"><code>points_per_circle</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数返回一个策略字节字符串，用于
           </font></font><a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">影响缓冲区计算。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关策略的信息，请访问
           </font></font><a class="ulink" href="http://www.boost.org" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boost.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          第一个参数必须是指示策略选项的字符串：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于点策略，允许的值是
               </font></font><code class="literal">'point_circle'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">'point_square'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于连接策略，允许的值是
               </font></font><code class="literal">'join_round'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">'join_miter'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于最终策略，允许的值是
               </font></font><code class="literal">'end_round'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">'end_flat'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果第一个参数是</font></font><code class="literal">'point_circle'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">'join_round'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">'join_miter'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><code class="literal">'end_round'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该
           </font></font><em class="replaceable"><code>points_per_circle</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数必须被给定为正的数值。</font><font style="vertical-align: inherit;">最大值
           </font></font><em class="replaceable"><code>points_per_circle</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><a class="link" href="server-administration.html#sysvar_max_points_in_geometry"><code class="literal">max_points_in_geometry</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">的值
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关示例，请参阅说明
           </font></font><a class="link" href="functions.html#function_st-buffer"><code class="literal">ST_Buffer()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-buffer-strategy"><code class="literal">ST_Buffer_Strategy()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果任何参数无效，
               </font></font><a class="link" href="error-handling.html#error_er_wrong_arguments"><code class="literal">ER_WRONG_ARGUMENTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果第一个参数是</font></font><code class="literal">'point_square'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              或</font></font><code class="literal">'end_flat'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则
               </font></font><em class="replaceable"><code>points_per_circle</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能给出参数或发生
               </font></font><a class="link" href="error-handling.html#error_er_wrong_arguments"><code class="literal">ER_WRONG_ARGUMENTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><a name="function_st-convexhull"></a><p>
          <a class="indexterm" name="idm140091678873536"></a>

          <a class="link" href="functions.html#function_st-convexhull"><code class="literal">ST_ConvexHull(<em class="replaceable"><code>g</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回表示几何值的凸包的几何</font></font><em class="replaceable"><code>g</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数通过首先检查其顶点是否为共线来计算几何体的凸包。</font><font style="vertical-align: inherit;">如果是这样，该函数返回一个线性外壳，否则返回一个多边形外壳。</font><font style="vertical-align: inherit;">此函数通过提取集合的所有组件的所有顶点，</font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从中</font><font style="vertical-align: inherit;">创建</font><font style="vertical-align: inherit;">值以及计算其凸包来</font><font style="vertical-align: inherit;">处理几何集合
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-convexhull"><code class="literal">ST_ConvexHull()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回值是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数为空几何集合的附加条件。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g = 'MULTIPOINT(5 0,25 0,15 10,15 25)';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_ConvexHull(ST_GeomFromText(@g)));</code></strong><font></font>
+-----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_ConvexHull（ST_GeomFromText（@g）））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">POLYGON（（5 0,25 0,15 25,5 0））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-difference"></a><p>
          <a class="indexterm" name="idm140091678857184"></a>

          <a class="link" href="functions.html#function_st-difference"><code class="literal">ST_Difference(<em class="replaceable"><code>g1</code></em>,
          <em class="replaceable"><code>g2</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回表示几何值的点集差异的几何形状</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-difference"><code class="literal">ST_Difference()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = Point(1,1), @g2 = Point(2,2);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Difference(@g1, @g2));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Difference（@ g1，@ g2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（1 1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-intersection"></a><p>
          <a class="indexterm" name="idm140091678843536"></a>

          <a class="link" href="functions.html#function_st-intersection"><code class="literal">ST_Intersection(<em class="replaceable"><code>g1</code></em>,
          <em class="replaceable"><code>g2</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回表示几何值的点交集的几何形状</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-intersection"><code class="literal">ST_Intersection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = ST_GeomFromText('LineString(1 1, 3 3)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @g2 = ST_GeomFromText('LineString(1 3, 3 1)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Intersection(@g1, @g2));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Intersection（@ g1，@ g2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（2 2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-symdifference"></a><p>
          <a class="indexterm" name="idm140091678829136"></a>

          <a class="link" href="functions.html#function_st-symdifference"><code class="literal">ST_SymDifference(<em class="replaceable"><code>g1</code></em>,
          <em class="replaceable"><code>g2</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回表示设置的几何值的对称差的点的几何形状
           </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其被定义为：
        </font></font></p><pre data-lang="clike" class="programlisting"><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">symdifference </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：=（</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">联合</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）差异（</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">交集</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者，在函数调用表示法中：
        </font></font></p><pre data-lang="clike" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ST_SymDifference（</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）= ST_Difference（ST_Union（</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），ST_Intersection（</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">））
</font></font></pre><p>
          <a class="link" href="functions.html#function_st-symdifference"><code class="literal">ST_SymDifference()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = Point(1,1), @g2 = Point(2,2);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_SymDifference(@g1, @g2));</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_SymDifference（@ g1，@ g2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MULTIPOINT（（1 1），（2 2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-transform"></a><p>
          <a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform(<em class="replaceable"><code>g</code></em>,
          <em class="replaceable"><code>target_srid</code></em>)</code></a>
        </p><a class="indexterm" name="idm140091678806160"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将几何体从一个空间参照系（SRS）转换为另一个。</font><font style="vertical-align: inherit;">返回值是与输入几何体相同类型的几何体，所有坐标都转换为目标SRID , </font></font><em class="replaceable"><code>target_srid</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">转换支持仅限于地理SRS，除非geometry参数的SRID与目标SRID值相同，在这种情况下，返回值是任何有效SRS的输入几何。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              具有地理SRS的SRID值的几何参数不会产生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果几何或目标SRID参数具有引用未定义空间参考系统（SRS）的SRID值，</font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果几何体位于</font></font><a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无法转换
               </font><font style="vertical-align: inherit;">的SRS中，
               </font></font><a class="link" href="error-handling.html#error_er_transform_source_srs_not_supported"><code class="literal">ER_TRANSFORM_SOURCE_SRS_NOT_SUPPORTED</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果目标SRID位于</font></font><a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无法转换为
               </font><font style="vertical-align: inherit;">的SRS中，
               </font></font><a class="link" href="error-handling.html#error_er_transform_target_srs_not_supported"><code class="literal">ER_TRANSFORM_TARGET_SRS_NOT_SUPPORTED</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果几何体位于不是WGS 84且没有TOWGS84子句的SRS中，
               </font></font><a class="link" href="error-handling.html#error_er_transform_source_srs_missing_towgs84"><code class="literal">ER_TRANSFORM_SOURCE_SRS_MISSING_TOWGS84</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果目标SRID位于不是WGS 84且没有TOWGS84子句的SRS中，
               </font></font><a class="link" href="error-handling.html#error_er_transform_target_srs_missing_towgs84"><code class="literal">ER_TRANSFORM_TARGET_SRS_MISSING_TOWGS84</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
</font></font></p></li></ul>
</div>
<p>
          <a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID(<em class="replaceable"><code>g</code></em>,
          <em class="replaceable"><code>target_srid</code></em>)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font><font style="vertical-align: inherit;">不同如下：
</font></font><a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform(<em class="replaceable"><code>g</code></em>,
          <em class="replaceable"><code>target_srid</code></em>)</code></a><font style="vertical-align: inherit;"></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <a class="link" href="functions.html#function_st-srid"><code class="literal">ST_SRID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 更改几何SRID值而不转换其坐标。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="functions.html#function_st-transform"><code class="literal">ST_Transform()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 除了更改其SRID值之外，还会转换几何坐标。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @p = ST_GeomFromText('POINT(52.381389 13.064444)', 4326);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(@p);</code></strong><font></font>
+----------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（@p）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（52.381389 13.064444）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @p = ST_Transform(@p, 4230);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(@p);</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（@p）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（52.38208611407426 13.065520672345304）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-union"></a><p>
          <a class="indexterm" name="idm140091678768224"></a>

          <a class="link" href="functions.html#function_st-union"><code class="literal">ST_Union(<em class="replaceable"><code>g1</code></em>,
          <em class="replaceable"><code>g2</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回表示几何值的点集联合的几何形状</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-union"><code class="literal">ST_Union()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = ST_GeomFromText('LineString(1 1, 3 3)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @g2 = ST_GeomFromText('LineString(1 3, 3 1)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Union(@g1, @g2));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Union（@ g1，@ g2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MULTILINESTRING（（1 1,3 3），（1 3,3 1））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font>
</pre></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      此外，</font></font><a class="xref" href="functions.html#gis-property-functions" title="12.16.7几何属性函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.16.7节“几何属性函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">讨论了从现有几何构造新几何的几个函数。</font><font style="vertical-align: inherit;">有关这些功能的说明，请参阅该部分：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="functions.html#function_st-envelope"><code class="literal">ST_Envelope(<em class="replaceable"><code>g</code></em>)</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="functions.html#function_st-startpoint"><code class="literal">ST_StartPoint(<em class="replaceable"><code>ls</code></em>)</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="functions.html#function_st-endpoint"><code class="literal">ST_EndPoint(<em class="replaceable"><code>ls</code></em>)</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="functions.html#function_st-pointn"><code class="literal">ST_PointN(<em class="replaceable"><code>ls</code></em>,
          <em class="replaceable"><code>N</code></em>)</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="functions.html#function_st-exteriorring"><code class="literal">ST_ExteriorRing(<em class="replaceable"><code>poly</code></em>)</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="functions.html#function_st-interiorringn"><code class="literal">ST_InteriorRingN(<em class="replaceable"><code>poly</code></em>,
          <em class="replaceable"><code>N</code></em>)</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="functions.html#function_st-geometryn"><code class="literal">ST_GeometryN(<em class="replaceable"><code>gc</code></em>,
          <em class="replaceable"><code>N</code></em>)</code></a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="spatial-relation-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.9测试几何对象之间空间关系的函数</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#spatial-relation-functions-object-shapes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.9.1使用对象形状的空间关系函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#spatial-relation-functions-mbr"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.9.2使用最小边界矩形的空间关系函数</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中描述的函数将两个几何作为参数，并返回它们之间的定性或定量关系。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL使用OpenGIS规范定义的函数名实现两组函数。</font><font style="vertical-align: inherit;">一组使用精确的对象形状测试两个几何值之间的关系，另一组使用对象最小边界矩形（MBR）。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="spatial-relation-functions-object-shapes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.9.1使用对象形状的空间关系函数</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        OpenGIS规范定义了以下函数来测试两个几何值之间的关系，
         </font></font><code class="literal">g1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code class="literal">g2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用精确的对象形状。</font><font style="vertical-align: inherit;">返回值1和0分别表示true和false，除了
         </font></font><a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回距离值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节中的函数检测笛卡尔或地理空间参照系（SRS）中的参数，并返回适合SRS的结果。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何参数是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或任何几何参数是空几何，则返回值为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数不是语法上格式良好的几何体，
             </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数引用未定义的空间参考系统（SRS），
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于采用多个几何参数的函数，如果这些参数不具有相同的SRID，
             </font></font><a class="link" href="error-handling.html#error_er_gis_different_srids"><code class="literal">ER_GIS_DIFFERENT_SRIDS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数在几何上无效，则结果为true或false（未定义哪个），或者发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于地理SRS几何参数，如果任何参数的经度或纬度超出范围，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果经度值不在范围（-180,180）内，
                 </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果纬度值不在[-90,90]范围内，
                 </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            显示的范围以度为单位。</font><font style="vertical-align: inherit;">如果SRS使用其他单位，则该范围使用其单位中的相应值。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些对象形状函数可用于测试几何关系：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-contains"></a><p>
            <a class="indexterm" name="idm140091678706112"></a>

            <a class="link" href="functions.html#function_st-contains"><code class="literal">ST_Contains(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0以指示是否
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全包含
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这测试了相反的关系</font></font><a class="link" href="functions.html#function_st-within"><code class="literal">ST_Within()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-contains"><code class="literal">ST_Contains()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p></li><li class="listitem"><a name="function_st-crosses"></a><p>
            <a class="indexterm" name="idm140091678695008"></a>

            <a class="link" href="functions.html#function_st-crosses"><code class="literal">ST_Crosses(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果空间关系具有以下属性，则</font><font style="vertical-align: inherit;">
            两个几何在</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间上交叉</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                除非</font></font><code class="literal">g1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且</font></font><code class="literal">g2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                都是尺寸1：</font><font style="vertical-align: inherit;">如果内部的内部
                 </font><font style="vertical-align: inherit;">具有与内部相同</font><font style="vertical-align: inherit;">但
                 </font><font style="vertical-align: inherit;">不覆盖整个内部的</font></font><code class="literal">g1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">十字形
                 </font><font style="vertical-align: inherit;">。
              </font></font><code class="literal">g2</code><font style="vertical-align: inherit;"></font><code class="literal">g2</code><font style="vertical-align: inherit;"></font><code class="literal">g1</code><font style="vertical-align: inherit;"></font><code class="literal">g2</code><font style="vertical-align: inherit;"></font><code class="literal">g1</code><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果两个</font></font><code class="literal">g1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">g2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                是尺寸1的：如果线彼此交叉在一个有限数目的点（即，没有共同的线段，仅在普通的单点）。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此函数返回1或0以指示是否在
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间上交叉
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-crosses"><code class="literal">ST_Crosses()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理其参数，如本节前言中所述，但返回值是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">针对以下附加条件：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">g1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是2（</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">维度</font><font style="vertical-align: inherit;">。
              </font></font></p></li><li class="listitem"><p>
                <em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是维度1（</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><a name="function_st-disjoint"></a><p>
            <a class="indexterm" name="idm140091678668240"></a>

            <a class="link" href="functions.html#function_st-disjoint"><code class="literal">ST_Disjoint(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0以指示是否
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在空间上不相交（不相交）</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-disjoint"><code class="literal">ST_Disjoint()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p></li><li class="listitem"><a name="function_st-distance"></a><p>
            <a class="indexterm" name="idm140091678658368"></a>

            <a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em> [,
            <em class="replaceable"><code>unit</code></em>])</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font><font style="vertical-align: inherit;">几何参数的空间参照系（SRS）的长度单位</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            和</font><font style="vertical-align: inherit;">之间的距离</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><em class="replaceable"><code>unit</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果指定</font><font style="vertical-align: inherit;">，则以可选</font><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">为单位
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此函数通过返回两个几何参数的所有组件组合中的最短距离来处理几何集合。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其几何参数，如本节前言中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测地理（椭圆体）空间参照系中的参数，并返回椭圆体上的测地距离。</font><font style="vertical-align: inherit;">唯一允许的地理参数类型是</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                 </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                和</font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（在任何参数顺序）。</font><font style="vertical-align: inherit;">如果在地理SRS中使用其他几何类型参数组合调用，
                 </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_geographic_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果任何参数在几何上无效，则结果是未定义的距离（即，它可以是任何数字），或者发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果中间或最终结果产生
                 </font></font><code class="literal">NaN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或为负数，
                 </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 8.0.14开始，
             </font></font><a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许使用可选</font></font><em class="replaceable"><code>unit</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数来指定返回距离值的线性单位。</font><font style="vertical-align: inherit;">这些规则适用于：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果指定了单元但MySQL不支持，
                 </font></font><a class="link" href="error-handling.html#error_er_unit_not_found"><code class="literal">ER_UNIT_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果指定了支持的线性单位且SRID为0，
                 </font></font><a class="link" href="error-handling.html#error_er_geometry_in_unknown_length_unit"><code class="literal">ER_GEOMETRY_IN_UNKNOWN_LENGTH_UNIT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果指定了受支持的线性单位且SRID不为0，则结果为该单位。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果未指定单位，则结果以几何的SRS为单位，无论是笛卡尔坐标还是地理坐标。</font><font style="vertical-align: inherit;">目前，所有MySQL SRS都以米为单位表示。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果在</font></font><code class="literal">INFORMATION_SCHEMA</code>
            <a class="link" href="information-schema.html#st-units-of-measure-table" title="25.29 INFORMATION_SCHEMA ST_UNITS_OF_MEASURE表"><code class="literal">ST_UNITS_OF_MEASURE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表中</font><font style="vertical-align: inherit;">找到，则支持单位
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="information-schema.html#st-units-of-measure-table" title="25.29 INFORMATION_SCHEMA ST_UNITS_OF_MEASURE表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第25.29节“INFORMATION_SCHEMA ST_UNITS_OF_MEASURE表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = Point(1,1);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @g2 = Point(2,2);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_Distance(@g1, @g2);</code></strong><font></font>
+-----------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Distance（@ g1，@ g2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+</font></font><font></font>
|    1.4142135623730951 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = ST_GeomFromText('POINT(1 1)', 4326);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @g2 = ST_GeomFromText('POINT(2 2)', 4326);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_Distance(@g1, @g2);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Distance（@ g1，@ g2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+</font></font><font></font>
|     156874.3859490455 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_Distance(@g1, @g2, 'metre');</code></strong><font></font>
+--------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Distance（@ g1，@ g2，'meter'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------+</font></font><font></font>
|              156874.3859490455 |<font></font>
+--------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_Distance(@g1, @g2, 'foot');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Distance（@ g1，@ g2，'foot'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
|             514679.7439273146 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关球体上距离计算的特殊情况，请参阅该</font></font><a class="link" href="functions.html#function_st-distance-sphere"><code class="literal">ST_Distance_Sphere()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            函数。
          </font></font></p></li><li class="listitem"><a name="function_st-equals"></a><p>
            <a class="indexterm" name="idm140091678613232"></a>

            <a class="link" href="functions.html#function_st-equals"><code class="literal">ST_Equals(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0以指示是否
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在空间上等于
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-equals"><code class="literal">ST_Equals()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理其参数，如本节的介绍中所述，除了它不返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空几何参数。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = Point(1,1), @g2 = Point(2,2);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_Equals(@g1, @g1), ST_Equals(@g1, @g2);</code></strong><font></font>
+---------------------+---------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Equals（@ g1，@ g1）| </font><font style="vertical-align: inherit;">ST_Equals（@ g1，@ g2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------+---------------------+</font></font><font></font>
|                   1 |                   0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------+---------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-intersects"></a><p>
            <a class="indexterm" name="idm140091678598928"></a>

            <a class="link" href="functions.html#function_st-intersects"><code class="literal">ST_Intersects(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0以指示是否在
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间上相交
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-intersects"><code class="literal">ST_Intersects()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p></li><li class="listitem"><a name="function_st-overlaps"></a><p>
            <a class="indexterm" name="idm140091678589088"></a>

            <a class="link" href="functions.html#function_st-overlaps"><code class="literal">ST_Overlaps(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果它们相交，则</font><font style="vertical-align: inherit;">
            两个几何在</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间上重叠</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且它们的交点产生相同尺寸的几何形状但不等于给定几何形状中的任何一个。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此函数返回1或0以指示是否在
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间上重叠
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-overlaps"><code class="literal">ST_Overlaps()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理其参数，如本节的介绍中所述，除了返回值是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">针对两个几何的尺寸不相等的附加条件。
          </font></font></p></li><li class="listitem"><a name="function_st-touches"></a><p>
            <a class="indexterm" name="idm140091678577328"></a>

            <a class="link" href="functions.html#function_st-touches"><code class="literal">ST_Touches(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果它们的内部不相交，则</font><font style="vertical-align: inherit;">
            两个几何在</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间上接触</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是一个几何的边界与另一个的边界或内部相交。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此函数返回1或0以指示是否在
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间上接触
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-touches"><code class="literal">ST_Touches()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理其参数，如本节的介绍中所述，除了返回值是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">针对两个几何都是维度0（</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">的附加条件</font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_st-within"></a><p>
            <a class="indexterm" name="idm140091678564144"></a>

            <a class="link" href="functions.html#function_st-within"><code class="literal">ST_Within(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0以指示是否
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在空间内
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这测试了相反的关系
             </font></font><a class="link" href="functions.html#function_st-contains"><code class="literal">ST_Contains()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_st-within"><code class="literal">ST_Within()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="spatial-relation-functions-mbr"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.9.2使用最小边界矩形的空间关系函数</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140091678554464"></a><a class="indexterm" name="idm140091678553424"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL提供用于测试最小外接矩形两个几何的（MBR）的之间的关系几个MySQL特定功能</font></font><code class="literal">g1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">g2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">返回值1和0分别表示true和false。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        点的边界框被解释为边界和内部的点。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        直水平或垂直线的边界框被解释为线的内部也是边界的线。</font><font style="vertical-align: inherit;">端点是边界点。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果任何参数是几何集合，则这些参数的内部，边界和外部是集合中所有元素的并集的参数。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节中的函数检测笛卡尔或地理空间参照系（SRS）中的参数，并返回适合SRS的结果。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或是空几何，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数不是语法上格式良好的几何体，
             </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何几何参数引用未定义的空间参考系统（SRS），
             </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于采用多个几何参数的函数，如果这些参数不具有相同的SRID，
             </font></font><a class="link" href="error-handling.html#error_er_gis_different_srids"><code class="literal">ER_GIS_DIFFERENT_SRIDS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果任何参数在几何上无效，则结果为true或false（未定义哪个），或者发生错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于地理SRS几何参数，如果任何参数的经度或纬度超出范围，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果经度值不在范围（-180,180）内，
                 </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果纬度值不在[-90,90]范围内，
                 </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            显示的范围以度为单位。</font><font style="vertical-align: inherit;">如果SRS使用其他单位，则该范围使用其单位中的相应值。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些MBR函数可用于测试几何关系：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_mbrcontains"></a><p>
            <a class="indexterm" name="idm140091678524720"></a>

            <a class="link" href="functions.html#function_mbrcontains"><code class="literal">MBRContains(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0以指示最小边界矩形是否</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含最小边界矩形</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这测试了相反的关系
             </font></font><a class="link" href="functions.html#function_mbrwithin"><code class="literal">MBRWithin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_mbrcontains"><code class="literal">MBRContains()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = ST_GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @g2 = ST_GeomFromText('Point(1 1)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT MBRContains(@g1,@g2), MBRWithin(@g2,@g1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+--------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MBRContains（@ g1，@ g2）| </font><font style="vertical-align: inherit;">MBRWithin（@ g2，@ g1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+--------------------+</font></font><font></font>
|                    1 |                  1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+--------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_mbrcoveredby"></a><p>
            <a class="indexterm" name="idm140091678510304"></a>

            <a class="link" href="functions.html#function_mbrcoveredby"><code class="literal">MBRCoveredBy(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0以指示最小边界矩形是否被最小边界矩形</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">覆盖</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这测试了相反的关系
             </font></font><a class="link" href="functions.html#function_mbrcovers"><code class="literal">MBRCovers()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_mbrcoveredby"><code class="literal">MBRCoveredBy()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = ST_GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @g2 = ST_GeomFromText('Point(1 1)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT MBRCovers(@g1,@g2), MBRCoveredby(@g1,@g2);</code></strong><font></font>
+--------------------+-----------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MBRCovers（@ g1，@ g2）| </font><font style="vertical-align: inherit;">MBRCoveredby（@ g1，@ g2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+-----------------------+</font></font><font></font>
|                  1 |                     0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+-----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT MBRCovers(@g2,@g1), MBRCoveredby(@g2,@g1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+-----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MBRCovers（@ g2，@ g1）| </font><font style="vertical-align: inherit;">MBRCoveredby（@ g2，@ g1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+-----------------------+</font></font><font></font>
|                  0 |                     1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+-----------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_mbrcovers"></a><p>
            <a class="indexterm" name="idm140091678494656"></a>

            <a class="link" href="functions.html#function_mbrcovers"><code class="literal">MBRCovers(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0以指示最小边界矩形是否</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">覆盖最小边界矩形</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这测试了相反的关系
             </font></font><a class="link" href="functions.html#function_mbrcoveredby"><code class="literal">MBRCoveredBy()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参阅</font></font><a class="link" href="functions.html#function_mbrcoveredby"><code class="literal">MBRCoveredBy()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            示例的说明。
          </font></font></p><p>
            <a class="link" href="functions.html#function_mbrcovers"><code class="literal">MBRCovers()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p></li><li class="listitem"><a name="function_mbrdisjoint"></a><p>
            <a class="indexterm" name="idm140091678482224"></a>

            <a class="link" href="functions.html#function_mbrdisjoint"><code class="literal">MBRDisjoint(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0，以指示两个几何的最小外接矩形是否
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是不相交的（不相交）。
          </font></font></p><p>
            <a class="link" href="functions.html#function_mbrdisjoint"><code class="literal">MBRDisjoint()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p></li><li class="listitem"><a name="function_mbrequals"></a><p>
            <a class="indexterm" name="idm140091678472992"></a>

            <a class="link" href="functions.html#function_mbrequals"><code class="literal">MBREquals(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0，以指示最低是否界定两个几何的矩形
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是相同的。
          </font></font></p><p>
            <a class="link" href="functions.html#function_mbrequals"><code class="literal">MBREquals()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理其参数，如本节的介绍中所述，除了它不返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空几何参数。
          </font></font></p></li><li class="listitem"><a name="function_mbrintersects"></a><p>
            <a class="indexterm" name="idm140091678462304"></a>

            <a class="link" href="functions.html#function_mbrintersects"><code class="literal">MBRIntersects(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0，以指示两个几何的最小外接矩形是否
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相交。
          </font></font></p><p>
            <a class="link" href="functions.html#function_mbrintersects"><code class="literal">MBRIntersects()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p></li><li class="listitem"><a name="function_mbroverlaps"></a><p>
            <a class="indexterm" name="idm140091678452416"></a>

            <a class="link" href="functions.html#function_mbroverlaps"><code class="literal">MBROverlaps(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果它们相交，则</font><font style="vertical-align: inherit;">
            两个几何在</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间上重叠</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且它们的交点产生相同尺寸的几何形状但不等于给定几何形状中的任何一个。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此函数返回1或0，以指示是否所述两个几何的最小外接矩形
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重叠。
          </font></font></p><p>
            <a class="link" href="functions.html#function_mbroverlaps"><code class="literal">MBROverlaps()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p></li><li class="listitem"><a name="function_mbrtouches"></a><p>
            <a class="indexterm" name="idm140091678441472"></a>

            <a class="link" href="functions.html#function_mbrtouches"><code class="literal">MBRTouches(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果它们的内部不相交，则</font><font style="vertical-align: inherit;">
            两个几何在</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间上接触</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是一个几何的边界与另一个的边界或内部相交。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此函数返回1或0，以指示最低是否界定两个几何的矩形
             </font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">触感。
          </font></font></p><p>
            <a class="link" href="functions.html#function_mbrtouches"><code class="literal">MBRTouches()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p></li><li class="listitem"><a name="function_mbrwithin"></a><p>
            <a class="indexterm" name="idm140091678430512"></a>

            <a class="link" href="functions.html#function_mbrwithin"><code class="literal">MBRWithin(<em class="replaceable"><code>g1</code></em>,
            <em class="replaceable"><code>g2</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回1或0以指示最小边界矩形是否在最小边界矩形</font></font><em class="replaceable"><code>g1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内</font></font><em class="replaceable"><code>g2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这测试了相反的关系
             </font></font><a class="link" href="functions.html#function_mbrcontains"><code class="literal">MBRContains()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_mbrwithin"><code class="literal">MBRWithin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g1 = ST_GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @g2 = ST_GeomFromText('Polygon((0 0,0 5,5 5,5 0,0 0))');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT MBRWithin(@g1,@g2), MBRWithin(@g2,@g1);</code></strong><font></font>
+--------------------+--------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">MBRWithin（@ g1，@ g2）| </font><font style="vertical-align: inherit;">MBRWithin（@ g2，@ g1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+--------------------+</font></font><font></font>
|                  1 |                  0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+--------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="spatial-geohash-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.10空间Geohash函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Geohash是一种将任意精度的纬度和经度坐标编码为文本字符串的系统。</font><font style="vertical-align: inherit;">Geohash值是仅包含从中选择的字符的字符串
       </font></font><code class="literal">"0123456789bcdefghjkmnpqrstuvwxyz"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中的函数允许操作geohash值，这为应用程序提供了导入和导出geohash数据的功能，以及索引和搜索geohash值的功能。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何参数无效，则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何参数的经度或纬度超出范围，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果任何经度参数不在范围（-180,180）内，
               </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果任何纬度参数不在[-90,90]范围内，
               </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          显示的范围以度为单位。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何点参数没有SRID 0或4326，
           </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
          </font></font><em class="replaceable"><code>point</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数SRID有效性未被检查。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何SRID参数引用未定义的空间参考系统（SRS），
           </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何SRID参数不在32位无符号整数的范围内，
           </font></font><a class="link" href="error-handling.html#error_er_data_out_of_range"><code class="literal">ER_DATA_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些geohash功能可用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-geohash"></a><p>
          <a class="indexterm" name="idm140091678392224"></a>

          <a class="link" href="functions.html#function_st-geohash"><code class="literal">ST_GeoHash(<em class="replaceable"><code>longitude</code></em>,
          <em class="replaceable"><code>latitude</code></em>,
          <em class="replaceable"><code>max_length</code></em>)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_st-geohash"><code class="literal">ST_GeoHash(<em class="replaceable"><code>point</code></em>,
          <em class="replaceable"><code>max_length</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回连接字符集和排序规则中的geohash字符串。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于第一种语法，</font></font><em class="replaceable"><code>longitude</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          必须是[-180,180]范围内的数字，并且
           </font></font><em class="replaceable"><code>latitude</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是[-90,90]范围内的数字。</font><font style="vertical-align: inherit;">对于第二种语法，</font></font><code class="literal">POINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要</font><font style="vertical-align: inherit;">一个
           </font><font style="vertical-align: inherit;">值，其中X和Y坐标分别位于经度和纬度的有效范围内。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          生成的字符串不会超过
           </font></font><em class="replaceable"><code>max_length</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符，其上限为100.字符串可能比</font></font><em class="replaceable"><code>max_length</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符</font><font style="vertical-align: inherit;">短，
           </font><font style="vertical-align: inherit;">因为创建geohash值的算法会一直持续，直到创建了一个字符串，该字符串是位置或</font></font><em class="replaceable"><code>max_length</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字符</font><font style="vertical-align: inherit;">的精确表示形式</font><font style="vertical-align: inherit;">， 以先到者为准。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-geohash"><code class="literal">ST_GeoHash()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_GeoHash(180,0,10), ST_GeoHash(-180,-90,15);</code></strong><font></font>
+----------------------+-------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_GeoHash（180,0,10）| </font><font style="vertical-align: inherit;">ST_GeoHash（-180，-90,15）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">xbpbpbpbpb | </font><font style="vertical-align: inherit;">000000000000000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+-------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-latfromgeohash"></a><p>
          <a class="indexterm" name="idm140091678373552"></a>

          <a class="link" href="functions.html#function_st-latfromgeohash"><code class="literal">ST_LatFromGeoHash(<em class="replaceable"><code>geohash_str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从geohash字符串值返回纬度，作为[-90,90]范围内的双精度数。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的</font></font><a class="link" href="functions.html#function_st-latfromgeohash"><code class="literal">ST_LatFromGeoHash()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          解码功能读取来自不超过433个字符
           </font></font><em class="replaceable"><code>geohash_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数。</font><font style="vertical-align: inherit;">这表示坐标值的内部表示中的信息的上限。</font><font style="vertical-align: inherit;">超过433rd的字符将被忽略，即使它们是非法的并产生错误。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-latfromgeohash"><code class="literal">ST_LatFromGeoHash()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_LatFromGeoHash(ST_GeoHash(45,-20,10));</code></strong><font></font>
+------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_LatFromGeoHash（ST_GeoHash（45，-20,10））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------+</font></font><font></font>
|                                      -20 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-longfromgeohash"></a><p>
          <a class="indexterm" name="idm140091678359792"></a>

          <a class="link" href="functions.html#function_st-longfromgeohash"><code class="literal">ST_LongFromGeoHash(<em class="replaceable"><code>geohash_str</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从geohash字符串值返回经度，作为[-180,180]范围内的双精度数。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_st-latfromgeohash"><code class="literal">ST_LatFromGeoHash()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于从</font></font><em class="replaceable"><code>geohash_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">处理的最大字符数
           </font><font style="vertical-align: inherit;">
          的描述中的注释
           </font><font style="vertical-align: inherit;">也适用于
           </font></font><a class="link" href="functions.html#function_st-longfromgeohash"><code class="literal">ST_LongFromGeoHash()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-longfromgeohash"><code class="literal">ST_LongFromGeoHash()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_LongFromGeoHash(ST_GeoHash(45,-20,10));</code></strong><font></font>
+-------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_LongFromGeoHash（ST_GeoHash（45，-20,10））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font>
|                                        45 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-pointfromgeohash"></a><p>
          <a class="indexterm" name="idm140091678344960"></a>

          <a class="link" href="functions.html#function_st-pointfromgeohash"><code class="literal">ST_PointFromGeoHash(<em class="replaceable"><code>geohash_str</code></em>,
          <em class="replaceable"><code>srid</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"></font><code class="literal">POINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给定geohash字符串值，</font><font style="vertical-align: inherit;">
          返回</font><font style="vertical-align: inherit;">包含已解码的geohash值的值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该点的X和Y坐标分别是范围[-180,180]中的经度和范围[-90,90]中的纬度。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所述</font></font><em class="replaceable"><code>srid</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是一个32位无符号整数。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_st-latfromgeohash"><code class="literal">ST_LatFromGeoHash()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于从</font></font><em class="replaceable"><code>geohash_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">处理的最大字符数
           </font><font style="vertical-align: inherit;">
          的描述中的注释
           </font><font style="vertical-align: inherit;">也适用于
           </font></font><a class="link" href="functions.html#function_st-pointfromgeohash"><code class="literal">ST_PointFromGeoHash()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-pointfromgeohash"><code class="literal">ST_PointFromGeoHash()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @gh = ST_GeoHash(45,-20,10);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_PointFromGeoHash(@gh,0));</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_PointFromGeoHash（@ gh，0））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">POINT（45 -20）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="spatial-geojson-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.11空间GeoJSON函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍在GeoJSON文档和空间值之间进行转换的功能。</font><font style="vertical-align: inherit;">GeoJSON是一种用于编码几何/地理特征的开放标准。</font><font style="vertical-align: inherit;">有关更多信息，请访问</font></font><a class="ulink" href="http://geojson.org" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://geojson.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这里讨论的函数遵循GeoJSON规范1.0版。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      GeoJSON支持MySQL支持的相同几何/地理数据类型。</font><font style="vertical-align: inherit;">除了从中提取几何对象外，不支持Feature和FeatureCollection对象。</font><font style="vertical-align: inherit;">CRS支持仅限于标识SRID的值。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL还支持本机</font></font><a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      数据类型和一组SQL函数，以启用对JSON值的操作。</font><font style="vertical-align: inherit;">有关更多信息，请参见</font></font><a class="xref" href="data-types.html#json" title="11.6 JSON数据类型"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11.6节“JSON数据类型”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="xref" href="functions.html#json-functions" title="12.17 JSON函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.17节“JSON函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-asgeojson"></a><p>
          <a class="indexterm" name="idm140091678320096"></a>

          <a class="link" href="functions.html#function_st-asgeojson"><code class="literal">ST_AsGeoJSON(<em class="replaceable"><code>g</code></em>
          [, <em class="replaceable"><code>max_dec_digits</code></em> [,
          <em class="replaceable"><code>options</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从几何体生成GeoJSON对象
           </font></font><em class="replaceable"><code>g</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对象字符串具有连接字符集和排序规则。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果任何非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数无效，则会发生错误。
        </font></font></p><p>
          <em class="replaceable"><code>max_dec_digits</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果指定，则限制坐标的小数位数并导致输出舍入。</font><font style="vertical-align: inherit;">如果未指定，则此参数默认为其最大值2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1.最小值为0。
        </font></font></p><p>
          <em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果指定，则是位掩码。</font><font style="vertical-align: inherit;">下表显示了允许的标志值。</font><font style="vertical-align: inherit;">如果geometry参数的SRID为0，则即使对于请求一个的标志值，也不会生成CRS对象。
</font></font></p>
<div class="informaltable">
<table summary="Option flags for the ST_AsGeoJSON() function."><colgroup><col width="10%"><col width="90%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">旗帜价值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含义</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有选择。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未指定，</font><font style="vertical-align: inherit;">则为默认值</font><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在输出中添加边界框。</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在输出中添加短格式CRS URN。</font><font style="vertical-align: inherit;">默认格式是短格式（</font><font style="vertical-align: inherit;">）。</font></font><code class="literal">EPSG:<em class="replaceable"><code>srid</code></em></code><font style="vertical-align: inherit;"></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加长格式CRS URN（</font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">此标志覆盖标志2.例如，选项值5和7表示相同（添加边界框和长格式CRS URN）。</font></font><code class="literal">urn:ogc:def:crs:EPSG::<em class="replaceable"><code>srid</code></em></code><font style="vertical-align: inherit;"></font></td>
</tr></tbody></table>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsGeoJSON(ST_GeomFromText('POINT(11.11111 12.22222)'),2);</code></strong><font></font>
+-------------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsGeoJSON（ST_GeomFromText（'POINT（11.11111 12.22222）'），2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“type”：“Point”，“coordinates”：[11.11,12.22]} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-geomfromgeojson"></a><p>
          <a class="indexterm" name="idm140091678285408"></a>

          <a class="link" href="functions.html#function_st-geomfromgeojson"><code class="literal">ST_GeomFromGeoJSON(<em class="replaceable"><code>str</code></em>
          [, <em class="replaceable"><code>options</code></em> [,
          <em class="replaceable"><code>srid</code></em>]])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          解析</font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示GeoJSON对象</font><font style="vertical-align: inherit;">的字符串</font><font style="vertical-align: inherit;">并返回几何。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果任何非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数无效，则会发生错误。
        </font></font></p><p>
          <em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果给定，则描述如何处理包含坐标尺寸大于2的几何的GeoJSON文档。下表显示了允许的</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
</font></font></p>
<div class="informaltable">
<table summary="Option flags for the ST_GeomFromGeoJSON() function."><colgroup><col width="10%"><col width="90%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">期权价值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含义</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拒绝文档并产生错误。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未指定，</font><font style="vertical-align: inherit;">则为默认值
                 </font><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row">2, 3, 4</td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接受文档并剥离坐标以获得更高的坐标尺寸。</font></font></td>
</tr></tbody></table>
</div>
<p>
          <em class="replaceable"><code>options</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值2,3和4目前产生相同的效果。</font><font style="vertical-align: inherit;">如果将来支持坐标尺寸大于2的几何图形，则这些值将产生不同的效果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的</font></font><em class="replaceable"><code>srid</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，如果给定的，必须是一个32位无符号整数。</font><font style="vertical-align: inherit;">如果未给出，则几何返回值的SRID为4326。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>srid</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引用未定义的空间参照系（SRS），
           </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于地理SRS几何参数，如果任何参数的经度或纬度超出范围，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果经度值不在范围（-180,180）内，
               </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果纬度值不在[-90,90]范围内，
               </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          显示的范围以度为单位。</font><font style="vertical-align: inherit;">如果SRS使用其他单位，则该范围使用其单位中的相应值。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          GeoJSON几何，要素和要素集合对象可能具有</font></font><code class="literal">crs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性。</font><font style="vertical-align: inherit;">解析函数解析</font><font style="vertical-align: inherit;">
          和</font><font style="vertical-align: inherit;">
          名称空间</font><font style="vertical-align: inherit;">中的命名CRS URN </font><font style="vertical-align: inherit;">，但不</font><font style="vertical-align: inherit;">解析
           </font><font style="vertical-align: inherit;">作为链接对象给出的CRS。</font><font style="vertical-align: inherit;">此外，
           </font><font style="vertical-align: inherit;">还被识别为SRID 4326.如果对象具有未被理解的CRS，则会发生错误，但如果</font><font style="vertical-align: inherit;">给出</font><font style="vertical-align: inherit;">可选
           </font><font style="vertical-align: inherit;">参数，则即使CRS无效，也会忽略任何CRS。
        </font></font><code class="literal">urn:ogc:def:crs:EPSG::<em class="replaceable"><code>srid</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">EPSG:<em class="replaceable"><code>srid</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">urn:ogc:def:crs:OGC:1.3:CRS84</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>srid</code></em><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><code class="literal">crs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在GeoJSON文档的较低级别找到指定与顶级对象SRID不同的SRID </font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">成员，
           </font></font><a class="link" href="error-handling.html#error_er_invalid_geojson_crs_not_top_level"><code class="literal">ER_INVALID_GEOJSON_CRS_NOT_TOP_LEVEL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          正如GeoJSON规范中所指定的，解析对于</font></font><code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GeoJSON输入</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">成员（</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等等）</font><font style="vertical-align: inherit;">区分大小写</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该规范没有提及其他解析的区分大小写，在MySQL中它不区分大小写。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此示例显示了简单GeoJSON对象的解析结果：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @json = '{ "type": "Point", "coordinates": [102.0, 0.0]}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_GeomFromGeoJSON(@json));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_GeomFromGeoJSON（@json））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">要点（102 0）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="spatial-convenience-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.16.12空间便利函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中的函数提供了几何值的便捷操作。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      除非另有说明，否则本节中的函数处理其参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何几何参数不是语法上格式良好的几何体，
           </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果任何几何参数具有引用未定义空间参考系统（SRS）的SRID值，
           </font></font><a class="link" href="error-handling.html#error_er_srs_not_found"><code class="literal">ER_SRS_NOT_FOUND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于采用多个几何参数的函数，如果这些参数不具有相同的SRID，
           </font></font><a class="link" href="error-handling.html#error_er_gis_different_srids"><code class="literal">ER_GIS_DIFFERENT_SRIDS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会发生错误。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          否则，返回值为非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些便利功能可用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_st-distance-sphere"></a><p>
          <a class="indexterm" name="idm140091678223232"></a>

          <a class="link" href="functions.html#function_st-distance-sphere"><code class="literal">ST_Distance_Sphere(<em class="replaceable"><code>g1</code></em>,
          <em class="replaceable"><code>g2</code></em> [,
          <em class="replaceable"><code>radius</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回球体之间的最小球面距离
           </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          球体上的参数（以米为单位）。</font><font style="vertical-align: inherit;">（对于通用距离计算，请参阅
           </font></font><a class="link" href="functions.html#function_st-distance"><code class="literal">ST_Distance()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。）可选</font></font><em class="replaceable"><code>radius</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数应以米为单位。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果两个几何参数都是有效的笛卡尔坐标
           </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          SRID 0中的值，则返回值是具有所提供半径的球体上两个几何之间的最短距离。</font><font style="vertical-align: inherit;">如果省略，则默认半径为6,370,986米，点X和Y坐标分别以度为单位解释为经度和纬度。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果两个几何参数均为有效</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或</font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">地理空间参照系（SRS）中的值，则返回值是球体上具有提供半径的两个几何之间的最短距离。</font><font style="vertical-align: inherit;">如果省略，则默认半径等于平均半径，定义为（2a + b）/ 3，其中a是半长轴，b是SRS的半短轴。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-distance-sphere"><code class="literal">ST_Distance_Sphere()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              支持的几何参数组合是
               </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
               </font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （以任何参数顺序）。</font><font style="vertical-align: inherit;">如果至少一个几何结构既不</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">也不
               </font><font style="vertical-align: inherit;">是SRID为0，
               </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_cartesian_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_CARTESIAN_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。</font><font style="vertical-align: inherit;">如果至少一个几何结构既不</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">MultiPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">也不
               </font><font style="vertical-align: inherit;">是
               </font><font style="vertical-align: inherit;">SRID，则其SRID指的是地理SRS，
               </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_geographic_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。</font><font style="vertical-align: inherit;">如果任何几何图形指的是投影的SRS，
               </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_projected_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_PROJECTED_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果任何参数的经度或纬度超出范围，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果任何经度参数不在范围（-180,180）内，
                   </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  则会发生错误。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果任何纬度参数不在[-90,90]范围内，
                   </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              显示的范围以度为单位。</font><font style="vertical-align: inherit;">如果SRS使用其他单位，则该范围使用其单位中的相应值。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><em class="replaceable"><code>radius</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数存在但不是正数，
               </font></font><a class="link" href="error-handling.html#error_er_nonpositive_radius"><code class="literal">ER_NONPOSITIVE_RADIUS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果距离超出双精度数的范围，
               </font></font><a class="link" href="error-handling.html#error_er_std_overflow_error"><code class="literal">ER_STD_OVERFLOW_ERROR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @pt1 = ST_GeomFromText('POINT(0 0)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @pt2 = ST_GeomFromText('POINT(180 0)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_Distance_Sphere(@pt1, @pt2);</code></strong><font></font>
+--------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_Distance_Sphere（@ pt1，@ pt2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------+</font></font><font></font>
|             20015042.813723423 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-isvalid"></a><p>
          <a class="indexterm" name="idm140091678178192"></a>

          <a class="link" href="functions.html#function_st-isvalid"><code class="literal">ST_IsValid(<em class="replaceable"><code>g</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果参数在几何上有效，则返回1;如果参数在几何上无效，则返回0。</font><font style="vertical-align: inherit;">几何有效性由OGC规范定义。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          唯一有效的空几何体以空几何集合值的形式表示。
          </font></font><a class="link" href="functions.html#function_st-isvalid"><code class="literal">ST_IsValid()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这种情况下返回1。</font><font style="vertical-align: inherit;">MySQL不支持GIS </font></font><code class="literal">EMPTY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          等</font></font><code class="literal">POINT EMPTY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-isvalid"><code class="literal">ST_IsValid()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果几何体具有经度或纬度超出范围的地理SRS，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果任何经度参数不在范围（-180,180）内，
                   </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  则会发生错误。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果任何纬度参数不在[-90,90]范围内，
                   </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              显示的范围以度为单位。</font><font style="vertical-align: inherit;">如果SRS使用其他单位，则该范围使用其单位中的相应值。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ls1 = ST_GeomFromText('LINESTRING(0 0,-0.00 0,0.0 0)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @ls2 = ST_GeomFromText('LINESTRING(0 0, 1 1)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_IsValid(@ls1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_IsValid（@ ls1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
|                0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_IsValid(@ls2);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_IsValid（@ ls2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
|                1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-makeenvelope"></a><p>
          <a class="indexterm" name="idm140091678153856"></a>

          <a class="link" href="functions.html#function_st-makeenvelope"><code class="literal">ST_MakeEnvelope(<em class="replaceable"><code>pt1</code></em>,
          <em class="replaceable"><code>pt2</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回形成围绕两点信封，作为一个矩形</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">LineString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用笛卡尔坐标系而不是球体，椭球体或地球上进行计算。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定两个点</font></font><em class="replaceable"><code>pt1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>pt2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="functions.html#function_st-makeenvelope"><code class="literal">ST_MakeEnvelope()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">产生在这样一个抽象的平面结果的几何图形：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><em class="replaceable"><code>pt1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
               </font></font><em class="replaceable"><code>pt2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相等，结果就是重点</font></font><em class="replaceable"><code>pt1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              否则，如果</font><font style="vertical-align: inherit;">是垂直或水平线段，则结果是线段
               </font><font style="vertical-align: inherit;">。
            </font></font><code class="literal">(<em class="replaceable"><code>pt1</code></em>,
              <em class="replaceable"><code>pt2</code></em>)</code><font style="vertical-align: inherit;"></font><code class="literal">(<em class="replaceable"><code>pt1</code></em>,
              <em class="replaceable"><code>pt2</code></em>)</code><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              否则，结果是使用多边形</font></font><em class="replaceable"><code>pt1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><em class="replaceable"><code>pt2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为对角点</font><font style="vertical-align: inherit;">的多边形
               </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果几何的SRID为0。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-makeenvelope"><code class="literal">ST_MakeEnvelope()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果参数不是</font></font><code class="literal">Point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，</font></font><a class="link" href="error-handling.html#error_er_wrong_arguments"><code class="literal">ER_WRONG_ARGUMENTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              两个点的任何坐标值都是无穷大或附加条件，则会发生错误
               </font></font><code class="literal">NaN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果任何几何具有地理空间参照系（SRS）的SRID值，
               </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_geographic_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @pt1 = ST_GeomFromText('POINT(0 0)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @pt2 = ST_GeomFromText('POINT(1 1)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_MakeEnvelope(@pt1, @pt2));</code></strong><font></font>
+----------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_MakeEnvelope（@ pt1，@ pt2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">POLYGON（（0 0,1 0,1 1,0 1,0 0））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-simplify"></a><p>
          <a class="indexterm" name="idm140091678118128"></a>

          <a class="link" href="functions.html#function_st-simplify"><code class="literal">ST_Simplify(<em class="replaceable"><code>g</code></em>,
          <em class="replaceable"><code>max_distance</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用Douglas-Peucker算法简化几何，并返回相同类型的简化值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          几何体可以是任何几何体类型，尽管Douglas-Peucker算法实际上可能不会处理每种类型。</font><font style="vertical-align: inherit;">通过将其组件逐个提供给简化算法来处理几何集合，并将返回的几何图形作为结果放入几何集合中。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的</font></font><em class="replaceable"><code>max_distance</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是要除去的距离（在输入坐标的单位）顶点到其他段。</font><font style="vertical-align: inherit;">移除简化线串的此距离内的顶点。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          根据Boost.Geometry，由于简化过程，几何可能会变得无效，并且该过程可能会创建自相交。</font><font style="vertical-align: inherit;">要检查结果的有效性，请将其传递给
           </font></font><a class="link" href="functions.html#function_st-isvalid"><code class="literal">ST_IsValid()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-simplify"><code class="literal">ST_Simplify()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理其参数，如本节的介绍中所述，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><em class="replaceable"><code>max_distance</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是正数，或者是</font></font><code class="literal">NaN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则发生
               </font></font><a class="link" href="error-handling.html#error_er_wrong_arguments"><code class="literal">ER_WRONG_ARGUMENTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @g = ST_GeomFromText('LINESTRING(0 0,0 1,1 1,1 2,2 2,2 3,3 3)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Simplify(@g, 0.5));</code></strong><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Simplify（@ g，0.5））|</font></font><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（0 0,0 1,1 1,2 3,3 3）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Simplify(@g, 1.0));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Simplify（@ g，1.0））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（0 0,3 3）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_st-validate"></a><p>
          <a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate(<em class="replaceable"><code>g</code></em>)</code></a>
        </p><a class="indexterm" name="idm140091678095168"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          根据OGC规范验证几何。</font><font style="vertical-align: inherit;">几何可以在语法上格式良好（WKB值加SRID），但几何上无效。</font><font style="vertical-align: inherit;">例如，此多边形几何无效：</font></font><code class="literal">POLYGON((0 0, 0 0, 0 0, 0 0, 0
          0))</code>
        </p><p>
          <a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回几何体，如果它在语法上是格式良好的并且在几何上是有效的，</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数在语法上没有良好形成或几何有效或是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于过滤掉无效的几何数据，但需要付出代价。</font><font style="vertical-align: inherit;">对于需要更精确结果而不受无效数据污染的应用程序，这种惩罚可能是值得的。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果geometry参数有效，则按原样返回，除非输入</font></font><code class="literal">Polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">MultiPolygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有顺时针环，</font><font style="vertical-align: inherit;">否则
           </font><font style="vertical-align: inherit;">在检查有效性之前将这些环反转。</font><font style="vertical-align: inherit;">如果几何有效，则返回带有反转环的值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          唯一有效的空几何体以空几何集合值的形式表示。
          </font></font><a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这种情况下，无需进一步检查即可直接返回
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从MySQL 8.0.13开始，
           </font></font><a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按照本节的介绍中的描述处理其参数，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果几何体具有经度或纬度超出范围的地理SRS，则会发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果任何经度参数不在范围（-180,180）内，
                   </font></font><a class="link" href="error-handling.html#error_er_longitude_out_of_range"><code class="literal">ER_LONGITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  则会发生错误。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果任何纬度参数不在[-90,90]范围内，
                   </font></font><a class="link" href="error-handling.html#error_er_latitude_out_of_range"><code class="literal">ER_LATITUDE_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  则会发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              显示的范围以度为单位。</font><font style="vertical-align: inherit;">由于浮点运算，精确的范围限制略有偏差。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.13之前，
           </font></font><a class="link" href="functions.html#function_st-validate"><code class="literal">ST_Validate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按照本节的介绍中的描述处理其参数，但有以下例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果几何在语法上没有良好形式，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一个
               </font></font><a class="link" href="error-handling.html#error_er_gis_invalid_data"><code class="literal">ER_GIS_INVALID_DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果几何具有地理空间参考系统（SRS）的SRID值，
               </font></font><a class="link" href="error-handling.html#error_er_not_implemented_for_geographic_srs"><code class="literal">ER_NOT_IMPLEMENTED_FOR_GEOGRAPHIC_SRS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              则会发生错误。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @ls1 = ST_GeomFromText('LINESTRING(0 0)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @ls2 = ST_GeomFromText('LINESTRING(0 0, 1 1)');</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Validate(@ls1));</code></strong><font></font>
+------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Validate（@ ls1））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ST_AsText(ST_Validate(@ls2));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ST_AsText（ST_Validate（@ ls2））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">LINESTRING（0 0,1 1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="json-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17 JSON函数</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#json-function-reference"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.1 JSON函数参考</font></font></a></span></dt><dt><span class="section"><a href="functions.html#json-creation-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.2创建JSON值的函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#json-search-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.3搜索JSON值的函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#json-modification-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.4修改JSON值的函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#json-attribute-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.5返回JSON值属性的函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#json-table-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.6 JSON表函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#json-validation-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.7 JSON模式验证函数</font></font></a></span></dt><dt><span class="section"><a href="functions.html#json-utility-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.8 JSON实用程序函数</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091678060112"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本节中描述的函数对JSON值执行操作。</font><font style="vertical-align: inherit;">有关</font></font><a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    数据类型和其他示例的</font><font style="vertical-align: inherit;">讨论</font><font style="vertical-align: inherit;">，请参见</font></font><a class="xref" href="data-types.html#json" title="11.6 JSON数据类型"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11.6节“JSON数据类型”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    对于采用JSON参数的函数，如果参数不是有效的JSON值，则会发生错误。</font><font style="vertical-align: inherit;">解析为JSON的参数表示为</font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">指示的参数</font></font><em class="replaceable"><code>val</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未被解析。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    还提供了一组用于操作GeoJSON值的空间函数。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="functions.html#spatial-geojson-functions" title="12.16.11空间GeoJSON函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.16.11节“空间GeoJSON函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="json-function-reference"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.1 JSON函数参考</font></font></h3>
</div>
</div>
</div>
<a class="indexterm" name="idm140091678052768"></a>
<div class="table">
<a name="idm140091678051696"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.21 JSON函数</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists all JSON functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_json-array"><code class="literal">JSON_ARRAY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      创建JSON数组
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-array-append"><code class="literal">JSON_ARRAY_APPEND()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将数据附加到JSON文档
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-array-insert"><code class="literal">JSON_ARRAY_INSERT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      插入JSON数组
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      评估路径后从JSON列返回值; </font><font style="vertical-align: inherit;">相当于JSON_EXTRACT（）。
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-contains"><code class="literal">JSON_CONTAINS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      JSON文档是否包含路径中的特定对象
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-contains-path"><code class="literal">JSON_CONTAINS_PATH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      JSON文档是否包含路径中的任何数据
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-depth"><code class="literal">JSON_DEPTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      JSON文档的最大深度
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-extract"><code class="literal">JSON_EXTRACT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从JSON文档返回数据
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_json-inline-path"><code class="literal">-&gt;&gt;</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在评估路径并取消引用结果后，从JSON列返回值; </font><font style="vertical-align: inherit;">相当于JSON_UNQUOTE（JSON_EXTRACT（））。
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将数据插入JSON文档
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-keys"><code class="literal">JSON_KEYS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      来自JSON文档的键数组
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-length"><code class="literal">JSON_LENGTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      JSON文档中的元素数量
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-merge"><code class="literal">JSON_MERGE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （已弃用8.0.3）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      合并JSON文档，保留重复键。</font><font style="vertical-align: inherit;">JSON_MERGE_PRESERVE（）的弃用词不再使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      合并JSON文档，替换重复键的值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      合并JSON文档，保留重复键
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      创建JSON对象
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-overlaps"><code class="literal">JSON_OVERLAPS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      比较两个JSON文档，如果它们具有任何共同的键值对或数组元素，则返回TRUE（1），否则返回FALSE（0）
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-pretty"><code class="literal">JSON_PRETTY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以人类可读的格式打印JSON文档
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-quote"><code class="literal">JSON_QUOTE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      引用JSON文档
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-remove"><code class="literal">JSON_REMOVE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从JSON文档中删除数据
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      替换JSON文档中的值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-schema-valid"><code class="literal">JSON_SCHEMA_VALID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      根据JSON模式验证JSON文档; </font><font style="vertical-align: inherit;">如果文档针对模式进行验证，则返回TRUE / 1;否则返回FALSE / 0
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-schema-validation-report"><code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      根据JSON模式验证JSON文档; </font><font style="vertical-align: inherit;">以JSON格式返回有关验证结果的报告，包括成功或失败以及失败原因
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-search"><code class="literal">JSON_SEARCH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      JSON文档中的值路径
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将数据插入JSON文档
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-storage-free"><code class="literal">JSON_STORAGE_FREE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在部分更新之后释放JSON列值的二进制表示内的空间
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-storage-size"><code class="literal">JSON_STORAGE_SIZE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      用于存储JSON文档的二进制表示的空间
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-table"><code class="literal">JSON_TABLE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将JSON表达式中的数据作为关系表返回
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-type"><code class="literal">JSON_TYPE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      JSON值的类型
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      取消引用JSON值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-valid"><code class="literal">JSON_VALID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      JSON值是否有效
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#operator_member-of"><code class="literal">MEMBER OF()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果第一个操作数匹配作为第二个操作数传递的JSON数组的任何元素，则返回true（1），否则返回false（0）
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL支持两个聚合JSON函数
       </font></font><a class="link" href="functions.html#function_json-arrayagg"><code class="literal">JSON_ARRAYAGG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="functions.html#function_json-objectagg"><code class="literal">JSON_OBJECTAGG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">这些的说明，</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="functions.html#group-by-functions-and-modifiers" title="12.20聚合（GROUP BY）函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20节“聚合（GROUP BY）函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL还</font><font style="vertical-align: inherit;">使用该</font><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">以易于阅读的格式</font><font style="vertical-align: inherit;">支持</font><font style="vertical-align: inherit;">JSON值的
       </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">漂亮打印</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_json-pretty"><code class="literal">JSON_PRETTY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可以看到给定JSON值占用多少存储空间，</font></font><a class="link" href="functions.html#function_json-storage-size"><code class="literal">JSON_STORAGE_SIZE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及</font></font><a class="link" href="functions.html#function_json-storage-free"><code class="literal">JSON_STORAGE_FREE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分别</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">和
       </font><font style="vertical-align: inherit;">存储额外存储空间
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关这些函数的完整描述，请参见
       </font></font><a class="xref" href="functions.html#json-utility-functions" title="12.17.8 JSON实用程序函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.17.8节“JSON实用程序函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="json-creation-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.2创建JSON值的函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中列出的函数组成了组件元素的JSON值。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-array"></a><p>
          <a class="indexterm" name="idm140091677926576"></a>

          <a class="link" href="functions.html#function_json-array"><code class="literal">JSON_ARRAY([<em class="replaceable"><code>val</code></em>[,
          <em class="replaceable"><code>val</code></em>] ...])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          计算（可能为空）值列表并返回包含这些值的JSON数组。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_ARRAY(1, "abc", NULL, TRUE, CURTIME());</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY（1，“abc”，NULL，TRUE，CURTIME（））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[1，“abc”，null，true，“11：30：24.000000”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-object"></a><p>
          <a class="indexterm" name="idm140091677915168"></a>

          <a class="link" href="functions.html#function_json-object"><code class="literal">JSON_OBJECT([<em class="replaceable"><code>key</code></em>,
          <em class="replaceable"><code>val</code></em>[,
          <em class="replaceable"><code>key</code></em>,
          <em class="replaceable"><code>val</code></em>] ...])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          计算键值对（可能为空）并返回包含这些对的JSON对象。</font><font style="vertical-align: inherit;">如果任何键名称</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或参数数量为奇数，</font><font style="vertical-align: inherit;">则会发生错误</font><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OBJECT('id', 87, 'name', 'carrot');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OBJECT（'​​id'，87，'name'，'carrot'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：87，“name”：“carrot”} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-quote"></a><p>
          <a class="indexterm" name="idm140091677902144"></a>

          <a class="link" href="functions.html#function_json-quote"><code class="literal">JSON_QUOTE(<em class="replaceable"><code>string</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过用双引号字符包装并转义内部引号和其他字符，然后将结果作为</font></font><code class="literal">utf8mb4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符串</font><font style="vertical-align: inherit;">返回，将</font><font style="vertical-align: inherit;">字符串</font><font style="vertical-align: inherit;">引用为JSON值
           </font><font style="vertical-align: inherit;">。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数是，则
           </font><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数通常用于生成有效的JSON字符串文字以包含在JSON文档中。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          根据</font></font><a class="xref" href="functions.html#json-unquote-character-escape-sequences" title="表12.22 JSON_UNQUOTE（）特殊字符转义序列"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.22“JSON_UNQUOTE（）特殊字符转义序列”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显示的转义序列，使用反斜杠转义某些特殊字符
           </font><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_QUOTE('null'), JSON_QUOTE('"null"');</code></strong><font></font>
+--------------------+----------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_QUOTE（'null'）| </font><font style="vertical-align: inherit;">JSON_QUOTE（'“null”'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“null”| </font><font style="vertical-align: inherit;">“\”null \“”|</font></font><font></font>
+--------------------+----------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_QUOTE('[1, 2, 3]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_QUOTE（'[1,2,3]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“[1,2,3]”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font>
</pre></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您还可以通过</font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用
       </font><font style="vertical-align: inherit;">其他类型的值转换为类型来获取JSON值</font><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">有关更多信息，</font><font style="vertical-align: inherit;">请参阅
       </font><a class="xref" href="data-types.html#json-converting-between-types" title="在JSON和非JSON值之间转换"><font style="vertical-align: inherit;">在JSON和非JSON值之间转换</font></a><font style="vertical-align: inherit;">。
    </font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST(<em class="replaceable"><code>value</code></em> AS
      JSON)</code></a><font style="vertical-align: inherit;"></font><a class="xref" href="data-types.html#json-converting-between-types" title="在JSON和非JSON值之间转换"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      可以使用两个生成JSON值的聚合函数。
      </font></font><a class="link" href="functions.html#function_json-arrayagg"><code class="literal">JSON_ARRAYAGG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将结果集作为单个JSON数组</font></font><a class="link" href="functions.html#function_json-objectagg"><code class="literal">JSON_OBJECTAGG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">，
       </font><font style="vertical-align: inherit;">并将结果集作为单个JSON对象返回。</font><font style="vertical-align: inherit;">有关更多信息，请参见
       </font></font><a class="xref" href="functions.html#group-by-functions-and-modifiers" title="12.20聚合（GROUP BY）函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20节“聚合（GROUP BY）函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="json-search-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.3搜索JSON值的函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中的函数对JSON值执行搜索或比较操作，以从中提取数据，报告数据是否存在于其中的位置，或报告其中数据的路径。</font><font style="vertical-align: inherit;">在</font></font><a class="link" href="functions.html#operator_member-of"><code class="literal">MEMBER OF()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      操作者在本文中也记载。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-contains"></a><p>
          <a class="indexterm" name="idm140091677875008"></a>

          <a class="link" href="functions.html#function_json-contains"><code class="literal">JSON_CONTAINS(<em class="replaceable"><code>target</code></em>,
          <em class="replaceable"><code>candidate</code></em>[,
          <em class="replaceable"><code>path</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过返回1或0来指示给定的
           </font></font><em class="replaceable"><code>candidate</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON文档是否包含在</font></font><em class="replaceable"><code>target</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON文档中，或者 - 如果提供了</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数 - 是否在目标内的特定路径中找到候选项。</font><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果任何参数
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者如果路径参数不识别目标文档的一部分。</font><font style="vertical-align: inherit;">如果发生错误
           </font></font><em class="replaceable"><code>target</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><em class="replaceable"><code>candidate</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是有效的JSON文档，或者如果</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是一个有效的路径表达式或包含一个
           </font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要仅检查路径中是否存在任何数据，请
           </font></font><a class="link" href="functions.html#function_json-contains-path"><code class="literal">JSON_CONTAINS_PATH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下规则定义了遏制：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              候选标量包含在目标标量中，当且仅当它们具有可比性且相等时。</font><font style="vertical-align: inherit;">如果它们具有相同的</font></font><a class="link" href="functions.html#function_json-type"><code class="literal">JSON_TYPE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型，</font><font style="vertical-align: inherit;">则两个标量值是可比较的
               </font><font style="vertical-align: inherit;">，除了类型的值</font></font><code class="literal">INTEGER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              并且</font></font><code class="literal">DECIMAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也彼此相当。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              当且仅当候选中的每个元素都包含在目标的某个元素中时，候选数组才包含在目标数组中。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              当且仅当候选者包含在目标的某个元素中时，候选非阵列包含在目标数组中。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              候选对象包含在目标对象中，当且仅当对于候选中的每个键时，在目标中存在具有相同名称的键，并且与候选键相关联的值包含在与目标键相关联的值中。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          否则，候选值不包含在目标文档中。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '{"a": 1, "b": 2, "c": {"d": 4}}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @j2 = '1';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_CONTAINS(@j, @j2, '$.a');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_CONTAINS（@ j，@ j2，'$ .a'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
|                             1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_CONTAINS(@j, @j2, '$.b');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_CONTAINS（@ j，@ j2，'$ .b'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                             0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @j2 = '{"d": 4}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_CONTAINS(@j, @j2, '$.a');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_CONTAINS（@ j，@ j2，'$ .a'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                             0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_CONTAINS(@j, @j2, '$.c');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_CONTAINS（@ j，@ j2，'$ .c'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                             1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-contains-path"></a><p>
          <a class="indexterm" name="idm140091677841856"></a>

          <a class="link" href="functions.html#function_json-contains-path"><code class="literal">JSON_CONTAINS_PATH(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>one_or_all</code></em>,
          <em class="replaceable"><code>path</code></em>[,
          <em class="replaceable"><code>path</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回0或1以指示JSON文档是否包含给定路径或路径的数据。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果有任何参数，则</font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是有效的JSON文档，任何</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数不是有效的路径表达式，或者</font></font><em class="replaceable"><code>one_or_all</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是
           </font></font><code class="literal">'one'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">则会发生错误</font></font><code class="literal">'all'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要检查路径中的特定值，请
           </font></font><a class="link" href="functions.html#function_json-contains"><code class="literal">JSON_CONTAINS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果文档中不存在指定的路径，则返回值为0。</font><font style="vertical-align: inherit;">否则，返回值取决于
           </font></font><em class="replaceable"><code>one_or_all</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">'one'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：如果文档中至少存在一个路径，则为1，否则为0。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">'all'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：如果文档中存在所有路径，则为1，否则为0。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '{"a": 1, "b": 2, "c": {"d": 4}}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_CONTAINS_PATH(@j, 'one', '$.a', '$.e');</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_CONTAINS_PATH（@ j，'one'，'$ .a'，'$ .e'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
|                                           1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_CONTAINS_PATH(@j, 'all', '$.a', '$.e');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_CONTAINS_PATH（@j，'all'，'$ .a'，'$ .e'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
|                                           0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_CONTAINS_PATH(@j, 'one', '$.c.d');</code></strong><font></font>
+----------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_CONTAINS_PATH（@j，'one'，'$ .c.d'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font>
|                                      1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_CONTAINS_PATH(@j, 'one', '$.a.d');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_CONTAINS_PATH（@ j，'one'，'$ .a.d'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font>
|                                      0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-extract"></a><p>
          <a class="indexterm" name="idm140091677814544"></a>

          <a class="link" href="functions.html#function_json-extract"><code class="literal">JSON_EXTRACT(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>path</code></em>[,
          <em class="replaceable"><code>path</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回JSON文档中的数据，该文档从</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数</font><font style="vertical-align: inherit;">匹配的文档部分中选择</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果任何参数
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或没有路径找到文档中的一个值。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是有效的JSON文档或任何</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是有效的路径表达式，</font><font style="vertical-align: inherit;">则会发生错误
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值由</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">匹配的所有值组成
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果这些参数可能返回多个值，则匹配的值将按照与生成它们的路径对应的顺序自动包装为数组。</font><font style="vertical-align: inherit;">否则，返回值是单个匹配的值。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]');</code></strong><font></font>
+--------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_EXTRACT（'[10,20，[30,40]]'，'$ [1]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font>
| 20                                         |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_EXTRACT('[10, 20, [30, 40]]', '$[1]', '$[0]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_EXTRACT（'[10,20，[30,40]]'，'$ [1]'，'$ [0]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font>
| [20, 10]                                           |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_EXTRACT('[10, 20, [30, 40]]', '$[2][*]');</code></strong><font></font>
+-----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_EXTRACT（'[10,20，[30,40]]'，'$ [2] [*]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------+</font></font><font></font>
| [30, 40]                                      |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL支持
           </font></font><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          运算符作为此函数的简写，与2个参数一起使用，其中左侧是
           </font></font><a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列标识符（不是表达式），右侧是要在列中匹配的JSON路径。
        </font></font></p></li><li class="listitem"><a name="operator_json-column-path"></a><p>
          <a class="indexterm" name="idm140091677792560"></a>

          <a class="link" href="functions.html#operator_json-column-path"><code class="literal"><em class="replaceable"><code>column</code></em>-&gt;<em class="replaceable"><code>path</code></em></code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当与两个参数一起使用时</font><font style="vertical-align: inherit;">
          ，
           </font></font><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          运算符充当</font></font><a class="link" href="functions.html#function_json-extract"><code class="literal">JSON_EXTRACT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">的别名，
           </font><font style="vertical-align: inherit;">左侧是列标识符，右侧是根据JSON文档评估的JSON路径（列值）。</font><font style="vertical-align: inherit;">您可以使用此类表达式代替SQL语句中出现的列标识符。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里显示</font><font style="vertical-align: inherit;">
          的两个</font><font style="vertical-align: inherit;">语句产生相同的输出：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的MySQL&gt; </font></font><strong class="userinput"><code>SELECT c, JSON_EXTRACT(c, "$.id"), g</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt; </font></font><strong class="userinput"><code>FROM jemp</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt; </font></font><strong class="userinput"><code>WHERE JSON_EXTRACT(c, "$.id") &gt; 1</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;</font></font><strong class="userinput"><code>ORDER BY JSON_EXTRACT(c, "$.name");</code></strong><font></font>
+-------------------------------+-----------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c | </font><font style="vertical-align: inherit;">c  - &gt;“$。id”| </font><font style="vertical-align: inherit;">g |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+-----------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“3”，“name”：“Barney”} | </font><font style="vertical-align: inherit;">“3”| </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“4”，“name”：“Betty”} | </font><font style="vertical-align: inherit;">“4”| </font><font style="vertical-align: inherit;">4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“2”，“name”：“Wilma”} | </font><font style="vertical-align: inherit;">“2”| </font><font style="vertical-align: inherit;">2 |</font></font><font></font>
+-------------------------------+-----------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3组（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的MySQL&gt; </font></font><strong class="userinput"><code>SELECT c, c-&gt;"$.id", g</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt; </font></font><strong class="userinput"><code>FROM jemp</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt; </font></font><strong class="userinput"><code>WHERE c-&gt;"$.id" &gt; 1</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;</font></font><strong class="userinput"><code>ORDER BY c-&gt;"$.name";</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+-----------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c | </font><font style="vertical-align: inherit;">c  - &gt;“$。id”| </font><font style="vertical-align: inherit;">g |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+-----------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“3”，“name”：“Barney”} | </font><font style="vertical-align: inherit;">“3”| </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“4”，“name”：“Betty”} | </font><font style="vertical-align: inherit;">“4”| </font><font style="vertical-align: inherit;">4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“2”，“name”：“Wilma”} | </font><font style="vertical-align: inherit;">“2”| </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+-----------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3组（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能不限
           </font></font><code class="literal">SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">于此，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>ALTER TABLE jemp ADD COLUMN n INT;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.68秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：0重复：0警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>UPDATE jemp SET n=1 WHERE c-&gt;"$.id" = "4";</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.04秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
匹配的行数：1已更改：1警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的MySQL&gt; </font></font><strong class="userinput"><code>SELECT c, c-&gt;"$.id", g, n</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt; </font></font><strong class="userinput"><code>FROM jemp</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt; </font></font><strong class="userinput"><code>WHERE JSON_EXTRACT(c, "$.id") &gt; 1</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;</font></font><strong class="userinput"><code>ORDER BY c-&gt;"$.name";</code></strong><font></font>
+-------------------------------+-----------+------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c | </font><font style="vertical-align: inherit;">c  - &gt;“$。id”| </font><font style="vertical-align: inherit;">g | </font><font style="vertical-align: inherit;">n |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+-----------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“3”，“name”：“Barney”} | </font><font style="vertical-align: inherit;">“3”| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“4”，“name”：“Betty”} | </font><font style="vertical-align: inherit;">“4”| </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“2”，“name”：“Wilma”} | </font><font style="vertical-align: inherit;">“2”| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+-----------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3组（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>DELETE FROM jemp WHERE c-&gt;"$.id" = "4";</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.04秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的MySQL&gt; </font></font><strong class="userinput"><code>SELECT c, c-&gt;"$.id", g, n</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt; </font></font><strong class="userinput"><code>FROM jemp</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt; </font></font><strong class="userinput"><code>WHERE JSON_EXTRACT(c, "$.id") &gt; 1</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;</font></font><strong class="userinput"><code>ORDER BY c-&gt;"$.name";</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+-----------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c | </font><font style="vertical-align: inherit;">c  - &gt;“$。id”| </font><font style="vertical-align: inherit;">g | </font><font style="vertical-align: inherit;">n |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+-----------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“3”，“name”：“Barney”} | </font><font style="vertical-align: inherit;">“3”| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“2”，“name”：“Wilma”} | </font><font style="vertical-align: inherit;">“2”| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+-----------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          （有关</font><font style="vertical-align: inherit;">用于创建和填充刚刚显示的表的语句，</font><font style="vertical-align: inherit;">请参阅</font></font><a class="xref" href="sql-syntax.html#json-column-indirect-index" title="索引生成的列以提供JSON列索引"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引生成的列以提供JSON列索引</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这也适用于JSON数组值，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE tj10 (a JSON, b INT);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.26秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql </font></font><strong class="userinput"><code>INSERT INTO tj10</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;&gt;</font></font><strong class="userinput"><code>VALUES ("[3,10,5,17,44]", 33), ("[3,10,5,17,[22,44,66]]", 0);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.04秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT a-&gt;"$[4]" FROM tj10;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a  - &gt;“$ [4]”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+</font></font><font></font>
| 44           |<font></font>
| [22, 44, 66] |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM tj10 WHERE a-&gt;"$[0]" = 3;</code></strong><font></font>
+------------------------------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+------+</font></font><font></font>
| [3, 10, 5, 17, 44]           |   33 |<font></font>
| [3, 10, 5, 17, [22, 44, 66]] |    0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          支持嵌套数组。</font><font style="vertical-align: inherit;">使用的表达式
           </font></font><code class="literal">-&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">计算</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          好像在目标JSON文档中找不到匹配的键，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM tj10 WHERE a-&gt;"$[4][1]" IS NOT NULL;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| [3, 10, 5, 17, [22, 44, 66]] |    0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT a-&gt;"$[4][1]" FROM tj10;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a  - &gt;“$ [4] [1]”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| 44           |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这与使用时的情况相同
           </font></font><code class="literal">JSON_EXTRACT()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_EXTRACT(a, "$[4][1]") FROM tj10;</code></strong><font></font>
+----------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_EXTRACT（a，“$ [4] [1]”）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font>
| 44                         |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre></li><li class="listitem"><a name="operator_json-inline-path"></a><p>
          <a class="indexterm" name="idm140091677741904"></a>

          <a class="link" href="functions.html#operator_json-inline-path"><code class="literal"><em class="replaceable"><code>column</code></em>-&gt;&gt;<em class="replaceable"><code>path</code></em></code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这是一个改进的，不引用的提取操作符。</font><font style="vertical-align: inherit;">而</font></font><code class="literal">-&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作者简单地提取的值时，</font></font><code class="literal">-&gt;&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在加法运算unquotes所提取的结果。</font><font style="vertical-align: inherit;">换句话说，给定
           </font></font><a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列值
           </font></font><em class="replaceable"><code>column</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和路径表达式
           </font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以下三个表达式返回相同的值：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE(</code></a>
              <a class="link" href="functions.html#function_json-extract"><code class="literal">JSON_EXTRACT(<em class="replaceable"><code>column</code></em>,
              <em class="replaceable"><code>path</code></em>) )</code></a>
            </p></li><li class="listitem"><p>
              <code class="literal">JSON_UNQUOTE(<em class="replaceable"><code>column</code></em></code>
              <a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a>
              <code class="literal"><em class="replaceable"><code>path</code></em>)</code>
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>column</code></em>-&gt;&gt;<em class="replaceable"><code>path</code></em></code>
</p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">-&gt;&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作可用于任何
           </font></font><code class="literal">JSON_UNQUOTE(JSON_EXTRACT())</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将被允许。</font><font style="vertical-align: inherit;">这包括（但不限于）
           </font></font><code class="literal">SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表，</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款，并</font></font><code class="literal">ORDER
          BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          接下来的几个语句演示</font></font><code class="literal">-&gt;&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了</font></font><a class="link" href="programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端中</font><font style="vertical-align: inherit;">其他表达式的</font><font style="vertical-align: inherit;">一些
           </font><font style="vertical-align: inherit;">运算符等价</font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM jemp WHERE g &gt; 2;</code></strong><font></font>
+-------------------------------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c | </font><font style="vertical-align: inherit;">g |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“3”，“name”：“Barney”} | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：“4”，“name”：“Betty”} | </font><font style="vertical-align: inherit;">4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT c-&gt;'$.name' AS name</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>FROM jemp WHERE g &gt; 2;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+</font></font><font></font>
| name     |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“巴尼”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“贝蒂”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT JSON_UNQUOTE(c-&gt;'$.name') AS name</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>FROM jemp WHERE g &gt; 2;</code></strong><font></font>
+--------+<font></font>
| name   |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">巴尼|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">贝蒂|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT c-&gt;&gt;'$.name' AS name</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>FROM jemp WHERE g &gt; 2;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| name   |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">巴尼|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">贝蒂|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参阅</font></font><a class="xref" href="sql-syntax.html#json-column-indirect-index" title="索引生成的列以提供JSON列索引"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引生成的列以提供JSON列索引</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，用于在</font></font><code class="literal">jemp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">刚刚显示的示例集中</font><font style="vertical-align: inherit;">创建和填充</font><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">的SQL语句
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此运算符也可以与JSON数组一起使用，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE tj10 (a JSON, b INT);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.26秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO tj10 VALUES</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>('[3,10,5,"x",44]', 33),</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>('[3,10,5,17,[22,"y",66]]', 0);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，2行受影响（0.04秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：2个重复：0个警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT a-&gt;"$[3]", a-&gt;"$[4][1]" FROM tj10;</code></strong><font></font>
+-----------+--------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a  - &gt;“$ [3]”| </font><font style="vertical-align: inherit;">a  - &gt;“$ [4] [1]”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+--------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“x”| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">17 | </font><font style="vertical-align: inherit;">“y”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+--------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT a-&gt;&gt;"$[3]", a-&gt;&gt;"$[4][1]" FROM tj10;</code></strong><font></font>
+------------+---------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a  -  &gt;&gt;“$ [3]”| </font><font style="vertical-align: inherit;">a  -  &gt;&gt;“$ [4] [1]”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------+---------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">x | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">17 | </font><font style="vertical-align: inherit;">和|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------+---------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与此同时
           </font></font><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">-&gt;&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算符总是在输出中展开</font></font><a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如下例所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>EXPLAIN SELECT c-&gt;&gt;'$.name' AS name</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>FROM jemp WHERE g &gt; 2\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           id：1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  select_type：SIMPLE</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        桌子：jemp</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   分区：NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
         类型：范围</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
possible_keys：i</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          关键：我</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      key_len：5</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          ref：NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
         行：2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     过滤：100.00</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        额外：使用在哪里</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排，1警告（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW WARNINGS\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  等级：注意</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   代码：1003</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
消息：/ *选择＃1 * /选择</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
json_unquote（json_extract（`jtest` .jemp``c`，'$。name'））AS`name`来自</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
`jtest``jemp` where（`jtest` .jemp``g`&gt; 2）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这类似于MySQL </font></font><a class="link" href="functions.html#operator_json-column-path"><code class="literal">-&gt;</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在相同情况下</font><font style="vertical-align: inherit;">扩展
           </font><font style="vertical-align: inherit;">运算符的方式。
        </font></font></p></li><li class="listitem"><a name="function_json-keys"></a><p>
          <a class="indexterm" name="idm140091677684512"></a>

          <a class="link" href="functions.html#function_json-keys"><code class="literal">JSON_KEYS(<em class="replaceable"><code>json_doc</code></em>[,
          <em class="replaceable"><code>path</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从JSON对象的顶级值返回键作为JSON数组，或者，如果</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给出参数，则返回所选路径中的顶级键。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果有任何参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">参数
           </font><font style="vertical-align: inherit;">，该
           </font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是对象，或者</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果给定，则不返回对象。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是有效的JSON文档或</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是有效的路径表达式或包含
           </font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符，</font><font style="vertical-align: inherit;">则会发生错误
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果所选对象为空，则结果数组为空。</font><font style="vertical-align: inherit;">如果顶级值具有嵌套的子对象，则返回值不包括来自这些子对象的键。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_KEYS('{"a": 1, "b": {"c": 30}}');</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_KEYS（'{“a”：1，“b”：{“c”：30}}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“a”，“b”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_KEYS('{"a": 1, "b": {"c": 30}}', '$.b');</code></strong><font></font>
+----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_KEYS（'{“a”：1，“b”：{“c”：30}}'，'$ .b'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“c”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-overlaps"></a><p>
          <a class="indexterm" name="idm140091677665952"></a>

          <a class="link" href="functions.html#function_json-overlaps"><code class="literal">JSON_OVERLAPS(<em class="replaceable"><code>json_doc1</code></em>,
          <em class="replaceable"><code>json_doc2</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          比较两个JSON文档。</font><font style="vertical-align: inherit;">如果两个文档具有任何共同的键值对或数组元素，则返回true（1）。</font><font style="vertical-align: inherit;">如果两个参数都是标量，则该函数执行简单的相等性测试。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该函数用作对应函数
           </font></font><a class="link" href="functions.html#function_json-contains"><code class="literal">JSON_CONTAINS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其要求搜索到的数组的所有元素都存在于搜索的数组中。因此，</font></font><code class="literal">JSON_CONTAINS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在执行</font></font><code class="literal">AND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作的同时对搜索键</font></font><code class="literal">JSON_OVERLAPS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行
           </font></font><code class="literal">OR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当两个比较两个数组时，</font></font><code class="literal">JSON_OVERLAPS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果它们共享一个或多个共同的数组元素</font><font style="vertical-align: inherit;">，则</font><font style="vertical-align: inherit;">返回true;如果不共享</font><font style="vertical-align: inherit;">，则
           </font><font style="vertical-align: inherit;">返回false：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS("[1,3,5,7]", "[2,5,7]");</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（“[1,3,5,7]”，“[2,5,7]”）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font>
|                                     1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS("[1,3,5,7]", "[2,6,7]");</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（“[1,3,5,7]”，“[2,6,7]”）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                                     1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS("[1,3,5,7]", "[2,6,8]");</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（“[1,3,5,7]”，“[2,6,8]”）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font>
|                                     0 |<font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          部分匹配被视为不匹配，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS('[[1,2],[3,4],5]', '[1,[2,3],[4,5]]');</code></strong><font></font>
+-----------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（'[[1,2]，[3,4]，5]'，'[1，[2,3]，[4,5]]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------+</font></font><font></font>
|                                                   0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          比较对象时，如果它们至少有一个共同的键值对，则结果为真。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS('{"a":1,"b":10,"d":10}', '{"c":1,"e":10,"f":1,"d":10}');</code></strong><font></font>
+-----------------------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（'{“a”：1，“b”：10，“d”：10}'，'{“c”：1，“e”：10，“f”：1，“d”：10} '）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------------------------+</font></font><font></font>
|                                                                     1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS('{"a":1,"b":10,"d":10}', '{"a":5,"e":10,"f":1,"d":20}');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（'{“a”：1，“b”：10，“d”：10}'，'{“a”：5，“e”：10，“f”：1，“d”：20} '）|</font></font><font></font>
+-----------------------------------------------------------------------+<font></font>
|                                                                     0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果使用两个标量作为函数的参数，则
           </font></font><code class="literal">JSON_OVERLAPS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行一个简单的相等测试：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS('5', '5');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（'5'，'5'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font>
|                       1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS('5', '6');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（'5'，'6'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font>
|                       0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将标量与数组进行比较时，会
           </font></font><code class="literal">JSON_OVERLAPS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试将标量视为数组元素。</font><font style="vertical-align: inherit;">在此示例中，第二个参数</font></font><code class="literal">6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被解释为
           </font></font><code class="literal">[6]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS('[4,5,6,7]', '6');</code></strong><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（'[4,5,6,7]'，'6'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
|                               1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该函数不执行类型转换：
        </font></font></p><pre class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS('[4,5,"6",7]', '6');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（'[4,5，“6”，7]'，'6'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font>
|                                 0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OVERLAPS('[4,5,6,7]', '"6"');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OVERLAPS（'[4,5,6,7]'，'“6”'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                                 0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p>
          <code class="literal">JSON_OVERLAPS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在MySQL 8.0.17中添加了。
        </font></font></p></li><li class="listitem"><a name="function_json-search"></a><p>
          <a class="indexterm" name="idm140091677626256"></a>

          <a class="link" href="functions.html#function_json-search"><code class="literal">JSON_SEARCH(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>one_or_all</code></em>,
          <em class="replaceable"><code>search_str</code></em>[,
          <em class="replaceable"><code>escape_char</code></em>[,
          <em class="replaceable"><code>path</code></em>] ...])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回JSON文档中给定字符串的路径。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果任何</font><font style="vertical-align: inherit;">，或者
           </font><font style="vertical-align: inherit;">参数是
           </font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">则
           </font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">
          文件中</font><font style="vertical-align: inherit;">不</font><font style="vertical-align: inherit;">存在; </font><font style="vertical-align: inherit;">或者
           </font><font style="vertical-align: inherit;">没找到。</font><font style="vertical-align: inherit;">发生错误时，如果</font><font style="vertical-align: inherit;">参数不是一个有效的JSON文档，任何</font><font style="vertical-align: inherit;">
          参数不是一个有效的路径表达式，
           </font><font style="vertical-align: inherit;">是不
           </font><font style="vertical-align: inherit;">或</font><font style="vertical-align: inherit;">，或者
           </font><font style="vertical-align: inherit;">是不是一个常量表达式。
        </font></font><em class="replaceable"><code>search_str</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>search_str</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>one_or_all</code></em><font style="vertical-align: inherit;"></font><code class="literal">'one'</code><font style="vertical-align: inherit;"></font><code class="literal">'all'</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>escape_char</code></em><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><em class="replaceable"><code>one_or_all</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数影响搜索，如下所示：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">'one'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：搜索在第一个匹配后终止，并返回一个路径字符串。</font><font style="vertical-align: inherit;">未定义哪个匹配首先考虑。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">'all'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：搜索返回所有匹配的路径字符串，以便不包含重复的路径。</font><font style="vertical-align: inherit;">如果有多个字符串，则将它们自动包装为数组。</font><font style="vertical-align: inherit;">数组元素的顺序未定义。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><em class="replaceable"><code>search_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索字符串参数中，</font></font><code class="literal">%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字符用于</font></font><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          运算符：</font></font><code class="literal">%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配任意数量的字符（包括零个字符），并且只
           </font></font><code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配一个字符。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要</font><font style="vertical-align: inherit;">在搜索字符串中</font><font style="vertical-align: inherit;">指定文字</font></font><code class="literal">%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符，请在其前面加上转义字符。</font><font style="vertical-align: inherit;">默认值是
           </font></font><code class="literal">\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果
           </font></font><em class="replaceable"><code>escape_char</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数丢失或
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，
           </font></font><em class="replaceable"><code>escape_char</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是空或一个字符的常量。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关匹配和转义字符行为的详细信息，请参阅的说明
           </font></font><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在
           </font></font><a class="xref" href="functions.html#string-comparison-functions" title="12.5.1字符串比较函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.5.1节，“字符串比较函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于转义字符处理，与</font></font><a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行为</font><font style="vertical-align: inherit;">的区别
           </font><font style="vertical-align: inherit;">在于转义字符</font></font><a class="link" href="functions.html#function_json-search"><code class="literal">JSON_SEARCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          必须在编译时计算为常量，而不仅仅是在执行时。</font><font style="vertical-align: inherit;">例如，如果</font></font><a class="link" href="functions.html#function_json-search"><code class="literal">JSON_SEARCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在预准备语句中使用</font><font style="vertical-align: inherit;">if
           </font><font style="vertical-align: inherit;">并且使用
           </font></font><em class="replaceable"><code>escape_char</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数提供</font></font><code class="literal">?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，则参数值在执行时可能是常量，但不是在编译时。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @j = '["abc", [{"k": "10"}, "def"], {"x":"abc"}, {"y":"bcd"}]';</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'one', 'abc');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'one'，'abc'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [0]”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', 'abc');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'abc'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“$ [0]”，“$ [2] .x”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', 'ghi');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'ghi'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10');</code></strong><font></font>
+------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'10'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [1] [0] .k”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@ j，'all'，'10'，NULL，'$'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [1] [0] .k”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$[*]');</code></strong><font></font>
+--------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'10'，NULL，'$ [*]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [1] [0] .k”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$**.k');</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'10'，NULL，'$ **。k'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [1] [0] .k”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$[*][0].k');</code></strong><font></font>
+-------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@ j，'all'，'10'，NULL，'$ [*] [0] .k'）|</font></font><font></font>
+-------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [1] [0] .k”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$[1]');</code></strong><font></font>
+--------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'10'，NULL，'$ [1]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [1] [0] .k”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '10', NULL, '$[1][0]');</code></strong><font></font>
+-----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@ j，'all'，'10'，NULL，'$ [1] [0]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [1] [0] .k”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', 'abc', NULL, '$[2]');</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@ j，'all'，'abc'，NULL，'$ [2]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [2] .x”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%a%');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'％a％'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“$ [0]”，“$ [2] .x”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'％b％'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“$ [0]”，“$ [2] .x”，“$ [3] .y”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', NULL, '$[0]');</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'％b％'，NULL，'$ [0]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [0]”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', NULL, '$[2]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'％b％'，NULL，'$ [2]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [2] .x”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', NULL, '$[1]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'％b％'，NULL，'$ [1]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', '', '$[1]');</code></strong><font></font>
+-------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'％b％'，''，'$ [1]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SEARCH(@j, 'all', '%b%', '', '$[3]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SEARCH（@j，'all'，'％b％'，''，'$ [3]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“$ [3] .y”|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关MySQL支持JSON的路径语法，包括有关通配符运营规则的详细信息
           </font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并</font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅
           </font></font><a class="xref" href="data-types.html#json-path-syntax" title="JSON路径语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON路径语法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="operator_member-of"></a><p>
          <a class="indexterm" name="idm140091677561440"></a>

          <a class="link" href="functions.html#operator_member-of"><code class="literal"><em class="replaceable"><code>value</code></em>
          MEMBER OF(<em class="replaceable"><code>json_array</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>value</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是元素</font></font><em class="replaceable"><code>json_array</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则</font><font style="vertical-align: inherit;">返回true（1）</font><font style="vertical-align: inherit;">，否则返回false（0）。</font></font><em class="replaceable"><code>value</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是标量或JSON文档; </font><font style="vertical-align: inherit;">如果它是标量，则运算符会尝试将其视为JSON数组的元素。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          简单标量被视为数组值，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 17 MEMBER OF('[23, "abc", 17, "ab", 10]');</code></strong><font></font>
+-------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">17成员（'[23，“abc”，17，“ab”，10]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font>
|                                         1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 'ab' MEMBER OF('[23, "abc", 17, "ab", 10]');</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">'ab'成员（'[23，“abc”，17，“ab”，10]'）|</font></font><font></font>
+---------------------------------------------+<font></font>
|                                           1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          数组元素值的部分匹配不匹配：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 7 MEMBER OF('[23, "abc", 17, "ab", 10]');</code></strong><font></font>
+------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">7成员（'[23，“abc”，17，“ab”，10]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------+</font></font><font></font>
|                                        0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 'a' MEMBER OF('[23, "abc", 17, "ab", 10]');</code></strong><font></font>
+--------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">'a'成员（'[23，“abc”，17，“ab”，10]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font>
|                                          0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不执行与字符串类型之间的转换：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
    - &gt; </font></font><strong class="userinput"><code>17 MEMBER OF('[23, "abc", "17", "ab", 10]'),</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
    - &gt;</font></font><strong class="userinput"><code>"17" MEMBER OF('[23, "abc", 17, "ab", 10]')\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
17成员（'[23，“abc”，“17”，“ab”，10]'）：0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“17”成员（'[23，“abc”，17，“ab”，10]'）：0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要将此运算符与其本身为数组的值一起使用，必须将其显式转换为JSON数组。</font><font style="vertical-align: inherit;">你可以这样做</font></font><a class="link" href="functions.html#function_cast"><code class="literal">CAST(... AS JSON)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT CAST('[4,5]' AS JSON) MEMBER OF('[[3,4],[4,5]]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CAST（'[4,5]'AS JSON）成员（'[[3,4]，[4,5]]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------------+</font></font><font></font>
|                                                1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          也可以使用</font></font><a class="link" href="functions.html#function_json-array"><code class="literal">JSON_ARRAY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">执行必要的强制转换
           </font><font style="vertical-align: inherit;">，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_ARRAY(4,5) MEMBER OF('[[3,4],[4,5]]');</code></strong><font></font>
+--------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY（4,5）成员（'[[3,4]，[4,5]]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font>
|                                          1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          用作要测试的值或出现在目标数组中的任何JSON对象必须使用</font></font><code class="literal">CAST(... AS JSON)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font><font style="vertical-align: inherit;">强制转换为正确的类型
           </font></font><a class="link" href="functions.html#function_json-object"><code class="literal">JSON_OBJECT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此外，包含JSON对象的目标数组本身必须使用
           </font></font><code class="literal">JSON_ARRAY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这在以下语句序列中得到证明：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @a = CAST('{"a":1}' AS JSON);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SET @b = JSON_OBJECT("b", 2);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SET @c = JSON_ARRAY(17, @b, "abc", @a, 23);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @a MEMBER OF(@c), @b MEMBER OF(@c);</code></strong><font></font>
+------------------+------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@a成员（@c）| </font><font style="vertical-align: inherit;">@b MEMBER OF（@c）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+------------------+</font></font><font></font>
|                1 |                1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">MEMBER OF()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作符已添加到MySQL 8.0.17中。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="json-modification-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.4修改JSON值的函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中的函数修改JSON值并返回结果。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-array-append"></a><p>
          <a class="indexterm" name="idm140091677520336"></a>

          <a class="link" href="functions.html#function_json-array-append"><code class="literal">JSON_ARRAY_APPEND(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>[,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将值附加到JSON文档中指定数组的末尾并返回结果。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果有任何参数，则
           </font><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果发生错误
           </font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数是不是一个有效的JSON文档或任何</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是不是有效的路径表达式或包含一个
           </font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          路径值对从左到右进行评估。</font><font style="vertical-align: inherit;">通过评估一对产生的文档成为评估下一对的新值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果路径选择标量或对象值，则该值将在数组中自动包装，并将新值添加到该数组中。</font><font style="vertical-align: inherit;">路径未标识JSON文档中的任何值的对将被忽略。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '["a", ["b", "c"], "d"]';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$[1]', 1);</code></strong><font></font>
+----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_APPEND（@ j，'$ [1]'，1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“a”，[“b”，“c”，1]，“d”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$[0]', 2);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_APPEND（@ j，'$ [0]'，2）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[[“a”，2]，[“b”，“c”]，“d”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$[1][0]', 3);</code></strong><font></font>
+-------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_APPEND（@ j，'$ [1] [0]'，3）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“a”，[[“b”，3]，“c”]，“d”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @j = '{"a": 1, "b": [2, 3], "c": 4}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$.b', 'x');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_APPEND（@ j，'$ .b'，'x'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：1，“b”：[2,3，“x”]，“c”：4} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$.c', 'y');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_APPEND（@ j，'$ .c'，'y'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：1，“b”：[2,3]，“c”：[4，“y”]} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @j = '{"a": 1}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_ARRAY_APPEND(@j, '$', 'z');</code></strong><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_APPEND（@ j，'$'，'z'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[{“a”：1}，“z”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 5.7中，这个函数被命名了
           </font></font><code class="literal">JSON_APPEND()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">MySQL 8.0不再支持该名称。
        </font></font></p></li><li class="listitem"><a name="function_json-array-insert"></a><p>
          <a class="indexterm" name="idm140091677493328"></a>

          <a class="link" href="functions.html#function_json-array-insert"><code class="literal">JSON_ARRAY_INSERT(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>[,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          更新JSON文档，插入文档中的数组并返回修改后的文档。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果有任何参数，则
           </font><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果发生错误
           </font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数是不是一个有效的JSON文档或任何</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是不是有效的路径表达式或包含一个
           </font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符或不与一个数组元素标识符结束。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          路径值对从左到右进行评估。</font><font style="vertical-align: inherit;">通过评估一对产生的文档成为评估下一对的新值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          路径未标识JSON文档中的任何数组的对将被忽略。</font><font style="vertical-align: inherit;">如果路径标识数组元素，则在该元素位置插入相应的值，将任何后续值移到右侧。</font><font style="vertical-align: inherit;">如果路径标识超出数组末尾的数组位置，则该值将插入数组的末尾。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '["a", {"b": [1, 2]}, [3, 4]]';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[1]', 'x');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_INSERT（@ j，'$ [1]'，'x'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“a”，“x”，{“b”：[1,2]}，[3,4]] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[100]', 'x');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_INSERT（@ j，'$ [100]'，'x'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“a”，{“b”：[1,2]}，[3,4]，“x”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[1].b[0]', 'x');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_INSERT（@ j，'$ [1] .b [0]'，'x'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“a”，{“b”：[“x”，1,2]}，[3,4]] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[2][1]', 'y');</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_INSERT（@ j，'$ [2] [1]'，'y'）|</font></font><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“a”，{“b”：[1,2]}，[3，“y”，4]] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_ARRAY_INSERT(@j, '$[0]', 'x', '$[2][1]', 'y');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_ARRAY_INSERT（@ j，'$ [0]'，'x'，'$ [2] [1]'，'y'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“x”，“a”，{“b”：[1,2]}，[3,4]] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          较早的修改会影响数组中以下元素的位置，因此同一</font></font><a class="link" href="functions.html#function_json-array-insert"><code class="literal">JSON_ARRAY_INSERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">中的后续路径
           </font><font style="vertical-align: inherit;">应考虑到这一点。</font><font style="vertical-align: inherit;">在最后一个示例中，第二个路径不插入任何内容，因为路径在第一次插入后不再匹配任何内容。
        </font></font></p></li><li class="listitem"><a name="function_json-insert"></a><p>
          <a class="indexterm" name="idm140091677467824"></a>

          <a class="link" href="functions.html#function_json-insert"><code class="literal">JSON_INSERT(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>[,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将数据插入JSON文档并返回结果。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果有任何参数，则
           </font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果发生错误
           </font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数是不是一个有效的JSON文档或任何</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是不是有效的路径表达式或包含一个
           </font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          路径值对从左到右进行评估。</font><font style="vertical-align: inherit;">通过评估一对产生的文档成为评估下一对的新值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将忽略文档中现有路径的路径值对，并且不会覆盖现有文档值。</font><font style="vertical-align: inherit;">如果路径标识了以下类型的值之一，则文档中不存在路径的路径值对会将值添加到文档中：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不存在于现有对象中的成员。</font><font style="vertical-align: inherit;">该成员将添加到对象并与新值关联。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              位于现有数组末尾的位置。</font><font style="vertical-align: inherit;">使用新值扩展数组。</font><font style="vertical-align: inherit;">如果现有值不是数组，则将其作为数组自动包装，然后使用新值进行扩展。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          否则，将忽略文档中不存在路径的路径 - 值对，但不起作用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了进行比较
           </font></font><a class="link" href="functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及
           </font></font><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，看到的讨论</font></font><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '{ "a": 1, "b": [2, 3]}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_INSERT(@j, '$.a', 10, '$.c', '[true, false]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_INSERT（@ j，'$ .a'，10，'$ .c'，'[true，false]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：1，“b”：[2,3]，“c”：“[true，false]”} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果中列出的第三个也是最后一个值是带引号的字符串，而不是像第二个那样的数组（在输出中没有引用）; </font><font style="vertical-align: inherit;">不会将值转换为JSON类型。</font><font style="vertical-align: inherit;">要将数组作为数组插入，必须显式执行此类强制转换，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_INSERT(@j, '$.a', 10, '$.c', CAST('[true, false]' AS JSON));</code></strong><font></font>
+------------------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_INSERT（@ j，'$ .a'，10，'$ .c'，CAST（'[true，false]'AS JSON））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：1，“b”：[2,3]，“c”：[true，false]} |</font></font><font></font>
+------------------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-merge"></a><p>
          <a class="indexterm" name="idm140091677438080"></a>

          <a class="link" href="functions.html#function_json-merge"><code class="literal">JSON_MERGE(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>json_doc</code></em>[,
          <em class="replaceable"><code>json_doc</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          合并两个或多个JSON文档。</font><font style="vertical-align: inherit;">同义词
           </font></font><code class="literal">JSON_MERGE_PRESERVE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">在MySQL 8.0.3中已弃用，并且在将来的版本中将被删除。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE('[1, 2]', '[true, false]');</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE（'[1,2]'，'[true，false]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[1,2，true，false] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排，1警告（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW WARNINGS\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  等级：警告</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   代码：1287</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
消息：'JSON_MERGE'已弃用，将在以后的版本中删除。</font><font style="vertical-align: inherit;">\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 请改用JSON_MERGE_PRESERVE / JSON_MERGE_PATCH</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关其他示例，请参阅相关条目
           </font></font><a class="link" href="functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_json-merge-patch"></a><p>
          <a class="indexterm" name="idm140091677422432"></a>

          <a class="link" href="functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>json_doc</code></em>[,
          <em class="replaceable"><code>json_doc</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          执行
           </font><font style="vertical-align: inherit;">符合</font></font><a class="ulink" href="https://tools.ietf.org/html/rfc7396" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC 7396</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的两个或多个JSON文档的合并，并返回合并的结果，而不保留具有重复键的成员。</font><font style="vertical-align: inherit;">如果至少有一个作为参数传递给此函数的文档无效，则引发错误。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关此函数与之间差异的解释和示例</font></font><code class="literal">JSON_MERGE_PRESERVE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请参阅与
             </font></font><a class="xref" href="functions.html#json-merge-patch-json-merge-preserve-compared" title="JSON_MERGE_PATCH（）与JSON_MERGE_PRESERVE（）进行比较"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON_MERGE_PRESERVE（）相比较的JSON_MERGE_PATCH（）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p>
          <code class="literal">JSON_MERGE_PATCH()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 执行合并如下：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果第一个参数不是对象，则合并的结果与将空对象与第二个参数合并的结果相同。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果第二个参数不是对象，则合并的结果是第二个参数。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果两个参数都是对象，则合并的结果是具有以下成员的对象：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  第一个对象的所有成员没有在第二个对象中具有相同键的相应成员。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  第二个对象的所有成员在第一个对象中没有对应的键，其值不是JSON </font></font><code class="literal">null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  具有在第一个和第二个对象中存在的键的所有成员，并且其在第二个对象中的值不是JSON </font></font><code class="literal">null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  文字。</font><font style="vertical-align: inherit;">这些成员的值是以递归方式将第一个对象中的值与第二个对象中的值合并的结果。
</font></font></p></li></ul>
</div>
</li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关其他信息，请参阅
           </font></font><a class="xref" href="data-types.html#json-normalization" title="JSON值的规范化，合并和自动包装"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON值的规范化，合并和自动包装</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PATCH('[1, 2]', '[true, false]');</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PATCH（'[1,2]'，'[true，false]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[true，false] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{"name": "x"}', '{"id": 47}');</code></strong><font></font>
+-------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PATCH（'{“name”：“x”}'，'{“id”：47}'）|</font></font><font></font>
+-------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：47，“name”：“x”} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PATCH('1', 'true');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PATCH（'1'，'true'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">是的|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PATCH('[1, 2]', '{"id": 47}');</code></strong><font></font>
+------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PATCH（'[1,2]'，'{“id”：47}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：47} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{ "a": 1, "b":2 }',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;&gt;     </font></font><strong class="userinput"><code>'{ "a": 3, "c":4 }');</code></strong><font></font>
+-----------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PATCH（'{“a”：1，“b”：2}'，'{“a”：3，“c”：4}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：3，“b”：2，“c”：4} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{ "a": 1, "b":2 }','{ "a": 3, "c":4 }',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;&gt;     </font></font><strong class="userinput"><code>'{ "a": 5, "d":6 }');</code></strong><font></font>
+-------------------------------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PATCH（'{“a”：1，“b”：2}'，'{“a”：3，“c”：4}'，'{“a”：5，“d”：6}'） |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：5，“b”：2，“c”：4，“d”：6} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您可以使用此函数通过</font></font><code class="literal">null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在seond参数中</font><font style="vertical-align: inherit;">指定</font><font style="vertical-align: inherit;">相同成员的值</font><font style="vertical-align: inherit;">来删除成员
           </font><font style="vertical-align: inherit;">，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{"a":1, "b":2}', '{"b":null}');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PATCH（'{“a”：1，“b”：2}'，'{“b”：null}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：1} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个例子表明该函数以递归方式运行; </font><font style="vertical-align: inherit;">也就是说，成员的值不仅限于标量，而是它们本身可以是JSON文档：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PATCH('{"a":{"x":1}}', '{"a":{"y":2}}');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PATCH（'{“a”：{“x”：1}}'，'{“a”：{“y”：2}}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：{“x”：1，“y”：2}} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font>
</pre><p>
          <code class="literal">JSON_MERGE_PATCH()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MySQL 8.0.3及更高版本支持。
        </font></font></p><p><a name="json-merge-patch-json-merge-preserve-compared"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON_MERGE_PATCH（）与JSON_MERGE_PRESERVE（）进行比较。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            的行为</font></font><code class="literal">JSON_MERGE_PATCH()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一样的是
             </font></font><a class="link" href="functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，有以下两种情况例外：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">JSON_MERGE_PATCH()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用第二个对象中的匹配键删除第一个对象中的任何成员，前提是与第二个对象中的键关联的值不是JSON </font></font><code class="literal">null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果第二个对象的成员具有与第一个对象中的成员匹配的键，则使用第二个对象中
               </font><font style="vertical-align: inherit;">的值</font></font><code class="literal">JSON_MERGE_PATCH()</code>
              <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替换</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一个对象中的值，而
               </font></font><code class="literal">JSON_MERGE_PRESERVE()</code>
              <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二个值</font><span class="emphasis"><em><font style="vertical-align: inherit;">附加</font></em></span><font style="vertical-align: inherit;">到第一个值。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此示例将相同的3个JSON对象（每个对象具有匹配的键</font></font><code class="literal">"a"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）与这两个函数中的</font><font style="vertical-align: inherit;">每一个进行比较的结果进行比较</font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @x = '{ "a": 1, "b": 2 }',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;      </font></font><strong class="userinput"><code>@y = '{ "a": 3, "c": 4 }',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;     </font></font><strong class="userinput"><code>@z = '{ "a": 5, "d": 6 }';</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT  JSON_MERGE_PATCH(@x, @y, @z)    AS Patch,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;         </font></font><strong class="userinput"><code>JSON_MERGE_PRESERVE(@x, @y, @z) AS Preserve\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   补丁：{“a”：5，“b”：2，“c”：4，“d”：6}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
保留：{“a”：[1,3,5]，“b”：2，“c”：4，“d”：6}</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-merge-preserve"></a><p>
          <a class="indexterm" name="idm140091677365488"></a>

          <a class="link" href="functions.html#function_json-merge-preserve"><code class="literal">JSON_MERGE_PRESERVE(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>json_doc</code></em>[,
          <em class="replaceable"><code>json_doc</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          合并两个或多个JSON文档并返回合并的结果。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果有任何参数，则
           </font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果任何参数不是有效的JSON文档，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          合并根据以下规则进行。</font><font style="vertical-align: inherit;">有关其他信息，请参阅
           </font></font><a class="xref" href="data-types.html#json-normalization" title="JSON值的规范化，合并和自动包装"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON值的规范化，合并和自动包装</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              相邻阵列合并为单个阵列。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              相邻对象合并为单个对象。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              标量值作为数组自动包装并合并为数组。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              通过将对象自动包装为数组并合并两个数组来合并相邻的数组和对象。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('[1, 2]', '[true, false]');</code></strong><font></font>
+------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PRESERVE（'[1,2]'，'[true，false]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[1,2，true，false] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('{"name": "x"}', '{"id": 47}');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PRESERVE（'{“name”：“x”}'，'{“id”：47}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“id”：47，“name”：“x”} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('1', 'true');</code></strong><font></font>
+----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PRESERVE（'1'，'true'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[1，true] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('[1, 2]', '{"id": 47}');</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PRESERVE（'[1,2]'，'{“id”：47}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[1,2，{“id”：47}] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('{ "a": 1, "b": 2 }',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;&gt;    </font></font><strong class="userinput"><code>'{ "a": 3, "c": 4 }');</code></strong><font></font>
+--------------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PRESERVE（'{“a”：1，“b”：2}'，'{“a”：3，“c”：4}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：[1,3]，“b”：2，“c”：4} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql </font></font><strong class="userinput"><code>SELECT JSON_MERGE_PRESERVE('{ "a": 1, "b": 2 }','{ "a": 3, "c": 4 }',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     &gt;&gt;    </font></font><strong class="userinput"><code>'{ "a": 5, "d": 6 }');</code></strong><font></font>
+----------------------------------------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_MERGE_PRESERVE（'{“a”：1，“b”：2}'，'{“a”：3，“c”：4}'，'{“a”：5，“d”：6}'） |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：[1,3,5]，“b”：2，“c”：4，“d”：6} |</font></font><font></font>
+----------------------------------------------------------------------------------+<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能在MySQL 8.0.3中添加为同义词
           </font></font><a class="link" href="functions.html#function_json-merge"><code class="literal">JSON_MERGE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">JSON_MERGE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数现已弃用，并且将在MySQL的未来版本中删除。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该功能与</font></font><a class="link" href="functions.html#function_json-merge-patch"><code class="literal">JSON_MERGE_PATCH()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要方面</font><font style="vertical-align: inherit;">相似但不同
           </font><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">有关详细信息，</font><font style="vertical-align: inherit;">请参阅
           </font></font><a class="xref" href="functions.html#json-merge-patch-json-merge-preserve-compared" title="JSON_MERGE_PATCH（）与JSON_MERGE_PRESERVE（）进行比较"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON_MERGE_PATCH（）与JSON_MERGE_PRESERVE（）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行比较。
        </font></font></p></li><li class="listitem"><a name="function_json-remove"></a><p>
          <a class="indexterm" name="idm140091677333904"></a>

          <a class="link" href="functions.html#function_json-remove"><code class="literal">JSON_REMOVE(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>path</code></em>[,
          <em class="replaceable"><code>path</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从JSON文档中删除数据并返回结果。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果有任何参数，则
           </font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是有效的JSON文档或任何</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是有效的路径表达式或者是</font></font><code class="literal">$</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或包含</font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通配符，</font><font style="vertical-align: inherit;">则会发生错误
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数进行评估从左到右。</font><font style="vertical-align: inherit;">通过评估一条路径生成的文档将成为评估下一条路径的新值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果文档中不存在要删除的元素，则不是错误; </font><font style="vertical-align: inherit;">在这种情况下，路径不会影响文档。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '["a", ["b", "c"], "d"]';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_REMOVE(@j, '$[1]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_REMOVE（@ j，'$ [1]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[“a”，“d”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-replace"></a><p>
          <a class="indexterm" name="idm140091677315232"></a>

          <a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>[,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          替换JSON文档中的现有值并返回结果。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果有任何参数，则
           </font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果发生错误
           </font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数是不是一个有效的JSON文档或任何</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是不是有效的路径表达式或包含一个
           </font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          路径值对从左到右进行评估。</font><font style="vertical-align: inherit;">通过评估一对产生的文档成为评估下一对的新值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          文档中现有路径的路径值对使用新值覆盖现有文档值。</font><font style="vertical-align: inherit;">文档中不存在路径的路径 - 值对将被忽略，并且不起作用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.4中，优化器可以执行列的部分就地更新，</font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是删除旧文档并将新文档完整地写入列。</font><font style="vertical-align: inherit;">可以对使用该</font></font><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">的更新语句执行此优化，
           </font><font style="vertical-align: inherit;">并满足</font></font><a class="xref" href="data-types.html#json-partial-updates" title="JSON值的部分更新"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON值的部分更新中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概述的条件
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了进行比较
           </font></font><a class="link" href="functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及
           </font></font><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，看到的讨论</font></font><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '{ "a": 1, "b": [2, 3]}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_REPLACE(@j, '$.a', 10, '$.c', '[true, false]');</code></strong><font></font>
+-----------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_REPLACE（@j，'$ .a'，10，'$ .c'，'[true，false]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：10，“b”：[2,3]} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-set"></a><p>
          <a class="indexterm" name="idm140091677287840"></a>

          <a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET(<em class="replaceable"><code>json_doc</code></em>,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>[,
          <em class="replaceable"><code>path</code></em>,
          <em class="replaceable"><code>val</code></em>] ...)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在JSON文档中插入或更新数据并返回结果。</font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果任何参数是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果给，不定位的对象。</font><font style="vertical-align: inherit;">如果发生错误
           </font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数是不是一个有效的JSON文档或任何</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是不是有效的路径表达式或包含一个
           </font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          路径值对从左到右进行评估。</font><font style="vertical-align: inherit;">通过评估一对产生的文档成为评估下一对的新值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          文档中现有路径的路径值对使用新值覆盖现有文档值。</font><font style="vertical-align: inherit;">如果路径标识了以下类型的值之一，则文档中不存在路径的路径值对会将值添加到文档中：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不存在于现有对象中的成员。</font><font style="vertical-align: inherit;">该成员将添加到对象并与新值关联。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              位于现有数组末尾的位置。</font><font style="vertical-align: inherit;">使用新值扩展数组。</font><font style="vertical-align: inherit;">如果现有值不是数组，则将其作为数组自动包装，然后使用新值进行扩展。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          否则，将忽略文档中不存在路径的路径 - 值对，但不起作用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.4中，优化器可以执行列的部分就地更新，</font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是删除旧文档并将新文档完整地写入列。</font><font style="vertical-align: inherit;">可以对使用该</font></font><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">的更新语句执行此优化，
           </font><font style="vertical-align: inherit;">并满足</font></font><a class="xref" href="data-types.html#json-partial-updates" title="JSON值的部分更新"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON值的部分更新中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概述的条件
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的</font></font><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能的关系：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 替换现有值并添加不存在的值。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="functions.html#function_json-insert"><code class="literal">JSON_INSERT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 插入值而不替换现有值。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a><font style="vertical-align: inherit;"></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替换
               </font><font style="vertical-align: inherit;">现有值。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例说明了这些差异，使用了document（</font></font><code class="literal">$.a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">中存在的一个路径</font><font style="vertical-align: inherit;">和另一个</font><font style="vertical-align: inherit;">不存在的路径</font><font style="vertical-align: inherit;">（</font></font><code class="literal">$.c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '{ "a": 1, "b": [2, 3]}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_SET(@j, '$.a', 10, '$.c', '[true, false]');</code></strong><font></font>
+-------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SET（@ j，'$ .a'，10，'$ .c'，'[true，false]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：10，“b”：[2,3]，“c”：“[true，false]”} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_INSERT(@j, '$.a', 10, '$.c', '[true, false]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_INSERT（@ j，'$ .a'，10，'$ .c'，'[true，false]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：1，“b”：[2,3]，“c”：“[true，false]”} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_REPLACE(@j, '$.a', 10, '$.c', '[true, false]');</code></strong><font></font>
+-----------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_REPLACE（@j，'$ .a'，10，'$ .c'，'[true，false]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：10，“b”：[2,3]} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-unquote"></a><p>
          <a class="indexterm" name="idm140091677246640"></a>

          <a class="link" href="functions.html#function_json-unquote"><code class="literal">JSON_UNQUOTE(<em class="replaceable"><code>json_val</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          取消引用JSON值并将结果作为</font></font><code class="literal">utf8mb4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符串</font><font style="vertical-align: inherit;">返回
           </font><font style="vertical-align: inherit;">。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数是，则
           </font><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果值以双引号开头和结尾但不是有效的JSON字符串文字，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在字符串中，除非</font></font><a class="link" href="server-administration.html#sqlmode_no_backslash_escapes"><code class="literal">NO_BACKSLASH_ESCAPES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用S​​QL模式，</font><font style="vertical-align: inherit;">否则某些序列具有特殊含义</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些序列中的每一个都以反斜杠（</font></font><code class="literal">\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">开头</font><font style="vertical-align: inherit;">，称为
           </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">转义字符</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">MySQL识别
           </font></font><a class="xref" href="functions.html#json-unquote-character-escape-sequences" title="表12.22 JSON_UNQUOTE（）特殊字符转义序列"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.22“JSON_UNQUOTE（）特殊字符转义序列”中显示的转义序列</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于所有其他转义序列，将忽略反斜杠。</font><font style="vertical-align: inherit;">也就是说，转义字符被解释为好像它没有被转义。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">\x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">就是这样</font></font><code class="literal">x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些序列区分大小写。</font><font style="vertical-align: inherit;">例如，
           </font></font><code class="literal">\b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被解释为退格，但
           </font></font><code class="literal">\B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被解释为</font></font><code class="literal">B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="table">
<a name="json-unquote-character-escape-sequences"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.22 JSON_UNQUOTE（）特殊字符转义序列</font></font></b></p>
<div class="table-contents">
<table><colgroup><col width="15%"><col width="85%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">逃脱序列</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由Sequence表示的字符</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">\"</code><a class="indexterm" name="idm140091677224464"></a><a class="indexterm" name="idm140091677223520"></a></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">双引号（</font></font><code class="literal">"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）字符</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">\b</code><a class="indexterm" name="idm140091677219104"></a><a class="indexterm" name="idm140091677218160"></a></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">退格字符</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">\f</code><a class="indexterm" name="idm140091677214384"></a><a class="indexterm" name="idm140091677213440"></a></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个换文字符</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">\n</code><a class="indexterm" name="idm140091677209712"></a><a class="indexterm" name="idm140091677208768"></a><a class="indexterm" name="idm140091677207824"></a><a class="indexterm" name="idm140091677206880"></a></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">换行符（换行符）</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">\r</code><a class="indexterm" name="idm140091677203136"></a><a class="indexterm" name="idm140091677202192"></a><a class="indexterm" name="idm140091677201248"></a></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回车符</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">\t</code><a class="indexterm" name="idm140091677197504"></a><a class="indexterm" name="idm140091677196560"></a></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制表符</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">\\</code><a class="indexterm" name="idm140091677192832"></a><a class="indexterm" name="idm140091677191888"></a></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反斜杠（</font></font><code class="literal">\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）字符</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">\u<em class="replaceable"><code>XXXX</code></em></code><a class="indexterm" name="idm140091677187184"></a><a class="indexterm" name="idm140091677186240"></a></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unicode值的UTF-8字节 </font></font><em class="replaceable"><code>XXXX</code></em></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这里显示了使用此函数的两个简单示例：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '"abc"';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT @j, JSON_UNQUOTE(@j);</code></strong><font></font>
+-------+------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@j | </font><font style="vertical-align: inherit;">JSON_UNQUOTE（@j）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">“abc”| </font><font style="vertical-align: inherit;">abc |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @j = '[1, 2, 3]';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT @j, JSON_UNQUOTE(@j);</code></strong><font></font>
+-----------+------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@j | </font><font style="vertical-align: inherit;">JSON_UNQUOTE（@j）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+------------------+</font></font><font></font>
| [1, 2, 3] | [1, 2, 3]        |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例显示了如何
           </font></font><code class="literal">JSON_UNQUOTE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a class="link" href="server-administration.html#sqlmode_no_backslash_escapes"><code class="literal">NO_BACKSLASH_ESCAPES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          禁用和启用时</font><font style="vertical-align: inherit;">转义句柄
           </font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @@sql_mode;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@@ sql_mode |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------+</font></font><font></font>
|            |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_UNQUOTE('"\\t\\u0032"');</code></strong><font></font>
+------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_UNQUOTE（'“\\ t \\ u0032”'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font>
|       2                           |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @@sql_mode = 'NO_BACKSLASH_ESCAPES';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_UNQUOTE('"\\t\\u0032"');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_UNQUOTE（'“\\ t \\ u0032”'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">\ t \ u0032 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_UNQUOTE('"\t\u0032"');</code></strong><font></font>
+----------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_UNQUOTE（'“\ t \ u0032”'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font>
|       2                         |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------+</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="json-attribute-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.5返回JSON值属性的函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中的函数返回JSON值的属性。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-depth"></a><p>
          <a class="indexterm" name="idm140091677164384"></a>

          <a class="link" href="functions.html#function_json-depth"><code class="literal">JSON_DEPTH(<em class="replaceable"><code>json_doc</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回JSON文档的最大深度。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数是，则
           </font><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果参数不是有效的JSON文档，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          空数组，空对象或标量值具有深度1.仅包含深度为1的元素的非空数组或仅包含深度为1的成员值的非空对象具有深度2.否则，JSON文档的深度大于2。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_DEPTH('{}'), JSON_DEPTH('[]'), JSON_DEPTH('true');</code></strong><font></font>
+------------------+------------------+--------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_DEPTH（'{}'）| </font><font style="vertical-align: inherit;">JSON_DEPTH（'[]'）| </font><font style="vertical-align: inherit;">JSON_DEPTH（'true'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+------------------+--------------------+</font></font><font></font>
|                1 |                1 |                  1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------+------------------+--------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_DEPTH('[10, 20]'), JSON_DEPTH('[[], {}]');</code></strong><font></font>
+------------------------+------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_DEPTH（'[10,20]'）| </font><font style="vertical-align: inherit;">JSON_DEPTH（'[[]，{}]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+------------------------+</font></font><font></font>
|                      2 |                      2 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_DEPTH('[10, {"a": 20}]');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_DEPTH（'[10，{“a”：20}]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
|                             3 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-length"></a><p>
          <a class="indexterm" name="idm140091677148672"></a>

          <a class="link" href="functions.html#function_json-length"><code class="literal">JSON_LENGTH(<em class="replaceable"><code>json_doc</code></em>[,
          <em class="replaceable"><code>path</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回JSON文档的长度，或者，如果</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出参数</font><font style="vertical-align: inherit;">，则返回
           </font><font style="vertical-align: inherit;">由路径标识的文档中的值的长度。</font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果任何参数
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数不文档中确定的值。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>json_doc</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是有效的JSON文档或
           </font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是有效的路径表达式或包含</font></font><code class="literal">*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通配符，</font><font style="vertical-align: inherit;">则会发生错误</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          文件的长度确定如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              标量的长度为1。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              数组的长度是数组元素的数量。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对象的长度是对象成员的数量。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              长度不计算嵌套数组或对象的长度。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_LENGTH('[1, 2, {"a": 3}]');</code></strong><font></font>
+---------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_LENGTH（'[1,2，{“a”：3}]'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font>
|                               3 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_LENGTH('{"a": 1, "b": {"c": 30}}');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_LENGTH（'{“a”：1，“b”：{“c”：30}}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font>
|                                       2 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_LENGTH('{"a": 1, "b": {"c": 30}}', '$.b');</code></strong><font></font>
+------------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_LENGTH（'{“a”：1，“b”：{“c”：30}}'，'$ .b'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+</font></font><font></font>
|                                              1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-type"></a><p>
          <a class="indexterm" name="idm140091677125856"></a>

          <a class="link" href="functions.html#function_json-type"><code class="literal">JSON_TYPE(<em class="replaceable"><code>json_val</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font></font><code class="literal">utf8mb4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示JSON值类型的字符串。</font><font style="vertical-align: inherit;">这可以是对象，数组或标量类型，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @j = '{"a": [10, true]}';</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT JSON_TYPE(@j);</code></strong><font></font>
+---------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_TYPE（@j）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">对象|</font></font><font></font>
+---------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_TYPE(JSON_EXTRACT(@j, '$.a'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_TYPE（JSON_EXTRACT（@ j，'$ .a'））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ARRAY |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_TYPE(JSON_EXTRACT(@j, '$.a[0]'));</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_TYPE（JSON_EXTRACT（@ j，'$ .a [0]'））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">INTEGER |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_TYPE(JSON_EXTRACT(@j, '$.a[1]'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_TYPE（JSON_EXTRACT（@ j，'$ .a [1]'））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">BOOLEAN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font>
</pre><p>
          <a class="link" href="functions.html#function_json-type"><code class="literal">JSON_TYPE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_TYPE(NULL);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_TYPE（NULL）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果参数不是有效的JSON值，则会发生错误：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_TYPE(1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ERROR 3146（22032）：参数1中JSON数据的数据类型无效</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用json_type; </font><font style="vertical-align: inherit;">需要JSON字符串或JSON类型。</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非错误结果，以下列表描述了可能的
           </font></font><a class="link" href="functions.html#function_json-type"><code class="literal">JSON_TYPE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              纯JSON类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">OBJECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：JSON对象
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">ARRAY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：JSON数组
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">BOOLEAN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：JSON真假文字
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：JSON null文字
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              数字类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">INTEGER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MySQL的
                   </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">TINYINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                   </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">SMALLINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                   </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">MEDIUMINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标量
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">DOUBLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MySQL
                   </font><font style="vertical-align: inherit;">标量
                </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a>
                  <a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
                  <code class="literal">DECIMAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MySQL
                   </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">NUMERIC</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标量
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              时间类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">DATETIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MySQL
                   </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标量
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">DATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MySQL
                   </font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标量
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MySQL
                   </font></font><a class="link" href="data-types.html#time" title="11.3.2 TIME类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标量
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              字符串类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">STRING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MySQL的
                   </font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符类型标量：
                   </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                   </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                   </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                   </font></font><a class="link" href="data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
                  </font></font><a class="link" href="data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a>
</p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              二进制类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">BLOB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：MySQL二进制标量类型包括</font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                   </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                   </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
                  </font></font><a class="link" href="data-types.html#bit-type" title="11.2.4比特值类型 -  BIT"><code class="literal">BIT</code></a>
</p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              所有其他类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>
                  <code class="literal">OPAQUE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （原始位）
</font></font></p></li></ul>
</div>
</li></ul>
</div>
</li><li class="listitem"><a name="function_json-valid"></a><p>
          <a class="indexterm" name="idm140091677045968"></a>

          <a class="link" href="functions.html#function_json-valid"><code class="literal">JSON_VALID(<em class="replaceable"><code>val</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回0或1以指示值是否为有效JSON。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数是，则
           </font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_VALID('{"a": 1}');</code></strong><font></font>
+------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_VALID（'{“a”：1}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+</font></font><font></font>
|                      1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_VALID('hello'), JSON_VALID('"hello"');</code></strong><font></font>
+---------------------+-----------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_VALID（'你好'）| </font><font style="vertical-align: inherit;">JSON_VALID（'“hello”'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------+-----------------------+</font></font><font></font>
|                   0 |                     1 |<font></font>
+---------------------+-----------------------+<font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="json-table-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.6 JSON表函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节包含有关将JSON数据转换为表格数据的JSON函数的信息。</font><font style="vertical-align: inherit;">在MySQL 8.0.4及更高版本中，</font></font><code class="literal">JSON_TABLE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font><font style="vertical-align: inherit;">一个这样的功能</font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-table"></a><p>
          <a class="indexterm" name="idm140091677029520"></a>

          <a class="link" href="functions.html#function_json-table"><code class="literal">JSON_TABLE(<em class="replaceable"><code>expr</code></em>,
          <em class="replaceable"><code>path</code></em> COLUMNS
          (<em class="replaceable"><code>column_list</code></em>) [AS]
          <em class="replaceable"><code>alias</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从JSON文档中提取数据并将其作为具有指定列的关系表返回。</font><font style="vertical-align: inherit;">此函数的完整语法如下所示：
        </font></font></p><pre data-lang="clike" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON_TABLE（
     </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
     </font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COLUMNS（</font></font><em class="replaceable"><code>column_list</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
）[AS] </font></font><em class="replaceable"><code>alias</code></em><font></font>
<font></font>
<em class="replaceable"><code>column_list</code></em>:
    <em class="replaceable"><code>column</code></em>[, <em class="replaceable"><code>column</code></em>][, ...]<font></font>
<font></font>
<em class="replaceable"><code>column</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
     </font></font><em class="replaceable"><code>name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了ORDINALITY</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    |  </font><font style="vertical-align: inherit;">路径</font><font style="vertical-align: inherit;">[ </font><font style="vertical-align: inherit;">] [ </font><font style="vertical-align: inherit;">]</font></font><em class="replaceable"><code>name</code></em> <em class="replaceable"><code>type</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>string path</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>on_error</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>on_empty</code></em><font style="vertical-align: inherit;"></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    |  </font><font style="vertical-align: inherit;">EXISTS PATH </font><font style="vertical-align: inherit;">
    | </font><font style="vertical-align: inherit;">NESTED [PATH] </font><font style="vertical-align: inherit;">COLUMNS（</font><font style="vertical-align: inherit;">）</font></font><em class="replaceable"><code>name</code></em> <em class="replaceable"><code>type</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>string path</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>column_list</code></em><font style="vertical-align: inherit;"></font><font></font>
<font></font>
<em class="replaceable"><code>on_error</code></em>:<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {NULL | </font><font style="vertical-align: inherit;">错误| </font></font><em class="replaceable"><code>json_string</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误的</font><font style="vertical-align: inherit;">默认值</font></font><font></font>
<font></font>
<em class="replaceable"><code>on_empty</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {NULL | </font><font style="vertical-align: inherit;">错误| </font><font style="vertical-align: inherit;">空缺的DEFAULT </font></font><em class="replaceable"><code>json_string</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}
</font></font></pre><p>
          <em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：这是一个返回JSON数据的表达式。</font><font style="vertical-align: inherit;">这可以是constant（</font></font><code class="literal">'{"a":1}'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），列（</font><font style="vertical-align: inherit;">在</font><font style="vertical-align: inherit;">
          子句</font><font style="vertical-align: inherit;">之前指定的
           </font></font><code class="literal">t1.json_data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给定表
           </font><font style="vertical-align: inherit;">）或函数调用（</font><font style="vertical-align: inherit;">）。
        </font></font><code class="literal">t1</code><font style="vertical-align: inherit;"></font><code class="literal">JSON_TABLE()</code><font style="vertical-align: inherit;"></font><code class="literal">FROM</code><font style="vertical-align: inherit;"></font><code class="literal">JSON_EXTRACT(t1,jsn_data,'$.post.comments')</code><font style="vertical-align: inherit;"></font></p><p>
          <em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：JSON路径表达式，应用于数据源。</font><font style="vertical-align: inherit;">我们将匹配路径的JSON值称为</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行源</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">这用于生成一行关系数据。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">COLUMNS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句计算行源，在行源中查找特定的JSON值，并将这些JSON值作为SQL值返回到一行关系数据的各列中。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这</font></font><em class="replaceable"><code>alias</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是必需的。</font><font style="vertical-align: inherit;">表别名的通常规则适用（请参见
           </font></font><a class="xref" href="language-structure.html#identifiers" title="9.2模式对象名称"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9.2节“模式对象名称”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p>
          <code class="literal">JSON_TABLE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 支持四种类型的列，如下面的列表所述：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>name</code></em> FOR
              ORDINALITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：此类型枚举</font></font><code class="literal">COLUMNS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中的</font><font style="vertical-align: inherit;">行
               </font><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">命名列
               </font></font><em class="replaceable"><code>name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个类型为的计数器
               </font></font><code class="literal">UNSIGNED INT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其初始值为1.这相当于</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在
               </font></font><a class="link" href="sql-syntax.html#create-table" title="13.1.20 CREATE TABLE语法"><code class="literal">CREATE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中</font><font style="vertical-align: inherit;">指定列
               </font><font style="vertical-align: inherit;">，并且可用于区分</font></font><code class="literal">NESTED
              [PATH]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">生成的多行的父行</font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>name</code></em>
              <em class="replaceable"><code>type</code></em> PATH
              <em class="replaceable"><code>string_path</code></em>
              [<em class="replaceable"><code>on_error</code></em>]
              [<em class="replaceable"><code>on_empty</code></em>]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：此类型的列用于提取指定的值
               </font></font><em class="replaceable"><code>string_path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
              </font></font><em class="replaceable"><code>type</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一种MySQL数据类型。
              </font></font><code class="literal">JSON_TABLE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用应用于MySQL中的JSON数据的常规自动类型转换，将数据提取为JSON，然后将其强制转换为列类型。</font><font style="vertical-align: inherit;">确切的行为取决于列类型：如果列类型是SQL类型，则只能在列中保存标量值。</font><font style="vertical-align: inherit;">保存对象或数组会触发该
               </font></font><em class="replaceable"><code>on error</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句; </font><font style="vertical-align: inherit;">在从保存为JSON的值到表列的强制执行期间发生错误时也会发生这种情况，例如尝试保存字符串</font></font><code class="literal">'asd'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到整数列。</font><font style="vertical-align: inherit;">缺失值会触发该
               </font></font><em class="replaceable"><code>on_empty</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              optional </font></font><em class="replaceable"><code>on_error</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句确定</font></font><code class="literal">JSON_TABLE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存对象或数组时的作用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">NULL ON ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：列设置为
                   </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">这是默认行为。</font><font style="vertical-align: inherit;">如果在类型强制期间发生错误，则会引发警告。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">ERROR ON ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：抛出错误。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">DEFAULT <em class="replaceable"><code>json
                  string</code></em> ON ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
                   </font></font><em class="replaceable"><code>json_string</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析为JSON（假设它是有效的）并存储而不是对象或数组。</font><font style="vertical-align: inherit;">如果错误是由类型强制引起的，则抛出警告。</font><font style="vertical-align: inherit;">列类型规则也适用于默认值。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              当截断保存到列的值（例如在</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL(10,1)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">保存3.14159）时
               </font><font style="vertical-align: inherit;">，将独立于任何</font></font><code class="literal">ON
              ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">发出警告</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在单个语句中截断多个值时，警告仅发出一次。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              optional </font></font><em class="replaceable"><code>on empty</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句确定</font></font><code class="literal">JSON_TABLE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在数据丢失的情况下（取决于类型）。</font><font style="vertical-align: inherit;">当子句中的列</font></font><code class="literal">NESTED
              PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有匹配且</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为其生成补充行时，也会</font><font style="vertical-align: inherit;">在</font><font style="vertical-align: inherit;">子句中
               </font><font style="vertical-align: inherit;">的列上触发此子句</font><font style="vertical-align: inherit;">。</font></font><em class="replaceable"><code>on empty</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">采用以下值之一：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">NULL ON EMPTY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：列设置为
                   </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">这是默认行为。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">ERROR ON EMPTY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：抛出错误。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">DEFAULT
                  <em class="replaceable"><code>json_string</code></em> ON
                  EMPTY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：提供
                   </font></font><em class="replaceable"><code>json_string</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的解析为JSON，只要它有效，并存储而不是缺少值。</font><font style="vertical-align: inherit;">列类型规则也适用于默认值。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此查询演示了使用</font></font><code class="literal">ON
              ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">ON EMPTY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项。</font><font style="vertical-align: inherit;">对应的行</font></font><code class="literal">{"b":1}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于路径是空的</font></font><code class="literal">"$.a"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并且尝试保存</font></font><code class="literal">[1,2]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为标量会产生错误; </font><font style="vertical-align: inherit;">这些行在显示的输出中突出显示。
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT *</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>FROM</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>JSON_TABLE(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'[{"a":"3"},{"a":2},{"b":1},{"a":0},{"a":[1,2]}]',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>"$[*]"</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>COLUMNS(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>rowid FOR ORDINALITY,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>ac VARCHAR(100) PATH "$.a" DEFAULT '999' ON ERROR DEFAULT '111' ON EMPTY,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>aj JSON PATH "$.a" DEFAULT '{"x": 333}' ON EMPTY,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>bx INT EXISTS PATH "$.b"</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;   </font></font><strong class="userinput"><code>) AS tt;</code></strong><font></font>
<font></font>
+-------+------+------------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">rowid | </font><font style="vertical-align: inherit;">ac | </font><font style="vertical-align: inherit;">aj | </font><font style="vertical-align: inherit;">bx |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+------+------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">“3”| </font><font style="vertical-align: inherit;">0 |</font></font><font></font>
|     2 | 2    | 2          |    0 |<font></font>
<span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">111 | </font><font style="vertical-align: inherit;">{“x”：333} | </font><font style="vertical-align: inherit;">1 |</font></font></em></span><font></font>
|     4 | 0    | 0          |    0 |<font></font>
<span class="emphasis"><em>|     5 | 999  | [1, 2]     |    0 |</em></span><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+------+------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5行（0.00秒）</font></font><font></font>
</pre></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>name</code></em>
              <em class="replaceable"><code>type</code></em> EXISTS PATH
              <em class="replaceable"><code>path</code></em></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：如果在指定的位置存在任何数据，则此列返回1，否则返回</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0。
              </font></font><em class="replaceable"><code>type</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是任何有效的MySQL数据类型，但通常应指定为多种类型</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">NESTED [PATH] <em class="replaceable"><code>path</code></em>
              COLUMNS
              (<em class="replaceable"><code>column_list</code></em>)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：这将JSON数据中的嵌套对象或数组与父对象或数组中的JSON值一起展平为单行。</font><font style="vertical-align: inherit;">使用多个</font></font><code class="literal">PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              选项可以将JSON值从多个嵌套级别投影到单个行中。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              它</font></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是相对于父路径行路径</font></font><code class="literal">JSON_TABLE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者</font></font><code class="literal">NESTED [PATH]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              是嵌套路径中</font><font style="vertical-align: inherit;">父子</font><font style="vertical-align: inherit;">句的路径。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          列名遵循管理表列名称的通常规则和限制。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="language-structure.html#identifiers" title="9.2模式对象名称"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9.2节“架构对象名称”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检查所有JSON和JSON路径表达式的有效性; </font><font style="vertical-align: inherit;">任何一种类型的无效表达式都会导致错误。
        </font></font></p><p><font style="vertical-align: inherit;"></font><em class="replaceable"><code>path</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前面</font></font><code class="literal">COLUMNS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字的</font><font style="vertical-align: inherit;">
          每个匹配都</font><font style="vertical-align: inherit;">映射到结果表中的单个行。</font><font style="vertical-align: inherit;">例如，以下查询给出了此处显示的结果：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT *</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>FROM</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>JSON_TABLE(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'[{"x":2,"y":"8"},{"x":"3","y":"7"},{"x":"4","y":6}]',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>"$[*]" COLUMNS(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>xval VARCHAR(100) PATH "$.x",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>yval VARCHAR(100) PATH "$.y"</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;   </font></font><strong class="userinput"><code>) AS  jt1;</code></strong><font></font>
<font></font>
+------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">xval | </font><font style="vertical-align: inherit;">yval |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font>
| 2    | 8    |<font></font>
| 3    | 7    |<font></font>
| 4    | 6    |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表达式</font></font><code class="literal">"$[*]"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配数组的每个元素。</font><font style="vertical-align: inherit;">您可以通过修改路径来过滤结果中的行。</font><font style="vertical-align: inherit;">例如，使用
           </font></font><code class="literal">"$[1]"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限制提取到用作源的JSON数组的第二个元素，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT *</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>FROM</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>JSON_TABLE(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'[{"x":2,"y":"8"},{"x":"3","y":"7"},{"x":"4","y":6}]',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>"$[1]" COLUMNS(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>xval VARCHAR(100) PATH "$.x",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>yval VARCHAR(100) PATH "$.y"</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;   </font></font><strong class="userinput"><code>) AS  jt1;</code></strong><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">xval | </font><font style="vertical-align: inherit;">yval |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| 3    | 7    |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在列定义中，</font></font><code class="literal">"$"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将整个匹配传递给列; </font></font><code class="literal">"$.x"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font></font><code class="literal">"$.y"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅传递与该键</font><font style="vertical-align: inherit;">匹配</font><font style="vertical-align: inherit;">的值</font></font><code class="literal">x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该匹配内</font><font style="vertical-align: inherit;">的值</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关更多信息，请参阅
           </font></font><a class="xref" href="data-types.html#json-path-syntax" title="JSON路径语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON路径语法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <code class="literal">NESTED PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或简单地
           </font></font><code class="literal">NESTED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font></font><code class="literal">PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是可选的）为</font></font><code class="literal">COLUMNS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它所属</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句中的</font><font style="vertical-align: inherit;">每个匹配生成一组记录
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果没有匹配项，则嵌套路径的所有列都将设置为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这实现了最顶层子句和</font></font><code class="literal">NESTED [PATH]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">之间的外连接</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">可以通过在</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">应用合适的条件来模拟内部联接</font><font style="vertical-align: inherit;">，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT *</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>FROM</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>JSON_TABLE(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'[ {"a": 1, "b": [11,111]}, {"a": 2, "b": [22,222]}, {"a":3}]',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'$[*]' COLUMNS(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;              </font></font><strong class="userinput"><code>a INT PATH '$.a',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;              </font></font><strong class="userinput"><code>NESTED PATH '$.b[*]' COLUMNS (b INT PATH '$')</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;             </font></font><strong class="userinput"><code>)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>) AS jt</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>WHERE b IS NOT NULL;</code></strong><font></font>
<font></font>
+------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a | </font><font style="vertical-align: inherit;">b |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font>
|    1 |   11 |<font></font>
|    1 |  111 |<font></font>
|    2 |   22 |<font></font>
|    2 |  222 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          兄弟姐妹嵌套路径 - 即</font></font><code class="literal">NESTED [PATH]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同一</font></font><code class="literal">COLUMNS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">中的
           </font><font style="vertical-align: inherit;">两个或多个实例
           </font><font style="vertical-align: inherit;">- 一个接一个地处理，一次一个。</font><font style="vertical-align: inherit;">当一个嵌套路径生成记录时，任何兄弟嵌套路径表达式的列都将设置为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这意味着单个包含</font></font><code class="literal">COLUMNS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">单个匹配的记录总数</font><font style="vertical-align: inherit;">是总和，而不是</font></font><code class="literal">NESTED
          [PATH]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修饰符</font><font style="vertical-align: inherit;">生成的所有记录的乘积</font><font style="vertical-align: inherit;">，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT *</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>FROM</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>JSON_TABLE(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'[{"a": 1, "b": [11,111]}, {"a": 2, "b": [22,222]}]',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'$[*]' COLUMNS(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;          </font></font><strong class="userinput"><code>a INT PATH '$.a',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;          </font></font><strong class="userinput"><code>NESTED PATH '$.b[*]' COLUMNS (b1 INT PATH '$'),</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;          </font></font><strong class="userinput"><code>NESTED PATH '$.b[*]' COLUMNS (b2 INT PATH '$')</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>) AS jt;</code></strong><font></font>
<font></font>
+------+------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a | </font><font style="vertical-align: inherit;">b1 | </font><font style="vertical-align: inherit;">b2 |</font></font><font></font>
+------+------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">11 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">111 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">11 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">111 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">22 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">222 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">22 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">222 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          甲</font></font><code class="literal">FOR ORDINALITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列列举由所产生的记录</font></font><code class="literal">COLUMNS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款，并且可以用来区分一个嵌套路径的父记录，特别是如果在父记录值是相同的，因为在这里可以看到：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT *</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>FROM</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;    </font></font><strong class="userinput"><code>JSON_TABLE(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'[{"a": "a_val",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;        </font></font><strong class="userinput"><code>"b": [{"c": "c_val", "l": [1,2]}]},</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>{"a": "a_val",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;        </font></font><strong class="userinput"><code>"b": [{"c": "c_val","l": [11]}, {"c": "c_val", "l": [22]}]}]',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>'$[*]' COLUMNS(</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>top_ord FOR ORDINALITY,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>apath VARCHAR(10) PATH '$.a',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;        </font></font><strong class="userinput"><code>NESTED PATH '$.b[*]' COLUMNS (</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;          </font></font><strong class="userinput"><code>bpath VARCHAR(10) PATH '$.c',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;          </font></font><strong class="userinput"><code>ord FOR ORDINALITY,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;          </font></font><strong class="userinput"><code>NESTED PATH '$.l[*]' COLUMNS (lpath varchar(10) PATH '$')</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;          </font></font><strong class="userinput"><code>)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>) as jt;</code></strong><font></font>
<font></font>
+---------+---------+---------+------+-------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">top_ord | </font><font style="vertical-align: inherit;">apath | </font><font style="vertical-align: inherit;">bpath | </font><font style="vertical-align: inherit;">字| </font><font style="vertical-align: inherit;">lpath |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------+---------+---------+------+-------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">a_val | </font><font style="vertical-align: inherit;">c_val | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">a_val | </font><font style="vertical-align: inherit;">c_val | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">a_val | </font><font style="vertical-align: inherit;">c_val | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">11 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">a_val | </font><font style="vertical-align: inherit;">c_val | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">22 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------+---------+---------+------+-------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          源文档包含两个元素的数组; </font><font style="vertical-align: inherit;">这些元素中的每一个都产生两行。</font><font style="vertical-align: inherit;">整个结果集</font><font style="vertical-align: inherit;">的值</font></font><code class="literal">apath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">值
           </font></font><code class="literal">bpath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相同; </font><font style="vertical-align: inherit;">这意味着它们不能用于确定</font></font><code class="literal">lpath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是来自相同或不同的父母。</font></font><code class="literal">ord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的值
           </font><font style="vertical-align: inherit;">保持与</font></font><code class="literal">top_ord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等于1 </font><font style="vertical-align: inherit;">的记录集</font><font style="vertical-align: inherit;">相同，因此这两个值来自单个对象。</font><font style="vertical-align: inherit;">其余两个值来自不同的对象，因为它们在</font></font><code class="literal">ord</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">具有不同的值</font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="json-validation-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.7 JSON模式验证函数</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091676863792"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从MySQL 8.0.17开始，MySQL支持针对符合</font></font><a class="ulink" href="https://json-schema.org/specification-links.html#draft-4" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON Schema规范草案4的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> JSON模式验证JSON文档
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这可以使用本节中详述的任一函数来完成，这两个函数都包含两个参数，一个JSON模式和一个根据模式验证的JSON文档。
      </font></font><a class="link" href="functions.html#function_json-schema-valid"><code class="literal">JSON_SCHEMA_VALID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果文档对模式进行验证，则返回true;如果不是，则返回false;否则返回false。
      </font></font><a class="link" href="functions.html#function_json-schema-validation-report"><code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      提供有关验证的JSON格式的报告。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个函数都处理null或无效输入，如下所示：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果至少有一个参数是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则函数返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果至少有一个参数是无效的JSON，则该函数会引发错误（</font></font><a class="link" href="error-handling.html#error_er_invalid_type_for_json"><code class="literal">ER_INVALID_TYPE_FOR_JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此外，如果架构不是有效的JSON对象，则函数返回
           </font></font><a class="link" href="error-handling.html#error_er_invalid_json_type"><code class="literal">ER_INVALID_JSON_TYPE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL支持</font></font><code class="literal">required</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON模式中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">属性以强制包含必需的属性（请参阅函数说明中的示例）。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL不支持JSON模式中的外部资源; </font><font style="vertical-align: inherit;">使用</font></font><code class="literal">$ref</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字导致
       </font></font><code class="literal">JSON_SCHEMA_VALID()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">失败
       </font></font><a class="link" href="error-handling.html#error_er_not_supported_yet"><code class="literal">ER_NOT_SUPPORTED_YET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL支持JSON模式中的正则表达式模式，它支持但默默地忽略无效模式（请参阅</font></font><code class="literal">JSON_SCHEMA_VALID()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例</font><font style="vertical-align: inherit;">的说明</font><font style="vertical-align: inherit;">）。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下列表详细介绍了这些功能：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-schema-valid"></a><p>
          <a class="indexterm" name="idm140091676840624"></a>

          <a class="link" href="functions.html#function_json-schema-valid"><code class="literal">JSON_SCHEMA_VALID(<em class="replaceable"><code>schema</code></em>,<em class="replaceable"><code>document</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          根据JSON验证</font></font><em class="replaceable"><code>document</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON </font></font><em class="replaceable"><code>schema</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这两个
           </font></font><em class="replaceable"><code>schema</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>document</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是必需的。</font><font style="vertical-align: inherit;">架构必须是有效的JSON对象; </font><font style="vertical-align: inherit;">该文档必须是有效的JSON文档。</font><font style="vertical-align: inherit;">只要满足这些条件：如果文档针对模式进行验证，则函数返回true（1）; </font><font style="vertical-align: inherit;">否则，返回false（0）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在此示例中，我们将用户变量设置</font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为地理坐标的aa JSON模式</font></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值，将</font><font style="vertical-align: inherit;">另一个
           </font><font style="vertical-align: inherit;">变量设置为
           </font><font style="vertical-align: inherit;">包含一个此类坐标的JSON文档的值。</font><font style="vertical-align: inherit;">然后，我们
           </font><font style="vertical-align: inherit;">通过使用它们作为参数来
           </font></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">验证验证
           </font><font style="vertical-align: inherit;">：
        </font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"></font><code class="literal">JSON_SCHEMA_VALID()</code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
mysql&gt; </font></font><strong class="userinput"><code>SET @schema = '{</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;   </font></font><strong class="userinput"><code>"id": "http://json-schema.org/geo",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"$schema": "http://json-schema.org/draft-04/schema#",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"description": "A geographical coordinate",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"type": "object",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"properties": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>"latitude": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"type": "number",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"minimum": -90,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"maximum": 90</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>},</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>"longitude": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"type": "number",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"minimum": -180,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"maximum": 180</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>}</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>},</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"required": ["latitude", "longitude"]</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;</font></font><strong class="userinput"><code>}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.01秒）</font></font><font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @document = '{</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"latitude": 63.444697,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"longitude": 10.445118</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;</font></font><strong class="userinput"><code>}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SCHEMA_VALID(@schema, @document);</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SCHEMA_VALID（@schema，@ document）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font>
|                                     1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由于</font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含
           </font></font><code class="literal">required</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性，我们可以将其设置
           </font></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为有效但不包含必需属性的值，然后对其进行测试</font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @document = '{}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SCHEMA_VALID(@schema, @document);</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SCHEMA_VALID（@schema，@ document）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font>
|                                     0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果我们现在将值设置为</font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相同的JSON模式但没有该</font></font><code class="literal">required</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          属性，则</font></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">验证因为它是有效的JSON对象，即使它不包含任何属性，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @schema = '{</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"id": "http://json-schema.org/geo",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"$schema": "http://json-schema.org/draft-04/schema#",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"description": "A geographical coordinate",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"type": "object",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"properties": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>"latitude": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"type": "number",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"minimum": -90,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"maximum": 90</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>},</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>"longitude": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"type": "number",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"minimum": -180,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"maximum": 180</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>}</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>}</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;</font></font><strong class="userinput"><code>}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SCHEMA_VALID(@schema, @document);</code></strong><font></font>
+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SCHEMA_VALID（@schema，@ document）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font>
|                                     1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><a class="indexterm" name="idm140091676787056"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          JSON Schema支持为字符串指定正则表达式模式，但MySQL使用的实现默默地忽略了无效模式。</font><font style="vertical-align: inherit;">这意味着</font></font><code class="literal">JSON_SCHEMA_VALID()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">即使正则表达式模式无效，</font><font style="vertical-align: inherit;">也
           </font><font style="vertical-align: inherit;">可以返回true，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SCHEMA_VALID('{"type":"string","pattern":"("}', '"abc"');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SCHEMA_VALID（'{“type”：“string”，“pattern”：“（”}'，'“abc”'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                                                             1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.04秒）</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-schema-validation-report"></a><p>
          <a class="indexterm" name="idm140091676778432"></a>

          <a class="link" href="functions.html#function_json-schema-validation-report"><code class="literal">JSON_SCHEMA_VALIDATION_REPORT(<em class="replaceable"><code>schema</code></em>,<em class="replaceable"><code>document</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          根据JSON验证</font></font><em class="replaceable"><code>document</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON </font></font><em class="replaceable"><code>schema</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这两个
           </font></font><em class="replaceable"><code>schema</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>document</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是必需的。</font><font style="vertical-align: inherit;">与JSON_VALID_SCHEMA（）一样，模式必须是有效的JSON对象，并且文档必须是有效的JSON文档。</font><font style="vertical-align: inherit;">如果满足这些条件，则该函数将返回关于验证结果的报告（作为JSON文档）。</font><font style="vertical-align: inherit;">如果根据JSON模式认为JSON文档有效，则该函数返回一个JSON对象，其中一个属性
           </font></font><code class="literal">valid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值为“true”。</font><font style="vertical-align: inherit;">如果JSON文档未通过验证，则该函数返回一个JSON对象，其中包含此处列出的属性：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">valid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：对于失败的模式验证，始终为“false”
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">reason</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含失败原因的人类可读字符串
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">schema-location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：JSON指针URI片段标识符，指示验证失败的JSON模式中的位置（请参阅此列表后面的注释）
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">document-location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：JSON指针URI片段标识符，指示验证失败的JSON文档中的位置（请参阅此列表后面的注释）
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">schema-failed-keyword</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：一个字符串，其中包含违反JSON模式中的关键字或属性的名称
</font></font></p></li></ul>
</div>
<a class="indexterm" name="idm140091676763184"></a>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            JSON指针URI片段标识符在
             </font></font><a class="ulink" href="https://tools.ietf.org/html/rfc6901#page-5" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC 6901  -  JavaScript Object Notation（JSON）指针中定义</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（这些是</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一样由所使用的JSON路径表示法
             </font></font><a class="link" href="functions.html#function_json-extract"><code class="literal">JSON_EXTRACT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和其他MySQL JSON功能）。在这种表示法中，
             </font></font><code class="literal">#</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示整个文档，和
             </font></font><code class="literal">#/myprop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示包括在命名顶层属性的文档的所述部分
             </font></font><code class="literal">myprop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关详细信息，请参阅刚才引用的规范和本节后面的示例。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在此示例中，我们将用户变量设置</font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为地理坐标的aa JSON模式</font></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值，将</font><font style="vertical-align: inherit;">另一个
           </font><font style="vertical-align: inherit;">变量设置为
           </font><font style="vertical-align: inherit;">包含一个此类坐标的JSON文档的值。</font><font style="vertical-align: inherit;">然后，我们
           </font><font style="vertical-align: inherit;">通过使用它们作为参数来
           </font></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">验证验证
           </font><font style="vertical-align: inherit;">：
        </font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"></font><code class="literal">JSON_SCHEMA_VALIDATION_REORT()</code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
mysql&gt; </font></font><strong class="userinput"><code>SET @schema = '{</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;   </font></font><strong class="userinput"><code>"id": "http://json-schema.org/geo",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"$schema": "http://json-schema.org/draft-04/schema#",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"description": "A geographical coordinate",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"type": "object",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"properties": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>"latitude": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"type": "number",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"minimum": -90,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"maximum": 90</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>},</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>"longitude": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"type": "number",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"minimum": -180,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"maximum": 180</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>}</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>},</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"required": ["latitude", "longitude"]</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;</font></font><strong class="userinput"><code>}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SET @document = '{</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"latitude": 63.444697,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"longitude": 10.445118</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;</font></font><strong class="userinput"><code>}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SCHEMA_VALIDATION_REPORT(@schema, @document);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SCHEMA_VALIDATION_REPORT（@schema，@ document）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“valid”：true} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          现在我们设置</font></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它为它的一个属性指定一个非法值，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @document = '{</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"latitude": 63.444697,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"longitude": 310.445118</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;</font></font><strong class="userinput"><code>}';</code></strong>
</pre><p><font style="vertical-align: inherit;"></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在测试时，</font><font style="vertical-align: inherit;">
          验证</font><font style="vertical-align: inherit;">现在失败
           </font></font><code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">函数调用的输出包含有关失败的详细信息（函数包含
           </font></font><a class="link" href="functions.html#function_json-pretty"><code class="literal">JSON_PRETTY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以提供更好的格式化），如下所示：
        </font></font></p><pre class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_PRETTY(JSON_SCHEMA_VALIDATION_REPORT(@schema, @document))\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JSON_PRETTY（JSON_SCHEMA_VALIDATION_REPORT（@schema，@ document））：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “有效”：错误，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “原因”：“JSON文档位置'＃/经度'在JSON架构位置'＃/ properties / longitude''的要求'最大'失败”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “schema-location”：“＃/ properties / longitude”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “文件位置”：“＃/经度”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “schema-failed-keyword”：“maximum”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由于</font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含
           </font></font><code class="literal">required</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性，我们可以设置
           </font></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为有效但不包含所需属性的值，然后对其进行测试</font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">输出
           </font></font><code class="literal">JSON_SCHEMA_VALIDATION_REPORT()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显示验证因缺少必需元素而失败，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @document = '{}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_PRETTY(JSON_SCHEMA_VALIDATION_REPORT(@schema, @document))\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JSON_PRETTY（JSON_SCHEMA_VALIDATION_REPORT（@schema，@ document））：{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “有效”：错误，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “reason”：“JSON Schema位置'＃'”中的JSON文档位置'＃'需要''''，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “schema-location”：“＃”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “文档位置”：“＃”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “schema-failed-keyword”：“required”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果我们现在将值设置为</font></font><code class="literal">@schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相同的JSON模式但没有该</font></font><code class="literal">required</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          属性，则</font></font><code class="literal">@document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">验证因为它是有效的JSON对象，即使它不包含任何属性，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET @schema = '{</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"id": "http://json-schema.org/geo",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"$schema": "http://json-schema.org/draft-04/schema#",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"description": "A geographical coordinate",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"type": "object",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>"properties": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>"latitude": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"type": "number",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"minimum": -90,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"maximum": 90</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>},</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>"longitude": {</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"type": "number",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"minimum": -180,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;      </font></font><strong class="userinput"><code>"maximum": 180</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;    </font></font><strong class="userinput"><code>}</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt; </font></font><strong class="userinput"><code>}</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;</font></font><strong class="userinput"><code>}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_SCHEMA_VALIDATION_REPORT(@schema, @document);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_SCHEMA_VALIDATION_REPORT（@schema，@ document）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“valid”：true} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="json-utility-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.17.8 JSON实用程序函数</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍了作用于JSON值的实用程序函数，或者可以解析为JSON值的字符串。
      </font></font><a class="link" href="functions.html#function_json-pretty"><code class="literal">JSON_PRETTY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以易于阅读的格式打印出JSON值。
      </font></font><a class="link" href="functions.html#function_json-storage-size"><code class="literal">JSON_STORAGE_SIZE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
       </font></font><a class="link" href="functions.html#function_json-storage-free"><code class="literal">JSON_STORAGE_FREE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分别显示给定JSON值使用的存储空间量以及</font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分更新后列中</font><font style="vertical-align: inherit;">剩余的空间量
       </font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_json-pretty"></a><p>
          <a class="indexterm" name="idm140091676686928"></a>

          <a class="link" href="functions.html#function_json-pretty"><code class="literal">JSON_PRETTY(<em class="replaceable"><code>json_val</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          提供类似于PHP和其他语言和数据库系统中实现的JSON值的漂亮打印。</font><font style="vertical-align: inherit;">提供的值必须是JSON值或JSON值的有效字符串表示形式。</font><font style="vertical-align: inherit;">此值中存在的外部空格和换行符对输出没有影响。</font><font style="vertical-align: inherit;">对于</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，函数返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果该值不是JSON文档，或者无法将其解析为一个，则该函数将失败并显示错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数的输出格式符合以下规则：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              每个数组元素或对象成员显示在单独的行上，与其父级相比，缩进一个额外的级别。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              每个级别的缩进都添加了两个前导空格。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在分隔两个元素或成员的换行符之前打印分隔各个数组元素或对象成员的逗号。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对象成员的键和值由冒号后跟空格（' </font></font><code class="literal">: </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'）</font><font style="vertical-align: inherit;">分隔</font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              空行或数组打印在一行上。</font><font style="vertical-align: inherit;">打开和关闭支架之间没有打印空间。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              字符串标量和键名中的特殊字符使用</font></font><a class="link" href="functions.html#function_json-quote"><code class="literal">JSON_QUOTE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">使用的相同规则进行转义
               </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_PRETTY('123'); # scalar</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_PRETTY（'123'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+</font></font><font></font>
| 123                |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_PRETTY("[1,3,5]"); # array</code></strong><font></font>
+------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_PRETTY（“[1,3,5]”）|</font></font><font></font>
+------------------------+<font></font>
| [<font></font>
  1,<font></font>
  3,<font></font>
  5<font></font>
]      |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_PRETTY('{"a":"10","b":"15","x":"25"}'); # object</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_PRETTY（'{“a”：“10”，“b”：“15”，“x”：“25”}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
| {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “a”：“10”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “b”：“15”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “x”：“25”</font></font><font></font>
}   |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT JSON_PRETTY('["a",1,{"key1":</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;     </font></font><strong class="userinput"><code>"value1"},"5",     "77" ,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;        </font></font><strong class="userinput"><code>{"key2":["value3","valueX",</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '&gt;</font></font><strong class="userinput"><code>"valueY"]},"j", "2"   ]')\G  # nested arrays and objects</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JSON_PRETTY（'[ “一”，1，{ “KEY1”：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             “value1”}，“5”，“77”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                { “KEY2”：[ “值3”， “valuex”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          “valuey”]}，“j”，“2”]'）：[</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “一个”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  1,</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “key1”：“value1”</font></font><font></font>
  },<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “5”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “77”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    “key2”：[</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “值3”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “valuex”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      “VALUE年”</font></font><font></font>
    ]<font></font>
  },<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “J”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “2”</font></font><font></font>
]<font></font>
</pre></li><li class="listitem"><a name="function_json-storage-free"></a><p>
          <a class="indexterm" name="idm140091676661200"></a>

          <a class="link" href="functions.html#function_json-storage-free"><code class="literal">JSON_STORAGE_FREE(<em class="replaceable"><code>json_val</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列值，该功能显示多少存储空间，在其二进制表示被释放它是使用到位更新后
           </font></font><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="functions.html#function_json-remove"><code class="literal">JSON_REMOVE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">参数也可以是一个有效的JSON文档或一个字符串，可以将其解析为一个文字值或用户变量的值 - 在这种情况下函数返回0.如果是，则返回正的非零值argument是一个</font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已经如前所述更新</font><font style="vertical-align: inherit;">的
           </font><font style="vertical-align: inherit;">列值，因此它的二进制表示占用的空间比更新之前的空间少。</font><font style="vertical-align: inherit;">为一个
          </font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已更新的列，使其二进制表示与之前相同或更大，或者如果更新无法利用部分更新，则返回0; </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数是，
           </font><font style="vertical-align: inherit;">则返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>json_val</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，既不是有效的JSON文档也不能成功解析为一个，则会产生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在此示例中，我们创建一个包含</font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的表
           </font><font style="vertical-align: inherit;">，然后插入包含JSON对象的行：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE jtable (jcol JSON);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.38秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO jtable VALUES</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>('{"a": 10, "b": "wxyz", "c": "[true, false]"}');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.04秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM jtable;</code></strong><font></font>
+----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">jcol |</font></font><font></font>
+----------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：10，“b”：“wxyz”，“c”：“[true，false]”} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          现在我们使用更新列值
           </font></font><code class="literal">JSON_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来执行部分更新; </font><font style="vertical-align: inherit;">在这种情况下，我们将</font></font><code class="literal">c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">键（数组</font></font><code class="literal">[true,
          false]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">指向的值替换为</font><font style="vertical-align: inherit;">占用较少空间（整数</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）的值：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>UPDATE jtable</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>SET jcol = JSON_SET(jcol, "$.a", 10, "$.b", "wxyz", "$.c", 1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.03秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
匹配的行数：1已更改：1警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM jtable;</code></strong><font></font>
+--------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">jcol |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：10，“b”：“wxyz”，“c”：1} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_STORAGE_FREE(jcol) FROM jtable;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_STORAGE_FREE（jcol）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font>
|                      14 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          连续部分更新对此可用空间的影响是累积的，如此示例所示，
           </font></font><code class="literal">JSON_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于减少具有键的值占用的空间</font></font><code class="literal">b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（并且不进行其他更改）：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>UPDATE jtable</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>SET jcol = JSON_SET(jcol, "$.a", 10, "$.b", "wx", "$.c", 1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.03秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
匹配的行数：1已更改：1警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_STORAGE_FREE(jcol) FROM jtable;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_STORAGE_FREE（jcol）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font>
|                      16 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不使用</font></font><code class="literal">JSON_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">更新列
           </font></font><code class="literal">JSON_REPLACE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><code class="literal">JSON_REMOVE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">意味着优化器无法就地执行更新; </font><font style="vertical-align: inherit;">在这种情况下，
           </font></font><code class="literal">JSON_STORAGE_FREE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回0，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>UPDATE jtable SET jcol = '{"a": 10, "b": 1}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，1行受影响（0.05秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
匹配的行数：1已更改：1警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_STORAGE_FREE(jcol) FROM jtable;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_STORAGE_FREE（jcol）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font>
|                       0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          只能对列值执行JSON文档的部分更新。</font><font style="vertical-align: inherit;">对于存储JSON值的用户变量，即使使用</font></font><code class="literal">JSON_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下命令</font><font style="vertical-align: inherit;">执行更新，也始终完全替换该值</font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @j = '{"a": 10, "b": "wxyz", "c": "[true, false]"}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SET @j = JSON_SET(@j, '$.a', 10, '$.b', 'wxyz', '$.c', '1');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @j, JSON_STORAGE_FREE(@j) AS Free;</code></strong><font></font>
+----------------------------------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@j | </font><font style="vertical-align: inherit;">免费|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：10，“b”：“wxyz”，“c”：“1”} | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于JSON文字，此函数始终返回0：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_STORAGE_FREE('{"a": 10, "b": "wxyz", "c": "1"}') AS Free;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">免费|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font>
|    0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-storage-size"></a><p>
          <a class="indexterm" name="idm140091676610208"></a>

          <a class="link" href="functions.html#function_json-storage-size"><code class="literal">JSON_STORAGE_SIZE(<em class="replaceable"><code>json_val</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数返回用于存储JSON文档的二进制表示的字节数。</font><font style="vertical-align: inherit;">当参数是一</font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列时，这是用于存储JSON文档的空间，因为它插入到列中，之后可能已对其执行任何部分更新。</font></font><em class="replaceable"><code>json_val</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是有效的JSON文档或可以解析为一个的字符串。</font><font style="vertical-align: inherit;">在它是字符串的情况下，该函数返回JSON二进制表示形式中的存储空间量，该表示形式是通过将字符串解析为JSON并将其转换为二进制而创建的。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果参数是
           </font><font style="vertical-align: inherit;">，则返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>json_val</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者不能 - 或者不能成功解析为JSON文档，则会</font><font style="vertical-align: inherit;">导致错误</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了说明此函数在与</font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列作为参数</font><font style="vertical-align: inherit;">一起使用时的行为
           </font><font style="vertical-align: inherit;">，我们创建一个名为</font></font><code class="literal">jtable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含
           </font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的表</font></font><code class="literal">jcol</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，将JSON值插入表中，然后获取此列使用的存储空间
           </font></font><code class="literal">JSON_STORAGE_SIZE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE jtable (jcol JSON);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.42秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO jtable VALUES</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>('{"a": 1000, "b": "wxyz", "c": "[1, 3, 5, 7]"}');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.04秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>jcol,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>JSON_STORAGE_SIZE(jcol) AS Size,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>JSON_STORAGE_FREE(jcol) AS Free</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>FROM jtable;</code></strong><font></font>
+-----------------------------------------------+------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">jcol | </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">免费|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：1000，“b”：“wxyz”，“c”：“[1,3,5,7]”} | </font><font style="vertical-align: inherit;">47 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------------------------------------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          根据输出
           </font></font><code class="literal">JSON_STORAGE_SIZE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，插入到列中的JSON文档占用47个字节。</font><font style="vertical-align: inherit;">我们还检查了以前使用该列的任何部分更新释放的空间量
           </font></font><a class="link" href="functions.html#function_json-storage-free"><code class="literal">JSON_STORAGE_FREE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">由于尚未执行任何更新，因此预期为0。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          接下来，我们</font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在表上</font><font style="vertical-align: inherit;">执行一个</font><font style="vertical-align: inherit;">应该导致存储的文档的部分更新</font></font><code class="literal">jcol</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后测试结果，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>UPDATE jtable SET jcol = </code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>JSON_SET(jcol, "$.b", "a");</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.04秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
匹配的行数：1已更改：1警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>jcol,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>JSON_STORAGE_SIZE(jcol) AS Size,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>JSON_STORAGE_FREE(jcol) AS Free</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>FROM jtable;</code></strong><font></font>
+--------------------------------------------+------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">jcol | </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">免费|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：1000，“b”：“a”，“c”：“[1,3,5,7]”} | </font><font style="vertical-align: inherit;">47 | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"></font><code class="literal">JSON_STORAGE_FREE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          上一个查询</font><font style="vertical-align: inherit;">
          返回的值</font><font style="vertical-align: inherit;">表示执行了JSON文档的部分更新，并释放了用于存储它的3个字节的空间。</font><font style="vertical-align: inherit;">返回的结果由
           </font></font><code class="literal">JSON_STORAGE_SIZE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分更新保持不变。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          部分更新使用支持更新
           </font></font><a class="link" href="functions.html#function_json-set"><code class="literal">JSON_SET()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="functions.html#function_json-replace"><code class="literal">JSON_REPLACE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="functions.html#function_json-remove"><code class="literal">JSON_REMOVE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code class="literal">JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能部分更新</font><font style="vertical-align: inherit;">值到</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的直接分配</font><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">在进行此类更新后，
           </font></font><code class="literal">JSON_STORAGE_SIZE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">始终显示用于新设置值的存储：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>UPDATE jtable</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;     </font></font><strong class="userinput"><code>SET jcol = '{"a": 4.55, "b": "wxyz", "c": "[true, false]"}';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.04秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
匹配的行数：1已更改：1警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>jcol,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>JSON_STORAGE_SIZE(jcol) AS Size,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>JSON_STORAGE_FREE(jcol) AS Free</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>FROM jtable;</code></strong><font></font>
+------------------------------------------------+------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">jcol | </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">免费|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“a”：4.55，“b”：“wxyz”，“c”：“[true，false]”} | </font><font style="vertical-align: inherit;">56 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------------------+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          无法部分更新JSON用户变量。</font><font style="vertical-align: inherit;">这意味着此函数始终显示当前用于在用户变量中存储JSON文档的空间：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @j = '[100, "sakila", [1, 3, 5], 425.05]';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @j, JSON_STORAGE_SIZE(@j) AS Size;</code></strong><font></font>
+------------------------------------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@j | </font><font style="vertical-align: inherit;">尺寸|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[100，“sakila”，[1,3,5]，425.05] | </font><font style="vertical-align: inherit;">45 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SET @j = JSON_SET(@j, '$[1]', "json");</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @j, JSON_STORAGE_SIZE(@j) AS Size;</code></strong><font></font>
+----------------------------------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@j | </font><font style="vertical-align: inherit;">尺寸|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[100，“json”，[1,3,5]，425.05] | </font><font style="vertical-align: inherit;">43 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SET @j = JSON_SET(@j, '$[2][0]', JSON_ARRAY(10, 20, 30));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @j, JSON_STORAGE_SIZE(@j) AS Size;</code></strong><font></font>
+---------------------------------------------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@j | </font><font style="vertical-align: inherit;">尺寸|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">[100，“json”，[[10,20,30]，3,5]，425.05] | </font><font style="vertical-align: inherit;">56 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于JSON文字，此函数始终返回当前使用的存储空间：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>JSON_STORAGE_SIZE('[100, "sakila", [1, 3, 5], 425.05]') AS A,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>JSON_STORAGE_SIZE('{"a": 1000, "b": "a", "c": "[1, 3, 5, 7]"}') AS B,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;      </font></font><strong class="userinput"><code>JSON_STORAGE_SIZE('{"a": 1000, "b": "wxyz", "c": "[1, 3, 5, 7]"}') AS C,</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>JSON_STORAGE_SIZE('[100, "json", [[10, 20, 30], 3, 5], 425.05]') AS D;</code></strong><font></font>
+----+----+----+----+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">A | </font><font style="vertical-align: inherit;">B | </font><font style="vertical-align: inherit;">C | </font><font style="vertical-align: inherit;">D |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+----+----+----+</font></font><font></font>
| 45 | 44 | 47 | 56 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----+----+----+----+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="gtid-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.18与全局事务标识符（GTID）一起使用的函数</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091676548000"></a><a class="indexterm" name="idm140091676546960"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中描述的功能与基于GTID的复制一起使用。</font><font style="vertical-align: inherit;">重要的是要记住，所有这些函数都将GTID集的字符串表示作为参数。</font><font style="vertical-align: inherit;">因此，与它们一起使用时，必须始终引用GTID集。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多信息，</font><font style="vertical-align: inherit;">请参阅</font></font><a class="xref" href="replication.html#replication-gtids-concepts-gtid-sets" title="GTID集"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GTID集</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个GTID集合的联合只是它们作为字符串的表示，用插入的逗号连接在一起。</font><font style="vertical-align: inherit;">换句话说，您可以定义一个非常简单的函数来获取两个GTID集的并集，类似于此处创建的：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建功能GTID_UNION（g1 TEXT，g2 TEXT）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    返回文本确定性</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    返回CONCAT（g1，'，'，g2）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关GTID以及如何在实践中使用这些GTID功能的更多信息，请参见</font></font><a class="xref" href="replication.html#replication-gtids" title="17.1.3使用全局事务标识符进行复制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.1.3节“使用全局事务标识符进行复制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="table">
<a name="idm140091676541024"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.23 GTID功能</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists functions used with global transaction identifiers (GTIDs)."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_gtid-subset"><code class="literal">GTID_SUBSET()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果子集中的所有GTID也已设置，则返回true;否则返回true。</font><font style="vertical-align: inherit;">否则是假的。
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_gtid-subtract"><code class="literal">GTID_SUBTRACT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回集合中不在子集中的所有GTID。
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_wait-for-executed-gtid-set"><code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      等到给定的GTID在slave上执行。
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_wait-until-sql-thread-after-gtids"><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      等到给定的GTID在slave上执行。
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_gtid-subset"></a><p>
          <a class="indexterm" name="idm140091676518976"></a>

          <a class="link" href="functions.html#function_gtid-subset"><code class="literal">GTID_SUBSET(<em class="replaceable"><code>set1</code></em>,<em class="replaceable"><code>set2</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由于两套全局事务标识符
           </font></font><em class="replaceable"><code>set1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>set2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果所有GTIDs返回true
           </font></font><em class="replaceable"><code>set1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也是
           </font></font><em class="replaceable"><code>set2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则返回false。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与此函数一起使用的GTID集表示为字符串，如以下示例所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57')\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GTID_SUBSET（ '3E11FA47-71CA-11E1-9E33-C80AA9429562：23'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '3E11FA47-71CA-11E1-9E33-C80AA9429562：21-57'）：1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:23-25',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57')\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GTID_SUBSET（ '3E11FA47-71CA-11E1-9E33-C80AA9429562：23-25'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '3E11FA47-71CA-11E1-9E33-C80AA9429562：21-57'）：1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT GTID_SUBSET('3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57')\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GTID_SUBSET（ '3E11FA47-71CA-11E1-9E33-C80AA9429562：20-25'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '3E11FA47-71CA-11E1-9E33-C80AA9429562：21-57'）：0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre></li><li class="listitem"><a name="function_gtid-subtract"></a><p>
          <a class="indexterm" name="idm140091676501952"></a>

          <a class="link" href="functions.html#function_gtid-subtract"><code class="literal">GTID_SUBTRACT(<em class="replaceable"><code>set1</code></em>,<em class="replaceable"><code>set2</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由于两套全局事务标识符
           </font></font><em class="replaceable"><code>set1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><em class="replaceable"><code>set2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，只返回那些GTIDs
           </font></font><em class="replaceable"><code>set1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不在
           </font></font><em class="replaceable"><code>set2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与此函数一起使用的所有GTID集都表示为字符串，必须引用，如下例所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:21')\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GTID_SUBTRACT（ '3E11FA47-71CA-11E1-9E33-C80AA9429562：21-57'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '3E11FA47-71CA-11E1-9E33-C80AA9429562：21'）：3e11fa47-71ca-11e1-9e33-c80aa9429562：22-57</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:20-25')\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GTID_SUBTRACT（ '3E11FA47-71CA-11E1-9E33-C80AA9429562：21-57'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '3E11FA47-71CA-11E1-9E33-C80AA9429562：20-25'）：3e11fa47-71ca-11e1-9e33-c80aa9429562：26-57</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT GTID_SUBTRACT('3E11FA47-71CA-11E1-9E33-C80AA9429562:21-57',</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;     </font></font><strong class="userinput"><code>'3E11FA47-71CA-11E1-9E33-C80AA9429562:23-24')\G</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*************************** 1。排******************** *******</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GTID_SUBTRACT（ '3E11FA47-71CA-11E1-9E33-C80AA9429562：21-57'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    '3E11FA47-71CA-11E1-9E33-C80AA9429562：23-24'）：3e11fa47-71ca-11e1-9e33-c80aa9429562：21-22：25胜57负</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.01秒）</font></font><font></font>
</pre></li><li class="listitem"><a name="function_wait-for-executed-gtid-set"></a><p>
          <a class="indexterm" name="idm140091676484688"></a>

          <a class="link" href="functions.html#function_wait-for-executed-gtid-set"><code class="literal">WAIT_FOR_EXECUTED_GTID_SET(<em class="replaceable"><code>gtid_set</code></em>[,
          <em class="replaceable"><code>timeout</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          等到服务器应用了包含全局事务标识符的所有事务
           </font></font><em class="replaceable"><code>gtid_set</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">也就是说，直到条件GTID_SUBSET（</font></font><em class="replaceable"><code>gtid_subset</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">@@GLOBAL.gtid_executed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）成立。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">GTID集的定义，</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="replication.html#replication-gtids-concepts" title="17.1.3.1 GTID格式和存储"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.1.3.1节“GTID格式和存储”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果指定了超时，并且
           </font></font><em class="replaceable"><code>timeout</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在应用GTID集中的所有事务之前经过了几秒钟，则该功能将停止等待。</font></font><em class="replaceable"><code>timeout</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是可选的，默认超时为0秒，在这种情况下，函数始终等待，直到应用了GTID集中的所有事务。
        </font></font></p><p>
          <code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">监视服务器上应用的所有GTID，包括从所有复制通道和用户客户端到达的事务。</font><font style="vertical-align: inherit;">它没有考虑复制通道是否已启动或停止。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关更多信息，请参见</font></font><a class="xref" href="replication.html#replication-gtids" title="17.1.3使用全局事务标识符进行复制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.1.3节“使用全局事务标识符进行复制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与此函数一起使用的GTID集表示为字符串，因此必须引用，如以下示例所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT WAIT_FOR_EXECUTED_GTID_SET('3E11FA47-71CA-11E1-9E33-C80AA9429562:1-5');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关GTID集的语法说明，请参见
           </font></font><a class="xref" href="replication.html#replication-gtids-concepts" title="17.1.3.1 GTID格式和存储"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.1.3.1节“GTID格式和存储”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，返回值是查询的状态，其中0表示成功，1表示超时。</font><font style="vertical-align: inherit;">任何其他故障都会产生错误。
        </font></font></p><p>
          <a class="link" href="replication.html#sysvar_gtid_mode"><code class="literal">gtid_mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 任何客户端使用此功能等待GTID应用时，都无法更改为OFF。
        </font></font></p></li><li class="listitem"><a name="function_wait-until-sql-thread-after-gtids"></a><p>
          <a class="indexterm" name="idm140091676463024"></a>

          <a class="link" href="functions.html#function_wait-until-sql-thread-after-gtids"><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS(<em class="replaceable"><code>gtid_set</code></em>[,
          <em class="replaceable"><code>timeout</code></em>][,<em class="replaceable"><code>channel</code></em>])</code></a>
        </p><p>
          <code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类似于</font></font><code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它等待直到包含其全局事务标识符的所有事务
           </font></font><em class="replaceable"><code>gtid_set</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已被应用，或者直到</font></font><em class="replaceable"><code>timeout</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秒已经过去，以先发生者为准。</font><font style="vertical-align: inherit;">但是，
           </font></font><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适用于特定的复制通道，并且仅在已在应用程序必须运行的指定通道上应用事务后停止。</font><font style="vertical-align: inherit;">相反，
           </font></font><code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在应用事务后停止，无论它们应用于何处（在任何复制通道或任何用户客户端上），以及是否正在运行任何复制通道。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><em class="replaceable"><code>channel</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项命名该函数适用的复制通道。</font><font style="vertical-align: inherit;">如果未命名通道且不存在默认复制通道以外的通道，则该功能将应用于默认复制通道。</font><font style="vertical-align: inherit;">如果存在多个复制通道，则必须指定通道，否则不知道该功能适用​​于哪个复制通道。</font><font style="vertical-align: inherit;">有关</font></font><a class="xref" href="replication.html#replication-channels" title="17.2.3复制通道"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制通道</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的更多信息</font><a class="xref" href="replication.html#replication-channels" title="17.2.3复制通道"><font style="vertical-align: inherit;">，</font></a><font style="vertical-align: inherit;">请参见
           </font><a class="xref" href="replication.html#replication-channels" title="17.2.3复制通道"><font style="vertical-align: inherit;">第17.2.3节“复制通道”</font></a><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            由于
             </font></font><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            应用于特定复制通道，如果预期事务到达不同的复制通道或用户客户端，例如在故障转移或手动恢复情况下，如果未设置超时，则该函数可无限期挂起。</font><font style="vertical-align: inherit;">使用
             </font></font><code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不是确保在这些情况下交易的正确处理。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用的GTID集
           </font></font><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示为字符串，必须以与for相同的方式引用</font></font><code class="literal">WAIT_FOR_EXECUTED_GTID_SET()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因为
           </font></font><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，函数的返回值是任意正数。</font><font style="vertical-align: inherit;">如果基于GTID的复制未激活（即，如果</font></font><a class="link" href="replication.html#sysvar_gtid_mode"><code class="literal">gtid_mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量的值为OFF），则此值未定义并
           </font></font><code class="literal">WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回NULL。</font><font style="vertical-align: inherit;">如果从站未运行，则该函数也返回NULL。
        </font></font></p><p>
          <a class="link" href="replication.html#sysvar_gtid_mode"><code class="literal">gtid_mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 任何客户端使用此功能等待GTID应用时，都无法更改为OFF。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="enterprise-encryption"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.19 MySQL企业加密功能</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#enterprise-encryption-installation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.19.1 MySQL Enterprise加密安装</font></font></a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-usage"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.19.2 MySQL Enterprise加密用法和示例</font></font></a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-function-reference"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.19.3 MySQL企业加密功能参考</font></font></a></span></dt><dt><span class="section"><a href="functions.html#enterprise-encryption-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.19.4 MySQL企业加密功能描述</font></font></a></span></dt></dl>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL Enterprise Encryption是商业产品MySQL企业版中的扩展。</font><font style="vertical-align: inherit;">要了解有关商业产品的更多信息，
         </font></font><a class="ulink" href="https://www.mysql.com/products/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请访问https://www.mysql.com/products/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL Enterprise Edition包含一组基于OpenSSL库的加密函数，这些函数在SQL级别公开OpenSSL功能。</font><font style="vertical-align: inherit;">这些功能使企业应用程序能够执行以下操作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用公钥非对称加密实现增加的数据保护
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          创建公钥和私钥以及数字签名
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          执行非对称加密和解密
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用加密散列进行数字签名和数据验证和验证
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL Enterprise Encryption支持RSA，DSA和DH加密算法。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL Enterprise Encryption作为用户定义函数（UDF）库提供，可以从中单独安装各个函数。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="enterprise-encryption-installation"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.19.1 MySQL Enterprise加密安装</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL Enterprise Encryption函数位于插件目录（</font></font><a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">指定的目录）中安装的用户定义函数（UDF）库文件中
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">UDF库基本名称</font></font><code class="filename">openssl_udf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        和后缀是平台相关的。</font><font style="vertical-align: inherit;">例如，Linux或Windows上的文件名</font><font style="vertical-align: inherit;">分别</font><font style="vertical-align: inherit;">为</font></font><code class="filename">openssl_udf.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><code class="filename">openssl_udf.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要从库文件安装函数，请使用该
         </font></font><a class="link" href="sql-syntax.html#create-function-udf" title="13.7.4.1 CREATE FUNCTION用户定义函数的语法"><code class="literal">CREATE
        FUNCTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。</font><font style="vertical-align: inherit;">要从库中加载所有函数，请使用这组语句（根据需要调整文件名后缀）：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE FUNCTION asymmetric_decrypt RETURNS STRING</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SONAME'openssl_udf.so';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE FUNCTION asymmetric_derive RETURNS STRING</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SONAME'openssl_udf.so';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE FUNCTION asymmetric_encrypt RETURNS STRING</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SONAME'openssl_udf.so';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE FUNCTION asymmetric_sign RETURNS STRING</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SONAME'openssl_udf.so';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE FUNCTION asymmetric_verify RETURNS INTEGER</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SONAME'openssl_udf.so';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建功能create_asymmetric_priv_key返回STRING</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SONAME'openssl_udf.so';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE FUNCTION create_asymmetric_pub_key RETURNS STRING</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SONAME'openssl_udf.so';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建功能create_dh_parameters RETURNS STRING</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SONAME'openssl_udf.so';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE FUNCTION create_digest RETURNS STRING</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SONAME'openssl_udf.so';</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        安装后，UDF将在服务器重新启动时保持安装状态。</font><font style="vertical-align: inherit;">要卸载UDF，请使用该
         </font></font><a class="link" href="sql-syntax.html#drop-function-udf" title="13.7.4.2 DROP FUNCTION语法"><code class="literal">DROP
        FUNCTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。</font><font style="vertical-align: inherit;">例如，要卸载密钥生成功能，请执行以下操作：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DROP FUNCTION create_asymmetric_priv_key;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DROP FUNCTION create_asymmetric_pub_key;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在
         </font></font><a class="link" href="sql-syntax.html#create-function-udf" title="13.7.4.1 CREATE FUNCTION用户定义函数的语法"><code class="literal">CREATE
        FUNCTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="sql-syntax.html#drop-function-udf" title="13.7.4.2 DROP FUNCTION语法"><code class="literal">DROP
        FUNCTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中，函数名必须以小写形式指定。</font><font style="vertical-align: inherit;">这与它们在函数调用时的使用不同，您可以使用任何字母。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><a class="link" href="sql-syntax.html#create-function-udf" title="13.7.4.1 CREATE FUNCTION用户定义函数的语法"><code class="literal">CREATE
        FUNCTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="sql-syntax.html#drop-function-udf" title="13.7.4.2 DROP FUNCTION语法"><code class="literal">DROP
        FUNCTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句需要
         </font></font><a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限，分别为</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="enterprise-encryption-usage"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.19.2 MySQL Enterprise加密用法和示例</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要在应用程序中使用MySQL Enterprise Encryption，请调用适合您要执行的操作的函数。</font><font style="vertical-align: inherit;">本节演示如何执行一些代表性任务：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#enterprise-encryption-usage-create-key-pair" title="使用RSA加密创建私钥/公钥对"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用RSA加密创建私钥/公钥对</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#enterprise-encryption-usage-encrypt-decrypt" title="使用私钥加密数据，使用公钥解密"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用私钥加密数据，使用公钥解密</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#enterprise-encryption-usage-create-digest" title="从字符串生成摘要"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从字符串生成摘要</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#enterprise-encryption-usage-digital-signing" title="使用密钥对的摘要"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用密钥对的摘要</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#enterprise-encryption-usage-create-symmetic-key" title="创建对称密钥"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建对称密钥</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#enterprise-encryption-usage-limit-cpu" title="通过密钥生成操作限制CPU使用率"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过密钥生成操作限制CPU使用率</font></font></a></p></li></ul>
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="enterprise-encryption-usage-create-key-pair"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用RSA加密创建私钥/公钥对</font></font></h4>

</div>

</div>

</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  加密演算法; </font><font style="vertical-align: inherit;">可以是“DSA”或“DH”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @algo ='RSA';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 密钥长度; </font><font style="vertical-align: inherit;">为更强的钥匙做大</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @key_len = 1024;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 创建私钥</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @priv = CREATE_ASYMMETRIC_PRIV_KEY（@ algo，@ key_len）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 使用相同的算法从私钥导出相应的公钥</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @pub = CREATE_ASYMMETRIC_PUB_KEY（@algo，@ priv）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          现在，您可以使用密钥对来加密和解密数据，签名和验证数据，或生成对称密钥。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="enterprise-encryption-usage-encrypt-decrypt"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用私钥加密数据，使用公钥解密</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这要求密钥对的成员是RSA密钥。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @ciphertext = ASYMMETRIC_ENCRYPT（@algo，'我的秘密文本'，@ priv）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @plaintext = ASYMMETRIC_DECRYPT（@ algo，@ ciphertext，@ pub）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          相反，您可以使用公钥进行加密并使用私钥进行解密。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @ciphertext = ASYMMETRIC_ENCRYPT（@algo，'我的秘密文本'，@ pub）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @plaintext = ASYMMETRIC_DECRYPT（@ algo，@ ciphertext，@ priv）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在任何一种情况下，为加密和解密函数指定的算法必须与用于生成密钥的算法匹配。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="enterprise-encryption-usage-create-digest"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从字符串生成摘要</font></font></h4>

</div>

</div>

</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 摘要类型; </font><font style="vertical-align: inherit;">可以是'SHA256'，'SHA384'或'SHA512'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @dig_type ='SHA224';</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 生成摘要字符串</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @dig = CREATE_DIGEST（@dig_type，'我要消化的文字'）;</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="enterprise-encryption-usage-digital-signing"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用密钥对的摘要</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          密钥对可用于签署数据，然后验证签名是否与摘要匹配。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  加密演算法; </font><font style="vertical-align: inherit;">可能是'DSA'; </font><font style="vertical-align: inherit;">钥匙必须</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 使用相同的算法创建</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @algo ='RSA';</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 为摘要生成签名并根据摘要验证签名</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @sig = ASYMMETRIC_SIGN（@ algo，@ dig，@ priv，@ dig_type）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 验证签名与摘要</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @verf = ASYMMETRIC_VERIFY（@ algo，@ dig，@ sig，@ pub，@ dig_type）;</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="enterprise-encryption-usage-create-symmetic-key"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建对称密钥</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这需要DH私钥/公钥作为输入，使用共享的对称秘密创建。</font><font style="vertical-align: inherit;">通过传递密钥长度来创建秘密
           </font></font><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后将密钥作为</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密钥长度</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">传递给
           </font></font><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 生成DH共享对称秘密</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @dhp = CREATE_DH_PARAMETERS（1024）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 生成DH密钥对</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @algo ='DH';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ priv1 = CREATE_ASYMMETRIC_PRIV_KEY（@algo，@ dhp）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ pub1 = CREATE_ASYMMETRIC_PUB_KEY（@algo，@ priv1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ priv2 = CREATE_ASYMMETRIC_PRIV_KEY（@algo，@ dhp）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ pub2 = CREATE_ASYMMETRIC_PUB_KEY（@algo，@ priv2）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 使用第一方的公钥生成对称密钥，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 第二方的私钥</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ sym1 = ASYMMETRIC_DERIVE（@ pub1，@ priv2）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 或使用第二方的公钥，第一方的私钥</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ sym2 = ASYMMETRIC_DERIVE（@ pub2，@ priv1）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以在运行时使用创建的密钥串的值，并存储到一个变量或表
           </font></font><a class="link" href="sql-syntax.html#set-variable" title="13.7.5.1变量赋值的SET语法"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @ priv1 = CREATE_ASYMMETRIC_PRIV_KEY（'RSA'，1024）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT CREATE_ASYMMETRIC_PRIV_KEY（'RSA'，1024）INTO @ priv2;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INSERT INTO t（key_col）VALUES（CREATE_ASYMMETRIC_PRIV_KEY（'RSA'，1024））;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          存储在文件中的键字符串值可以</font></font><a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由具有该</font></font><a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限的</font><font style="vertical-align: inherit;">用户</font><font style="vertical-align: inherit;">使用该</font><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">读取
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          摘要和签名字符串可以类似地处理。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="enterprise-encryption-usage-limit-cpu"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过密钥生成操作限制CPU使用率</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的
           </font></font><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          和</font></font><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          加密函数采用一个密钥长度参数，和CPU资源的这些功能所需的量随着密钥长度增加而增加。</font><font style="vertical-align: inherit;">对于某些安装，如果应用程序经常生成过长的密钥，则可能会导致CPU使用率不可接受。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          OpenSSL为所有密钥强加最小密钥长度1,024位。</font><font style="vertical-align: inherit;">OpenSSL还为DSA和RSA密钥分别施加10,000位和16,384位
           </font></font><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的最大密钥长度，最大密钥长度为10,000位
           </font></font><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果这些最大值太高，则可以使用三个环境变量来使MySQL服务器管理员为密钥生成设置较低的最大长度，从而限制CPU使用率：
</font></font></p><a class="indexterm" name="idm140091676365616"></a><a class="indexterm" name="idm140091676364496"></a><a class="indexterm" name="idm140091676363040"></a><a class="indexterm" name="idm140091676361920"></a><a class="indexterm" name="idm140091676360416"></a><a class="indexterm" name="idm140091676359296"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">MYSQL_OPENSSL_UDF_DSA_BITS_THRESHOLD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：最大DSA密钥长度（以位为单位）
               </font></font><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此变量的最小值和最大值为1,024和10,000。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPENSSL_UDF_RSA_BITS_THRESHOLD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：最大RSA密钥长度（以位为单位）
               </font></font><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此变量的最小值和最大值分别为1,024和16,384。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPENSSL_UDF_DH_BITS_THRESHOLD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：最大密钥长度（以位为单位）
               </font></font><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此变量的最小值和最大值为1,024和10,000。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要使用任何这些环境变量，请在启动服务器的进程的环境中设置它们。</font><font style="vertical-align: inherit;">如果设置，则它们的值优先于OpenSSL施加的最大密钥长度。</font><font style="vertical-align: inherit;">例如，要为DSA和RSA密钥设置最大密钥长度为4,096位
           </font></font><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请设置以下变量：
        </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">export MYSQL_OPENSSL_UDF_DSA_BITS_THRESHOLD = 4096</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
export MYSQL_OPENSSL_UDF_RSA_BITS_THRESHOLD = 4096</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该示例使用Bourne shell语法。</font><font style="vertical-align: inherit;">其他shell的语法可能不同。
</font></font></p>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="enterprise-encryption-function-reference"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.19.3 MySQL企业加密功能参考</font></font></h3>

</div>

</div>

</div>

<div class="table">
<a name="idm140091676343536"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.24 MySQL企业加密功能</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists MySQL Enterprise Encryption functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-decrypt"><code class="literal">ASYMMETRIC_DECRYPT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用私钥或公钥解密密文
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-derive"><code class="literal">ASYMMETRIC_DERIVE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从非对称密钥导出对称密钥
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用私钥或公钥加密明文
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-sign"><code class="literal">ASYMMETRIC_SIGN()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从摘要生成签名
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_asymmetric-verify"><code class="literal">ASYMMETRIC_VERIFY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      验证签名是否与摘要匹配
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      创建私钥
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-asymmetric-pub-key"><code class="literal">CREATE_ASYMMETRIC_PUB_KEY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      创建公钥
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      生成共享DH密钥
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_create-digest"><code class="literal">CREATE_DIGEST()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从字符串生成摘要
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="enterprise-encryption-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.19.4 MySQL企业加密功能描述</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL Enterprise Encryption功能具有以下一般特征：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于错误类型或不正确数量的参数的参数，每个函数都会返回错误。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果参数不适合允许函数执行所请求的操作，则它会</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据需要</font><font style="vertical-align: inherit;">返回
             </font><font style="vertical-align: inherit;">0或0。</font><font style="vertical-align: inherit;">例如，如果函数不支持指定的算法，密钥长度太短或太长，或者预期为PEM格式的密钥字符串的字符串不是有效密钥，则会发生这种情况。</font><font style="vertical-align: inherit;">（OpenSSL强加了自己的密钥长度限制，服务器管理员可以通过设置环境变量对最大密钥长度施加额外限制。请参见
             </font></font><a class="xref" href="functions.html#enterprise-encryption-usage" title="12.19.2 MySQL Enterprise加密用法和示例"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.19.2节“MySQL Enterprise加密用法和示例”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            底层SSL库负责随机初始化。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        其中一些函数采用加密算法参数。</font><font style="vertical-align: inherit;">下表按功能总结了支持的算法。
</font></font></p>
<div class="table">
<a name="idm140091676300448"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.25按功能支持的算法</font></font></b></p>
<div class="table-contents">
<table summary="Supported encryption algorithms by function."><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></th>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持的算法</font></font></th>
          </tr></thead><tbody><tr>
            <td scope="row"><a class="link" href="functions.html#function_asymmetric-decrypt"><code class="literal">ASYMMETRIC_DECRYPT()</code></a></td>
            <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA</font></font></td>
          </tr><tr>
            <td scope="row"><a class="link" href="functions.html#function_asymmetric-derive"><code class="literal">ASYMMETRIC_DERIVE()</code></a></td>
            <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DH</font></font></td>
          </tr><tr>
            <td scope="row"><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a></td>
            <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA</font></font></td>
          </tr><tr>
            <td scope="row"><a class="link" href="functions.html#function_asymmetric-sign"><code class="literal">ASYMMETRIC_SIGN()</code></a></td>
            <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA，DSA</font></font></td>
          </tr><tr>
            <td scope="row"><a class="link" href="functions.html#function_asymmetric-verify"><code class="literal">ASYMMETRIC_VERIFY()</code></a></td>
            <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA，DSA</font></font></td>
          </tr><tr>
            <td scope="row"><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a></td>
            <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA，DSA，DH</font></font></td>
          </tr><tr>
            <td scope="row"><a class="link" href="functions.html#function_create-asymmetric-pub-key"><code class="literal">CREATE_ASYMMETRIC_PUB_KEY()</code></a></td>
            <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA，DSA，DH</font></font></td>
          </tr><tr>
            <td scope="row"><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a></td>
            <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DH</font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          虽然您可以使用任何RSA，DSA或DH加密算法创建密钥，但其他带有关键参数的函数可能只接受某些类型的密钥。</font><font style="vertical-align: inherit;">例如，
           </font></font><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font></font><a class="link" href="functions.html#function_asymmetric-decrypt"><code class="literal">ASYMMETRIC_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只接受RSA密钥。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下描述描述了MySQL Enterprise Encryption功能的调用序列。</font><font style="vertical-align: inherit;">有关其他示例和讨论，请参见</font></font><a class="xref" href="functions.html#enterprise-encryption-usage" title="12.19.2 MySQL Enterprise加密用法和示例"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.19.2节“MySQL Enterprise Encryption用法和示例”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_asymmetric-decrypt"></a><p>
            <a class="indexterm" name="idm140091676260256"></a>

            <a class="link" href="functions.html#function_asymmetric-decrypt"><code class="literal">ASYMMETRIC_DECRYPT(<em class="replaceable"><code>algorithm</code></em>,
            <em class="replaceable"><code>crypt_str</code></em>,
            <em class="replaceable"><code>key_str</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用给定的算法和密钥字符串解密加密的字符串，并将生成的明文作为二进制字符串返回。</font><font style="vertical-align: inherit;">如果解密失败，结果是
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是PEM格式的有效密钥字符串。</font><font style="vertical-align: inherit;">为了成功解密，它必须是与</font></font><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于生成加密字符串</font><font style="vertical-align: inherit;">的私钥或公钥字符串对应的公钥或私钥
             </font><font style="vertical-align: inherit;">字符串。
            </font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示用于创建密钥的加密算法。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
            </font></font><code class="literal">'RSA'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关用法示例，请参阅说明
             </font></font><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_asymmetric-derive"></a><p>
            <a class="indexterm" name="idm140091676245024"></a>

            <a class="link" href="functions.html#function_asymmetric-derive"><code class="literal">ASYMMETRIC_DERIVE(<em class="replaceable"><code>pub_key_str</code></em>,
            <em class="replaceable"><code>priv_key_str</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用一方的私钥和另一方的公钥来派生对称密钥，并将得到的密钥作为二进制字符串返回。</font><font style="vertical-align: inherit;">如果密钥派生失败，则结果为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>pub_key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
             </font></font><em class="replaceable"><code>priv_key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是PEM格式的有效密钥字符串。</font><font style="vertical-align: inherit;">必须使用DH算法创建它们。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            假设您有两对公钥和私钥：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @dhp = CREATE_DH_PARAMETERS（1024）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ priv1 = CREATE_ASYMMETRIC_PRIV_KEY（'DH'，@ dhp）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ pub1 = CREATE_ASYMMETRIC_PUB_KEY（'DH'，@ priv1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ priv2 = CREATE_ASYMMETRIC_PRIV_KEY（'DH'，@ dhp）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ pub2 = CREATE_ASYMMETRIC_PUB_KEY（'DH'，@ priv2）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            进一步假设您使用一对中的私钥和另一对中的公钥来创建对称密钥字符串。</font><font style="vertical-align: inherit;">然后，这种对称的密钥身份关系成立：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASYMMETRIC_DERIVE（@ pub1，@ priv2）= ASYMMETRIC_DERIVE（@ pub2，@ priv1）
</font></font></pre></li><li class="listitem"><a name="function_asymmetric-encrypt"></a><p>
            <a class="indexterm" name="idm140091676231712"></a>

            <a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT(<em class="replaceable"><code>algorithm</code></em>,
            <em class="replaceable"><code>str</code></em>,
            <em class="replaceable"><code>key_str</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用给定的算法和密钥字符串加密字符串，并将生成的密文作为二进制字符串返回。</font><font style="vertical-align: inherit;">如果加密失败，结果是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            的</font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">长度不能大于更大</font></font><em class="replaceable"><code>key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">长度- 11，以字节为单位
          </font></font></p><p>
            <em class="replaceable"><code>key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是PEM格式的有效密钥字符串。</font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            表示用于创建密钥的加密算法。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
            </font></font><code class="literal">'RSA'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要加密字符串，请将私钥或公钥字符串传递给
             </font></font><a class="link" href="functions.html#function_asymmetric-encrypt"><code class="literal">ASYMMETRIC_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要恢复原始未加密的字符串，请将加密的字符串</font></font><a class="link" href="functions.html#function_asymmetric-decrypt"><code class="literal">ASYMMETRIC_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与公钥或私钥字符串一起</font><font style="vertical-align: inherit;">传递
             </font><font style="vertical-align: inherit;">给与用于加密的私钥或公钥字符串相对应。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 生成私钥/公钥对</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @priv = CREATE_ASYMMETRIC_PRIV_KEY（'RSA'，1024）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @pub = CREATE_ASYMMETRIC_PUB_KEY（'RSA'，@ priv）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 使用私钥加密，使用公钥解密</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ciphertext = ASYMMETRIC_ENCRYPT（'RSA'，'快速棕狐'，@ priv）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @plaintext = ASYMMETRIC_DECRYPT（'RSA'，@ ciphertext，@ pub）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 使用公钥加密，使用私钥解密</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @ciphertext = ASYMMETRIC_ENCRYPT（'RSA'，'快速棕狐'，@ pub）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @plaintext = ASYMMETRIC_DECRYPT（'RSA'，@ ciphertext，@ priv）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            假设：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @s =要加密的字符串</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @priv = PEM格式的有效私有RSA密钥字符串</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @pub = PEM格式的相应公共RSA密钥字符串</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            然后这些身份关系成立：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASYMMETRIC_DECRYPT（'RSA'，ASYMMETRIC_ENCRYPT（'RSA'，@ s，@ priv），@ pub）= @s</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ASYMMETRIC_DECRYPT（'RSA'，ASYMMETRIC_ENCRYPT（'RSA'，@ s，@ pub），@ priv）= @s</font></font><font></font>
</pre></li><li class="listitem"><a name="function_asymmetric-sign"></a><p>
            <a class="indexterm" name="idm140091676210128"></a>

            <a class="link" href="functions.html#function_asymmetric-sign"><code class="literal">ASYMMETRIC_SIGN(<em class="replaceable"><code>algorithm</code></em>,
            <em class="replaceable"><code>digest_str</code></em>,
            <em class="replaceable"><code>priv_key_str</code></em>,
            <em class="replaceable"><code>digest_type</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用私钥字符串签署摘要字符串，并将签名作为二进制字符串返回。</font><font style="vertical-align: inherit;">如果签名失败，结果是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>digest_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是摘要字符串。</font><font style="vertical-align: inherit;">它可以通过调用生成
             </font></font><a class="link" href="functions.html#function_create-digest"><code class="literal">CREATE_DIGEST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>digest_type</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示用于生成摘要字符串的摘要算法。
          </font></font></p><p>
            <em class="replaceable"><code>priv_key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是用于对摘要字符串进行签名的私钥字符串。</font><font style="vertical-align: inherit;">它必须是PEM格式的有效密钥字符串。
            </font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示用于创建密钥的加密算法。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
             </font></font><code class="literal">'RSA'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'DSA'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>digest_type</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
             </font></font><code class="literal">'SHA224'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'SHA256'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><code class="literal">'SHA384'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'SHA512'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关用法示例，请参阅说明
             </font></font><a class="link" href="functions.html#function_asymmetric-verify"><code class="literal">ASYMMETRIC_VERIFY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_asymmetric-verify"></a><p>
            <a class="indexterm" name="idm140091676188896"></a>

            <a class="link" href="functions.html#function_asymmetric-verify"><code class="literal">ASYMMETRIC_VERIFY(<em class="replaceable"><code>algorithm</code></em>,
            <em class="replaceable"><code>digest_str</code></em>,
            <em class="replaceable"><code>sig_str</code></em>,
            <em class="replaceable"><code>pub_key_str</code></em>,
            <em class="replaceable"><code>digest_type</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            验证签名字符串是否与摘要字符串匹配，并返回1或0以指示验证是成功还是失败。
          </font></font></p><p>
            <em class="replaceable"><code>digest_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是摘要字符串。</font><font style="vertical-align: inherit;">它可以通过调用生成
             </font></font><a class="link" href="functions.html#function_create-digest"><code class="literal">CREATE_DIGEST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>digest_type</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示用于生成摘要字符串的摘要算法。
          </font></font></p><p>
            <em class="replaceable"><code>sig_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是签名字符串。</font><font style="vertical-align: inherit;">它可以通过调用生成
             </font></font><a class="link" href="functions.html#function_asymmetric-sign"><code class="literal">ASYMMETRIC_SIGN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>pub_key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是签名者的公钥字符串。</font><font style="vertical-align: inherit;">它对应于传递给</font></font><a class="link" href="functions.html#function_asymmetric-sign"><code class="literal">ASYMMETRIC_SIGN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            生成签名字符串</font><font style="vertical-align: inherit;">的私钥，</font><font style="vertical-align: inherit;">并且必须是PEM格式的有效密钥字符串。</font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            表示用于创建密钥的加密算法。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
             </font></font><code class="literal">'RSA'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'DSA'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>digest_type</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
             </font></font><code class="literal">'SHA224'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'SHA256'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><code class="literal">'SHA384'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'SHA512'</code>
          </p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 设置加密算法和摘要类型</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @algo ='RSA';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @dig_type ='SHA224';</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 创建私钥/公钥对</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @priv = CREATE_ASYMMETRIC_PRIV_KEY（@algo，1024）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @pub = CREATE_ASYMMETRIC_PUB_KEY（@algo，@ priv）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 从字符串生成摘要</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @dig = CREATE_DIGEST（@dig_type，'快速棕狐'）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 为摘要生成签名并根据摘要验证签名</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @sig = ASYMMETRIC_SIGN（@ algo，@ dig，@ priv，@ dig_type）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @verf = ASYMMETRIC_VERIFY（@ algo，@ dig，@ sig，@ pub，@ dig_type）;</font></font><font></font>
</pre></li><li class="listitem"><a name="function_create-asymmetric-priv-key"></a><p>
            <a class="indexterm" name="idm140091676164208"></a>

            <a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY(<em class="replaceable"><code>algorithm</code></em>,
            {<em class="replaceable"><code>key_len</code></em>|<em class="replaceable"><code>dh_secret</code></em>})</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用给定的算法和密钥长度或DH密钥创建私钥，并将密钥作为PEM格式的二进制字符串返回。</font><font style="vertical-align: inherit;">如果密钥生成失败，结果是
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
             </font></font><code class="literal">'RSA'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'DSA'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
            </font></font><code class="literal">'DH'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>key_len</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：最小密钥长度（以位为单位）为1,024。</font><font style="vertical-align: inherit;">最大密钥长度取决于算法：RSA为16,384，DSA为10,000。</font><font style="vertical-align: inherit;">这些密钥长度限制是OpenSSL强加的约束。</font><font style="vertical-align: inherit;">服务器管理员可以通过设置环境变量对最大密钥长度施加额外限制。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="functions.html#enterprise-encryption-usage" title="12.19.2 MySQL Enterprise加密用法和示例"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.19.2节“MySQL Enterprise Encryption用法和示例”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于DH密钥，传递共享DH密钥而不是密钥长度。</font><font style="vertical-align: inherit;">要创建密钥，请将密钥长度传递给
             </font></font><a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此示例创建一个2,048位DSA私钥，然后从私钥派生公钥：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @priv = CREATE_ASYMMETRIC_PRIV_KEY（'DSA'，2048）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET @pub = CREATE_ASYMMETRIC_PUB_KEY（'DSA'，@ priv）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关显示DH密钥生成的示例，请参阅说明
             </font></font><a class="link" href="functions.html#function_asymmetric-derive"><code class="literal">ASYMMETRIC_DERIVE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            选择密钥长度和加密算法时的一些一般注意事项：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                私钥和公钥的加密强度随密钥大小的增加而增加，但密钥生成的时间也会增加。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                DH密钥的生成比RSA或RSA密钥花费更长的时间。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                非对称加密函数比对称函数慢。</font><font style="vertical-align: inherit;">如果性能是一个重要因素，并且要经常使用这些功能，那么最好使用对称加密。</font><font style="vertical-align: inherit;">例如，考虑使用
                 </font></font><a class="link" href="functions.html#function_aes-encrypt"><code class="literal">AES_ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                 </font></font><a class="link" href="functions.html#function_aes-decrypt"><code class="literal">AES_DECRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><a name="function_create-asymmetric-pub-key"></a><p>
            <a class="indexterm" name="idm140091676137664"></a>

            <a class="link" href="functions.html#function_create-asymmetric-pub-key"><code class="literal">CREATE_ASYMMETRIC_PUB_KEY(<em class="replaceable"><code>algorithm</code></em>,
            <em class="replaceable"><code>priv_key_str</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用给定算法从给定私钥派生公钥，并将密钥作为PEM格式的二进制字符串返回。</font><font style="vertical-align: inherit;">如果密钥派生失败，则结果为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>priv_key_str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是PEM格式的有效密钥字符串。</font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            表示用于创建密钥的加密算法。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>algorithm</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
             </font></font><code class="literal">'RSA'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'DSA'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
            </font></font><code class="literal">'DH'</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关用法示例，请参阅说明
             </font></font><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_create-dh-parameters"></a><p>
            <a class="indexterm" name="idm140091676122128"></a>

            <a class="link" href="functions.html#function_create-dh-parameters"><code class="literal">CREATE_DH_PARAMETERS(<em class="replaceable"><code>key_len</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            创建用于生成DH私钥/公钥对的共享密钥，并返回可传递给的二进制字符串
             </font></font><a class="link" href="functions.html#function_create-asymmetric-priv-key"><code class="literal">CREATE_ASYMMETRIC_PRIV_KEY()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果秘密生成失败，则结果为null。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>key_len</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：最小和最大密钥长度（以位为单位）为1,024和10,000。</font><font style="vertical-align: inherit;">这些密钥长度限制是OpenSSL强加的约束。</font><font style="vertical-align: inherit;">服务器管理员可以通过设置环境变量对最大密钥长度施加额外限制。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="functions.html#enterprise-encryption-usage" title="12.19.2 MySQL Enterprise加密用法和示例"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.19.2节“MySQL Enterprise Encryption用法和示例”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关如何使用返回值生成对称密钥的示例，请参阅的说明
             </font></font><a class="link" href="functions.html#function_asymmetric-derive"><code class="literal">ASYMMETRIC_DERIVE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @dhp = CREATE_DH_PARAMETERS（1024）;
</font></font></pre></li><li class="listitem"><a name="function_create-digest"></a><p>
            <a class="indexterm" name="idm140091676108768"></a>

            <a class="link" href="functions.html#function_create-digest"><code class="literal">CREATE_DIGEST(<em class="replaceable"><code>digest_type</code></em>,
            <em class="replaceable"><code>str</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用给定的摘要类型从给定字符串创建摘要，并将摘要作为二进制字符串返回。</font><font style="vertical-align: inherit;">如果摘要生成失败，结果是
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            支持的</font></font><em class="replaceable"><code>digest_type</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
             </font></font><code class="literal">'SHA224'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'SHA256'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><code class="literal">'SHA384'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">'SHA512'</code>
          </p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET @dig = CREATE_DIGEST（'SHA512'，快棕狐'）;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            生成的摘要字符串适合与</font></font><code class="literal">ASYMMETRIC_SIGN()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font><font style="vertical-align: inherit;">一起使用
             </font></font><code class="literal">ASYMMETRIC_VERIFY()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-by-functions-and-modifiers"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.20聚合（GROUP BY）函数</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#group-by-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.20.1聚合（GROUP BY）功能描述</font></font></a></span></dt><dt><span class="section"><a href="functions.html#group-by-modifiers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.20.2 GROUP BY修饰符</font></font></a></span></dt><dt><span class="section"><a href="functions.html#group-by-handling"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.20.3 GROUP BY的MySQL处理</font></font></a></span></dt><dt><span class="section"><a href="functions.html#group-by-functional-dependence"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.20.4功能依赖性的检测</font></font></a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-by-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.20.1聚合（GROUP BY）功能描述</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091676092768"></a><a class="indexterm" name="idm140091676091728"></a><a class="indexterm" name="idm140091676090240"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节介绍对值集合进行操作的组（聚合）函数。
</font></font></p>
<div class="table">
<a name="idm140091676088224"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.26聚合（GROUP BY）函数</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists aggregate (GROUP BY) functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col">Name</th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回参数的平均值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      按位返回AND
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      按位返回OR
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      按位返回异或
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回返回的行数
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_count-distinct"><code class="literal">COUNT(DISTINCT)</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回许多不同值的计数
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_group-concat"><code class="literal">GROUP_CONCAT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回连接的字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-arrayagg"><code class="literal">JSON_ARRAYAGG()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将结果集作为单个JSON数组返回
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_json-objectagg"><code class="literal">JSON_OBJECTAGG()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将结果集作为单个JSON对象返回
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回最大值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回最小值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_std"><code class="literal">STD()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回人口标准差
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回人口标准差
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回人口标准差
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_stddev-samp"><code class="literal">STDDEV_SAMP()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回样本标准差
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      归还总和
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回人口标准差异
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_var-samp"><code class="literal">VAR_SAMP()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回样本方差
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回人口标准差异
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除非另有说明，否则组函数会忽略
         </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果在包含无</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">的语句中使用组函数
         </font><font style="vertical-align: inherit;">，则等效于对所有行进行分组。</font><font style="vertical-align: inherit;">有关更多信息，请参见
         </font></font><a class="xref" href="functions.html#group-by-handling" title="12.20.3 GROUP BY的MySQL处理"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20.3节“GROUP BY的MySQL处理”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        大多数聚合函数可用作窗口函数。</font><font style="vertical-align: inherit;">可以这种方式使用的那些在它们的语法描述中表示
         </font><font style="vertical-align: inherit;">，表示可选</font><font style="vertical-align: inherit;">子句。
        </font><font style="vertical-align: inherit;">在
         </font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中进行了描述</font></a><font style="vertical-align: inherit;">，其中还包含有关窗口函数用法的其他信息。
      </font></font><code class="literal">[<em class="replaceable"><code>over_clause</code></em>]</code><font style="vertical-align: inherit;"></font><code class="literal">OVER</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于数字参数，方差和标准差函数返回一个</font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">的</font></font><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数返回一个
         </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为准确值参数（整数或值</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），以及</font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为近似值参数（值</font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在</font></font><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚合函数不具有时间价值的工作。</font><font style="vertical-align: inherit;">（它们将值转换为数字，在第一个非数字字符后丢失所有内容。）要解决此问题，请转换为数字单位，执行聚合操作，然后转换回时间值。</font><font style="vertical-align: inherit;">例子：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT SEC_TO_TIME（SUM（TIME_TO_SEC（</font></font><em class="replaceable"><code>time_col</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）））FROM</font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT FROM_DAYS（SUM（TO_DAYS（</font></font><em class="replaceable"><code>date_col</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）））FROM </font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果需要，</font><font style="vertical-align: inherit;">
        诸如</font></font><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">期望数字参数的函数将参数强制转换为数字。</font><font style="vertical-align: inherit;">对于
         </font></font><a class="link" href="data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，强制转换操作会导致使用基础数值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        的</font></font><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚合函数执行位操作。</font><font style="vertical-align: inherit;">在MySQL 8.0之前，位函数和运算符需要</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位整数）参数和返回
         </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，因此它们的最大范围为64位。</font><font style="vertical-align: inherit;">非</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在执行操作之前</font><font style="vertical-align: inherit;">被转换为</font><font style="vertical-align: inherit;">可能发生截断。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在MySQL 8.0中，位函数和运算符允许二进制字符串类型参数（</font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型）并返回类似的值，这使它们能够获取参数并生成大于64位的返回值。</font><font style="vertical-align: inherit;">有关位操作的参数评估和结果类型的讨论，请参见</font></font><a class="xref" href="functions.html#bit-functions" title="12.12位功能和操作符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.12节“位功能和操作符”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的介绍性讨论</font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_avg"></a><p>
            <a class="indexterm" name="idm140091675973248"></a>

            <a class="indexterm" name="idm140091675972176"></a>

            <a class="indexterm" name="idm140091675971104"></a>

            <a class="link" href="functions.html#function_avg"><code class="literal">AVG([DISTINCT]
            <em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回的平均值
             </font></font><code class="literal"><em class="replaceable"><code>expr</code></em></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该
             </font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项可用于返回不同值的平均值
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">它不能用于</font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT student_name, AVG(test_score)</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre></li><li class="listitem"><a name="function_bit-and"></a><p>
            <a class="indexterm" name="idm140091675952112"></a>

            <a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><code class="literal">AND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有位</font><font style="vertical-align: inherit;">的按</font><font style="vertical-align: inherit;">位
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果类型取决于函数参数值是作为二进制字符串还是数字计算：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                当参数值具有二进制字符串类型且参数不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字</font><font style="vertical-align: inherit;">时，会发生二进制字符串评估
                 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数值转换为无符号64位整数。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                二进制字符串评估生成与参数值长度相同的二进制字符串。</font><font style="vertical-align: inherit;">如果参数值具有不相等的长度，
                 </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_operands_size"><code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。</font><font style="vertical-align: inherit;">如果参数大小超过511个字节，
                 </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_aggregate_operands_size"><code class="literal">ER_INVALID_BITWISE_AGGREGATE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_bit-and"><code class="literal">BIT_AND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回与参数值具有相同长度的中性值（所有位设置为1）。
          </font></font></p><p>
            <code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非所有值都是，否则值不会影响结果</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，结果是具有与参数值相同长度的中性值。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关参数评估和结果类型的更多信息讨论，请参见</font></font><a class="xref" href="functions.html#bit-functions" title="12.12位功能和操作符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.12节“位功能和操作符”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的介绍性讨论
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 8.0.12开始，如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在</font><font style="vertical-align: inherit;">，该函数将作为窗口函数执行</font><font style="vertical-align: inherit;">。</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如</font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_bit-or"></a><p>
            <a class="indexterm" name="idm140091675929680"></a>

            <a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><code class="literal">OR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有位</font><font style="vertical-align: inherit;">的按</font><font style="vertical-align: inherit;">位
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果类型取决于函数参数值是作为二进制字符串还是数字计算：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                当参数值具有二进制字符串类型且参数不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字</font><font style="vertical-align: inherit;">时，会发生二进制字符串评估
                 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数值转换为无符号64位整数。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                二进制字符串评估生成与参数值长度相同的二进制字符串。</font><font style="vertical-align: inherit;">如果参数值具有不相等的长度，
                 </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_operands_size"><code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。</font><font style="vertical-align: inherit;">如果参数大小超过511个字节，
                 </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_aggregate_operands_size"><code class="literal">ER_INVALID_BITWISE_AGGREGATE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_bit-or"><code class="literal">BIT_OR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回与参数值具有相同长度的中性值（所有位设置为0）。
          </font></font></p><p>
            <code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非所有值都是，否则值不会影响结果</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，结果是具有与参数值相同长度的中性值。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关参数评估和结果类型的更多信息讨论，请参见</font></font><a class="xref" href="functions.html#bit-functions" title="12.12位功能和操作符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.12节“位功能和操作符”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的介绍性讨论
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 8.0.12开始，如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在</font><font style="vertical-align: inherit;">，该函数将作为窗口函数执行</font><font style="vertical-align: inherit;">。</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如</font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_bit-xor"></a><p>
            <a class="indexterm" name="idm140091675907184"></a>

            <a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><a class="link" href="functions.html#operator_xor"><code class="literal">XOR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有位</font><font style="vertical-align: inherit;">的按</font><font style="vertical-align: inherit;">位</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果类型取决于函数参数值是作为二进制字符串还是数字计算：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                当参数值具有二进制字符串类型且参数不是十六进制文字，位字面值或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字</font><font style="vertical-align: inherit;">时，会发生二进制字符串评估
                 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则进行数值计算，必要时将参数值转换为无符号64位整数。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                二进制字符串评估生成与参数值长度相同的二进制字符串。</font><font style="vertical-align: inherit;">如果参数值具有不相等的长度，
                 </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_operands_size"><code class="literal">ER_INVALID_BITWISE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。</font><font style="vertical-align: inherit;">如果参数大小超过511个字节，
                 </font></font><a class="link" href="error-handling.html#error_er_invalid_bitwise_aggregate_operands_size"><code class="literal">ER_INVALID_BITWISE_AGGREGATE_OPERANDS_SIZE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                则会发生错误。</font><font style="vertical-align: inherit;">数值计算生成无符号的64位整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_bit-xor"><code class="literal">BIT_XOR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回与参数值具有相同长度的中性值（所有位设置为0）。
          </font></font></p><p>
            <code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非所有值都是，否则值不会影响结果</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，结果是具有与参数值相同长度的中性值。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关参数评估和结果类型的更多信息讨论，请参见</font></font><a class="xref" href="functions.html#bit-functions" title="12.12位功能和操作符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.12节“位功能和操作符”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的介绍性讨论
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 8.0.12开始，如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在</font><font style="vertical-align: inherit;">，该函数将作为窗口函数执行</font><font style="vertical-align: inherit;">。</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如</font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_count"></a><p>
            <a class="indexterm" name="idm140091675884176"></a>

            <a class="link" href="functions.html#function_count"><code class="literal">COUNT(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font><font style="vertical-align: inherit;">
            语句</font><font style="vertical-align: inherit;">检索的行</font><font style="vertical-align: inherit;">中非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            值</font><font style="vertical-align: inherit;">数的计数</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">结果是一个
             </font><font style="vertical-align: inherit;">值。
          </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT student.student_name,COUNT(*)</code></strong>
       <strong class="userinput"><code>FROM student,course</code></strong>
       <strong class="userinput"><code>WHERE student.student_id=course.student_id</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p>
            <a class="link" href="functions.html#function_count"><code class="literal">COUNT(*)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有点不同，它返回检索的行数的计数，无论它们是否包含
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于事务性存储引擎，例如
             </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，存储精确的行数是有问题的。</font><font style="vertical-align: inherit;">多个交易可能同时发生，每个交易都可能影响计数。
          </font></font></p><p>
            <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不保留表中的内部行数，因为并发事务可能同时
             </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看到</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不同数量的行。</font><font style="vertical-align: inherit;">因此，</font></font><code class="literal">SELECT COUNT(*)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            语句只计算当前事务可见的行。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 8.0.13开始，</font><font style="vertical-align: inherit;">如果没有诸如</font><font style="vertical-align: inherit;">或之类的
             </font><font style="vertical-align: inherit;">额外子句，则针对单线程工作负载优化表的</font><font style="vertical-align: inherit;">查询性能</font><font style="vertical-align: inherit;">。
          </font></font><code class="literal">SELECT COUNT(*) FROM
            <em class="replaceable"><code>tbl_name</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"></font></p><p>
            <code class="literal">InnoDB</code><font style="vertical-align: inherit;"></font><code class="literal">SELECT
            COUNT(*)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过遍历最小的可用二级索引来</font><font style="vertical-align: inherit;">处理</font><font style="vertical-align: inherit;">语句，除非索引或优化程序提示指示优化程序使用不同的索引。</font><font style="vertical-align: inherit;">如果不存在辅助索引，则</font><font style="vertical-align: inherit;">通过扫描聚簇索引来</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            处理</font></font><code class="literal">SELECT COUNT(*)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
          </font></font></p><p><font style="vertical-align: inherit;"></font><code class="literal">SELECT COUNT(*)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果索引记录不完​​全在缓冲池中，则</font><font style="vertical-align: inherit;">
            处理</font><font style="vertical-align: inherit;">语句需要一些时间。</font><font style="vertical-align: inherit;">为了更快地计算，请创建一个计数器表，让应用程序根据插入和删除更新它。</font><font style="vertical-align: inherit;">但是，在数千个并发事务正在启动对同一计数器表的更新的情况下，此方法可能无法很好地扩展。</font><font style="vertical-align: inherit;">如果大概行数足够，请使用
             </font></font><a class="link" href="sql-syntax.html#show-table-status" title="13.7.6.36 SHOW TABLE STATUS语法"><code class="literal">SHOW TABLE STATUS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            以相同的方式</font><font style="vertical-align: inherit;">处理</font></font><code class="literal">SELECT
            COUNT(*)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">SELECT COUNT(1)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作。</font><font style="vertical-align: inherit;">没有性能差异。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，</font></font><a class="link" href="functions.html#function_count"><code class="literal">COUNT(*)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><a class="link" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从一个表检索，没有检索到其他列，并且没有
             </font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">，
             </font><font style="vertical-align: inherit;">则优化为非常快速地返回
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COUNT(*) FROM student;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此优化仅适用于</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            表，因为为此存储引擎存储了精确的行数，并且可以非常快速地访问。
            </font></font><code class="literal">COUNT(1)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果第一列定义为，则仅受相同优化的影响</font></font><code class="literal">NOT
            NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_count-distinct"></a><p>
            <a class="indexterm" name="idm140091675834128"></a>

            <a class="indexterm" name="idm140091675833056"></a>

            <a class="link" href="functions.html#function_count"><code class="literal">COUNT(DISTINCT
            <em class="replaceable"><code>expr</code></em>,[<em class="replaceable"><code>expr</code></em>...])</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回具有不同非</font></font><code class="literal">NULL</code> <em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            值</font><font style="vertical-align: inherit;">的行数</font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，
            </font></font><a class="link" href="functions.html#function_count"><code class="literal">COUNT(DISTINCT)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT COUNT(DISTINCT results) FROM student;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在MySQL中，您可以</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过提供表达式列表</font><font style="vertical-align: inherit;">来获取不包含的不同表达式组合的数量</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在标准SQL中，您必须对内部的所有表达式进行连接
             </font></font><a class="link" href="functions.html#function_count"><code class="literal">COUNT(DISTINCT ...)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_group-concat"></a><p>
            <a class="indexterm" name="idm140091675815808"></a>

            <a class="link" href="functions.html#function_group-concat"><code class="literal">GROUP_CONCAT(<em class="replaceable"><code>expr</code></em>)</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            此函数返回字符串结果，其中</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含来自组</font><font style="vertical-align: inherit;">的连接非</font><font style="vertical-align: inherit;">值。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">，则返回
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">完整语法如下：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GROUP_CONCAT（[DISTINCT] </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[，</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             [ORDER BY { </font></font><em class="replaceable"><code>unsigned_integer</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font><em class="replaceable"><code>col_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                 [ASC | </font><font style="vertical-align: inherit;">DESC] [，</font></font><em class="replaceable"><code>col_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...]]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             [分隔器 </font></font><em class="replaceable"><code>str_val</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]）
</font></font></pre><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT student_name,</code></strong>
         <strong class="userinput"><code>GROUP_CONCAT(test_score)</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要么：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT student_name,</code></strong>
         <strong class="userinput"><code>GROUP_CONCAT(DISTINCT test_score</code></strong>
                      <strong class="userinput"><code>ORDER BY test_score DESC SEPARATOR ' ')</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在MySQL中，您可以获得表达式组合的连接值。</font><font style="vertical-align: inherit;">要消除重复值，请使用该
             </font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句。</font><font style="vertical-align: inherit;">要对结果中的值进行排序，请使用该</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句。</font><font style="vertical-align: inherit;">要按相反顺序排序，请将</font></font><code class="literal">DESC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            （descending）关键字</font><font style="vertical-align: inherit;">添加</font><font style="vertical-align: inherit;">到要在</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">中排序的列的名称中</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认为升序; </font><font style="vertical-align: inherit;">这可以使用</font></font><code class="literal">ASC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字</font><font style="vertical-align: inherit;">明确指定</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">组中值之间的默认分隔符是逗号（</font></font><code class="literal">,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">要明确指定分隔符，请使用</font></font><code class="literal">SEPARATOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后跟应在组值之间插入的字符串文字值。</font><font style="vertical-align: inherit;">要完全消除分隔符，请指定
             </font></font><code class="literal">SEPARATOR ''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            结果被截断为</font></font><a class="link" href="server-administration.html#sysvar_group_concat_max_len"><code class="literal">group_concat_max_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            系统变量</font><font style="vertical-align: inherit;">给出的最大长度</font><font style="vertical-align: inherit;">，其默认值为1024.尽管返回值的有效最大长度受值的约束，但该值可以设置得更高
             </font></font><a class="link" href="server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><a class="link" href="server-administration.html#sysvar_group_concat_max_len"><code class="literal">group_concat_max_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在运行时</font><font style="vertical-align: inherit;">更改值的语法
             </font><font style="vertical-align: inherit;">如下，其中</font></font><em class="replaceable"><code>val</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            是无符号整数：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET [GLOBAL | </font><font style="vertical-align: inherit;">SESSION] group_concat_max_len = </font></font><em class="replaceable"><code>val</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回值是非二进制或二进制字符串，具体取决于参数是非二进制还是二进制字符串。</font><font style="vertical-align: inherit;">结果类型是</font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者
             </font></font><a class="link" href="data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非
             </font></font><a class="link" href="server-administration.html#sysvar_group_concat_max_len"><code class="literal">group_concat_max_len</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小于或等于512，在这种情况下结果类型是
             </font></font><a class="link" href="data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            另见</font></font><a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="functions.html#function_concat-ws"><code class="literal">CONCAT_WS()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
             </font></font><a class="xref" href="functions.html#string-functions" title="12.5字符串函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.5节“字符串函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_json-arrayagg"></a><p>
            <a class="indexterm" name="idm140091675768976"></a>

            <a class="link" href="functions.html#function_json-arrayagg"><code class="literal">JSON_ARRAYAGG(<em class="replaceable"><code>col_or_expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            将结果集聚合为单个
             </font></font><a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数组，其元素由行组成。</font><font style="vertical-align: inherit;">此数组中元素的顺序未定义。</font><font style="vertical-align: inherit;">该函数作用于计算为单个值的列或表达式。</font><font style="vertical-align: inherit;">返回
            </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果结果不包含任何行，或在错误的事件。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 8.0.14开始，如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在</font><font style="vertical-align: inherit;">，该函数将作为窗口函数执行</font><font style="vertical-align: inherit;">。</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如</font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT o_id, attribute, value FROM t3;</code></strong><font></font>
+------+-----------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">o_id | </font><font style="vertical-align: inherit;">属性| </font><font style="vertical-align: inherit;">价值|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-----------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">颜色| </font><font style="vertical-align: inherit;">红色|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">面料| </font><font style="vertical-align: inherit;">丝绸|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">颜色| </font><font style="vertical-align: inherit;">绿色|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">形状| </font><font style="vertical-align: inherit;">广场|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-----------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4行（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT o_id, JSON_ARRAYAGG(attribute) AS attributes </code></strong>
       <strong class="userinput"><code>FROM t3 GROUP BY o_id;</code></strong><font></font>
+------+---------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">o_id | </font><font style="vertical-align: inherit;">属性|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">[“颜色”，“面料”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">[“颜色”，“形状”] |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre></li><li class="listitem"><a name="function_json-objectagg"></a><p>
            <a class="indexterm" name="idm140091675751360"></a>

            <a class="link" href="functions.html#function_json-objectagg"><code class="literal">JSON_OBJECTAGG(<em class="replaceable"><code>key</code></em>,
            <em class="replaceable"><code>value</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            将两个列名或表达式作为参数，第一个用作键，第二个用作值，并返回包含键值对的JSON对象。</font><font style="vertical-align: inherit;">返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果结果不包含任何行，或在错误的事件。</font><font style="vertical-align: inherit;">如果任何键名称</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或参数数量不等于2，</font><font style="vertical-align: inherit;">则会发生错误</font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 8.0.14开始，如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在</font><font style="vertical-align: inherit;">，该函数将作为窗口函数执行</font><font style="vertical-align: inherit;">。</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如</font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT o_id, attribute, value FROM t3;</code></strong><font></font>
+------+-----------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">o_id | </font><font style="vertical-align: inherit;">属性| </font><font style="vertical-align: inherit;">价值|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-----------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">颜色| </font><font style="vertical-align: inherit;">红色|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">面料| </font><font style="vertical-align: inherit;">丝绸|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">颜色| </font><font style="vertical-align: inherit;">绿色|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">形状| </font><font style="vertical-align: inherit;">广场|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-----------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4行（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT o_id, JSON_OBJECTAGG(attribute, value)</code></strong>
       <strong class="userinput"><code>FROM t3 GROUP BY o_id;</code></strong><font></font>
+------+---------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">o_id | </font><font style="vertical-align: inherit;">JSON_OBJECTAGG（属性，值）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">{“color”：“red”，“fabric”：“silk”}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">{“color”：“green”，“shape”：“square”} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重复密钥处理
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              当对该函数的结果进行归一化时，丢弃具有重复键的值。</font><font style="vertical-align: inherit;">为了与</font></font><a class="link" href="data-types.html#json" title="11.6 JSON数据类型"><code class="literal">JSON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不允许重复键</font><font style="vertical-align: inherit;">的MySQL </font><font style="vertical-align: inherit;">数据类型规范</font><font style="vertical-align: inherit;">保持一致</font><font style="vertical-align: inherit;">，只有遇到的最后一个值与返回对象中的该键一起使用（</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后重复键获胜</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">这意味着在a的列上使用此函数的结果</font></font><code class="literal">SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以取决于返回行的顺序，这是不能保证的。</font><font style="vertical-align: inherit;">当用作窗口函数时，如果帧中存在重复的键，则结果中仅存在该键的最后一个值。</font><font style="vertical-align: inherit;">如果</font><font style="vertical-align: inherit;">，则帧中最后一行的键值是确定的
              </font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规范保证值具有特定的顺序。</font><font style="vertical-align: inherit;">如果不是，则键的结果值是不确定的。</font><font style="vertical-align: inherit;">考虑以下：
</font></font></p>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t(c VARCHAR(10), i INT);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.03秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES</code></strong>
       <strong class="userinput"><code>('key', 3), ('key', 4), ('key', 5);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，3行受影响（0.01秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：3个重复：0个警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT c, i FROM t;</code></strong><font></font>
+------+------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c | </font><font style="vertical-align: inherit;">我|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">关键| </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">关键| </font><font style="vertical-align: inherit;">4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">关键| </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3组（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i) FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OBJECTAGG（c，i）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：5} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>DELETE FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，3行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES</code></strong>
       <strong class="userinput"><code>('key', 3), ('key', 5), ('key', 4);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，3行受影响（0.00秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：3个重复：0个警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT c, i FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c | </font><font style="vertical-align: inherit;">我|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">关键| </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">关键| </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">关键| </font><font style="vertical-align: inherit;">4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3组（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i) FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">JSON_OBJECTAGG（c，i）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：4} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从上一个查询中选择的密钥是不确定的。</font><font style="vertical-align: inherit;">如果您更喜欢特定的键排序，则可以</font></font><code class="literal">JSON_OBJECTAGG()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过包含</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带有</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规范</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句
             </font><font style="vertical-align: inherit;">来调用
             </font><font style="vertical-align: inherit;">作为窗口函数，</font><font style="vertical-align: inherit;">以在帧行上强加特定顺序。</font><font style="vertical-align: inherit;">以下示例显示了</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于一些不同的帧规范</font><font style="vertical-align: inherit;">会发生和不发生的情况</font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            没有</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，框架是整个分区：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER () AS json_object FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">json_object |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：4} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：4} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：4} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            with </font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中框架是默认值</font></font><code class="literal">RANGE BETWEEN UNBOUNDED PRECEDING AND
            CURRENT ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（按升序和降序排列）：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i) AS json_object FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">json_object |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：3} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：4} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：5} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i DESC) AS json_object FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">json_object |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：5} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：4} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：3} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和整个分区的显式框架：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i</code></strong>
            <strong class="userinput"><code>ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)</code></strong>
        <strong class="userinput"><code>AS json_object</code></strong>
       <strong class="userinput"><code>FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">json_object |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：5} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：5} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：5} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要返回特定键值（例如最小值或最大值），请</font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在相应的查询中</font><font style="vertical-align: inherit;">包含一个</font><font style="vertical-align: inherit;">子句。</font><font style="vertical-align: inherit;">例如：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i) AS json_object FROM t LIMIT 1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">json_object |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：3} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT JSON_OBJECTAGG(c, i)</code></strong>
       <strong class="userinput"><code>OVER (ORDER BY i DESC) AS json_object FROM t LIMIT 1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">json_object |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">{“key”：5} |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关</font><font style="vertical-align: inherit;">其他信息和示例</font></font><a class="xref" href="data-types.html#json-normalization" title="JSON值的规范化，合并和自动包装"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font><a class="xref" href="data-types.html#json-normalization" title="JSON值的规范化，合并和自动包装"><font style="vertical-align: inherit;">JSON值的规范化，合并和自动包装</font></a><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_max"></a><p>
            <a class="indexterm" name="idm140091675693184"></a>

            <a class="indexterm" name="idm140091675692112"></a>

            <a class="indexterm" name="idm140091675691040"></a>

            <a class="link" href="functions.html#function_max"><code class="literal">MAX([DISTINCT]
            <em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回的最大值
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以采用字符串参数; </font><font style="vertical-align: inherit;">在这种情况下，它返回最大字符串值。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 MySQL如何使用索引"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.3.1节“MySQL如何使用索引”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">的
             </font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字可用于以找到最大的不同值中的
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然而，这产生相同的结果作为遗漏</font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">它不能用于</font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT student_name, MIN(test_score), MAX(test_score)</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            因为</font></font><a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL当前</font><font style="vertical-align: inherit;">按字符串值</font><font style="vertical-align: inherit;">比较</font></font><a class="link" href="data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列，而不是字符串在集合中的相对位置。</font><font style="vertical-align: inherit;">这与</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            比较它们</font><font style="vertical-align: inherit;">有所不同</font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_min"></a><p>
            <a class="indexterm" name="idm140091675664080"></a>

            <a class="indexterm" name="idm140091675663008"></a>

            <a class="indexterm" name="idm140091675661936"></a>

            <a class="link" href="functions.html#function_min"><code class="literal">MIN([DISTINCT]
            <em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回的最小值
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以采用字符串参数; </font><font style="vertical-align: inherit;">在这种情况下，它返回最小字符串值。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 MySQL如何使用索引"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.3.1节“MySQL如何使用索引”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">的
             </font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字可用来找到最小的不同值中的
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然而，这产生相同的结果作为遗漏</font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">它不能用于</font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT student_name, MIN(test_score), MAX(test_score)</code></strong>
       <strong class="userinput"><code>FROM student</code></strong>
       <strong class="userinput"><code>GROUP BY student_name;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            因为</font></font><a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL当前</font><font style="vertical-align: inherit;">按字符串值</font><font style="vertical-align: inherit;">比较</font></font><a class="link" href="data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列，而不是字符串在集合中的相对位置。</font><font style="vertical-align: inherit;">这与</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            比较它们</font><font style="vertical-align: inherit;">有所不同</font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_std"></a><p>
            <a class="indexterm" name="idm140091675635040"></a>

            <a class="link" href="functions.html#function_std"><code class="literal">STD(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回人口标准差
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="functions.html#function_std"><code class="literal">STD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是标准SQL函数的同义词
             </font></font><a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，作为MySQL扩展提供。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_std"><code class="literal">STD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_stddev"></a><p>
            <a class="indexterm" name="idm140091675619136"></a>

            <a class="indexterm" name="idm140091675618064"></a>

            <a class="indexterm" name="idm140091675616992"></a>

            <a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回人口标准差
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与Oracle兼容</font><font style="vertical-align: inherit;">的标准SQL函数的同义词
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_stddev-pop"></a><p>
            <a class="indexterm" name="idm140091675601360"></a>

            <a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（平方根
             </font></font><a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">的总体标准差
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您也可以使用
             </font></font><a class="link" href="functions.html#function_std"><code class="literal">STD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><a class="link" href="functions.html#function_stddev"><code class="literal">STDDEV()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等效但不是标准SQL。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_stddev-pop"><code class="literal">STDDEV_POP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_stddev-samp"></a><p>
            <a class="indexterm" name="idm140091675584928"></a>

            <a class="link" href="functions.html#function_stddev-samp"><code class="literal">STDDEV_SAMP(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回样本标准差
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（的平方根）
             </font></font><a class="link" href="functions.html#function_var-samp"><code class="literal">VAR_SAMP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_stddev-samp"><code class="literal">STDDEV_SAMP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_sum"></a><p>
            <a class="indexterm" name="idm140091675570352"></a>

            <a class="indexterm" name="idm140091675569280"></a>

            <a class="indexterm" name="idm140091675568208"></a>

            <a class="link" href="functions.html#function_sum"><code class="literal">SUM([DISTINCT]
            <em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回的总和</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果返回集没有行，则</font></font><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">的
             </font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字可用来仅求和的不同的值</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">它不能用于</font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_var-pop"></a><p>
            <a class="indexterm" name="idm140091675551216"></a>

            <a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回人口标准方差
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它将行视为整个总体，而不是作为样本，因此它将行数作为分母。</font><font style="vertical-align: inherit;">您也可以使用
             </font></font><a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这是等效的但不是标准SQL。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_var-samp"></a><p>
            <a class="indexterm" name="idm140091675537200"></a>

            <a class="link" href="functions.html#function_var-samp"><code class="literal">VAR_SAMP(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回样本方差
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">也就是说，分母是行数减1。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_var-samp"><code class="literal">VAR_SAMP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_variance"></a><p>
            <a class="indexterm" name="idm140091675524480"></a>

            <a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE(<em class="replaceable"><code>expr</code></em>)
            [<em class="replaceable"><code>over_clause</code></em>]</code></a>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回人口标准方差
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是标准SQL函数的同义词
             </font></font><a class="link" href="functions.html#function_var-pop"><code class="literal">VAR_POP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，作为MySQL扩展提供。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果没有匹配的行，则
             </font></font><a class="link" href="functions.html#function_variance"><code class="literal">VARIANCE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在，</font><font style="vertical-align: inherit;">该函数作为窗口函数执行
             </font><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-by-modifiers"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.20.2 GROUP BY修饰符</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091675510144"></a><a class="indexterm" name="idm140091675509072"></a><a class="indexterm" name="idm140091675508000"></a><a class="indexterm" name="idm140091675506928"></a><a class="indexterm" name="idm140091675505440"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句允许使用一个</font></font><code class="literal">WITH
        ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修饰符，使得​​汇总输出包含表示更高级别（即超级聚合）汇总操作的额外行。</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        因此，您可以使用单个查询在多个分析级别回答问题。</font><font style="vertical-align: inherit;">例如，
         </font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于为OLAP（在线分析处理）操作提供支持。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        假设一个</font></font><code class="literal">sales</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表有
         </font></font><code class="literal">year</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><code class="literal">product</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和</font></font><code class="literal">profit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        列记录销售利润率：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE TABLE销售</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    年INT，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    country VARCHAR（20），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    产品VARCHAR（32），</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    利润INT</font></font><font></font>
);<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要总结每年的表格内容，请使用以下简单的内容
         </font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT year, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year;</code></strong><font></font>
+------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------+</font></font><font></font>
| 2000 |   4525 |<font></font>
| 2001 |   3010 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        输出显示每年的总（总）利润。</font><font style="vertical-align: inherit;">要确定所有年份的总利润总额，您必须自己添加单个值或运行其他查询。</font><font style="vertical-align: inherit;">或者您可以使用</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它通过单个查询提供两种级别的分析。</font><font style="vertical-align: inherit;">向</font><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">添加
         </font></font><code class="literal">WITH ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修饰符</font></font><code class="literal">GROUP
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会导致查询生成另一个（超级聚合）行，该行显示所有年份值的总计：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT year, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year WITH ROLLUP;</code></strong><font></font>
+------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------+</font></font><font></font>
| 2000 |   4525 |<font></font>
| 2001 |   3010 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">7535 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        列中</font><font style="vertical-align: inherit;">
        的</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font><code class="literal">year</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标识总计超级聚合行。
      </font></font></p><p>
        <code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当有多</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">时，会产生更复杂的效果</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，每次除最后一个分组列之外的任何值发生更改时，查询都会生成一个额外的超级聚合摘要行。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        例如，如果没有</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该摘要
         </font></font><code class="literal">sales</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基于表</font></font><code class="literal">year</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><code class="literal">country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及</font></font><code class="literal">product</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能是这样的，当输出只在一年/国家/产品的分析水平表明汇总值：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT year, country, product, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product;</code></strong><font></font>
+------+---------+------------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">产品| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+------------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">150 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">2700 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">250 |</font></font><font></font>
+------+---------+------------+--------+<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        随着</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">增加，查询会产生一些额外行：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT year, country, product, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+------------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">产品| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+------------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1600 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">150 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1350 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">4525 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">2700 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">250 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3010 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">7535 |</font></font><font></font>
+------+---------+------------+--------+<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        现在输出包括四个分析级别的摘要信息，而不仅仅是一个：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在给定年份和国家/地区的每组产品行之后，将显示额外的超级汇总摘要行，显示所有产品的总计。</font><font style="vertical-align: inherit;">这些行的
             </font></font><code class="literal">product</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列设置为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在给定年份的每组行之后，将显示一个额外的超级汇总摘要行，显示所有国家/地区和产品的总计。</font><font style="vertical-align: inherit;">这些行具有
             </font></font><code class="literal">country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font></font><code class="literal">products</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            列设置为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            最后，在所有其他行之后，将显示一个额外的超级汇总摘要行，显示所有年份，国家/地区和产品的总计。</font><font style="vertical-align: inherit;">此行的
             </font></font><code class="literal">year</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,, </font></font><code class="literal">country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><code class="literal">products</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列设置为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        将</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行发送到客户端时，将生成每个超级聚合行中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">指示符。</font><font style="vertical-align: inherit;">服务器查看</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        最左边的一个已更改值</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">指定的列</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于结果集中具有与任何名称匹配的名称的任何列，其值设置为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（如果按列位置指定分组列，则服务器会</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按位置</font><font style="vertical-align: inherit;">标识要设置的列</font><font style="vertical-align: inherit;">。）
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        由于</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">超级聚合行中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值在查询处理的后期阶段放入结果集中，因此</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只能在选择列表或</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">中将</font><font style="vertical-align: inherit;">它们作为</font><font style="vertical-align: inherit;">值
         </font><font style="vertical-align: inherit;">进行测试
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您无法</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在连接条件或</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">中将</font><font style="vertical-align: inherit;">它们作为</font><font style="vertical-align: inherit;">值进行
         </font><font style="vertical-align: inherit;">测试，
         </font><font style="vertical-align: inherit;">以确定要选择的行。</font><font style="vertical-align: inherit;">例如，您无法添加</font></font><code class="literal">WHERE product IS
        NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询以从输出中消除除超级聚合行之外的所有行。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值确实显示
         </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在客户端，可以使用任何MySQL客户端编程接口进行测试。</font><font style="vertical-align: inherit;">但是，此时，您无法区分a
         </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示常规分组值还是超级聚合值。</font><font style="vertical-align: inherit;">要测试区别，请使用</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">稍后描述</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">函数。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以前，MySQL不允许使用
         </font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在具有</font></font><code class="literal">WITH ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">的查询中使用</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在MySQL 8.0.12及更高版本中解除了此限制。</font><font style="vertical-align: inherit;">（Bug＃87450，Bug＃86311，Bug＃26640100，Bug＃26073513）
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于</font></font><code class="literal">GROUP BY ... WITH ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询，要测试</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果中的值</font><font style="vertical-align: inherit;">是否</font><font style="vertical-align: inherit;">表示超级聚合值，该
         </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数可用于选择列表，</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句和（从MySQL 8.0.12开始）</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句。</font><font style="vertical-align: inherit;">例如，</font><font style="vertical-align: inherit;">在</font><font style="vertical-align: inherit;">
        列中发生超级聚合行时</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING(year)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回1 </font><font style="vertical-align: inherit;">，否则</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">0。</font><font style="vertical-align: inherit;">同样，</font><font style="vertical-align: inherit;">并
         </font><font style="vertical-align: inherit;">
        分别</font><font style="vertical-align: inherit;">在</font><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">为超级聚合</font><font style="vertical-align: inherit;">值
         </font><font style="vertical-align: inherit;">返回1 </font><font style="vertical-align: inherit;">：
      </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><code class="literal">year</code><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING(country)</code></a><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING(product)</code></a><font style="vertical-align: inherit;"></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><code class="literal">country</code><font style="vertical-align: inherit;"></font><code class="literal">product</code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>year, country, product, SUM(profit) AS profit,</code></strong>
         <strong class="userinput"><code>GROUPING(year) AS grp_year,</code></strong>
         <strong class="userinput"><code>GROUPING(country) AS grp_country,</code></strong>
         <strong class="userinput"><code>GROUPING(product) AS grp_product</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP;</code></strong><font></font>
+------+---------+------------+--------+----------+-------------+-------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">产品| </font><font style="vertical-align: inherit;">利润| </font><font style="vertical-align: inherit;">grp_year | </font><font style="vertical-align: inherit;">grp_country | </font><font style="vertical-align: inherit;">grp_product |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+------------+--------+----------+-------------+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">100 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1600 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1350 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1575 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">4525 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">50 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">2700 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">250 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3000 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3010 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font>
+------+---------+------------+--------+----------+-------------+-------------+<font></font>
</pre><p><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以使用</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替换标签来获取超级聚合</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">
        而不是</font><font style="vertical-align: inherit;">直接</font><font style="vertical-align: inherit;">显示
         </font><font style="vertical-align: inherit;">结果</font><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>IF(GROUPING(year), 'All years', year) AS year,</code></strong>
         <strong class="userinput"><code>IF(GROUPING(country), 'All countries', country) AS country,</code></strong>
         <strong class="userinput"><code>IF(GROUPING(product), 'All products', product) AS product,</code></strong>
         <strong class="userinput"><code>SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP;</code></strong><font></font>
+-----------+---------------+--------------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">产品| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+---------------+--------------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">所有产品| </font><font style="vertical-align: inherit;">1600 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">150 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">所有产品| </font><font style="vertical-align: inherit;">1350 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">所有产品| </font><font style="vertical-align: inherit;">1575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">所有国家| </font><font style="vertical-align: inherit;">所有产品| </font><font style="vertical-align: inherit;">4525 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">所有产品| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">2700 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">250 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">所有产品| </font><font style="vertical-align: inherit;">3000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">所有国家| </font><font style="vertical-align: inherit;">所有产品| </font><font style="vertical-align: inherit;">3010 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">所有年份| </font><font style="vertical-align: inherit;">所有国家| </font><font style="vertical-align: inherit;">所有产品| </font><font style="vertical-align: inherit;">7535 |</font></font><font></font>
+-----------+---------------+--------------+--------+<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用多个表达式参数，
         </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回表示位掩码的结果，组合每个表达式的结果，最低位对应于最右侧表达式的结果。</font><font style="vertical-align: inherit;">例如，
         </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING(year, country, product)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        评估如下：
      </font></font></p><pre data-lang="clike" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  GROUPING的结果（</font></font><em class="replaceable"><code>product</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+结果为GROUPING（</font></font><em class="replaceable"><code>country</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）&lt;&lt; 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+结果为GROUPING（</font></font><em class="replaceable"><code>year</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）&lt;&lt; 2
</font></font></pre><p><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果任何表达式表示超级聚合</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">则</font><font style="vertical-align: inherit;">
        此类结果</font><font style="vertical-align: inherit;">为非零</font><font style="vertical-align: inherit;">，因此您只能返回超级聚合行并过滤掉常规分组行，如下所示：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT year, country, product, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP</code></strong>
       <strong class="userinput"><code>HAVING GROUPING(year, country, product) &lt;&gt; 0;</code></strong><font></font>
+------+---------+---------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">产品| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+---------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1600 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1350 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">4525 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3010 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">7535 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+---------+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><code class="literal">sales</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表不包含任何
         </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，因此</font><font style="vertical-align: inherit;">结果中的</font><font style="vertical-align: inherit;">所有</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        值</font><font style="vertical-align: inherit;">都</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示超级聚合值。</font><font style="vertical-align: inherit;">当数据集包含</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值时，</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        摘要</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不仅</font><font style="vertical-align: inherit;">可以包含</font><font style="vertical-align: inherit;">超聚合行</font><font style="vertical-align: inherit;">中的
         </font><font style="vertical-align: inherit;">值，</font><font style="vertical-align: inherit;">还可以包含</font><font style="vertical-align: inherit;">常规分组行中的值。
        </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使这些可以区分。</font><font style="vertical-align: inherit;">假设该表</font></font><code class="literal">t1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含一个简单的数据集，其中包含一组数量值的两个分组因子，其中</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示类似</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未知</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”的内容</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM t1;</code></strong><font></font>
+------+-------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">15 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3 |</font></font><font></font>
+------+-------+----------+<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        一个简单的</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作会产生这些结果，在这些结果中，将</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">超级聚合行中的
         </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值与常规分组行中的值</font><font style="vertical-align: inherit;">区分开来并不容易
         </font><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">35 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">15 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">58 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替代标签的超总量</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，使得结果更容易解释：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>IF(GROUPING(name) = 1, 'All items', name) AS name,</code></strong>
         <strong class="userinput"><code>IF(GROUPING(size) = 1, 'All sizes', size) AS size,</code></strong>
         <strong class="userinput"><code>SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong><font></font>
+-----------+-----------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+-----------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">所有尺寸| </font><font style="vertical-align: inherit;">35 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">15 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">所有尺寸| </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">所有项目| </font><font style="vertical-align: inherit;">所有尺寸| </font><font style="vertical-align: inherit;">58 |</font></font><font></font>
+-----------+-----------+----------+<font></font>
</pre>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="group-by-modifiers-other-considerations-when-using-rollup"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他注意事项使用ROLLUP时</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下讨论列出了一些特定于MySQL实现的行为</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 8.0.12之前，当您使用时</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，您也不能使用</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句对结果进行排序。</font><font style="vertical-align: inherit;">换句话说，</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          并且</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在MySQL中是互斥的。</font><font style="vertical-align: inherit;">但是，您仍然可以控制排序顺序。</font><font style="vertical-align: inherit;">若要解决阻止使用限制
           </font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，实现分组结果的具体排序顺序，生成分组结果集派生表，并应用</font></font><code class="literal">ORDER
          BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM</code></strong>
         <strong class="userinput"><code>(SELECT year, SUM(profit) AS profit</code></strong>
         <strong class="userinput"><code>FROM sales GROUP BY year WITH ROLLUP) AS dt</code></strong>
       <strong class="userinput"><code>ORDER BY year DESC;</code></strong><font></font>
+------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------+</font></font><font></font>
| 2001 |   3010 |<font></font>
| 2000 |   4525 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">7535 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从MySQL 8.0.12的，</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以一起使用，这使得能够使用</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现分组结果的具体排序顺序。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT year, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year WITH ROLLUP</code></strong>
       <strong class="userinput"><code>ORDER BY GROUPING(year) DESC;</code></strong><font></font>
+------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">7535 |</font></font><font></font>
| 2000 |   4525 |<font></font>
| 2001 |   3010 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在这两种情况下，超级聚合摘要行都按计算它们的行进行排序，它们的位置取决于排序顺序（在升序排序的末尾，在降序排序的开头）。
        </font></font></p><p>
          <code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于限制返回给客户端的行数。</font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在之后应用</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此该限制适用于添加的额外行</font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT year, country, product, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year, country, product WITH ROLLUP</code></strong>
       <strong class="userinput"><code>LIMIT 5;</code></strong><font></font>
+------+---------+------------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">产品| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+------------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">1600 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">150 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+------------+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用</font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with </font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可能会产生更难以解释的结果，因为用于理解超级聚合行的上下文较少。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL扩展允许</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表</font><font style="vertical-align: inherit;">中未出现的
           </font><font style="vertical-align: inherit;">列在选择列表中命名。</font><font style="vertical-align: inherit;">（有关非</font><a class="xref" href="functions.html#group-by-handling" title="12.20.3 GROUP BY的MySQL处理"><font style="vertical-align: inherit;">聚合</font></a><font style="vertical-align: inherit;">列的信息
           </font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请参见
           </font></font><a class="xref" href="functions.html#group-by-handling" title="12.20.3 GROUP BY的MySQL处理"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20.3节“GROUP BY的MySQL处理”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）在这种情况下，服务器可以自由选择摘要行中此非聚合列的任何值，这包括添加的额外行通过
           </font></font><code class="literal">WITH ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，在以下查询中，</font></font><code class="literal">country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个未出现在</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表中的非</font><font style="vertical-align: inherit;">聚合列，并且</font><font style="vertical-align: inherit;">为此列选择的值是不确定的：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT year, country, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year WITH ROLLUP;</code></strong><font></font>
+------+---------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">4525 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">3010 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">7535 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未启用SQL模式</font><font style="vertical-align: inherit;">
          时，允许此行为
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果启用了该模式，则服务器会将查询拒绝为非法，因为</font></font><code class="literal">country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">未列出</font><font style="vertical-align: inherit;">该查询</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">与
           </font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用，您仍然可以通过执行查询
           </font></font><code class="literal">ANY_VALUE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非确定性值列功能：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT year, ANY_VALUE(country) AS country, SUM(profit) AS profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY year WITH ROLLUP;</code></strong><font></font>
+------+---------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">4525 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">3010 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">7535 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+--------+</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-by-handling"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.20.3 GROUP BY的MySQL处理</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091675323344"></a><a class="indexterm" name="idm140091675322304"></a><a class="indexterm" name="idm140091675320800"></a><a class="indexterm" name="idm140091675319312"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        SQL-92和更早版本不允许选择列表，</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件或</font></font><code class="literal">ORDER
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表引用未在</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">命名的非聚合列的查询</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，此查询在标准SQL-92中是非法的，因为</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择列表中的非</font><font style="vertical-align: inherit;">聚合</font><font style="vertical-align: inherit;">列不会出现在</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT o.custid，c.name，MAX（o.payment）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  来自订单AS o，客户AS c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  在哪里o.custid = c.custid</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  GROUP BY o.custid;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要使查询在SQL-92中合法，</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        必须从选择列表中省略该列，或在该</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">对该</font><font style="vertical-align: inherit;">列进行命名
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        SQL：1999及更高版本允许每个可选功能T301的非聚合，如果它们在功能上依赖于
         </font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列：如果</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font><font style="vertical-align: inherit;">之间存在这样的关系</font></font><code class="literal">custid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则查询是合法的。</font><font style="vertical-align: inherit;">例如，这是</font></font><code class="literal">custid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个主要的关键</font></font><code class="literal">customers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL实现了对功能依赖的检测。</font><font style="vertical-align: inherit;">如果</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用</font><font style="vertical-align: inherit;">了
         </font><font style="vertical-align: inherit;">SQL模式（默认情况下是这样），则MySQL拒绝查询，其中选择列表，</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件或
         </font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表引用非聚合列，这些列既不在</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">命名</font><font style="vertical-align: inherit;">也不在功能上依赖于它们。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用，则标准SQL使用的MySQL扩展
         </font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许选择列表，
         </font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件或</font></font><code class="literal">ORDER
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表引用非聚合列，即使列在功能上不依赖于</font></font><code class="literal">GROUP
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列。</font><font style="vertical-align: inherit;">这导致MySQL接受前面的查询。</font><font style="vertical-align: inherit;">在这种情况下，服务器可以自由选择每个组中的任何值，因此除非它们相同，否则所选的值是不确定的，这可能不是您想要的。</font><font style="vertical-align: inherit;">此外，添加一个</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款</font><font style="vertical-align: inherit;">不会影响每个组的值的选择</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">结果集排序在选择值后发生，并且
        </font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会影响服务器选择的每个组中的哪个值。</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您知道由于数据的某些属性时，每个未分配的每个非聚合列中的所有值</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于每个组都是相同的</font><font style="vertical-align: inherit;">，因此</font><font style="vertical-align: inherit;">禁用
         </font><font style="vertical-align: inherit;">非常有用
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您可以</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过使用
         </font></font><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引用非聚合列</font><font style="vertical-align: inherit;">来实现相同的效果而不禁用
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下讨论演示了函数依赖性，MySQL在缺少函数依赖时产生的错误消息，以及在没有函数依赖性的情况下使MySQL接受查询的方法。
      </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用</font><font style="vertical-align: inherit;">
        此查询可能无效，
         </font><font style="vertical-align: inherit;">因为</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择列表中的非</font><font style="vertical-align: inherit;">聚合</font><font style="vertical-align: inherit;">列未在其中命名</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        子句中</font><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT名称，地址，MAX（年龄）FROM t GROUP BY名称;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果查询是</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主键</font></font><code class="literal">t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或是唯一</font></font><code class="literal">NOT
        NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列，</font><font style="vertical-align: inherit;">则查询有效</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，MySQL会识别所选列在功能上依赖于分组列。</font><font style="vertical-align: inherit;">例如，如果</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是主键，则其值确定值，</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为每个组只有一个主键值，因此只有一行。</font><font style="vertical-align: inherit;">因此，</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组</font><font style="vertical-align: inherit;">中</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的选择没有随机性
         </font><font style="vertical-align: inherit;">，也不需要拒绝查询。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果查询</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是主键</font></font><code class="literal">t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或唯一</font></font><code class="literal">NOT
        NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列，</font><font style="vertical-align: inherit;">则查询无效</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，不能推断出功能依赖性并发生错误：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT name, address, MAX(age) FROM t GROUP BY name;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1055（42000）：SELECT列表的表达式＃2不在GROUP中</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BY子句并包含非聚合列'mydb.t.address'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在功能上不依赖于GROUP BY子句中的列; </font><font style="vertical-align: inherit;">这个</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与sql_mode = only_full_group_by不兼容</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果您知道，</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于给定的数据集，</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        每个</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值实际上唯一地确定该</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在功能上是有效依赖的
         </font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要告诉MySQL接受查询，可以使用以下</font></font><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT名称，ANY_VALUE（地址），MAX（年龄）FROM t GROUP BY名称;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        或者，禁用
         </font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        然而，前面的例子非常简单。</font><font style="vertical-align: inherit;">特别是，您不太可能在单个主键列上进行分组，因为每个组只包含一行。</font><font style="vertical-align: inherit;">有关在更复杂查询中显示函数依赖性的</font></font><a class="xref" href="functions.html#group-by-functional-dependence" title="12.20.4功能依赖性的检测"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附加</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例，请参见</font><a class="xref" href="functions.html#group-by-functional-dependence" title="12.20.4功能依赖性的检测"><font style="vertical-align: inherit;">第12.20.4节“函数依赖性检测”</font></a><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果查询具有聚合函数且没有</font></font><code class="literal">GROUP
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句，则在</font><font style="vertical-align: inherit;">启用</font><font style="vertical-align: inherit;">的选择列表，</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件或
         </font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表中
         </font><font style="vertical-align: inherit;">不能包含</font><font style="vertical-align: inherit;">非聚合</font><font style="vertical-align: inherit;">列</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT name, MAX(age) FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1140（42000）：在没有GROUP BY，表达式的聚合查询中</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT列表的＃1包含非聚合列'mydb.t.name'; </font><font style="vertical-align: inherit;">这个</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与sql_mode = only_full_group_by不兼容</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        没有</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，只有一个组，它是不确定的，</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为组选择值。</font></font><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL选择的值</font><font style="vertical-align: inherit;">不重要</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">也可以使用</font><font style="vertical-align: inherit;">这里
         </font><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT ANY_VALUE（name），MAX（age）FROM t;
</font></font></pre><p>
        <code class="literal">ONLY_FULL_GROUP_BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也会影响使用</font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">查询的处理</font></font><code class="literal">ORDER
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">考虑表的情况下，</font></font><code class="literal">t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有三列</font></font><code class="literal">c1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">c2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及</font></font><code class="literal">c3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含这些行：
      </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c1 c2 c3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 2 A.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3 4 B.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 2 C.</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        假设我们执行以下查询，期望按以下顺序排序结果</font></font><code class="literal">c3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT DISTINCT c1，c2 FROM t ORDER BY c3;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要订购结果，必须首先删除重复项。</font><font style="vertical-align: inherit;">但要这样做，我们应该保留第一行还是第三行？</font><font style="vertical-align: inherit;">这种任意选择会影响保留值</font></font><code class="literal">c3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，从而影响排序并使其任意。</font><font style="vertical-align: inherit;">要防止出现此问题，</font><font style="vertical-align: inherit;">如果任何</font><font style="vertical-align: inherit;">
        表达式不满足以下条件中的至少一个条件</font><font style="vertical-align: inherit;">，则该查询具有
         </font></font><code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被拒绝为无效</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            表达式在选择列表中等于1
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            表达式引用并属于查询所选表的所有列都是选择列表的元素
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        标准SQL的另一个MySQL扩展允许</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中的</font><font style="vertical-align: inherit;">引用</font><font style="vertical-align: inherit;">到选择列表中的别名表达式。</font><font style="vertical-align: inherit;">例如，以下查询返回
         </font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在表中只出现一次的值
         </font></font><code class="literal">orders</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT名称，COUNT（名称）FROM订单</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  GROUP BY名称</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  有COUNT（名字）= 1;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL扩展允许</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在聚合列</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">使用别名
         </font><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT name，COUNT（name）AS c FROM orders</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  GROUP BY名称</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  有c = 1;</font></font><font></font>
</pre><a class="indexterm" name="idm140091675235488"></a><a class="indexterm" name="idm140091675234000"></a><a class="indexterm" name="idm140091675232512"></a><a class="indexterm" name="idm140091675231440"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        标准SQL只允许</font></font><code class="literal">GROUP
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中的</font><font style="vertical-align: inherit;">列表达式</font><font style="vertical-align: inherit;">，因此这样的语句无效，因为它</font></font><code class="literal">FLOOR(value/100)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个非列表达式：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT id，FLOOR（value / 100）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  从 </font></font><em class="replaceable"><code>tbl_name</code></em><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  GROUP BY id，FLOOR（value / 100）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL扩展标准SQL以允许非列表达式
        </font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中的非</font><font style="vertical-align: inherit;">并认为前面的语句有效。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        标准SQL也不允许</font></font><code class="literal">GROUP
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中的</font><font style="vertical-align: inherit;">别名</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">MySQL扩展标准SQL以允许别名，因此编写查询的另一种方法如下：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT id，FLOOR（value / 100）AS val</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  从 </font></font><em class="replaceable"><code>tbl_name</code></em><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  GROUP BY id，val;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        别名</font></font><code class="literal">val</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">被视为列表达式</font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在</font></font><code class="literal">GROUP
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">存在非列表达式的情况下</font><font style="vertical-align: inherit;">，MySQL会识别该表达式与选择列表中的表达式之间的相等性。</font><font style="vertical-align: inherit;">这意味着在</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用S​​QL模式的情况下，包含的查询</font></font><code class="literal">GROUP BY id,
        FLOOR(value/100)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是有效的，因为</font></font><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在选择列表中会出现</font><font style="vertical-align: inherit;">相同的
         </font><font style="vertical-align: inherit;">表达式。</font><font style="vertical-align: inherit;">但是，MySQL不会尝试识别对非</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表达式的</font><font style="vertical-align: inherit;">函数依赖性</font><font style="vertical-align: inherit;">，因此以下查询在</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用时</font><font style="vertical-align: inherit;">无效
         </font><font style="vertical-align: inherit;">，即使第三个选定表达式是</font></font><code class="literal">id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的简单公式</font><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">的
         </font></font><a class="link" href="functions.html#function_floor"><code class="literal">FLOOR()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式
         </font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT id，FLOOR（value / 100），id + FLOOR（value / 100）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  从 </font></font><em class="replaceable"><code>tbl_name</code></em><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  GROUP BY id，FLOOR（value / 100）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        解决方法是使用派生表：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT id，F，id + F.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  从</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    （SELECT id，FLOOR（value / 100）AS F.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     从 </font></font><em class="replaceable"><code>tbl_name</code></em><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
     GROUP BY id，FLOOR（value / 100））AS dt;</font></font><font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-by-functional-dependence"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.20.4功能依赖性的检测</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091675206656"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下讨论提供了MySQL检测功能依赖性的方式的几个示例。</font><font style="vertical-align: inherit;">示例使用此表示法：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ </font></font><em class="replaceable"><code>X</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}  - &gt; { </font></font><em class="replaceable"><code>Y</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        理解这一点如</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><em class="replaceable"><code>X</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">唯一地确定</font></font><em class="replaceable"><code>Y</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这也意味着，</font></font><em class="replaceable"><code>Y</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在功能上依赖于</font></font><em class="replaceable"><code>X</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些示例使用</font></font><code class="literal">world</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库，可以从</font></font><a class="ulink" href="https://dev.mysql.com/doc/index-other.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://dev.mysql.com/doc/index-other.html</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可以在同一页面上找到有关如何安装数据库的详细信息。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-keys" title="从Keys派生的功能依赖"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从Keys派生的功能依赖</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-multiple-column-keys" title="源自多列密钥和来自等式的功能依赖性"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">源自多列密钥和来自等式的功能依赖性</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-special-cases" title="功能依赖特殊案例"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能依赖特殊案例</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-views" title="功能依赖和视图"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能依赖和视图</font></font></a></p></li><li class="listitem"><p><a class="xref" href="functions.html#functional-dependence-combinations" title="功能依赖的组合"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能依赖的组合</font></font></a></p></li></ul>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="functional-dependence-keys"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从Keys派生的功能依赖</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下查询为每个国家/地区选择口语数量：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT co.Name，COUNT（*）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来自countrylanguage cl，country co</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在哪里cl.CountryCode = co.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GROUP BY co.Code;</font></font><font></font>
</pre><p>
          <code class="literal">co.Code</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">co</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有列的</font><font style="vertical-align: inherit;">主键
          </font></font><code class="literal">co</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          都在功能上依赖于它，如使用此表示法表示的：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{co.Code}  - &gt; {co。*}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          因此，</font></font><code class="literal">co.name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在功能上依赖于
           </font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列并且查询是有效的。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用列上</font><font style="vertical-align: inherit;">
          的</font></font><code class="literal">UNIQUE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引</font></font><code class="literal">NOT
          NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是主键，并且将应用相同的功能依赖性。</font><font style="vertical-align: inherit;">（对于</font></font><code class="literal">UNIQUE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">索引，情况
           </font><font style="vertical-align: inherit;">并非如此，</font><font style="vertical-align: inherit;">因为它允许多个
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，在这种情况下，唯一性会丢失。）
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="functional-dependence-multiple-column-keys"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">源自多列密钥和来自等式的功能依赖性</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此查询为每个国家/地区选择所有口语的列表以及有多少人说话：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT co.Name，cl.Language，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cl.Percentage * co.Population / 100.0 AS SpokenBy</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来自countrylanguage cl，country co</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在哪里cl.CountryCode = co.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GROUP BY cl.CountryCode，cl.Language;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对（</font></font><code class="literal">cl.CountryCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">cl.Language</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）是两列复合主键</font></font><code class="literal">cl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此列对唯一地确定所有列</font></font><code class="literal">cl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{cl.CountryCode，cl.Language}  - &gt; {cl。*}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          而且，由于</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款</font><font style="vertical-align: inherit;">中的平等
           </font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{cl.CountryCode}  - &gt; {co.Code}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          并且，因为</font></font><code class="literal">co.Code</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是主要关键
           </font></font><code class="literal">co</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{co.Code}  - &gt; {co。*}
</font></font></pre><p>
          <span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独特决定</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关系是可传递的，因此：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{cl.CountryCode，cl.Language}  - &gt; {cl。*，co。*}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          因此，查询有效。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与前面的示例一样，</font><font style="vertical-align: inherit;">可以使用列上</font><font style="vertical-align: inherit;">的</font></font><code class="literal">UNIQUE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">键</font></font><code class="literal">NOT NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是主键。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的</font></font><code class="literal">INNER JOIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件可以被用来代替</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">相同的功能依赖性适用：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT co.Name，cl.Language，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cl.Percentage * co.Population / 100.0 AS SpokenBy</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来自countrylanguage cl INNER JOIN country co</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ON cl.CountryCode = co.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GROUP BY cl.CountryCode，cl.Language;</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="functional-dependence-special-cases"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能依赖特殊案例</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          虽然</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          条件或</font></font><code class="literal">INNER JOIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件中的相等性测试是对称的，但外部连接条件中的相等性测试不是，因为表扮演不同的角色。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          假设参照完整性被意外破坏，并且存在一行</font></font><code class="literal">countrylanguage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有相应的行</font></font><code class="literal">country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">考虑与前一个示例中相同的查询，但使用
           </font></font><code class="literal">LEFT JOIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT co.Name，cl.Language，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cl.Percentage * co.Population / 100.0 AS SpokenBy</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来自countrylanguage cl LEFT JOIN country co</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ON cl.CountryCode = co.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GROUP BY cl.CountryCode，cl.Language;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于给定值</font></font><code class="literal">cl.CountryCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">co.Code</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接结果中的值可以在匹配的行中找到（由...确定
           </font></font><code class="literal">cl.CountryCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），或者</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有匹配</font><font style="vertical-align: inherit;">则也是
           </font><font style="vertical-align: inherit;">- 如果没有匹配（也由...确定</font></font><code class="literal">cl.CountryCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">在每种情况下，这种关系适用：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{cl.CountryCode}  - &gt; {co.Code}
</font></font></pre><p>
          <code class="literal">cl.CountryCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它本身在功能上依赖于{ </font></font><code class="literal">cl.CountryCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">cl.Language</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}这是一个主键。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果在连接结果中</font></font><code class="literal">co.Code</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-complemented，
           </font></font><code class="literal">co.Name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">那么也是如此。</font><font style="vertical-align: inherit;">如果
           </font></font><code class="literal">co.Code</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-complemented，那么因为它
           </font></font><code class="literal">co.Code</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个主键，它确定
           </font></font><code class="literal">co.Name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因此，在所有情况下：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{co.Code}  - &gt; {co.Name}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          产量：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{cl.CountryCode，cl.Language}  - &gt; {cl。*，co。*}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          因此，查询有效。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          但是，假设表已交换，如此查询中所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT co.Name，cl.Language，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cl.Percentage * co.Population / 100.0 AS SpokenBy</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来自country co LEFT JOIN countrylanguage cl</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ON cl.CountryCode = co.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GROUP BY cl.CountryCode，cl.Language;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          现在，这种关系并</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适用：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{cl.CountryCode，cl.Language}  - &gt; {cl。*，co。*}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          实际上，所有已</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成的
           </font></font><code class="literal">cl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行将被放入一个组（它们的</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列都等于
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），并且在这个组中，值
           </font></font><code class="literal">co.Name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以变化。</font><font style="vertical-align: inherit;">查询无效，MySQL拒绝它。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          因此，外连接中的功能依赖性与行列式列是属于左侧还是右侧有关
           </font></font><code class="literal">LEFT JOIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果存在嵌套外连接或连接条件不完全由相等比较组成，则函数依赖性的确定变得更加复杂。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="functional-dependence-views"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能依赖和视图</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          假设一个国家的观点产生他们的代码，他们的名字是大写的，他们有多少种不同的官方语言：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建视图Country2 AS</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT co.Code，UPPER（co.Name）AS UpperName，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COUNT（cl.Language）AS OfficialLanguages</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来自国家AS co JOIN countrylanguage AS cl</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ON cl.CountryCode = co.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在哪里cl.isOfficial ='T'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GROUP BY co.Code;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此定义有效，因为：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{co.Code}  - &gt; {co。*}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在视图结果中，第一个选定的列是
           </font></font><code class="literal">co.Code</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，也是组列，因此确定所有其他选定的表达式：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{Country2.Code}  - &gt; {Country2。*}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL理解这一点并使用这些信息，如下所述。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此查询通过将视图加入</font></font><code class="literal">city</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格来</font><font style="vertical-align: inherit;">显示国家/地区，他们拥有多少种不同的官方语言以及他们拥有的城市数量</font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT co2.Code，co2.UpperName，co2.OfficialLanguages，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COUNT（*）AS城市</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来自country2 AS co2 JOIN city ci</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ON ci.CountryCode = co2.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GROUP BY co2.Code;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此查询有效，因为如前所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{co2.Code}  - &gt; {co2。*}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL能够在视图的结果中发现功能依赖，并使用它来验证使用该视图的查询。</font><font style="vertical-align: inherit;">如果
           </font></font><code class="literal">country2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是派生表（或公用表表达式），情况也是如此，如：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT co2.Code，co2.UpperName，co2.OfficialLanguages，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COUNT（*）AS城市</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SELECT co.Code，UPPER（co.Name）AS UpperName，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 COUNT（cl.Language）AS OfficialLanguages</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 来自国家AS co JOIN countrylanguage AS cl</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ON cl.CountryCode = co.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 在哪里cl.isOfficial ='T'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 GROUP BY co.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
）AS co2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JOIN city ci ON ci.CountryCode = co2.Code</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GROUP BY co2.Code;</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="functional-dependence-combinations"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能依赖的组合</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL能够结合所有前面类型的功能依赖（基于密钥，基于相等，基于视图）来验证更复杂的查询。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="window-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21窗口函数</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#window-function-descriptions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.1窗口功能描述</font></font></a></span></dt><dt><span class="section"><a href="functions.html#window-functions-usage"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.2窗口函数概念和语法</font></font></a></span></dt><dt><span class="section"><a href="functions.html#window-functions-frames"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.3窗口功能框架规范</font></font></a></span></dt><dt><span class="section"><a href="functions.html#window-functions-named-windows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.4命名为Windows</font></font></a></span></dt><dt><span class="section"><a href="functions.html#window-function-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.5窗口函数限制</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091675112080"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL支持窗口函数，对于查询中的每一行，它使用与该行相关的行执行计算。</font><font style="vertical-align: inherit;">以下部分讨论如何使用窗口函数，包括</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><code class="literal">WINDOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句的</font><font style="vertical-align: inherit;">描述</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">第一部分提供非聚合窗口函数的描述。</font><font style="vertical-align: inherit;">有关聚合窗口函数的描述，请参见
       </font></font><a class="xref" href="functions.html#group-by-functions" title="12.20.1聚合（GROUP BY）功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20.1节“聚合（GROUP BY）函数描述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关优化和窗口函数的信息，请参见
       </font></font><a class="xref" href="optimization.html#window-function-optimization" title="8.2.1.20窗口函数优化"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.2.1.20节“窗口函数优化”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="window-function-descriptions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.1窗口功能描述</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节介绍非聚合窗口函数，对于查询中的每一行，它使用与该行相关的行执行计算。</font><font style="vertical-align: inherit;">大多数聚合函数也可以用作窗口函数; </font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="functions.html#group-by-functions" title="12.20.1聚合（GROUP BY）功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20.1节“聚合（GROUP BY）功能描述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关窗口函数用法信息和示例，以及术语（如</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句，窗口，分区，框架和对等项）的定义，请参见
         </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="table">
<a name="idm140091675102576"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.27窗口函数</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists window functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_cume-dist"><code class="literal">CUME_DIST()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      累积分配值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      其分区内当前行的排名，没有间隙
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      窗口框架第一行的参数值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      行中滞后当前行的参数值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_last-value"><code class="literal">LAST_VALUE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      窗口框架最后一行的参数值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      分区中行前导行的参数值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      第N行窗口框架的参数值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ntile"><code class="literal">NTILE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      其分区中当前行的存储桶编号。
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_percent-rank"><code class="literal">PERCENT_RANK()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      百分比等级值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      其分区内当前行的排名，有差距
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      其分区中当前行的数量
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在以下函数描述中，
         </font></font><em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示</font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中</font></a></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">子句
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">某些窗口函数允许一个</font><font style="vertical-align: inherit;">子句，指定</font><font style="vertical-align: inherit;">在计算结果时</font><font style="vertical-align: inherit;">如何处理</font><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">该子句是可选的。</font><font style="vertical-align: inherit;">它是SQL标准的一部分，但MySQL实现仅允许
         </font><font style="vertical-align: inherit;">（这也是默认值）。</font><font style="vertical-align: inherit;">这意味着</font><font style="vertical-align: inherit;">在计算结果时会考虑值。</font><font style="vertical-align: inherit;">被解析，但产生错误。
</font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><em class="replaceable"><code>null_treatment</code></em><font style="vertical-align: inherit;"></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><code class="literal">RESPECT NULLS</code><font style="vertical-align: inherit;"></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><code class="literal">IGNORE NULLS</code><font style="vertical-align: inherit;"></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_cume-dist"></a><p>
            <a class="link" href="functions.html#function_cume-dist"><code class="literal">CUME_DIST()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091675049568"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回一组值中的值的累积分布; </font><font style="vertical-align: inherit;">也就是说，分区值的百分比小于或等于当前行中的值。</font><font style="vertical-align: inherit;">这表示窗口分区的窗口顺序中当前行之前或与之对应的行数除以窗口分区中的总行数。</font><font style="vertical-align: inherit;">返回值的范围是0到1。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            应该使用此函数将</font></font><code class="literal">ORDER
            BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区行排序为所需的顺序。</font><font style="vertical-align: inherit;">如果没有</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则所有行都是对等的并且值为
             </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= 1，其中</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是分区大小。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            以下查询针对
             </font></font><code class="literal">val</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中的</font></font><code class="literal">CUME_DIST()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值集显示每行</font><font style="vertical-align: inherit;">的
             </font><font style="vertical-align: inherit;">值，以及类似</font></font><code class="literal">PERCENT_RANK()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">返回的百分比等级值
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">作为参考，查询还使用</font></font><a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下方式</font><font style="vertical-align: inherit;">显示行号
             </font><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>val,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER()   OVER w AS 'row_number',</code></strong>
         <strong class="userinput"><code>CUME_DIST()    OVER w AS 'cume_dist',</code></strong>
         <strong class="userinput"><code>PERCENT_RANK() OVER w AS 'percent_rank'</code></strong>
       <strong class="userinput"><code>FROM numbers</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY val);</code></strong><font></font>
+------+------------+--------------------+--------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">val | </font><font style="vertical-align: inherit;">row_number | </font><font style="vertical-align: inherit;">cume_dist | </font><font style="vertical-align: inherit;">percent_rank |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------------+--------------------+--------------+</font></font><font></font>
|    1 |          1 | 0.2222222222222222 |            0 |<font></font>
|    1 |          2 | 0.2222222222222222 |            0 |<font></font>
|    2 |          3 | 0.3333333333333333 |         0.25 |<font></font>
|    3 |          4 | 0.6666666666666666 |        0.375 |<font></font>
|    3 |          5 | 0.6666666666666666 |        0.375 |<font></font>
|    3 |          6 | 0.6666666666666666 |        0.375 |<font></font>
|    4 |          7 | 0.8888888888888888 |         0.75 |<font></font>
|    4 |          8 | 0.8888888888888888 |         0.75 |<font></font>
|    5 |          9 |                  1 |            1 |<font></font>
+------+------------+--------------------+--------------+<font></font>
</pre></li><li class="listitem"><a name="function_dense-rank"></a><p>
            <a class="link" href="functions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091675025888"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回其分区中当前行的排名，没有间隙。</font><font style="vertical-align: inherit;">同行被视为关系，并获得相同的排名。</font><font style="vertical-align: inherit;">此功能将连续的等级分配给对等组; </font><font style="vertical-align: inherit;">结果是，大于1的组不会产生不连续的等级数。</font><font style="vertical-align: inherit;">有关示例，请参阅</font></font><a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能说明。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            应该使用此函数将</font></font><code class="literal">ORDER
            BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区行排序为所需的顺序。</font><font style="vertical-align: inherit;">没有</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，所有行都是对等的。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_first-value"></a><p>
            <a class="link" href="functions.html#function_first-value"><code class="literal">FIRST_VALUE(<em class="replaceable"><code>expr</code></em>)</code></a>
            [<em class="replaceable"><code>null_treatment</code></em>]
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091675013040"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">窗口框架第一行</font><font style="vertical-align: inherit;">的值</font><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>null_treatment</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如引言部分所述。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            下面的查询演示
             </font></font><a class="link" href="functions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="functions.html#function_last-value"><code class="literal">LAST_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及两个实例</font></font><a class="link" href="functions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>time, subject, val,</code></strong>
         <strong class="userinput"><code>FIRST_VALUE(val)  OVER w AS 'first',</code></strong>
         <strong class="userinput"><code>LAST_VALUE(val)   OVER w AS 'last',</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 2) OVER w AS 'second',</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 4) OVER w AS 'fourth'</code></strong>
       <strong class="userinput"><code>FROM observations</code></strong>
       <strong class="userinput"><code>WINDOW w AS (PARTITION BY subject ORDER BY time</code></strong>
                    <strong class="userinput"><code>ROWS UNBOUNDED PRECEDING);</code></strong><font></font>
+----------+---------+------+-------+------+--------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">时间| </font><font style="vertical-align: inherit;">主题| </font><font style="vertical-align: inherit;">val | </font><font style="vertical-align: inherit;">第一个| </font><font style="vertical-align: inherit;">最后| </font><font style="vertical-align: inherit;">第二个| </font><font style="vertical-align: inherit;">第四|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+---------+------+-------+------+--------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:00:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:15:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:30:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:45:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">20 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">20 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:00:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:15:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:30:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:45:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">30 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">30 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">30 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">08:00:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">30 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+---------+------+-------+------+--------+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            每个函数使用当前帧中的行，根据所示的窗口定义，这些行从第一个分区行延伸到当前行。</font><font style="vertical-align: inherit;">对于
             </font></font><a class="link" href="functions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用，当前帧并不总是包括所请求的行; </font><font style="vertical-align: inherit;">在这种情况下，返回值是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_lag"></a><p>
            <a class="link" href="functions.html#function_lag"><code class="literal">LAG(<em class="replaceable"><code>expr</code></em> [,
            <em class="replaceable"><code>N</code></em>[,
            <em class="replaceable"><code>default</code></em>]])</code></a>
            [<em class="replaceable"><code>null_treatment</code></em>]
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091674985216"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前行滞后（先于）</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其分区内的</font><font style="vertical-align: inherit;">行的
             </font><font style="vertical-align: inherit;">行的值。</font><font style="vertical-align: inherit;">如果没有这样的行，则返回值为
             </font></font><em class="replaceable"><code>default</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，如果
             </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为3，则返回值为
             </font></font><em class="replaceable"><code>default</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前两行。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><em class="replaceable"><code>default</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缺少，则默认值分别为1和1 </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是文字非负整数。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为0，
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则评估当前行。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>null_treatment</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如引言部分所述。
          </font></font></p><p>
            <a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（和类似的
             </font></font><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能）通常用于计算行之间的差异。</font><font style="vertical-align: inherit;">以下查询显示了一组按时间顺序排列的观察值，并且对于每个观察</font><font style="vertical-align: inherit;">值，显示了相邻行的值</font></font><a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，以及当前行和相邻行之间的差异：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>t, val,</code></strong>
         <strong class="userinput"><code>LAG(val)        OVER w AS 'lag',</code></strong>
         <strong class="userinput"><code>LEAD(val)       OVER w AS 'lead',</code></strong>
         <strong class="userinput"><code>val - LAG(val)  OVER w AS 'lag diff',</code></strong>
         <strong class="userinput"><code>val - LEAD(val) OVER w AS 'lead diff'</code></strong>
       <strong class="userinput"><code>FROM series</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY t);</code></strong><font></font>
+----------+------+------+------+----------+-----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">t | </font><font style="vertical-align: inherit;">val | </font><font style="vertical-align: inherit;">滞后| </font><font style="vertical-align: inherit;">铅| </font><font style="vertical-align: inherit;">滞后差异| </font><font style="vertical-align: inherit;">lead diff |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+------+------+------+----------+-----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">12:00:00 | </font><font style="vertical-align: inherit;">100 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">125 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">-25 |</font></font><font></font>
| 13:00:00 |  125 |  100 |  132 |       25 |        -7 |<font></font>
| 14:00:00 |  132 |  125 |  145 |        7 |       -13 |<font></font>
| 15:00:00 |  145 |  132 |  140 |       13 |         5 |<font></font>
| 16:00:00 |  140 |  145 |  150 |       -5 |       -10 |<font></font>
| 17:00:00 |  150 |  140 |  200 |       10 |       -50 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">18:00:00 | </font><font style="vertical-align: inherit;">200 | </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">50 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font>
+----------+------+------+------+----------+-----------+<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在示例中，</font></font><a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用分别使用默认值
             </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><em class="replaceable"><code>default</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值1和
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            第一行显示当没有前一行时发生的情况</font></font><a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：函数返回</font></font><em class="replaceable"><code>default</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值（在本例中为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">当没有下一行时，最后一行显示相同的内容
             </font></font><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
             </font></font><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还用于计算总和而不是差异。</font><font style="vertical-align: inherit;">考虑这个数据集，其中包含Fibonacci系列的前几个数字：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT n FROM fib ORDER BY n;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">n |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font>
|    1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|    1 |</font></font><font></font>
|    2 |<font></font>
|    3 |<font></font>
|    5 |<font></font>
|    8 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            以下查询显示</font></font><a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font></font><a class="link" href="functions.html#function_lead"><code class="literal">LEAD()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前行相邻的行</font><font style="vertical-align: inherit;">的
             </font><font style="vertical-align: inherit;">和
             </font><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">它还使用这些函数将前一行和后一行中的值添加到当前行值。</font><font style="vertical-align: inherit;">效果是在Fibonacci系列中生成下一个数字，然后是下一个数字：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>n,</code></strong>
         <strong class="userinput"><code>LAG(n, 1, 0)      OVER w AS 'lag',</code></strong>
         <strong class="userinput"><code>LEAD(n, 1, 0)     OVER w AS 'lead',</code></strong>
         <strong class="userinput"><code>n + LAG(n, 1, 0)  OVER w AS 'next_n',</code></strong>
         <strong class="userinput"><code>n + LEAD(n, 1, 0) OVER w AS 'next_next_n'</code></strong>
       <strong class="userinput"><code>FROM fib</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY n);</code></strong><font></font>
+------+------+------+--------+-------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">n | </font><font style="vertical-align: inherit;">滞后| </font><font style="vertical-align: inherit;">铅| </font><font style="vertical-align: inherit;">next_n | </font><font style="vertical-align: inherit;">next_next_n |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+------+--------+-------------+</font></font><font></font>
|    1 |    0 |    1 |      1 |           2 |<font></font>
|    1 |    1 |    2 |      2 |           3 |<font></font>
|    2 |    1 |    3 |      3 |           5 |<font></font>
|    3 |    2 |    5 |      5 |           8 |<font></font>
|    5 |    3 |    8 |      8 |          13 |<font></font>
|    8 |    5 |    0 |     13 |           8 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+------+--------+-------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            生成初始Fibonacci数集的一种方法是使用递归公用表表达式。</font><font style="vertical-align: inherit;">有关示例，请参阅
             </font></font><a class="xref" href="sql-syntax.html#common-table-expressions-recursive-fibonacci-series" title="斐波纳契系列生成"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fibonacci Series Generation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><a name="function_last-value"></a><p>
            <a class="link" href="functions.html#function_last-value"><code class="literal">LAST_VALUE(<em class="replaceable"><code>expr</code></em>)</code></a>
            [<em class="replaceable"><code>null_treatment</code></em>]
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091674930592"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">窗口框架最后一行</font><font style="vertical-align: inherit;">的值</font><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>null_treatment</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如引言部分所述。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关示例，请参阅
             </font></font><a class="link" href="functions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能说明。
          </font></font></p></li><li class="listitem"><a name="function_lead"></a><p>
            <a class="link" href="functions.html#function_lead"><code class="literal">LEAD(<em class="replaceable"><code>expr</code></em> [,
            <em class="replaceable"><code>N</code></em>[,
            <em class="replaceable"><code>default</code></em>]])</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            [</font></font><em class="replaceable"><code>null_treatment</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]
            </font></font><em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091674917728"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font><font style="vertical-align: inherit;">从其分区中</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的行引导（跟随）当前行的
             </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行的值。</font><font style="vertical-align: inherit;">如果没有这样的行，则返回值为
             </font></font><em class="replaceable"><code>default</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，如果
             </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为3，则返回值为
             </font></font><em class="replaceable"><code>default</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后两行。</font><font style="vertical-align: inherit;">如果
             </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><em class="replaceable"><code>default</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缺少，则默认值分别为1和1 </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是文字非负整数。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为0，
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则评估当前行。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>null_treatment</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如引言部分所述。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关示例，请参阅</font></font><a class="link" href="functions.html#function_lag"><code class="literal">LAG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            功能说明。
          </font></font></p></li><li class="listitem"><a name="function_nth-value"></a><p>
            <a class="link" href="functions.html#function_nth-value"><code class="literal">NTH_VALUE(<em class="replaceable"><code>expr</code></em>,
            <em class="replaceable"><code>N</code></em>)</code></a>
            [<em class="replaceable"><code>from_first_last</code></em>]
            [<em class="replaceable"><code>null_treatment</code></em>]
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091674899632"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回</font><font style="vertical-align: inherit;">窗口框架</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第-th行</font><font style="vertical-align: inherit;">的值</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果没有这样的行，则返回值为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p>
            <em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 必须是字面正整数。
          </font></font></p><p>
            <em class="replaceable"><code>from_first_last</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是SQL标准的一部分，但MySQL实现仅允许
             </font></font><code class="literal">FROM FIRST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（这也是默认值）。</font><font style="vertical-align: inherit;">这意味着计算从窗口的第一行开始。</font></font><code class="literal">FROM LAST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被解析，但产生错误。</font><font style="vertical-align: inherit;">要获得与</font></font><code class="literal">FROM
            LAST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（在窗口的最后一行开始计算）</font><font style="vertical-align: inherit;">相同的效果</font><font style="vertical-align: inherit;">，请使用</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相反的顺序排序。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font><em class="replaceable"><code>null_treatment</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如引言部分所述。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关示例，请参阅
             </font></font><a class="link" href="functions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能说明。
          </font></font></p></li><li class="listitem"><a name="function_ntile"></a><p>
            <a class="link" href="functions.html#function_ntile"><code class="literal">NTILE(<em class="replaceable"><code>N</code></em>)</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091674882080"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            将分区划分为</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组（存储桶），为分区中的每一行分配其存储桶编号，并返回其分区中当前行的存储区编号。</font><font style="vertical-align: inherit;">例如，如果
             </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为4，
             </font></font><code class="literal">NTILE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则将行分为四个桶。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为100，
             </font></font><code class="literal">NTILE()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则将行划分为100个桶。
          </font></font></p><p>
            <em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是字面正整数。</font><font style="vertical-align: inherit;">存储桶编号返回值的范围为1到
             </font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            应该使用此函数将</font></font><code class="literal">ORDER
            BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区行排序为所需的顺序。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            以下查询针对</font></font><code class="literal">val</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">的值集显示
             </font><font style="vertical-align: inherit;">通过将行划分为两个或四个组而产生的百分位数值。</font><font style="vertical-align: inherit;">作为参考，查询还使用</font></font><a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下方式</font><font style="vertical-align: inherit;">显示行号
             </font><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>val,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER w AS 'row_number',</code></strong>
         <strong class="userinput"><code>NTILE(2)     OVER w AS 'ntile2',</code></strong>
         <strong class="userinput"><code>NTILE(4)     OVER w AS 'ntile4'</code></strong>
       <strong class="userinput"><code>FROM numbers</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY val);</code></strong><font></font>
+------+------------+--------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">val | </font><font style="vertical-align: inherit;">row_number | </font><font style="vertical-align: inherit;">ntile2 | </font><font style="vertical-align: inherit;">ntile4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------------+--------+--------+</font></font><font></font>
|    1 |          1 |      1 |      1 |<font></font>
|    1 |          2 |      1 |      1 |<font></font>
|    2 |          3 |      1 |      1 |<font></font>
|    3 |          4 |      1 |      2 |<font></font>
|    3 |          5 |      1 |      2 |<font></font>
|    3 |          6 |      2 |      3 |<font></font>
|    4 |          7 |      2 |      3 |<font></font>
|    4 |          8 |      2 |      4 |<font></font>
|    5 |          9 |      2 |      4 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------------+--------+--------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_percent-rank"></a><p>
            <a class="link" href="functions.html#function_percent-rank"><code class="literal">PERCENT_RANK()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091674858304"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回小于当前行中值的分区值的百分比，不包括最高值。</font><font style="vertical-align: inherit;">返回值的范围从0到1，表示行的相对等级，计算为此公式的结果，其中</font></font><em class="replaceable"><code>rank</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是行等级，
             </font></font><em class="replaceable"><code>rows</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是分区行的数量：
          </font></font></p><pre data-lang="clike" class="programlisting">(<em class="replaceable"><code>rank</code></em> - 1) / (<em class="replaceable"><code>rows</code></em> - 1)
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            应该使用此函数将</font></font><code class="literal">ORDER
            BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区行排序为所需的顺序。</font><font style="vertical-align: inherit;">没有</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，所有行都是对等的。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关示例，请参阅
             </font></font><a class="link" href="functions.html#function_cume-dist"><code class="literal">CUME_DIST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能说明。
          </font></font></p></li><li class="listitem"><a name="function_rank"></a><p>
            <a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091674843200"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回其分区中当前行的排名，带有间隙。</font><font style="vertical-align: inherit;">同行被视为关系，并获得相同的排名。</font><font style="vertical-align: inherit;">如果存在大于1的组，则此函数不会将连续的等级分配给对等组; </font><font style="vertical-align: inherit;">结果是不连续的排名数字。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            应该使用此函数将</font></font><code class="literal">ORDER
            BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区行排序为所需的顺序。</font><font style="vertical-align: inherit;">没有</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，所有行都是对等的。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            以下查询显示了它们之间的差异
             </font></font><a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它产生了具有间隙的排名，并且</font></font><a class="link" href="functions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">产生了没有间隙的排名。</font><font style="vertical-align: inherit;">该查询显示</font></font><code class="literal">val</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">中一组值的每个成员的等级值
             </font><font style="vertical-align: inherit;">，其中包含一些重复项。</font></font><a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为对等体（重复）分配相同的等级值，并且下一个更大的值具有高于对等体的数量减去1的等级。</font></font><a class="link" href="functions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同时为对等体分配相同的等级值，但是下一个更高的值具有更高的等级1。</font><font style="vertical-align: inherit;">作为参考，查询还使用</font></font><a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下方式</font><font style="vertical-align: inherit;">显示行号
             </font><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>val,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER w AS 'row_number',</code></strong>
         <strong class="userinput"><code>RANK()       OVER w AS 'rank',</code></strong>
         <strong class="userinput"><code>DENSE_RANK() OVER w AS 'dense_rank'</code></strong>
       <strong class="userinput"><code>FROM numbers</code></strong>
       <strong class="userinput"><code>WINDOW w AS (ORDER BY val);</code></strong><font></font>
+------+------------+------+------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">val | </font><font style="vertical-align: inherit;">row_number | </font><font style="vertical-align: inherit;">排名| </font><font style="vertical-align: inherit;">dense_rank |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------------+------+------------+</font></font><font></font>
|    1 |          1 |    1 |          1 |<font></font>
|    1 |          2 |    1 |          1 |<font></font>
|    2 |          3 |    3 |          2 |<font></font>
|    3 |          4 |    4 |          3 |<font></font>
|    3 |          5 |    4 |          3 |<font></font>
|    3 |          6 |    4 |          3 |<font></font>
|    4 |          7 |    7 |          4 |<font></font>
|    4 |          8 |    7 |          4 |<font></font>
|    5 |          9 |    9 |          5 |<font></font>
+------+------------+------+------------+<font></font>
</pre></li><li class="listitem"><a name="function_row-number"></a><p>
            <a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a>
            <em class="replaceable"><code>over_clause</code></em>
          </p><a class="indexterm" name="idm140091674817328"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回其分区中当前行的编号。</font><font style="vertical-align: inherit;">行数从1到分区行数。
          </font></font></p><p>
            <code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">影响行的编号顺序。</font><font style="vertical-align: inherit;">没有</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，行编号是不确定的。
          </font></font></p><p>
            <a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为同伴分配不同的行号。</font><font style="vertical-align: inherit;">要为对等体分配相同的值，请使用
             </font></font><a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><a class="link" href="functions.html#function_dense-rank"><code class="literal">DENSE_RANK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关示例，请参阅</font></font><a class="link" href="functions.html#function_rank"><code class="literal">RANK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能说明。
          </font></font></p><p>
            <em class="replaceable"><code>over_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如
             </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="window-functions-usage"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.2窗口函数概念和语法</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091674804752"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节介绍如何使用窗口函数。</font><font style="vertical-align: inherit;">示例使用与</font><a class="xref" href="functions.html#group-by-modifiers" title="12.20.2 GROUP BY修饰符"><font style="vertical-align: inherit;">第12.20.2节“GROUP BY Modifiers”</font></a><font style="vertical-align: inherit;">中的</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数
         </font><font style="vertical-align: inherit;">讨论中相同的销售信息数据集</font><font style="vertical-align: inherit;">：
      </font></font><a class="xref" href="functions.html#group-by-modifiers" title="12.20.2 GROUP BY修饰符"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM sales ORDER BY country, year, product;</code></strong><font></font>
+------+---------+------------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">产品| </font><font style="vertical-align: inherit;">利润|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+------------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">100 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">50 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">150 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">100 |</font></font><font></font>
+------+---------+------------+--------+<font></font>
</pre><a class="indexterm" name="idm140091674798336"></a><a class="indexterm" name="idm140091674796848"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        窗口函数对一组查询行执行类似聚合的操作。</font><font style="vertical-align: inherit;">但是，聚合操作将查询行分组到单个结果行中，而窗口函数会为每个查询行生成结果：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            发生功能评估的行称为当前行。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            与发生功能评估的当前行相关的查询行包括当前行的窗口。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        例如，使用销售信息表，这两个查询执行聚合操作，为作为组的所有行生成单个全局总和，并按国家/地区分组的总和：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT SUM(profit) AS total_profit</code></strong>
       <strong class="userinput"><code>FROM sales;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">total_profit |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+</font></font><font></font>
|         7535 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT country, SUM(profit) AS country_profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>GROUP BY country</code></strong>
       <strong class="userinput"><code>ORDER BY country;</code></strong><font></font>
+---------+----------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">country_profit |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------+----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">1610 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">1350 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">4575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------+----------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        相比之下，窗口操作不会将查询行组折叠到单个输出行。</font><font style="vertical-align: inherit;">相反，它们为每一行产生一个结果。</font><font style="vertical-align: inherit;">与前面的查询一样，以下查询使用
        </font></font><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但这次作为窗口函数：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>year, country, product, profit,</code></strong>
         <strong class="userinput"><code>SUM(profit) OVER() AS total_profit,</code></strong>
         <strong class="userinput"><code>SUM(profit) OVER(PARTITION BY country) AS country_profit</code></strong>
       <strong class="userinput"><code>FROM sales</code></strong>
       <strong class="userinput"><code>ORDER BY country, year, product, profit;</code></strong><font></font>
+------+---------+------------+--------+--------------+----------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">产品| </font><font style="vertical-align: inherit;">利润| </font><font style="vertical-align: inherit;">total_profit | </font><font style="vertical-align: inherit;">country_profit |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+------------+--------+--------------+----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">1610 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">100 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">1610 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">1610 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">1350 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">1350 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">1350 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">4575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">4575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">50 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">4575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">4575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">4575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">100 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">4575 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">7535 | </font><font style="vertical-align: inherit;">4575 |</font></font><font></font>
+------+---------+------------+--------+--------------+----------------+<font></font>
</pre><a class="indexterm" name="idm140091674777984"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        查询中的每个窗口操作都通过包含一个</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句来</font><font style="vertical-align: inherit;">表示，该</font><font style="vertical-align: inherit;">子句指定如何将查询行分区为组以供窗口函数处理：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            第一个</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句为空，它将整个查询行集视为单个分区。</font><font style="vertical-align: inherit;">因此，窗函数产生全局和，但对每一行都这样做。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            第二个</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句按国家/地区划分行，每个分区（每个国家/地区）生成一个总和。</font><font style="vertical-align: inherit;">该函数为每个分区行生成此总和。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        仅在选择列表和</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">中允许窗口函数
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">查询结果行从确定</font></font><code class="literal">FROM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句后
         </font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及
         </font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理和开窗执行发生之前</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">SELECT
        DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句允许用于许多聚合函数，因此可以用作窗口函数或非窗口函数，具体取决于是否
        </font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">存在：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AVG（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BIT_AND（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BIT_OR（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BIT_XOR（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
计数（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JSON_ARRAYAGG（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JSON_OBJECTAGG（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAX（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MIN（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
STDDEV_POP（），STDDEV（），STD（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
STDDEV_SAMP（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
和（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VAR_POP（），VARIANCE（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VAR_SAMP（）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关每个聚合函数的详细信息，请参见
         </font></font><a class="xref" href="functions.html#group-by-functions" title="12.20.1聚合（GROUP BY）功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20.1节“聚合（GROUP BY）函数说明”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL还支持仅用作窗口函数的非聚合函数。</font><font style="vertical-align: inherit;">对于这些，该</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款是强制性的：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CUME_DIST（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DENSE_RANK（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FIRST_VALUE（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LAG（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LAST_VALUE（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
铅（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NTH_VALUE（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NTILE（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PERCENT_RANK（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
秩（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ROW_NUMBER（）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关每个非</font></font><a class="xref" href="functions.html#window-function-descriptions" title="12.21.1窗口功能描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚合</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数的详细信息，请参见
         </font><a class="xref" href="functions.html#window-function-descriptions" title="12.21.1窗口功能描述"><font style="vertical-align: inherit;">第12.21.1节“窗口函数说明”</font></a><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        作为其中一个非聚合窗口函数的示例，此查询使用</font></font><a class="link" href="functions.html#function_row-number"><code class="literal">ROW_NUMBER()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它生成其分区中每行的行号。</font><font style="vertical-align: inherit;">在这种情况下，行按每个国家/地区编号。</font><font style="vertical-align: inherit;">默认情况下，分区行是无序的，行编号是不确定的。</font><font style="vertical-align: inherit;">要对分区行进行排序，请</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在窗口定义中</font><font style="vertical-align: inherit;">包含一个
         </font><font style="vertical-align: inherit;">子句。</font><font style="vertical-align: inherit;">该查询使用无序和有序分区（
         </font></font><code class="literal">row_num1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">row_num2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        列）来说明省略和包括之间的区别</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>year, country, product, profit,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER(PARTITION BY country) AS row_num1,</code></strong>
         <strong class="userinput"><code>ROW_NUMBER() OVER(PARTITION BY country ORDER BY year, product) AS row_num2</code></strong>
       <strong class="userinput"><code>FROM sales;</code></strong><font></font>
+------+---------+------------+--------+----------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">一年| </font><font style="vertical-align: inherit;">国家| </font><font style="vertical-align: inherit;">产品| </font><font style="vertical-align: inherit;">利润| </font><font style="vertical-align: inherit;">row_num1 | </font><font style="vertical-align: inherit;">row_num2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+---------+------------+--------+----------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">100 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">芬兰| </font><font style="vertical-align: inherit;">电话| </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">印度| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">75 | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2000年| </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">计算器| </font><font style="vertical-align: inherit;">50 | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1500 | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电脑| </font><font style="vertical-align: inherit;">1200 | </font><font style="vertical-align: inherit;">7 | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">6 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">2001 | </font><font style="vertical-align: inherit;">美国| </font><font style="vertical-align: inherit;">电视| </font><font style="vertical-align: inherit;">100 | </font><font style="vertical-align: inherit;">6 | </font><font style="vertical-align: inherit;">7 |</font></font><font></font>
+------+---------+------------+--------+----------+----------+<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如前所述，要使用窗口函数（或将聚合函数视为窗口函数），请</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在函数调用后</font><font style="vertical-align: inherit;">包含一个
         </font><font style="vertical-align: inherit;">子句。</font><font style="vertical-align: inherit;">该
         </font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款有两种形式：
      </font></font></p><pre data-lang="sql" class="programlisting"><em class="replaceable"><code>over_clause</code></em>:<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {OVER（</font></font><em class="replaceable"><code>window_spec</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）| </font><font style="vertical-align: inherit;">超过</font></font><em class="replaceable"><code>window_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        两种形式都定义了窗口函数应如何处理查询行。</font><font style="vertical-align: inherit;">它们的不同之处在于窗口是直接在</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">定义</font><font style="vertical-align: inherit;">，还是由对查询中其他位置定义的命名窗口的引用提供：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在第一种情况下，窗口规范直接出现在</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">括号内</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句中。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在第二种情况下，</font></font><em class="replaceable"><code>window_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            是由</font></font><code class="literal">WINDOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询中其他地方</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">定义的窗口规范的名称
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关详细信息，请参见
             </font></font><a class="xref" href="functions.html#window-functions-named-windows" title="12.21.4命名为Windows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.4节“命名Windows”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于</font><font style="vertical-align: inherit;">语法，窗口规范有几个部分，都是可选的：
      </font></font><code class="literal">OVER
        (<em class="replaceable"><code>window_spec</code></em>)</code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><em class="replaceable"><code>window_spec</code></em>:<font></font>
    [<em class="replaceable"><code>window_name</code></em>] [<em class="replaceable"><code>partition_clause</code></em>] [<em class="replaceable"><code>order_clause</code></em>] [<em class="replaceable"><code>frame_clause</code></em>]
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果</font></font><code class="literal">OVER()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为空，则窗口由所有查询行组成，窗口函数使用所有行计算结果。</font><font style="vertical-align: inherit;">否则，括号内的子句确定使用哪些查询行来计算函数结果以及如何对它们进行分区和排序：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <em class="replaceable"><code>window_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：由</font></font><code class="literal">WINDOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询中其他位置</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">定义的窗口的名称</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果</font></font><em class="replaceable"><code>window_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中单独出现，则它完全定义窗口。</font><font style="vertical-align: inherit;">如果还给出了分区，排序或框架子句，则它们会修改指定窗口的解释。</font><font style="vertical-align: inherit;">有关详细信息，请参见
             </font></font><a class="xref" href="functions.html#window-functions-named-windows" title="12.21.4命名为Windows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.4节“命名Windows”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <em class="replaceable"><code>partition_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
             </font></font><code class="literal">PARTITION BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句指示如何将查询行划分为组。</font><font style="vertical-align: inherit;">给定行的窗口函数结果基于包含该行的分区的行。</font><font style="vertical-align: inherit;">如果</font></font><code class="literal">PARTITION BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">省略，则存在由所有查询行组成的单个分区。
</font></font></p><a class="indexterm" name="idm140091674721680"></a><a class="indexterm" name="idm140091674720192"></a>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              窗口函数的分区与表分区不同。</font><font style="vertical-align: inherit;">有关表分区的信息，请参见</font></font><a class="xref" href="partitioning.html" title="第23章分区"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第23章，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p>
            <em class="replaceable"><code>partition_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 有这种语法：
          </font></font></p><pre data-lang="sql" class="programlisting"><em class="replaceable"><code>partition_clause</code></em>:<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    PARTITION BY </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[，</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] ......
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            标准SQL只需要</font></font><code class="literal">PARTITION BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后跟列名。</font><font style="vertical-align: inherit;">MySQL扩展是允许表达式，而不仅仅是列名。</font><font style="vertical-align: inherit;">例如，如果一个表包含一个</font></font><a class="link" href="data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            名为</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">列</font></font><code class="literal">ts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，标准SQL允许
             </font></font><code class="literal">PARTITION BY ts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但不允许
             </font></font><code class="literal">PARTITION BY HOUR(ts)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而MySQL允许两者。
          </font></font></p></li><li class="listitem"><p>
            <em class="replaceable"><code>order_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code class="literal">ORDER
            BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句指示如何对每个分区中的行进行排序。</font><font style="vertical-align: inherit;">根据</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">相等的分区行
             </font><font style="vertical-align: inherit;">被视为对等。</font><font style="vertical-align: inherit;">如果
             </font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">省略，则分区行是无序的，没有隐含的处理顺序，并且所有分区行都是对等的。
          </font></font></p><a class="indexterm" name="idm140091674705488"></a><a class="indexterm" name="idm140091674704000"></a><p>
            <em class="replaceable"><code>order_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 有这种语法：
          </font></font></p><pre data-lang="sql" class="programlisting"><em class="replaceable"><code>order_clause</code></em>:<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ORDER BY </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ASC | DESC] [，</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ASC | DESC]] ......
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            每个</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式可选地可以跟随</font></font><code class="literal">ASC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><code class="literal">DESC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示排序方向。</font><font style="vertical-align: inherit;">默认为</font></font><code class="literal">ASC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未指定方向。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值首先排序为升序排序，最后排序为降序排序。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            一个</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单独的分区中的一个窗口定义适用。</font><font style="vertical-align: inherit;">要将结果集整体排序，请</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在查询顶级</font><font style="vertical-align: inherit;">包含a </font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <em class="replaceable"><code>frame_clause</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：帧是当前分区的子集，frame子句指定如何定义子集。</font><font style="vertical-align: inherit;">frame子句有许多子条款。</font><font style="vertical-align: inherit;">有关详细信息，请参见
             </font></font><a class="xref" href="functions.html#window-functions-frames" title="12.21.3窗口功能框架规范"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.3节“窗口功能框架规范”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p><a class="indexterm" name="idm140091674691008"></a></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="window-functions-frames"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.3窗口功能框架规范</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140091674687984"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        与窗口函数一起使用的窗口的定义可以包括frame子句。</font><font style="vertical-align: inherit;">帧是当前分区的子集，frame子句指定如何定义子集。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        帧是根据当前行确定的，这使得帧能够在分区内移动，具体取决于其分区内当前行的位置。</font><font style="vertical-align: inherit;">例子：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            通过将帧定义为从分区开始到当前行的所有行，您可以计算每行的运行总计。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            通过将框架定义为</font></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前行两侧的</font><font style="vertical-align: inherit;">扩展
             </font><font style="vertical-align: inherit;">行，您可以计算滚动平均值。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下查询演示了如何使用移动框架来计算每组时间排序</font></font><code class="literal">level</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值中的</font><font style="vertical-align: inherit;">运行总计
         </font><font style="vertical-align: inherit;">，以及从当前行计算的滚动平均值以及紧接在其之前和之后的行：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>time, subject, val,</code></strong>
         <strong class="userinput"><code>SUM(val) OVER (PARTITION BY subject ORDER BY time</code></strong>
                        <strong class="userinput"><code>ROWS UNBOUNDED PRECEDING)</code></strong>
           <strong class="userinput"><code>AS running_total,</code></strong>
         <strong class="userinput"><code>AVG(val) OVER (PARTITION BY subject ORDER BY time</code></strong>
                        <strong class="userinput"><code>ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING)</code></strong>
           <strong class="userinput"><code>AS running_average</code></strong>
       <strong class="userinput"><code>FROM observations;</code></strong><font></font>
+----------+---------+------+---------------+-----------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">时间| </font><font style="vertical-align: inherit;">主题| </font><font style="vertical-align: inherit;">val | </font><font style="vertical-align: inherit;">running_total | </font><font style="vertical-align: inherit;">running_average |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+---------+------+---------------+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:00:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">9.5000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:15:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">19 | </font><font style="vertical-align: inherit;">14.6667 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:30:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">44 | </font><font style="vertical-align: inherit;">18.0000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:45:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">20 | </font><font style="vertical-align: inherit;">64 | </font><font style="vertical-align: inherit;">22.5000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:00:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">5.0000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:15:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">5.0000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:30:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">15 | </font><font style="vertical-align: inherit;">15.0000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:45:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">30 | </font><font style="vertical-align: inherit;">45 | </font><font style="vertical-align: inherit;">20.0000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">08:00:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">70 | </font><font style="vertical-align: inherit;">27.5000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+---------+------+---------------+-----------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于</font></font><code class="literal">running_average</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列，在第一个之前或之后没有帧行。</font><font style="vertical-align: inherit;">在这些情况下，</font></font><a class="link" href="functions.html#function_avg"><code class="literal">AVG()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">计算可用行的平均值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        用作窗口函数的聚合函数对当前行框架中的行进行操作，这些非聚合窗口函数也是如此：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIRST_VALUE（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LAST_VALUE（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NTH_VALUE（）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        标准SQL指定在整个分区上运行的窗口函数应该没有frame子句。</font><font style="vertical-align: inherit;">MySQL为这些函数允许一个frame子句但忽略它。</font><font style="vertical-align: inherit;">即使指定了框架，这些函数也会使用整个分区：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CUME_DIST（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DENSE_RANK（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LAG（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
铅（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NTILE（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PERCENT_RANK（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
秩（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ROW_NUMBER（）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果给出了frame子句，则具有以下语法：
      </font></font></p><pre data-lang="sql" class="programlisting"><em class="replaceable"><code>frame_clause</code></em>:
    <em class="replaceable"><code>frame_units</code></em> <em class="replaceable"><code>frame_extent</code></em><font></font>
<font></font>
<em class="replaceable"><code>frame_units</code></em>:<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {ROWS | </font><font style="vertical-align: inherit;">范围}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在没有frame子句的情况下，默认帧取决于是否存在</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句，如本节后面所述。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><em class="replaceable"><code>frame_units</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值指示当前行和帧行之间的关系类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：框架由开始和结束行位置定义。</font><font style="vertical-align: inherit;">偏移量是行号与当前行号的差异。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">RANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：框架由值范围内的行定义。</font><font style="vertical-align: inherit;">偏移量是行值与当前行值的差异。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><em class="replaceable"><code>frame_extent</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值表示帧的起点和终点。</font><font style="vertical-align: inherit;">您可以只指定帧的开头（在这种情况下，当前行隐式结束）或用于</font></font><code class="literal">BETWEEN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定两个帧端点：
      </font></font></p><pre data-lang="sql" class="programlisting"><em class="replaceable"><code>frame_extent</code></em>:<font></font>
    {<em class="replaceable"><code>frame_start</code></em> | <em class="replaceable"><code>frame_between</code></em>}<font></font>
<font></font>
<em class="replaceable"><code>frame_between</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    在</font></font><em class="replaceable"><code>frame_start</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和之间</font></font><em class="replaceable"><code>frame_end</code></em><font></font>
<font></font>
<em class="replaceable"><code>frame_start</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><em class="replaceable"><code>frame_end</code></em>: {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    当前行</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  | </font><font style="vertical-align: inherit;">无约束的先行</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  | </font><font style="vertical-align: inherit;">以下是无限制的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  | </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  | </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用</font></font><code class="literal">BETWEEN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语法，
         </font></font><em class="replaceable"><code>frame_start</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不得晚于
         </font></font><em class="replaceable"><code>frame_end</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        允许</font><font style="vertical-align: inherit;">值</font></font><em class="replaceable"><code>frame_start</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><em class="replaceable"><code>frame_end</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值具有以下含义：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">CURRENT ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：对于</font></font><code class="literal">ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，绑定是当前行。</font><font style="vertical-align: inherit;">因为</font></font><code class="literal">RANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，bound是当前行的对等体。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">UNBOUNDED PRECEDING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：绑定是第一个分区行。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">UNBOUNDED FOLLOWING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：绑定是最后一个分区行。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em>
            PRECEDING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：对于</font></font><code class="literal">ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，绑定是</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前行之前的行。</font><font style="vertical-align: inherit;">对于</font></font><code class="literal">RANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，bound是值等于当前行值减去的行
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">如果当前行值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">则该行是
             </font><font style="vertical-align: inherit;">该行的对等点。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于</font></font><code class="literal"><em class="replaceable"><code>expr</code></em>
            PRECEDING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（和
             </font></font><code class="literal"><em class="replaceable"><code>expr</code></em>
            FOLLOWING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是</font></font><code class="literal">?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数标记（用于预准备语句），非负数字文字或表单的时间间隔</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于
             </font><font style="vertical-align: inherit;">表达式，
             </font><font style="vertical-align: inherit;">指定非负区间值，并且</font><font style="vertical-align: inherit;">是一个关键字，指示应在其中解释值的单位。</font><font style="vertical-align: inherit;">（有关详细信息，允许
             </font><font style="vertical-align: inherit;">符，看到的描述</font><font style="vertical-align: inherit;">
            功能在</font><a class="xref" href="functions.html#date-and-time-functions" title="12。7日期和时间函数"><font style="vertical-align: inherit;">12.7节，“日期和时间函数”</font></a><font style="vertical-align: inherit;">。）
          </font></font><code class="literal">INTERVAL
            <em class="replaceable"><code>val</code></em>
            <em class="replaceable"><code>unit</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">INTERVAL</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>val</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>unit</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>units</code></em><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a><font style="vertical-align: inherit;"></font><a class="xref" href="functions.html#date-and-time-functions" title="12。7日期和时间函数"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p>
            <code class="literal">RANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分别对</font><font style="vertical-align: inherit;">数字或时间表达式</font><font style="vertical-align: inherit;">的数字或时间
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要求</font></font><code class="literal">ORDER
            BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有效</font></font><code class="literal"><em class="replaceable"><code>expr</code></em>
            PRECEDING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><code class="literal"><em class="replaceable"><code>expr</code></em> FOLLOWING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            指标的</font><font style="vertical-align: inherit;">例子</font><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10预先</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
间隔5天预付款</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5以下</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INTERVAL'2：30'MINUTE_SECOND以下</font></font><font></font>
</pre></li><li class="listitem"><p>
            <code class="literal"><em class="replaceable"><code>expr</code></em>
            FOLLOWING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：对于</font></font><code class="literal">ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，绑定是</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前行之后的行。</font><font style="vertical-align: inherit;">对于</font></font><code class="literal">RANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，bound是值等于当前行值加上的行
             </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">如果当前行值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">则该行是
             </font><font style="vertical-align: inherit;">该行的对等点。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关允许值</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请参阅说明</font></font><code class="literal"><em class="replaceable"><code>expr</code></em>
            PRECEDING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        下面的查询演示
         </font></font><a class="link" href="functions.html#function_first-value"><code class="literal">FIRST_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="functions.html#function_last-value"><code class="literal">LAST_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及两个实例</font></font><a class="link" href="functions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>time, subject, val,</code></strong>
         <strong class="userinput"><code>FIRST_VALUE(val)  OVER w AS 'first',</code></strong>
         <strong class="userinput"><code>LAST_VALUE(val)   OVER w AS 'last',</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 2) OVER w AS 'second',</code></strong>
         <strong class="userinput"><code>NTH_VALUE(val, 4) OVER w AS 'fourth'</code></strong>
       <strong class="userinput"><code>FROM observations</code></strong>
       <strong class="userinput"><code>WINDOW w AS (PARTITION BY subject ORDER BY time</code></strong>
                    <strong class="userinput"><code>ROWS UNBOUNDED PRECEDING);</code></strong><font></font>
+----------+---------+------+-------+------+--------+--------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">时间| </font><font style="vertical-align: inherit;">主题| </font><font style="vertical-align: inherit;">val | </font><font style="vertical-align: inherit;">第一个| </font><font style="vertical-align: inherit;">最后| </font><font style="vertical-align: inherit;">第二个| </font><font style="vertical-align: inherit;">第四|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+---------+------+-------+------+--------+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:00:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:15:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:30:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:45:00 | </font><font style="vertical-align: inherit;">st113 | </font><font style="vertical-align: inherit;">20 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">20 | </font><font style="vertical-align: inherit;">9 | </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:00:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:15:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:30:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">07:45:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">30 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">30 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">30 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">08:00:00 | </font><font style="vertical-align: inherit;">xh458 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">25 | </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">30 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------+---------+------+-------+------+--------+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        每个函数使用当前帧中的行，根据所示的窗口定义，这些行从第一个分区行延伸到当前行。</font><font style="vertical-align: inherit;">对于
         </font></font><a class="link" href="functions.html#function_nth-value"><code class="literal">NTH_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用，当前帧并不总是包括所请求的行; </font><font style="vertical-align: inherit;">在这种情况下，返回值是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在没有frame子句的情况下，默认帧取决于是否存在</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：默认框架包括从分区开始到当前行的行，包括当前行的所有对等项（根据</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            子句</font><font style="vertical-align: inherit;">等于当前行的行</font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">默认值等效于此帧规范：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无界先行与当前行之间的范围
</font></font></pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            不使用</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：默认框架包括所有分区行（因为没有</font></font><code class="literal">ORDER
            BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，所有分区行都是对等的）。</font><font style="vertical-align: inherit;">默认值等效于此帧规范：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无界先行与无界之间的范围
</font></font></pre></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        因为默认框架根据是否存在而不同</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，添加</font></font><code class="literal">ORDER
        BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到查询以获得确定性结果可能会更改结果。</font><font style="vertical-align: inherit;">（例如，</font></font><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会更改</font><font style="vertical-align: inherit;">生成的值
         </font><font style="vertical-align: inherit;">。）要获得相同但按顺序排序的结果</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请提供要使用的显式帧规范，而不管是否</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存在。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当前行值为时，帧规范的含义可以是非显而易见的</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">假设是这种情况，这些示例说明了各种帧规范如何适用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 FOLLOWING AND 15
            FOLLOWING</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            帧开始于</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和停止
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此仅包括具有值的行
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 FOLLOWING AND
            UNBOUNDED FOLLOWING</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            框架从</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区结束处</font><font style="vertical-align: inherit;">开始</font><font style="vertical-align: inherit;">并停止。</font><font style="vertical-align: inherit;">因为</font></font><code class="literal">ASC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">排序</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先</font><font style="vertical-align: inherit;">放置</font><font style="vertical-align: inherit;">值，所以帧是整个分区。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X DESC RANGE BETWEEN 10 FOLLOWING AND
            UNBOUNDED FOLLOWING</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            框架从</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区结束处</font><font style="vertical-align: inherit;">开始</font><font style="vertical-align: inherit;">并停止。</font><font style="vertical-align: inherit;">因为</font></font><code class="literal">DESC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">排序</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后</font><font style="vertical-align: inherit;">放置</font><font style="vertical-align: inherit;">值，所以框架只是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 PRECEDING AND
            UNBOUNDED FOLLOWING</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            框架从</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区结束处</font><font style="vertical-align: inherit;">开始</font><font style="vertical-align: inherit;">并停止。</font><font style="vertical-align: inherit;">因为</font></font><code class="literal">ASC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">排序</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先</font><font style="vertical-align: inherit;">放置</font><font style="vertical-align: inherit;">值，所以帧是整个分区。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 PRECEDING AND 10
            FOLLOWING</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            帧开始于</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和停止
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此仅包括具有值的行
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN 10 PRECEDING AND 1
            PRECEDING</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            帧开始于</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和停止
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此仅包括具有值的行
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">ORDER BY X ASC RANGE BETWEEN UNBOUNDED PRECEDING
            AND 10 FOLLOWING</code>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            框架从分区的开始处开始，并在具有值的行处停止</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因为
             </font></font><code class="literal">ASC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">排序</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            首先</font><font style="vertical-align: inherit;">放置</font><font style="vertical-align: inherit;">值，所以框架只是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            值。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="window-functions-named-windows"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.4命名为Windows</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        可以定义Windows并给出用于在</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">引用它们的名称</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">为此，请使用
         </font></font><code class="literal">WINDOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句。</font><font style="vertical-align: inherit;">如果存在于查询中，则该
         </font></font><code class="literal">WINDOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句位于</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        子句</font><font style="vertical-align: inherit;">的位置之间</font><font style="vertical-align: inherit;">，并具有以下语法：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WINDOW </font></font><em class="replaceable"><code>window_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AS（</font></font><em class="replaceable"><code>window_spec</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    [，</font></font><em class="replaceable"><code>window_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AS（</font></font><em class="replaceable"><code>window_spec</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）] ......
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于每个窗口定义，
         </font></font><em class="replaceable"><code>window_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是窗口名称，并且与
         </font><font style="vertical-align: inherit;">子句</font></font><em class="replaceable"><code>window_spec</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的括号之间给出的窗口规范类型相同
         </font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如
         </font></font><a class="xref" href="functions.html#window-functions-usage" title="12.21.2窗口函数概念和语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.21.2节“窗口函数概念和语法”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><em class="replaceable"><code>window_spec</code></em>:<font></font>
    [<em class="replaceable"><code>window_name</code></em>] [<em class="replaceable"><code>partition_clause</code></em>] [<em class="replaceable"><code>order_clause</code></em>] [<em class="replaceable"><code>frame_clause</code></em>]
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        甲</font></font><code class="literal">WINDOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句对于其中多个查询是有用</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的条款，否则定义相同的窗口。</font><font style="vertical-align: inherit;">相反，您可以定义窗口一次，为其命名，并在</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">引用名称
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">考虑这个查询，它多次定义同一个窗口：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  小时</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ROW_NUMBER（）OVER（ORDER BY val）AS'row_number'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  RANK（）OVER（ORDER BY val）AS'rank'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  DENSE_RANK（）OVER（ORDER BY val）AS'heavy_rank'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来自数字;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        通过使用</font></font><code class="literal">WINDOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一次定义窗口并在</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        子句中</font><font style="vertical-align: inherit;">按名称引用窗口，</font><font style="vertical-align: inherit;">可以更简单地编写查询
         </font><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  小时</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ROW_NUMBER（）超过'row_number'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  RANK（）超过'等级'，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  DENSE_RANK（）超过'dense_rank'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从数字</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WINDOW W AS（ORDER BY val）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        命名窗口还可以更轻松地尝试窗口定义以查看对查询结果的影响。</font><font style="vertical-align: inherit;">您只需要修改</font></font><code class="literal">WINDOW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">的窗口定义
         </font><font style="vertical-align: inherit;">，而不是多个
         </font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句定义。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句使用</font><font style="vertical-align: inherit;">而不是</font><font style="vertical-align: inherit;">，则可以通过添加其他子句来修改命名窗口。</font><font style="vertical-align: inherit;">例如，此查询定义了一个包含分区的窗口，并</font><font style="vertical-align: inherit;">在
         </font><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">以不同方式修改窗口：
      </font></font><code class="literal">OVER
        (<em class="replaceable"><code>window_name</code></em> ...)</code><font style="vertical-align: inherit;"></font><code class="literal">OVER
        <em class="replaceable"><code>window_name</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">ORDER BY</code><font style="vertical-align: inherit;"></font><code class="literal">OVER</code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  DISTINCT年份，国家，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  FIRST_VALUE（年）超过（按年度ASC排序）AS，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  FIRST_VALUE（年）超过（按年度DESC）作为最后一个</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从销售</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WINDOW W AS（国家分区）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        一个</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句只能添加属性命名的窗口，不能修改它们。</font><font style="vertical-align: inherit;">如果指定的窗口定义包含分区，排序或框架属性，则</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引用窗口名称</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">子句也不能包含相同类型的属性或发生错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            允许此构造，因为窗口定义和引用</font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句不包含相同类型的属性：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">超过（按国家/地区分类）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... WINDOW w AS（按国家划分）</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            不允许使用此构造，因为该
             </font></font><code class="literal">OVER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font></font><code class="literal">PARTITION
            BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为已经具有以下内容的命名窗口
             </font><font style="vertical-align: inherit;">指定</font></font><code class="literal">PARTITION BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">超过（按年度划分）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... WINDOW w AS（按国家划分）</font></font><font></font>
</pre></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        命名窗口的定义本身可以以a开头
         </font></font><em class="replaceable"><code>window_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，允许前向和后向引用，但不允许循环：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            这是允许的; </font><font style="vertical-align: inherit;">它包含前向和后向引用，但没有循环：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WINDOW w1 AS（w2），w2 AS（），w3 AS（w1）
</font></font></pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            这是不允许的，因为它包含一个循环：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WINDOW w1 AS（w2），w2 AS（w3），w3 AS（w1）
</font></font></pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="window-function-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.21.5窗口函数限制</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        SQL标准对不能使用的窗口函数</font></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新行的语句</font><font style="vertical-align: inherit;">施加约束</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">允许在这些语句的子查询中使用此类函数（以选择行）。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL不支持这些窗口功能：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">DISTINCT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 聚合窗口函数的语法。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            嵌套窗口函数。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            动态帧端点，它取决于当前行的值。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        解析器识别这些不支持的窗口构造：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            的</font></font><code class="literal">GROUPS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">帧为单位指定符进行解析，但产生一个错误。</font><font style="vertical-align: inherit;">只有</font></font><code class="literal">ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            和</font></font><code class="literal">RANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><code class="literal">EXCLUDE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解析帧规范</font><font style="vertical-align: inherit;">
            的</font><font style="vertical-align: inherit;">子句，但会产生错误。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">IGNORE NULLS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被解析，但产生错误。</font><font style="vertical-align: inherit;">仅</font></font><code class="literal">RESPECT NULLS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">FROM LAST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被解析，但产生错误。</font><font style="vertical-align: inherit;">仅</font></font><code class="literal">FROM FIRST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.22性能模式函数</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091674489840"></a><a class="indexterm" name="idm140091674488352"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从MySQL 8.0.16开始，MySQL包含内置的SQL函数，可以格式化或检索性能模式数据，并且可以用作相应</font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式存储函数的</font><font style="vertical-align: inherit;">等效</font><font style="vertical-align: inherit;">函数。</font><font style="vertical-align: inherit;">可以在任何模式中调用内置函数，并且不需要限定符，这与</font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      需要</font></font><code class="literal">sys.</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式限定符或</font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前模式</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">不同</font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="table">
<a name="idm140091674483712"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.28性能模式函数</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists Performance Schema functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_format-bytes"><code class="literal">FORMAT_BYTES()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将字节数转换为带单位的值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_format-pico-time"><code class="literal">FORMAT_PICO_TIME()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将时间（皮秒）转换为单位值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ps-current-thread-id"><code class="literal">PS_CURRENT_THREAD_ID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      当前线程的性能架构线程ID
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      给定线程的性能架构线程ID
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      内置函数取代了相应的
       </font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数，这些函数已弃用，将在未来的MySQL版本中删除。</font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应调整</font><font style="vertical-align: inherit;">使用这些</font><font style="vertical-align: inherit;">函数的</font><font style="vertical-align: inherit;">应用程序
       </font><font style="vertical-align: inherit;">以使用内置函数，同时记住</font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数和内置函数</font><font style="vertical-align: inherit;">之间的一些细微差别</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关这些差异的详细信息，请参阅本节中的功能说明。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_format-bytes"></a><p>
          <a class="link" href="functions.html#function_format-bytes"><code class="literal">FORMAT_BYTES(<em class="replaceable"><code>count</code></em>)</code></a>
        </p><a class="indexterm" name="idm140091674455648"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定数字字节计数，将其转换为人类可读格式并返回由值和单位指示符组成的字符串。</font><font style="vertical-align: inherit;">该字符串包含舍入到2位小数的字节数和最少3位有效数字。</font><font style="vertical-align: inherit;">小于1024字节的数字表示为整数，不是舍入的。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          units指示符取决于byte-count参数的大小，如下表所示。
</font></font></p>
<div class="informaltable">
<table summary="Units indicators used by FORMAT_BYTES() function."><colgroup><col width="30%"><col width="25%"><col width="45%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">论证价值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果单位</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果单位指标</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高达1023</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最多1024 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kibibytes</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">昆明植物研究所</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最多1024 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mebibytes</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MIB</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最多1024 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gibibytes</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">吉布</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最多1024 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tebibytes</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最多1024 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pebibytes</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启动</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1024 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">及以上</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exbibytes</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EIB</font></font></td>
</tr></tbody></table>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT FORMAT_BYTES(512), FORMAT_BYTES(18446644073709551615);</code></strong><font></font>
+-------------------+------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">FORMAT_BYTES（512）| </font><font style="vertical-align: inherit;">FORMAT_BYTES（18446644073709551615）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">512字节| </font><font style="vertical-align: inherit;">16.00 EiB |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------+------------------------------------+</font></font><font></font>
</pre><p>
          <a class="link" href="functions.html#function_format-bytes"><code class="literal">FORMAT_BYTES()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在MySQL 8.0.16中添加了。</font><font style="vertical-align: inherit;">它可以用来代替
           </font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式
           </font></font><a class="link" href="sys-schema.html#sys-format-bytes" title="27.4.5.3 format_bytes（）函数"><code class="literal">format_bytes()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数，记住这个区别：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <a class="link" href="functions.html#function_format-bytes"><code class="literal">FORMAT_BYTES()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用
               </font></font><code class="literal">EiB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单位指标。
              </font></font><a class="link" href="sys-schema.html#sys-format-bytes" title="27.4.5.3 format_bytes（）函数"><code class="literal">sys.format_bytes()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">才不是。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><a name="function_format-pico-time"></a><p>
          <a class="link" href="functions.html#function_format-pico-time"><code class="literal">FORMAT_PICO_TIME(<em class="replaceable"><code>time_val</code></em>)</code></a>
        </p><a class="indexterm" name="idm140091674403344"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定数字性能模式延迟或以皮秒为单位的等待时间，将其转换为人类可读格式并返回由值和单位指示符组成的字符串。</font><font style="vertical-align: inherit;">该字符串包含舍入到2位小数的十进制时间和最少3位有效数字。</font><font style="vertical-align: inherit;">1纳秒以下的时间表示为整数，不是四舍五入。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          单位指示符取决于时间值参数的大小，如下表所示。
</font></font></p>
<div class="informaltable">
<table summary="Units indicators used by FORMAT_PICO_TIME() function."><colgroup><col width="30%"><col width="25%"><col width="45%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">论证价值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果单位</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果单位指标</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最多10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">皮秒</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最多10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">纳秒</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NS</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高达10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">微秒</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最多10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">毫秒</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">女士</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高达60×10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秒</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小号</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高达3.6×10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分钟</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高达8.64×10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小时</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.64×10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">及以上</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">天</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></td>
</tr></tbody></table>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT FORMAT_PICO_TIME(3501), FORMAT_PICO_TIME(188732396662000);</code></strong><font></font>
+------------------------+-----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">FORMAT_PICO_TIME（3501）| </font><font style="vertical-align: inherit;">FORMAT_PICO_TIME（188732396662000）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+-----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">3.50 ns | </font><font style="vertical-align: inherit;">3.15分钟|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+-----------------------------------+</font></font><font></font>
</pre><p>
          <a class="link" href="functions.html#function_format-pico-time"><code class="literal">FORMAT_PICO_TIME()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在MySQL 8.0.16中添加了。</font><font style="vertical-align: inherit;">它可以用来代替
           </font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式
           </font></font><a class="link" href="sys-schema.html#sys-format-time" title="27.4.5.6 format_time（）函数"><code class="literal">format_time()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数，记住这些差异：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              要指示分钟，请
               </font></font><a class="link" href="sys-schema.html#sys-format-time" title="27.4.5.6 format_time（）函数"><code class="literal">sys.format_time()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用
               </font></font><code class="literal">m</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单位指示符，而
               </font></font><a class="link" href="functions.html#function_format-pico-time"><code class="literal">FORMAT_PICO_TIME()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用
               </font></font><code class="literal">min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="sys-schema.html#sys-format-time" title="27.4.5.6 format_time（）函数"><code class="literal">sys.format_time()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用
               </font></font><code class="literal">w</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（周）单位指标。
              </font></font><a class="link" href="functions.html#function_format-pico-time"><code class="literal">FORMAT_PICO_TIME()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">才不是。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><a name="function_ps-current-thread-id"></a><p>
          <a class="link" href="functions.html#function_ps-current-thread-id"><code class="literal">PS_CURRENT_THREAD_ID()</code></a>
        </p><a class="indexterm" name="idm140091674342528"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font></font><code class="literal">BIGINT UNSIGNED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示分配给当前连接的Performance Schema线程ID </font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          线程ID返回值是</font></font><code class="literal">THREAD_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance Schema表列中</font><font style="vertical-align: inherit;">给出的类型的值
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          性能架构配置的影响</font></font><a class="link" href="functions.html#function_ps-current-thread-id"><code class="literal">PS_CURRENT_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方式</font><font style="vertical-align: inherit;">与之
           </font><font style="vertical-align: inherit;">相同</font></font><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关详细信息，请参阅该功能的说明。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT PS_CURRENT_THREAD_ID();</code></strong><font></font>
+------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">PS_CURRENT_THREAD_ID（）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+</font></font><font></font>
|                     52 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT PS_THREAD_ID(CONNECTION_ID());</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">PS_THREAD_ID（CONNECTION_ID（））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
|                            52 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------+</font></font><font></font>
</pre><p>
          <a class="link" href="functions.html#function_ps-current-thread-id"><code class="literal">PS_CURRENT_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在MySQL 8.0.16中添加了。</font><font style="vertical-align: inherit;">它可以用作调用</font><font style="vertical-align: inherit;">带有</font><font style="vertical-align: inherit;">或
           </font><font style="vertical-align: inherit;">的参数</font><font style="vertical-align: inherit;">的</font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式
           </font></font><a class="link" href="sys-schema.html#sys-ps-thread-id" title="27.4.5.15 ps_thread_id（）函数"><code class="literal">ps_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">的快捷方式</font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><a name="function_ps-thread-id"></a><p>
          <a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID(<em class="replaceable"><code>connection_id</code></em>)</code></a>
        </p><a class="indexterm" name="idm140091674320976"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定连接ID，返回</font></font><code class="literal">BIGINT
          UNSIGNED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示分配给连接ID的性能模式线程ID </font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值，或者</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font><font style="vertical-align: inherit;">连接ID
           </font><font style="vertical-align: inherit;">不存在线程ID。</font><font style="vertical-align: inherit;">后者可以针对未检测的线程发生。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          连接ID参数是</font></font><code class="literal">PROCESSLIST_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance Schema </font></font><a class="link" href="performance-schema.html#threads-table" title="26.12.17.5线程表"><code class="literal">threads</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表的</font></font><code class="literal">Id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="sql-syntax.html#show-processlist" title="13.7.6.29 SHOW PROCESSLIST语法"><code class="literal">SHOW
          PROCESSLIST</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输出</font><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">给出的类型的值
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          线程ID返回值是</font></font><code class="literal">THREAD_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance Schema表列中</font><font style="vertical-align: inherit;">给出的类型的值
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          性能模式配置会影响
           </font></font><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作，如下所示。</font><font style="vertical-align: inherit;">（这些评论也适用于
           </font></font><a class="link" href="functions.html#function_ps-current-thread-id"><code class="literal">PS_CURRENT_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              禁用</font></font><code class="literal">thread_instrumentation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用者会禁用在线程级别收集和聚合的统计信息，但不会对其产生影响
               </font></font><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果
               </font></font><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances"><code class="literal">performance_schema_max_thread_instances</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不为0，则性能模式为线程统计分配内存，并为每个可用实例内存的线程分配内部ID。</font><font style="vertical-align: inherit;">如果存在实例内存不可用的线程，则
               </font></font><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">在这种情况下，
               </font></font><a class="link" href="performance-schema.html#statvar_Performance_schema_thread_instances_lost"><code class="literal">Performance_schema_thread_instances_lost</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              将非零。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果
               </font></font><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances"><code class="literal">performance_schema_max_thread_instances</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为0，则性能模式不分配线程内存并</font></font><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果禁用性能架构本身，则会
               </font></font><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">产生错误。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT PS_THREAD_ID(6);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">PS_THREAD_ID（6）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font>
|              45 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font>
</pre><p>
          <a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在MySQL 8.0.16中添加了。</font><font style="vertical-align: inherit;">它可以用来代替
           </font></font><code class="literal">sys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式
           </font></font><a class="link" href="sys-schema.html#sys-ps-thread-id" title="27.4.5.15 ps_thread_id（）函数"><code class="literal">ps_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数，记住这个区别：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="sys-schema.html#sys-ps-thread-id" title="27.4.5.15 ps_thread_id（）函数"><code class="literal">sys.ps_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回当前连接的线程ID，而
               </font></font><a class="link" href="functions.html#function_ps-thread-id"><code class="literal">PS_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要获取当前连接线程ID，请
               </font></font><a class="link" href="functions.html#function_ps-current-thread-id"><code class="literal">PS_CURRENT_THREAD_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              改用。
</font></font></p></li></ul>
</div>
</li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="internal-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.23内部功能</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091674278800"></a><a class="indexterm" name="idm140091674277728"></a>
<div class="table">
<a name="idm140091674276240"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.29内部功能</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists functions intended only for internal use by the server."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_can-access-column"><code class="literal">CAN_ACCESS_COLUMN()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_can-access-database"><code class="literal">CAN_ACCESS_DATABASE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_can-access-table"><code class="literal">CAN_ACCESS_TABLE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_can-access-view"><code class="literal">CAN_ACCESS_VIEW()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_get-dd-column-privileges"><code class="literal">GET_DD_COLUMN_PRIVILEGES()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_get-dd-create-options"><code class="literal">GET_DD_CREATE_OPTIONS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_get-dd-index-sub-part-length"><code class="literal">GET_DD_INDEX_SUB_PART_LENGTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-auto-increment"><code class="literal">INTERNAL_AUTO_INCREMENT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-avg-row-length"><code class="literal">INTERNAL_AVG_ROW_LENGTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-check-time"><code class="literal">INTERNAL_CHECK_TIME()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-checksum"><code class="literal">INTERNAL_CHECKSUM()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-data-free"><code class="literal">INTERNAL_DATA_FREE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-data-length"><code class="literal">INTERNAL_DATA_LENGTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-dd-char-length"><code class="literal">INTERNAL_DD_CHAR_LENGTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-get-comment-or-error"><code class="literal">INTERNAL_GET_COMMENT_OR_ERROR()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-get-view-warning-or-error"><code class="literal">INTERNAL_GET_VIEW_WARNING_OR_ERROR()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-index-column-cardinality"><code class="literal">INTERNAL_INDEX_COLUMN_CARDINALITY()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-index-length"><code class="literal">INTERNAL_INDEX_LENGTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-keys-disabled"><code class="literal">INTERNAL_KEYS_DISABLED()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-max-data-length"><code class="literal">INTERNAL_MAX_DATA_LENGTH()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-table-rows"><code class="literal">INTERNAL_TABLE_ROWS()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_internal-update-time"><code class="literal">INTERNAL_UPDATE_TIME()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      限内部使用
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节中列出的功能仅供服务器内部使用。</font><font style="vertical-align: inherit;">用户尝试调用它们会导致错误。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_can-access-column"></a><p>
          <a class="indexterm" name="idm140091674193600"></a>

          <a class="link" href="functions.html#function_can-access-column"><code class="literal">CAN_ACCESS_COLUMN(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_can-access-database"></a><p>
          <a class="indexterm" name="idm140091674187088"></a>

          <a class="link" href="functions.html#function_can-access-database"><code class="literal">CAN_ACCESS_DATABASE(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_can-access-table"></a><p>
          <a class="indexterm" name="idm140091674180576"></a>

          <a class="link" href="functions.html#function_can-access-table"><code class="literal">CAN_ACCESS_TABLE(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_can-access-view"></a><p>
          <a class="indexterm" name="idm140091674174064"></a>

          <a class="link" href="functions.html#function_can-access-view"><code class="literal">CAN_ACCESS_VIEW(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_get-dd-column-privileges"></a><p>
          <a class="indexterm" name="idm140091674167584"></a>

          <a class="link" href="functions.html#function_get-dd-column-privileges"><code class="literal">GET_DD_COLUMN_PRIVILEGES(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_get-dd-create-options"></a><p>
          <a class="indexterm" name="idm140091674161040"></a>

          <a class="link" href="functions.html#function_get-dd-create-options"><code class="literal">GET_DD_CREATE_OPTIONS(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_get-dd-index-sub-part-length"></a><p>
          <a class="indexterm" name="idm140091674154544"></a>

          <a class="link" href="functions.html#function_get-dd-index-sub-part-length"><code class="literal">GET_DD_INDEX_SUB_PART_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-auto-increment"></a><p>
          <a class="indexterm" name="idm140091674147936"></a>

          <a class="link" href="functions.html#function_internal-auto-increment"><code class="literal">INTERNAL_AUTO_INCREMENT(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-avg-row-length"></a><p>
          <a class="indexterm" name="idm140091674141376"></a>

          <a class="link" href="functions.html#function_internal-avg-row-length"><code class="literal">INTERNAL_AVG_ROW_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-check-time"></a><p>
          <a class="indexterm" name="idm140091674134880"></a>

          <a class="link" href="functions.html#function_internal-check-time"><code class="literal">INTERNAL_CHECK_TIME(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-checksum"></a><p>
          <a class="indexterm" name="idm140091674128368"></a>

          <a class="link" href="functions.html#function_internal-checksum"><code class="literal">INTERNAL_CHECKSUM(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-data-free"></a><p>
          <a class="indexterm" name="idm140091674121856"></a>

          <a class="link" href="functions.html#function_internal-data-free"><code class="literal">INTERNAL_DATA_FREE(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-data-length"></a><p>
          <a class="indexterm" name="idm140091674115280"></a>

          <a class="link" href="functions.html#function_internal-data-length"><code class="literal">INTERNAL_DATA_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-dd-char-length"></a><p>
          <a class="indexterm" name="idm140091674108752"></a>

          <a class="link" href="functions.html#function_internal-dd-char-length"><code class="literal">INTERNAL_DD_CHAR_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-get-comment-or-error"></a><p>
          <a class="indexterm" name="idm140091674102224"></a>

          <a class="link" href="functions.html#function_internal-get-comment-or-error"><code class="literal">INTERNAL_GET_COMMENT_OR_ERROR(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-get-view-warning-or-error"></a><p>
          <a class="indexterm" name="idm140091674095616"></a>

          <a class="link" href="functions.html#function_internal-get-view-warning-or-error"><code class="literal">INTERNAL_GET_VIEW_WARNING_OR_ERROR(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-index-column-cardinality"></a><p>
          <a class="indexterm" name="idm140091674088976"></a>

          <a class="link" href="functions.html#function_internal-index-column-cardinality"><code class="literal">INTERNAL_INDEX_COLUMN_CARDINALITY(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-index-length"></a><p>
          <a class="indexterm" name="idm140091674082400"></a>

          <a class="link" href="functions.html#function_internal-index-length"><code class="literal">INTERNAL_INDEX_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-keys-disabled"></a><p>
          <a class="indexterm" name="idm140091674075936"></a>

          <a class="link" href="functions.html#function_internal-keys-disabled"><code class="literal">INTERNAL_KEYS_DISABLED(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-max-data-length"></a><p>
          <a class="indexterm" name="idm140091674069424"></a>

          <a class="link" href="functions.html#function_internal-max-data-length"><code class="literal">INTERNAL_MAX_DATA_LENGTH(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-table-rows"></a><p>
          <a class="indexterm" name="idm140091674062880"></a>

          <a class="link" href="functions.html#function_internal-table-rows"><code class="literal">INTERNAL_TABLE_ROWS(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_internal-update-time"></a><p>
          <a class="indexterm" name="idm140091674056304"></a>

          <a class="link" href="functions.html#function_internal-update-time"><code class="literal">INTERNAL_UPDATE_TIME(<em class="replaceable"><code>ARGS</code></em>)</code></a>
        </p></li><li class="listitem"><a name="function_is-visible-dd-object"></a><p>
          <a class="indexterm" name="idm140091674049760"></a>

          <a class="link" href="functions.html#function_is-visible-dd-object"><code class="literal">IS_VISIBLE_DD_OBJECT(<em class="replaceable"><code>ARGS</code></em>)</code></a>
</p></li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="miscellaneous-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.24其他功能</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140091674044720"></a><a class="indexterm" name="idm140091674043648"></a>
<div class="table">
<a name="idm140091674042160"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表12.30其他功能</font></font></b></p>
<div class="table-contents">
<table frame="box" rules="all" summary="A reference that lists miscellaneous functions."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
</tr></thead><tbody><tr><td scope="row"><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      抑制ONLY_FULL_GROUP_BY值拒绝
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将二进制UUID转换为字符串
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_default"><code class="literal">DEFAULT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回表列的默认值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      区分超级聚合ROLLUP行与常规行
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回IP地址的数值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_inet-ntoa"><code class="literal">INET_NTOA()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从数值返回IP地址
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回IPv6地址的数值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_inet6-ntoa"><code class="literal">INET6_NTOA()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从数值返回IPv6地址
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      参数是否为IPv4地址
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4-compat"><code class="literal">IS_IPV4_COMPAT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      参数是否是IPv4兼容的地址
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv4-mapped"><code class="literal">IS_IPV4_MAPPED()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      参数是否是IPv4映射地址
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-ipv6"><code class="literal">IS_IPV6()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      参数是否是IPv6地址
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_is-uuid"><code class="literal">IS_UUID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      参数是否是有效的UUID
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      阻止，直到从站已读取并应用所有更新到指定位置
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_name-const"><code class="literal">NAME_CONST()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      导致列具有给定名称
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回随机浮点值
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      睡几秒钟
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回通用唯一标识符（UUID）
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回整数值通用标识符
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      将字符串UUID转换为二进制
    </font></font></td>
</tr><tr><td scope="row"><a class="link" href="functions.html#function_values"><code class="literal">VALUES()</code></a></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      定义INSERT期间要使用的值
    </font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a name="function_any-value"></a><p>
          <a class="indexterm" name="idm140091673963776"></a>

          <a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE(<em class="replaceable"><code>arg</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font><font style="vertical-align: inherit;">启用S​​QL模式的</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          查询，
           </font><font style="vertical-align: inherit;">此函数非常有用</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因为MySQL拒绝您知道MySQL无法确定的查询的查询。</font><font style="vertical-align: inherit;">函数返回值和类型与其参数的返回值和类型相同，但不检查</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          SQL模式</font><font style="vertical-align: inherit;">的函数结果</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例如，如果</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是非索引列，则以下查询将失败并
           </font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT name, address, MAX(age) FROM t GROUP BY name;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1055（42000）：SELECT列表的表达式＃2不在GROUP中</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BY子句并包含非聚合列'mydb.t.address'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在功能上不依赖于GROUP BY子句中的列; </font><font style="vertical-align: inherit;">这个</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与sql_mode = only_full_group_by不兼容</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          发生故障是因为</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非聚合列既不在</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">命名，
           </font><font style="vertical-align: inherit;">也不在功能上依赖于它们。</font><font style="vertical-align: inherit;">因此，</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组中的</font><font style="vertical-align: inherit;">行</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">是不确定的。</font><font style="vertical-align: inherit;">有多种方法可以使MySQL接受查询：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              更改表以创建</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主键或唯一</font></font><code class="literal">NOT NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列。</font><font style="vertical-align: inherit;">这使MySQL能够确定</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在功能上依赖于</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">也就是说，</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由唯一确定
               </font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（如果</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须允许</font><font style="vertical-align: inherit;">此技术</font><font style="vertical-align: inherit;">作为有效值，
               </font><font style="vertical-align: inherit;">则此技术不适用</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用</font></font><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是指
               </font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT名称，ANY_VALUE（地址），MAX（年龄）FROM t GROUP BY名称;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在这种情况下，MySQL忽略</font></font><code class="literal">address</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组</font><font style="vertical-align: inherit;">中</font><font style="vertical-align: inherit;">值
               </font><font style="vertical-align: inherit;">的不确定性
               </font><font style="vertical-align: inherit;">并接受查询。</font><font style="vertical-align: inherit;">如果您根本不关心为每个组选择哪个非聚合列的值，这可能很有用。
              </font></font><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是聚集函数，不像功能，例如
               </font></font><a class="link" href="functions.html#function_sum"><code class="literal">SUM()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它只是用来抑制非确定性的测试。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              禁用
               </font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这相当于使用
               </font></font><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with
               </font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              enabled，如上一项所述。
</font></font></p></li></ul>
</div>
<p>
          <a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果列之间存在函数依赖，但MySQL无法确定它，这也很有用。</font><font style="vertical-align: inherit;">以下查询是有效的，因为
           </font></font><code class="literal">age</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它在功能上依赖于分组列</font></font><code class="literal">age-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但MySQL不能告诉它并拒绝</font></font><a class="link" href="server-administration.html#sqlmode_only_full_group_by"><code class="literal">ONLY_FULL_GROUP_BY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用</font><font style="vertical-align: inherit;">的查询
           </font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择年龄FROM t GROUP BY age-1;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要使MySQL接受查询，请使用
           </font></font><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT ANY_VALUE（age）FROM t GROUP BY age-1;
</font></font></pre><p>
          <a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以用于在没有</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">的情况下引用聚合函数的查询
           </font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT name, MAX(age) FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1140（42000）：在没有GROUP BY，表达式的聚合查询中</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT列表的＃1包含非聚合列'mydb.t.name'; </font><font style="vertical-align: inherit;">这个</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与sql_mode = only_full_group_by不兼容</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，只有一个组，它是不确定的，</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为组选择值。
          </font></font><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">告诉MySQL接受查询：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT ANY_VALUE（name），MAX（age）FROM t;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可能是由于给定数据集的某些属性，您知道所选的非聚合列在功能上有效地依赖于</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          列。</font><font style="vertical-align: inherit;">例如，应用程序可以强制一列相对于另一列的唯一性。</font><font style="vertical-align: inherit;">在这种情况下，使用
           </font></font><a class="link" href="functions.html#function_any-value"><code class="literal">ANY_VALUE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效的功能依赖列可能是有意义的。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关其他讨论，请参见
           </font></font><a class="xref" href="functions.html#group-by-handling" title="12.20.3 GROUP BY的MySQL处理"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20.3节“GROUP BY的MySQL处理”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_bin-to-uuid"></a><p>
          <a class="indexterm" name="idm140091673903472"></a>

          <a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID(<em class="replaceable"><code>binary_uuid</code></em>)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID(<em class="replaceable"><code>binary_uuid</code></em>,
          <em class="replaceable"><code>swap_flag</code></em>)</code></a>
        </p><p>
          <a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是反的
           </font></font><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它将二进制UUID转换为字符串UUID并返回结果。</font><font style="vertical-align: inherit;">二进制值应该是UUID作为
           </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY(16)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">返回值是</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由破折号分隔的五个十六进制数字</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">字符串。</font><font style="vertical-align: inherit;">（有关此格式的详细信息，请参阅</font></font><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数说明。）如果UUID参数为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果任何参数无效，则会发生错误。
        </font></font></p><p>
          <a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 需要一个或两个参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              单参数形式采用二进制UUID值。</font><font style="vertical-align: inherit;">假设UUID值没有交换时间低和时间高的部分。</font><font style="vertical-align: inherit;">字符串结果与二进制参数的顺序相同。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              双参数形式采用二进制UUID值和swap-flag值：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果</font></font><em class="replaceable"><code>swap_flag</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为0，则双参数形式等效于单参数形式。</font><font style="vertical-align: inherit;">字符串结果与二进制参数的顺序相同。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果</font></font><em class="replaceable"><code>swap_flag</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为1，则假定UUID值具有交换的时间低和时间高的部分。</font><font style="vertical-align: inherit;">这些部件将交换回结果值中的原始位置。
</font></font></p></li></ul>
</div>
</li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关时间 - 部分交换的用法示例和信息，请参阅</font></font><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能说明。
        </font></font></p></li><li class="listitem"><a name="function_default"></a><p>
          <a class="indexterm" name="idm140091673878768"></a>

          <a class="link" href="functions.html#function_default"><code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回表列的默认值。</font><font style="vertical-align: inherit;">如果列没有默认值，则会出现错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          仅允许具有文字默认值的列</font><font style="vertical-align: inherit;">
          使用
           </font><font style="vertical-align: inherit;">指定命名列的默认值，而不允许使用具有表达式默认值的列。
        </font></font><a class="link" href="functions.html#function_default"><code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code></a><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>UPDATE t SET i = DEFAULT(i)+1 WHERE id &lt; 100;</code></strong>
</pre></li><li class="listitem"><p>
          <a class="link" href="functions.html#function_format"><code class="literal">FORMAT(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将数字格式化</font></font><em class="replaceable"><code>X</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为格式</font></font><code class="literal">'#,###,###.##'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，舍入到
           </font></font><em class="replaceable"><code>D</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小数位，并将结果作为字符串返回。</font><font style="vertical-align: inherit;">有关详细信息，请参见
           </font></font><a class="xref" href="functions.html#string-functions" title="12.5字符串函数"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.5节“字符串函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_grouping"></a><p>
          <a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING(<em class="replaceable"><code>expr</code></em>
          [, <em class="replaceable"><code>expr</code></em>] ...)</code></a>
        </p><a class="indexterm" name="idm140091673857728"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含</font></font><code class="literal">WITH ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修饰符的</font><font style="vertical-align: inherit;">查询
           </font><font style="vertical-align: inherit;">，该
           </font></font><code class="literal">ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作会生成超级聚合输出行，其中</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示所有值的集合。</font><font style="vertical-align: inherit;">该</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          功能使您可以区分</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          超级聚合行的</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值与常规分组行中的值。
        </font></font></p><p>
          <a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只允许在选择列表或</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中使用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          每个参数</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          必须是与</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">中的表达式完全匹配的表达式</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">表达式不能是位置说明符。</font><font style="vertical-align: inherit;">对于每个表达式，</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果当前行中的表达式值</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示超级聚合值</font><font style="vertical-align: inherit;">，则
           </font><font style="vertical-align: inherit;">生成1
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成0，表示表达式值是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常规结果行的a或不是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          假设该表</font></font><code class="literal">t1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含这些行，其中</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">other</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unknown</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”之类的内容</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM t1;</code></strong><font></font>
+------+-------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量|</font></font><font></font>
+------+-------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">15 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表的摘要不是</font></font><code class="literal">WITH ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这样的：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">15 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果包含</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，但这些值不代表超级聚合行，因为查询不包含</font></font><code class="literal">WITH ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          添加</font></font><code class="literal">WITH ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会生成包含其他</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值的</font><font style="vertical-align: inherit;">超级聚合摘要行</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，如果不将此结果与前一个结果进行比较，则很难看出哪些</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值出现在超级聚合行中，哪些值出现在常规分组行中：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong><font></font>
+------+-------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">35 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">15 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">58 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要区分</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">超级聚合行中的值与常规分组行中的值，请使用
           </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，仅对超级聚合</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">返回1 </font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>name, size, SUM(quantity) AS quantity,</code></strong>
         <strong class="userinput"><code>GROUPING(name) AS grp_name,</code></strong>
         <strong class="userinput"><code>GROUPING(size) AS grp_size</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong><font></font>
+------+-------+----------+----------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量| </font><font style="vertical-align: inherit;">grp_name | </font><font style="vertical-align: inherit;">grp_size |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+----------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">20 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">35 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">15 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">23 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">58 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+----------+----------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          常用用途</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用标签替换超级聚合
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>IF(GROUPING(name) = 1, 'All items', name) AS name,</code></strong>
         <strong class="userinput"><code>IF(GROUPING(size) = 1, 'All sizes', size) AS size,</code></strong>
         <strong class="userinput"><code>SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong><font></font>
+-----------+-----------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+-----------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">20 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">10 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">所有尺寸| </font><font style="vertical-align: inherit;">35 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">5 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">15 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">所有尺寸| </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">所有项目| </font><font style="vertical-align: inherit;">所有尺寸| </font><font style="vertical-align: inherit;">58 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+-----------+----------+</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              通过过滤掉常规的分组行，仅返回超级聚合行：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP</code></strong>
       <strong class="userinput"><code>HAVING GROUPING(name) = 1 OR GROUPING(size) = 1;</code></strong><font></font>
+------+------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">35 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">58 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+----------+</font></font><font></font>
</pre></li></ul>
</div>
<p>
          <a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许多个表达式参数。</font><font style="vertical-align: inherit;">在这种情况下，
           </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值表示从每个表达式的结果组合的位掩码，其中最低位对应于最右侧表达式的结果。</font><font style="vertical-align: inherit;">例如，使用三个表达式参数，
           </font><font style="vertical-align: inherit;">就像这样计算：
        </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING(<em class="replaceable"><code>expr1</code></em>,
          <em class="replaceable"><code>expr2</code></em>,
          <em class="replaceable"><code>expr3</code></em>)</code></a><font style="vertical-align: inherit;"></font></p><pre data-lang="clike" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  GROUPING（</font></font><em class="replaceable"><code>expr3</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）的</font><font style="vertical-align: inherit;">结果</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+结果为GROUPING（</font></font><em class="replaceable"><code>expr2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）&lt;&lt; 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+结果为GROUPING（</font></font><em class="replaceable"><code>expr1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）&lt;&lt; 2
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下查询显示</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单个参数的结果</font><font style="vertical-align: inherit;">如何
           </font><font style="vertical-align: inherit;">组合以进行多参数调用以生成位掩码值：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong>
         <strong class="userinput"><code>name, size, SUM(quantity) AS quantity,</code></strong>
         <strong class="userinput"><code>GROUPING(name) AS grp_name,</code></strong>
         <strong class="userinput"><code>GROUPING(size) AS grp_size,</code></strong>
       <strong class="userinput"><code>GROUPING(name, size) AS grp_all</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP;</code></strong><font></font>
+------+-------+----------+----------+----------+---------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量| </font><font style="vertical-align: inherit;">grp_name | </font><font style="vertical-align: inherit;">grp_size | </font><font style="vertical-align: inherit;">grp_all |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+----------+----------+---------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">20 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">10 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">35 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">大| </font><font style="vertical-align: inherit;">5 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">箍| </font><font style="vertical-align: inherit;">小| </font><font style="vertical-align: inherit;">15 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">23 | </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">58 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+-------+----------+----------+----------+---------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于多个表达式参数，</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果任何表达式表示超级聚合值</font><font style="vertical-align: inherit;">，则
           </font><font style="vertical-align: inherit;">返回值为非零。</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          因此，通过使用单个多参数</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          调用而不是多个单参数调用，</font><font style="vertical-align: inherit;">多参数</font><font style="vertical-align: inherit;">语法提供了一种更简单的方法来编写仅返回超级聚合行的早期查询</font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT name, size, SUM(quantity) AS quantity</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY name, size WITH ROLLUP</code></strong>
       <strong class="userinput"><code>HAVING GROUPING(name, size) &lt;&gt; 0;</code></strong><font></font>
+------+------+----------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名字| </font><font style="vertical-align: inherit;">尺寸| </font><font style="vertical-align: inherit;">数量|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+----------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">球| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">35 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">希望| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">23 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">58 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+------+----------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受以下限制：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不要将子查询</font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              表达式用作</font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              参数，因为匹配可能会失败。</font><font style="vertical-align: inherit;">例如，此查询的匹配失败：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT GROUPING((SELECT MAX(name) FROM t1))</code></strong>
       <strong class="userinput"><code>FROM t1</code></strong>
       <strong class="userinput"><code>GROUP BY (SELECT MAX(name) FROM t1) WITH ROLLUP;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ERROR 3580（HY000）：GROUPING函数的参数＃1不在GROUP BY中</font></font><font></font>
</pre></li><li class="listitem"><p>
              <code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字表达式不应该在</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中用作
               </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数。</font><font style="vertical-align: inherit;">由于当优化评估之间的差异
               </font></font><code class="literal">GROUP BY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，匹配可能会成功，但
               </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">评价不会产生预期的结果。</font><font style="vertical-align: inherit;">考虑这个查询：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择AS f1，'w'AS f2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从T</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GROUP BY f1，f2 WITH ROLLUP</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
分组（f2）= 1;</font></font><font></font>
</pre><p>
              <a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于文字常量表达式的评估比对整个</font></font><code class="literal">HAVING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句的</font><font style="vertical-align: inherit;">评估更早
               </font><font style="vertical-align: inherit;">并返回0.要检查此类查询是否受到影响，</font></font><a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请</font></font><code class="literal">Impossible having</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在
               </font></font><code class="literal">Extra</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">使用
               </font><font style="vertical-align: inherit;">并查找
               </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关详细信息</font></font><code class="literal">WITH ROLLUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并
           </font></font><a class="link" href="functions.html#function_grouping"><code class="literal">GROUPING()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅
           </font></font><a class="xref" href="functions.html#group-by-modifiers" title="12.20.2 GROUP BY修饰符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.20.2，“GROUP BY修改”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_inet-aton"></a><p>
          <a class="indexterm" name="idm140091673747760"></a>

          <a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定IPv4网络地址的虚线四边形表示为字符串，返回一个整数，表示网络字节顺序（大端）的地址的数值。</font><font style="vertical-align: inherit;">如果它不理解它的参数，则</font></font><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT INET_ATON('10.0.5.9');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 167773449</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于此示例，返回值计算为10×256 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + 0×256 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + 5×256 + 9。
        </font></font></p><p>
          <a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会也可能不会返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">短格式IP地址</font><font style="vertical-align: inherit;">的非</font><font style="vertical-align: inherit;">结果（例如</font></font><code class="literal">'127.1'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示</font></font><code class="literal">'127.0.0.1'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">因此，</font></font><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不应将a用于此类地址。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要存储生成的值
             </font></font><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请使用
             </font></font><code class="literal">INT UNSIGNED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列而不是
             </font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">签名。</font><font style="vertical-align: inherit;">如果使用带符号列，则无法正确存储与第一个八位字节大于127的IP地址对应的值。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="data-types.html#out-of-range-and-overflow" title="11.2.6超出范围和溢出处理"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11.2.6节“超出范围和溢出处理”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
</li><li class="listitem"><a name="function_inet-ntoa"></a><p>
          <a class="indexterm" name="idm140091673724624"></a>

          <a class="link" href="functions.html#function_inet-ntoa"><code class="literal">INET_NTOA(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定网络字节顺序的数字IPv4网络地址，返回地址的点分四字符串表示形式作为连接字符集中的字符串。
          </font><font style="vertical-align: inherit;">如果它不理解它的参数，则</font></font><a class="link" href="functions.html#function_inet-ntoa"><code class="literal">INET_NTOA()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT INET_NTOA(167773449);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; '10 .0.5.9'</font></font><font></font>
</pre></li><li class="listitem"><a name="function_inet6-aton"></a><p>
          <a class="indexterm" name="idm140091673713072"></a>

          <a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定IPv6或IPv4网络地址作为字符串，返回二进制字符串，该字符串表示网络字节顺序（大端）的地址的数值。</font><font style="vertical-align: inherit;">由于数字格式的IPv6地址需要的字节数多于最大的整数类型，因此此函数返回的表示形式具有以下
           </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据类型：
           </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY(16)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于IPv6地址和</font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY(4)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPv4地址。</font><font style="vertical-align: inherit;">如果参数不是有效地址，则
           </font></font><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例用于
           </font></font><a class="link" href="functions.html#function_hex"><code class="literal">HEX()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以</font></font><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可打印的形式</font><font style="vertical-align: inherit;">显示
           </font><font style="vertical-align: inherit;">结果：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(INET6_ATON('fdfe::5a55:caff:fefa:9089'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'FDFE0000000000005A55CAFFFEFA9089'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(INET6_ATON('10.0.5.9'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'0A000509'</font></font><font></font>
</pre><p>
          <code class="literal">INET6_ATON()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">观察有效参数的几个约束。</font><font style="vertical-align: inherit;">这些在下面的列表中给出以及示例。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不允许使用尾随区域ID，如
               </font></font><code class="literal">fe80::3%1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><code class="literal">fe80::3%eth0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不允许使用尾随网络掩码，如
               </font></font><code class="literal">2001:45f:3:ba::/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><code class="literal">198.51.100.0/24</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于表示IPv4地址的值，仅支持无类地址。</font><font style="vertical-align: inherit;">有类别的地址如
               </font></font><code class="literal">198.51.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被拒绝。</font><font style="vertical-align: inherit;">不允许使用尾随端口号，如
               </font></font><code class="literal">198.51.100.2:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">不允许地址组件中的十六进制数字，如
               </font></font><code class="literal">198.0xa0.1.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">不支持八进制数：</font></font><code class="literal">198.51.010.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被视为
               </font></font><code class="literal">198.51.10.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，不是
               </font></font><code class="literal">198.51.8.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些IPv4约束也适用于具有IPv4地址部分的IPv6地址，例如IPv4兼容或IPv4映射地址。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将以数字形式表示</font><font style="vertical-align: inherit;">的IPv4地址</font><font style="vertical-align: inherit;">作为</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">转换为</font><font style="vertical-align: inherit;">以数字形式表示
           </font><font style="vertical-align: inherit;">的IPv6地址作为
           </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，请使用以下表达式：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INET6_ATON（INET_NTOA </font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例如：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(INET6_ATON(INET_NTOA(167773449)));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'0A000509'</font></font><font></font>
</pre></li><li class="listitem"><a name="function_inet6-ntoa"></a><p>
          <a class="indexterm" name="idm140091673675024"></a>

          <a class="link" href="functions.html#function_inet6-ntoa"><code class="literal">INET6_NTOA(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定以数字形式表示为二进制字符串的IPv6或IPv4网络地址，将地址的字符串表示形式返回为连接字符集中的字符串。</font><font style="vertical-align: inherit;">如果参数不是有效地址，则
           </font></font><a class="link" href="functions.html#function_inet6-ntoa"><code class="literal">INET6_NTOA()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="functions.html#function_inet6-ntoa"><code class="literal">INET6_NTOA()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 有这些属性：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              它不使用操作系统函数来执行转换，因此输出字符串与平台无关。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回字符串的最大长度为39（4 x 8 + 7）。</font><font style="vertical-align: inherit;">鉴于此声明：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE TABLE t AS SELECT INET6_NTOA（</font></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）AS c1;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              结果表将具有以下定义：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE TABLE t（c1 VARCHAR（39）CHARACTER SET utf8 DEFAULT NULL）;
</font></font></pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回字符串使用小写字母表示IPv6地址。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT INET6_NTOA(INET6_ATON('fdfe::5a55:caff:fefa:9089'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'fdfe :: 5a55：caff：fefa：9089'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT INET6_NTOA(INET6_ATON('10.0.5.9'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; '10 .0.5.9'</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT INET6_NTOA(UNHEX('FDFE0000000000005A55CAFFFEFA9089'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'fdfe :: 5a55：caff：fefa：9089'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT INET6_NTOA(UNHEX('0A000509'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; '10 .0.5.9'</font></font><font></font>
</pre></li><li class="listitem"><a name="function_is-ipv4"></a><p>
          <a class="indexterm" name="idm140091673653232"></a>

          <a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果参数是指定为字符串的有效IPv4地址，则返回1，否则返回0。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_IPV4('10.0.5.9'), IS_IPV4('10.0.5.256');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1,0</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于给定的参数，如果
           </font></font><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回1，
           </font></font><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（和
           </font></font><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）将返回非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">相反的陈述不正确：在某些情况下，
           </font><font style="vertical-align: inherit;">返回0 </font><font style="vertical-align: inherit;">时
           </font><font style="vertical-align: inherit;">返回</font></font><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非</font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          正如前面的评论所暗示的那样，
           </font></font><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比</font></font><a class="link" href="functions.html#function_inet-aton"><code class="literal">INET_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构成有效IPv4地址的内容</font><font style="vertical-align: inherit;">更严格
           </font><font style="vertical-align: inherit;">，因此对于需要对无效值执行强检查的应用程序可能很有用。</font><font style="vertical-align: inherit;">或者，用于
           </font></font><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将IPv4地址转换为内部格式并检查
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果（表示无效的地址）。</font><font style="vertical-align: inherit;">
          关于检查IPv4地址</font></font><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同样强大</font></font><a class="link" href="functions.html#function_is-ipv4"><code class="literal">IS_IPV4()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_is-ipv4-compat"></a><p>
          <a class="indexterm" name="idm140091673627872"></a>

          <a class="link" href="functions.html#function_is-ipv4-compat"><code class="literal">IS_IPV4_COMPAT(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数将以数字形式表示的IPv6地址作为二进制字符串，如返回
           </font></font><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果参数是有效的IPv4兼容IPv6地址，则返回1，否则返回0。</font><font style="vertical-align: inherit;">IPv4兼容地址具有该形式
           </font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">::<em class="replaceable"><code>ipv4_address</code></em></code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_IPV4_COMPAT(INET6_ATON('::10.0.5.9'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_IPV4_COMPAT(INET6_ATON('::ffff:10.0.5.9'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          IPv4兼容地址的IPv4部分也可以使用十六进制表示法表示。</font><font style="vertical-align: inherit;">例如，
           </font></font><code class="literal">198.51.100.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有此原始十六进制值：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(INET6_ATON('198.51.100.1'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'C6336401'</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以IPv4兼容的形式表示，
           </font></font><code class="literal">::198.51.100.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相当于
           </font></font><code class="literal">::c0a8:0001</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或（没有前导零）
          </font></font><code class="literal">::c0a8:1</code>
        </p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
    - &gt; </font></font><strong class="userinput"><code>  IS_IPV4_COMPAT(INET6_ATON('::198.51.100.1')),</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  IS_IPV4_COMPAT(INET6_ATON('::c0a8:0001')),</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>  IS_IPV4_COMPAT(INET6_ATON('::c0a8:1'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1,1,1</font></font><font></font>
</pre></li><li class="listitem"><a name="function_is-ipv4-mapped"></a><p>
          <a class="indexterm" name="idm140091673605744"></a>

          <a class="link" href="functions.html#function_is-ipv4-mapped"><code class="literal">IS_IPV4_MAPPED(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数将以数字形式表示的IPv6地址作为二进制字符串，如返回
           </font></font><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果参数是有效的IPv4映射IPv6地址，则返回1，否则返回0。</font><font style="vertical-align: inherit;">IPv4映射地址具有该形式
           </font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">::ffff:<em class="replaceable"><code>ipv4_address</code></em></code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_IPV4_MAPPED(INET6_ATON('::10.0.5.9'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_IPV4_MAPPED(INET6_ATON('::ffff:10.0.5.9'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          和。一样 </font></font><code class="literal">IS_IPV4_COMPAT()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IPv4映射地址的IPv4部分一样，也可以使用十六进制表示法表示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt; </font></font><strong class="userinput"><code>  IS_IPV4_MAPPED(INET6_ATON('::ffff:198.51.100.1')),</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>  IS_IPV4_MAPPED(INET6_ATON('::ffff:c0a8:0001')),</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>  IS_IPV4_MAPPED(INET6_ATON('::ffff:c0a8:1'));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 1,1,1</font></font><font></font>
</pre></li><li class="listitem"><a name="function_is-ipv6"></a><p>
          <a class="indexterm" name="idm140091673587936"></a>

          <a class="link" href="functions.html#function_is-ipv6"><code class="literal">IS_IPV6(<em class="replaceable"><code>expr</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果参数是指定为字符串的有效IPv6地址，则返回1，否则返回0。</font><font style="vertical-align: inherit;">此功能不会将IPv4地址视为有效的IPv6地址。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_IPV6('10.0.5.9'), IS_IPV6('::1');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 0,1</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于给定的参数，如果
           </font></font><a class="link" href="functions.html#function_is-ipv6"><code class="literal">IS_IPV6()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回1，
           </font></font><a class="link" href="functions.html#function_inet6-aton"><code class="literal">INET6_ATON()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则返回非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_is-uuid"></a><p>
          <a class="indexterm" name="idm140091673573968"></a>

          <a class="link" href="functions.html#function_is-uuid"><code class="literal">IS_UUID(<em class="replaceable"><code>string_uuid</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果该参数是一个有效的字符串格式的UUID，0如果参数是不是有效的UUID，并返回1 </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果该参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示该值采用可以解析的格式。</font><font style="vertical-align: inherit;">也就是说，它具有正确的长度并且仅包含允许的字符（任何字母表中的十六进制数字，以及可选的破折号和花括号）。</font><font style="vertical-align: inherit;">这种格式最常见：
        </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AAAA-BBBB  -  CCCC-DDDD-eeeeeeeeeeee
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些其他格式也是允许的：
        </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aaaaaaaabbbbccccddddeeeeeeeeeeee</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{AAAA-BBBB-CCCC-DDDD-eeeeeeeeeeee}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关值内字段的含义，请参阅
           </font></font><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数说明。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_UUID('6ccd780c-baba-1026-9564-5b8c656024db');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">IS_UUID（'6ccd780c-baba-1026-9564-5b8c656024db'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font>
|                                               1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_UUID('6CCD780C-BABA-1026-9564-5B8C656024DB');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">IS_UUID（'6CCD780C-BABA-1026-9564-5B8C656024DB'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                                               1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_UUID('6ccd780cbaba102695645b8c656024db');</code></strong><font></font>
+---------------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">IS_UUID（'6ccd780cbaba102695645b8c656024db'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
|                                           1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_UUID('{6ccd780c-baba-1026-9564-5b8c656024db}');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">IS_UUID（'{6ccd780c-baba-1026-9564-5b8c656024db}'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|                                                 1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_UUID('6ccd780c-baba-1026-9564-5b8c6560');</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">IS_UUID（'6ccd780c-baba-1026-9564-5b8c6560'）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font>
|                                           0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+---------------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT IS_UUID(RAND());</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">IS_UUID（RAND（））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font>
|               0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_master-pos-wait"></a><p>
          <a class="indexterm" name="idm140091673551776"></a>

          <a class="link" href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT(<em class="replaceable"><code>log_name</code></em>,<em class="replaceable"><code>log_pos</code></em>[,<em class="replaceable"><code>timeout</code></em>][,<em class="replaceable"><code>channel</code></em>])</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能对于控制主/从同步很有用。</font><font style="vertical-align: inherit;">它会阻塞，直到从属设备已读取并将所有更新应用到主日志中的指定位置。</font><font style="vertical-align: inherit;">返回值是从站必须等待前进到指定位置的日志事件数。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果未启动从属SQL线程，未初始化从属主信息，参数不正确或发生错误，则</font><font style="vertical-align: inherit;">函数返回</font><font style="vertical-align: inherit;">。</font></font><code class="literal">-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果超出超时</font><font style="vertical-align: inherit;">，则返回</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果从属SQL线程在</font></font><a class="link" href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等待时</font><font style="vertical-align: inherit;">停止，
           </font><font style="vertical-align: inherit;">则该函数返回</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果从站超过指定位置，则该函数立即返回。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          上一个多线程从机，功能等待，直到由所述设置的限制期满
           </font></font><a class="link" href="replication.html#sysvar_slave_checkpoint_group"><code class="literal">slave_checkpoint_group</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="replication.html#sysvar_slave_checkpoint_period"><code class="literal">slave_checkpoint_period</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          系统变量，当检查点操作被称为更新从站的状态。</font><font style="vertical-align: inherit;">因此，根据系统变量的设置，函数可能会在达到指定位置后返回一段时间。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><em class="replaceable"><code>timeout</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定</font><font style="vertical-align: inherit;">了</font><font style="vertical-align: inherit;">值，则
           </font></font><a class="link" href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><em class="replaceable"><code>timeout</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秒数过后</font><font style="vertical-align: inherit;">停止等待</font><font style="vertical-align: inherit;">。
          </font></font><em class="replaceable"><code>timeout</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须大于0; </font><font style="vertical-align: inherit;">零或负</font></font><em class="replaceable"><code>timeout</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">意味着没有超时。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可选</font></font><em class="replaceable"><code>channel</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值使您可以命名该函数适用的复制通道。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多信息</font></font><a class="xref" href="replication.html#replication-channels" title="17.2.3复制通道"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font><a class="xref" href="replication.html#replication-channels" title="17.2.3复制通道"><font style="vertical-align: inherit;">第17.2.3节“复制通道”</font></a><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数对于基于语句的复制不安全。</font><font style="vertical-align: inherit;">如果在</font></font><a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为时使用此功能，则会记录警告
           </font></font><code class="literal">STATEMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_name-const"></a><p>
          <a class="indexterm" name="idm140091673528192"></a>

          <a class="link" href="functions.html#function_name-const"><code class="literal">NAME_CONST(<em class="replaceable"><code>name</code></em>,<em class="replaceable"><code>value</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回给定值。</font><font style="vertical-align: inherit;">用于生成结果集列时，</font></font><a class="link" href="functions.html#function_name-const"><code class="literal">NAME_CONST()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会使列具有给定名称。</font><font style="vertical-align: inherit;">参数应该是常量。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT NAME_CONST('myname', 14);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">myname |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font>
|     14 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能仅供内部使用。</font><font style="vertical-align: inherit;">服务器在从包含对本地程序变量的引用的存储程序中编写语句时使用它，如
           </font></font><a class="xref" href="stored-objects.html#stored-programs-logging" title="24.7存储程序二进制日志"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第24.7节“存储程序二进制日志记录”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可能会在</font></font><a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog  - 处理二进制日志文件的实用程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqlbinlog</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的输出中看到此函数</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于您的应用程序，您可以使用简单的别名获得与刚刚显示的示例完全相同的结果，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 14 AS myname;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">myname |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font>
|     14 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关列别名的更多信息</font></font><a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          请参见</font><a class="xref" href="sql-syntax.html#select" title="13.2.10 SELECT语法"><font style="vertical-align: inherit;">第13.2.10节“SELECT语法”</font></a><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_sleep"></a><p>
          <a class="indexterm" name="idm140091673511472"></a>

          <a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP(<em class="replaceable"><code>duration</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          休眠（暂停）</font></font><em class="replaceable"><code>duration</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">给出的秒数
           </font><font style="vertical-align: inherit;">，然后返回0.持续时间可能有一个小数部分。</font><font style="vertical-align: inherit;">如果参数为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或为负，则
           </font></font><a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在严格SQL模式下生成警告或错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当睡眠正常返回（没有中断）时，它返回0：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT SLEEP(1000);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">睡眠（1000）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
|           0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          何时</font></font><a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是被中断的查询调用的唯一内容，它返回1并且查询本身不返回错误。</font><font style="vertical-align: inherit;">无论查询是被终止还是超时，都是如此：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用</font></font><a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL语法"><code class="literal">KILL QUERY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              另一个会话</font><font style="vertical-align: inherit;">中断此语句
               </font><font style="vertical-align: inherit;">：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT SLEEP(1000);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">睡眠（1000）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
|           1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              超时会中断此声明：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT /*+ MAX_EXECUTION_TIME(1) */ SLEEP(1000);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">睡眠（1000）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
|           1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------------+</font></font><font></font>
</pre></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><a class="link" href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只是查询中断的一部分，查询将返回错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用</font></font><a class="link" href="sql-syntax.html#kill" title="13.7.7.4 KILL语法"><code class="literal">KILL QUERY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              另一个会话</font><font style="vertical-align: inherit;">中断此语句
               </font><font style="vertical-align: inherit;">：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT 1 FROM t1 WHERE SLEEP(1000);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1317（70100）：查询执行被中断</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              超时会中断此声明：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT /*+ MAX_EXECUTION_TIME(1000) */ 1 FROM t1 WHERE SLEEP(1000);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ERROR 3024（HY000）：查询执行被中断，最大语句</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
超出执行时间</font></font><font></font>
</pre></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数对于基于语句的复制不安全。</font><font style="vertical-align: inherit;">如果在</font></font><a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为时使用此功能，则会记录警告
           </font></font><code class="literal">STATEMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_uuid"></a><p>
          <a class="indexterm" name="idm140091673479712"></a>

          <a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回根据RFC 4122 </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A Universally Unique IDentifier（UUID）URN命名空间</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成</font><span class="quote"><span class="quote"><font style="vertical-align: inherit;">的通用唯一标识符（UUID）</font></span></span><font style="vertical-align: inherit;"> 
          （</font></font><a class="ulink" href="http://www.ietf.org/rfc/rfc4122.txt" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.ietf.org/rfc/rfc4122.txt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          UUID被设计为在空间和时间上全球唯一的数字。</font></font><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">预计</font><font style="vertical-align: inherit;">两次调用将
           </font><font style="vertical-align: inherit;">生成两个不同的值，即使这些调用是在两个彼此未连接的独立设备上执行的。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            虽然</font></font><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">价值观是独一无二的，但它们不一定是不可评论的或不可预测的。</font><font style="vertical-align: inherit;">如果需要不可预测性，则应以其他方式生成UUID值。
</font></font></p>
</div>
<p>
          <a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回符合RFC 4122中描述的UUID版本1的值。该值是128位数字，表示为</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          格式为五个十六进制数字</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">字符串
           </font></font><code class="literal">aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          ：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              前三个数字是从时间戳的低，中，高部分生成的。</font><font style="vertical-align: inherit;">高部分还包括UUID版本号。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果时间戳值失去单调性（例如，由于夏令时），则第四个数字保留时间唯一性。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              第五个数字是提供空间唯一性的IEEE 802节点号。</font><font style="vertical-align: inherit;">如果后者不可用，则替换随机数（例如，因为主机设备没有以太网卡，或者不知道如何在主机操作系统上找到接口的硬件地址）。</font><font style="vertical-align: inherit;">在这种情况下，无法保证空间唯一性。</font><font style="vertical-align: inherit;">然而，碰撞应该具有
               </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">低的概率。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              仅在FreeBSD，Linux和Windows上考虑接口的MAC地址。</font><font style="vertical-align: inherit;">在其他操作系统上，MySQL使用随机生成的48位数字。
</font></font></p></li></ul>
</div>
<pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT UUID();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt;'6ccd780c-baba-1026-9564-5b8c656024db'</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要在字符串和二进制UUID值之间进行转换，请使用
           </font></font><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。</font><font style="vertical-align: inherit;">要检查字符串是否为有效的UUID值，请使用该
           </font></font><a class="link" href="functions.html#function_is-uuid"><code class="literal">IS_UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数对于基于语句的复制不安全。</font><font style="vertical-align: inherit;">如果在</font></font><a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为时使用此功能，则会记录警告
           </font></font><code class="literal">STATEMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><a name="function_uuid-short"></a><p>
          <a class="indexterm" name="idm140091673450624"></a>

          <a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">短</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通用标识符作为64位无符号整数返回。</font><font style="vertical-align: inherit;">返回的值
           </font></font><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font></font><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">返回的字符串格式128位标识符
           </font><font style="vertical-align: inherit;">不同，并且具有不同的唯一性属性。</font></font><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果满足以下条件</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">则保证</font><font style="vertical-align: inherit;">值
           </font><font style="vertical-align: inherit;">是唯一的：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在</font></font><a class="link" href="server-administration.html#sysvar_server_id"><code class="literal">server_id</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前服务器的值介于0和255之间，您的设置主从服务器中是唯一的
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              您不会在</font></font><a class="link" href="programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqld</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> restarts
             </font><font style="vertical-align: inherit;">之间设置服务器主机的系统时间</font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a class="link" href="programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqld</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重启
 </font><font style="vertical-align: inherit;">之间，</font><font style="vertical-align: inherit;">
              你</font><font style="vertical-align: inherit;">平均每秒</font><font style="vertical-align: inherit;">调用的</font><font style="vertical-align: inherit;">次数少于1600万次
              </font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值的构造是这样的：
        </font></font></p><pre data-lang="clike" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  （server_id＆255）&lt;&lt; 56</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+（server_startup_time_in_seconds &lt;&lt; 24）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ incremented_variable ++;</font></font><font></font>
</pre><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT UUID_SHORT();</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        - &gt; 92395783831158784</font></font><font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 不适用于基于语句的复制。
</font></font></p>
</div>
</li><li class="listitem"><a name="function_uuid-to-bin"></a><p>
          <a class="indexterm" name="idm140091673423632"></a>

          <a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN(<em class="replaceable"><code>string_uuid</code></em>)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,
          </font></font><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN(<em class="replaceable"><code>string_uuid</code></em>,
          <em class="replaceable"><code>swap_flag</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将字符串UUID转换为二进制UUID并返回结果。</font><font style="vertical-align: inherit;">（</font></font><a class="link" href="functions.html#function_is-uuid"><code class="literal">IS_UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数描述列出了允许的字符串UUID格式。）返回二进制UUID是一个
           </font></font><a class="link" href="data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY(16)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">如果是UUID参数</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则返回值为
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果任何参数无效，则会发生错误。
        </font></font></p><p>
          <a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 需要一个或两个参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              单参数形式采用字符串UUID值。</font><font style="vertical-align: inherit;">二进制结果与字符串参数的顺序相同。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              双参数形式采用字符串UUID值和标志值：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果</font></font><em class="replaceable"><code>swap_flag</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为0，则双参数形式等效于单参数形式。</font><font style="vertical-align: inherit;">二进制结果与字符串参数的顺序相同。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果</font></font><em class="replaceable"><code>swap_flag</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为1，则返回值的格式不同：交换时间低和时间高的部分（分别为第一组和第三组十六进制数字）。</font><font style="vertical-align: inherit;">这会将更快速变化的部分向右移动，并且如果结果存储在索引列中，则可以提高索引效率。
</font></font></p></li></ul>
</div>
</li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          时间 - 部分交换假定使用UUID版本1值，例如由</font></font><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">生成的
           </font><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">对于不遵循版本1格式的其他方法生成的UUID值，时间 - 部分交换不会带来任何好处。</font><font style="vertical-align: inherit;">有关版本1格式的详细信息，请参阅
           </font></font><a class="link" href="functions.html#function_uuid"><code class="literal">UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能说明。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          假设您具有以下字符串UUID值：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET @uuid = '6ccd780c-baba-1026-9564-5b8c656024db';</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要使用或不使用时间 - 部分交换将字符串UUID转换为二进制，请使用</font></font><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(UUID_TO_BIN(@uuid));</code></strong><font></font>
+----------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（UUID_TO_BIN（@uuid））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6CCD780CBABA102695645B8C656024DB |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(UUID_TO_BIN(@uuid, 0));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（UUID_TO_BIN（@ uuid，0））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6CCD780CBABA102695645B8C656024DB |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT HEX(UUID_TO_BIN(@uuid, 1));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">HEX（UUID_TO_BIN（@ uuid，1））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1026BABA6CCD780C95645B8C656024DB |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要将返回的二进制UUID转换为
           </font></font><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符串UUID，请使用</font></font><a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果通过</font></font><a class="link" href="functions.html#function_uuid-to-bin"><code class="literal">UUID_TO_BIN()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用第二个参数1来交换时间部分来</font><font style="vertical-align: inherit;">生成二进制UUID
           </font><font style="vertical-align: inherit;">，则还应该传递第二个参数1，</font></font><a class="link" href="functions.html#function_bin-to-uuid"><code class="literal">BIN_TO_UUID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以便在将二进制UUID转换回字符串UUID时取消</font><font style="vertical-align: inherit;">交换时间部分
           </font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">BIN_TO_UUID（UUID_TO_BIN（@ uuid））|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6ccd780c-baba-1026-9564-5b8c656024db |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid,0),0);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">BIN_TO_UUID（UUID_TO_BIN（@ uuid，0），0）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6ccd780c-baba-1026-9564-5b8c656024db |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid,1),1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">BIN_TO_UUID（UUID_TO_BIN（@ uuid，1），1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">6ccd780c-baba-1026-9564-5b8c656024db |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果两个方向的转换使用时间 - 部分交换不相同，则原始UUID将无法正确恢复：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid,0),1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">BIN_TO_UUID（UUID_TO_BIN（@ uuid，0），1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">baba1026-780c-6ccd-9564-5b8c656024db |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT BIN_TO_UUID(UUID_TO_BIN(@uuid,1),0);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">BIN_TO_UUID（UUID_TO_BIN（@ uuid，1），0）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1026baba-6ccd-780c-9564-5b8c656024db |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------------------------------+</font></font><font></font>
</pre></li><li class="listitem"><a name="function_values"></a><p>
          <a class="indexterm" name="idm140091673379264"></a>

          <a class="link" href="functions.html#function_values"><code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code></a>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在
           </font></font><a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE语法"><code class="literal">INSERT
          ... ON DUPLICATE KEY UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中，您可以使用</font><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">的
           </font><font style="vertical-align: inherit;">
          函数</font><font style="vertical-align: inherit;">来引用</font><font style="vertical-align: inherit;">语句部分中的</font><font style="vertical-align: inherit;">列值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">换句话说，
           </font><font style="vertical-align: inherit;">
          在</font><font style="vertical-align: inherit;">子句中引用了</font><font style="vertical-align: inherit;">将插入</font><font style="vertical-align: inherit;">的值</font><font style="vertical-align: inherit;">，没有发生重复键冲突。</font><font style="vertical-align: inherit;">此功能在多行插入中特别有用。</font><font style="vertical-align: inherit;">该
           </font><font style="vertical-align: inherit;">函数仅在</font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">有意义</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">否则</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
           </font><a class="xref" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE语法"><font style="vertical-align: inherit;">第13.2.6.2节“INSERT ... ON DUPLICATE KEY UPDATE语法”</font></a><font style="vertical-align: inherit;">。
        </font></font><code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"></font><code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#update" title="13.2.12 UPDATE语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"></font><em class="replaceable"><code>col_name</code></em><font style="vertical-align: inherit;"></font><a class="link" href="functions.html#function_values"><code class="literal">VALUES()</code></a><font style="vertical-align: inherit;"></font><code class="literal">ON DUPLICATE KEY UPDATE</code><font style="vertical-align: inherit;"></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><a class="xref" href="sql-syntax.html#insert-on-duplicate" title="13.2.6.2 INSERT ... ON DUPLICATE KEY UPDATE语法"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO table (a,b,c) VALUES (1,2,3),(4,5,6)</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>ON DUPLICATE KEY UPDATE c=VALUES(a)+VALUES(b);</code></strong>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="precision-math"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25精度数学</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="functions.html#precision-math-numbers"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.1数值的类型</font></font></a></span></dt><dt><span class="section"><a href="functions.html#precision-math-decimal-characteristics"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.2 DECIMAL数据类型特征</font></font></a></span></dt><dt><span class="section"><a href="functions.html#precision-math-expressions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.3表达处理</font></font></a></span></dt><dt><span class="section"><a href="functions.html#precision-math-rounding"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.4舍入行为</font></font></a></span></dt><dt><span class="section"><a href="functions.html#precision-math-examples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.5精确数学例子</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140091673357376"></a><a class="indexterm" name="idm140091673356304"></a><a class="indexterm" name="idm140091673355232"></a><a class="indexterm" name="idm140091673354160"></a><a class="indexterm" name="idm140091673353088"></a><a class="indexterm" name="idm140091673352016"></a><a class="indexterm" name="idm140091673350944"></a><a class="indexterm" name="idm140091673349456"></a><a class="indexterm" name="idm140091673347968"></a><a class="indexterm" name="idm140091673346896"></a><a class="indexterm" name="idm140091673345808"></a><a class="indexterm" name="idm140091673344736"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL提供对精确数学的支持：数值处理可以产生极其准确的结果，并且可以高度控制无效值。</font><font style="vertical-align: inherit;">精确数学基于以下两个特征：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        控制服务器接受或拒绝无效数据的严格程度的SQL模式。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        用于定点算术的MySQL库。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    这些功能对数值运算有几个含义，并提供与标准SQL的高度兼容性：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精确计算</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：对于精确值数字，计算不会引入浮点错误。</font><font style="vertical-align: inherit;">相反，使用精确的精度。</font><font style="vertical-align: inherit;">例如，MySQL将一个数字视为</font></font><code class="literal">.0001</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        精确值而不是近似值，并将其相加10,000次会产生精确的结果
        </font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不是仅仅
        </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接近</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1的值。
      </font></font></p></li><li class="listitem"><p>
        <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明确定义的舍入行为</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：对于精确值数字，结果
        </font></font><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于其参数，而不取决于环境因素，例如底层C库的工作方式。
      </font></font></p></li><li class="listitem"><p>
        <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平台独立性</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：对于不同平台（如Windows和Unix），精确数值的操作是相同的。
      </font></font></p></li><li class="listitem"><p>
        <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制无效值的处理</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：可以检测到溢出和除零，可以将其视为错误。</font><font style="vertical-align: inherit;">例如，您可以将对于列而言太大的值视为错误，而不是将值截断为位于列的数据类型的范围内。</font><font style="vertical-align: inherit;">类似地，您可以将除以零视为错误而不是作为产生结果的操作
        </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">选择采用哪种方法取决于服务器SQL模式的设置。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    以下讨论涵盖精确数学如何工作的几个方面，包括可能与旧应用程序不兼容。</font><font style="vertical-align: inherit;">最后，给出了一些示例，演示了MySQL如何精确处理数值运算。</font><font style="vertical-align: inherit;">有关控制SQL模式的信息，请参见</font></font><a class="xref" href="server-administration.html#sql-mode" title="5.1.11服务器SQL模式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.11节“服务器SQL模式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="precision-math-numbers"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.1数值的类型</font></font></h3>
</div>
</div>
</div>
<a class="indexterm" name="idm140091673325376"></a><a class="indexterm" name="idm140091673324288"></a><a class="indexterm" name="idm140091673323200"></a><a class="indexterm" name="idm140091673321712"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      精确值运算的精度数学范围包括精确值数据类型（整数和
       </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型）和精确值数字文字。</font><font style="vertical-align: inherit;">近似值数据类型和数字文字作为浮点数处理。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      精确值数字文字具有整数部分或小数部分，或两者都有。</font><font style="vertical-align: inherit;">他们可能会签名。</font><font style="vertical-align: inherit;">例如：</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><code class="literal">.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">3.4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><code class="literal">-5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">-6.78</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><code class="literal">+9.10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      近似值数字文字用科学记数法表示，带有尾数和指数。</font><font style="vertical-align: inherit;">可以签署任一部分或两部分。</font><font style="vertical-align: inherit;">例如：</font></font><code class="literal">1.2E3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><code class="literal">1.2E-3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">-1.2E3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><code class="literal">-1.2E-3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个看起来相似的数字可能会有不同的对待。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">2.34</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是精确值（定点）数，而是</font></font><code class="literal">2.34E0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">近似值（浮点数）。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      的</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据类型是一个定点类型和计算是精确的。</font><font style="vertical-align: inherit;">在MySQL中，
       </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型有多个同义词：
       </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">NUMERIC</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DEC</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">FIXED</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">整数类型也是精确值类型。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该</font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据类型是浮点类型，其计算是近似的。</font><font style="vertical-align: inherit;">在MySQL中，类型与同义
       </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有
       </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE PRECISION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">REAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="precision-math-decimal-characteristics"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.2 DECIMAL数据类型特征</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节讨论
       </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据类型（及其同义词）的特征，特别是以下主题：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          最大位数
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          存储格式
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          存储要求
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列
 </font><font style="vertical-align: inherit;">
          的上部范围的非标准MySQL扩展
          </font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">
      的声明语法
       </font><font style="vertical-align: inherit;">是
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">参数的值范围如下：
</font></font><code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code><font style="vertical-align: inherit;"></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <em class="replaceable"><code>M</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是最大位数（精度）。</font><font style="vertical-align: inherit;">它的范围是1到65。
        </font></font></p></li><li class="listitem"><p>
          <em class="replaceable"><code>D</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是小数点右边的位数（刻度）。</font><font style="vertical-align: inherit;">它的范围为0到30，且不得大于</font></font><em class="replaceable"><code>M</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果</font></font><em class="replaceable"><code>D</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">省略，则默认值为0.如果
       </font></font><em class="replaceable"><code>M</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">省略，则默认值为10。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      最大值65 </font></font><em class="replaceable"><code>M</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示</font><font style="vertical-align: inherit;">值的</font><font style="vertical-align: inherit;">计算</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精确到65位。</font><font style="vertical-align: inherit;">这个65位精度的限制也适用于精确值数字文字，因此这些文字的最大范围与以前不同。
    </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列的</font><font style="vertical-align: inherit;">
      值</font><font style="vertical-align: inherit;">使用二进制格式存储，该格式将九个十进制数字打包为4个字节。</font><font style="vertical-align: inherit;">每个值的整数和小数部分的存储要求分别确定。</font><font style="vertical-align: inherit;">九个数字的每个倍数需要4个字节，剩下的任何剩余数字需要4个字节的一部分。</font><font style="vertical-align: inherit;">剩余数字所需的存储量由下表给出。
</font></font></p>
<div class="informaltable">
<table summary="The number of bytes required for remaining/leftover digits in DECIMAL values."><colgroup><col width="25%"><col width="25%"></colgroup><thead><tr>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">剩下的数字</font></font></th>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节数</font></font></th>
        </tr></thead><tbody><tr>
          <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
        </tr><tr>
          <td scope="row">1–2</td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
        </tr><tr>
          <td scope="row">3–4</td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
        </tr><tr>
          <td scope="row">5–6</td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
        </tr><tr>
          <td scope="row">7–9</td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      例如，一</font></font><code class="literal">DECIMAL(18,9)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列在小数点的两边各有九位数，因此整数部分和小数部分各需要4个字节。</font><font style="vertical-align: inherit;">一
       </font></font><code class="literal">DECIMAL(20,6)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列有十四个整数位和六个小数位。</font><font style="vertical-align: inherit;">对于九个数字，整数位需要四个字节，对于剩余的五个数字，整数位需要3个字节。</font><font style="vertical-align: inherit;">六个小数位需要3个字节。
    </font></font></p><p>
      <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列不存储前导</font></font><code class="literal">+</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符或</font></font><code class="literal">-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      字符或前导</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数字。</font><font style="vertical-align: inherit;">如果插入
       </font></font><code class="literal">+0003.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到一个</font></font><code class="literal">DECIMAL(5,1)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      列，它被存储为</font></font><code class="literal">3.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于负数，</font></font><code class="literal">-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不存储</font><font style="vertical-align: inherit;">文字</font><font style="vertical-align: inherit;">字符。
    </font></font></p><p>
      <a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列不允许大于列定义隐含的范围的值。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">DECIMAL(3,0)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列支持范围</font></font><code class="literal">-999</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><code class="literal">999</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一
       </font><font style="vertical-align: inherit;">
      列允许最多</font><font style="vertical-align: inherit;">-
       </font><font style="vertical-align: inherit;">数字到小数点的左侧。
    </font></font><code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>M</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>D</code></em><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      SQL标准要求的精确度
       </font><font style="vertical-align: inherit;">
      是</font><span class="emphasis"><em><font style="vertical-align: inherit;">准确</font></em></span><font style="vertical-align: inherit;"> 
      数字。</font><font style="vertical-align: inherit;">因为
       </font><font style="vertical-align: inherit;">，该标准要求至少</font><font style="vertical-align: inherit;">数字</font><font style="vertical-align: inherit;">的精度，
       </font><font style="vertical-align: inherit;">但允许更多。</font><font style="vertical-align: inherit;">在MySQL中，
       </font><font style="vertical-align: inherit;">
      并且
       </font><font style="vertical-align: inherit;">
      是相同的，并且都恰好精确
       </font><font style="vertical-align: inherit;">数字。
    </font></font><code class="literal">NUMERIC(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code><font style="vertical-align: inherit;"></font><span class="emphasis"><em><font style="vertical-align: inherit;"></font></em></span> <em class="replaceable"><code>M</code></em><font style="vertical-align: inherit;"></font><code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>M</code></em><font style="vertical-align: inherit;"></font><code class="literal">DECIMAL(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code><font style="vertical-align: inherit;"></font><code class="literal">NUMERIC(<em class="replaceable"><code>M</code></em>,<em class="replaceable"><code>D</code></em>)</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>M</code></em><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关</font></font><code class="literal">DECIMAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的内部格式的完整说明
       </font><font style="vertical-align: inherit;">，请参阅</font></font><code class="filename">strings/decimal.c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL源代码分发中</font><font style="vertical-align: inherit;">的文件
       </font><font style="vertical-align: inherit;">。</font></font><code class="literal">decimal2bin()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数中</font><font style="vertical-align: inherit;">解释了格式（带有示例）
       </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="precision-math-expressions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.3表达处理</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通过精确数学运算，尽可能使用精确值数字。</font><font style="vertical-align: inherit;">例如，比较中的数字完全按照给定而不改变值。</font><font style="vertical-align: inherit;">在严格的SQL模式下，对于</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有精确数据类型（</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或整数）的列，如果数字在列范围内，则会插入一个具有精确值的数字。</font><font style="vertical-align: inherit;">检索时，该值应与插入的值相同。</font><font style="vertical-align: inherit;">（如果未启用严格的SQL模式，则允许截断</font></font><a class="link" href="sql-syntax.html#insert" title="13.2.6 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      处理数值表达式取决于表达式包含的值的类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果存在任何近似值，则表达式为近似值，并使用浮点算法进行评估。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果不存在近似值，则表达式仅包含精确值。</font><font style="vertical-align: inherit;">如果任何精确值包含小数部分（小数点后面的值），则使用</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精确算术计算</font><font style="vertical-align: inherit;">表达式</font><font style="vertical-align: inherit;">，并且精度为65位。</font><font style="vertical-align: inherit;">术语
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精确</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受二进制表示的限制。</font><font style="vertical-align: inherit;">例如，</font></font><code class="literal">1.0/3.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以用十进制表示法近似
           </font></font><code class="literal">.333...</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但不能写为精确数字，因此</font></font><code class="literal">(1.0/3.0)*3.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能精确计算</font></font><code class="literal">1.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          否则，表达式仅包含整数值。</font><font style="vertical-align: inherit;">表达式是精确的，并使用整数运算进行计算，其精度与</font></font><a class="link" href="data-types.html#integer-types" title="11.2.1整数类型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位）</font><font style="vertical-align: inherit;">相同
           </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果数值表达式包含任何字符串，则它们将转换为双精度浮点值，表达式为近似值。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      插入数字列受SQL模式的影响，该模式由</font></font><a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      系统变量</font><font style="vertical-align: inherit;">控制</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（请参见</font></font><a class="xref" href="server-administration.html#sql-mode" title="5.1.11服务器SQL模式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.11节“服务器SQL模式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）以下讨论提到严格模式（由
       </font></font><a class="link" href="server-administration.html#sqlmode_strict_all_tables"><code class="literal">STRICT_ALL_TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="server-administration.html#sqlmode_strict_trans_tables"><code class="literal">STRICT_TRANS_TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式值选择）和</font></font><a class="link" href="server-administration.html#sqlmode_error_for_division_by_zero"><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要打开所有限制，您只需使用
       </font></font><a class="link" href="server-administration.html#sqlmode_traditional"><code class="literal">TRADITIONAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式，其中包括严格模式值和
       </font></font><a class="link" href="server-administration.html#sqlmode_error_for_division_by_zero"><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET sql_mode ='TRADITIONAL';
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果将数字插入到精确类型列（</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或整数）中，则如果它在列范围和精度范围内，则会插入其精确值。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果该值在小数部分中具有太多数字，则会发生舍入并生成注释。</font><font style="vertical-align: inherit;">舍入按
       </font></font><a class="xref" href="functions.html#precision-math-rounding" title="12.25.4舍入行为"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.25.4节“舍入行为”中所述完成</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">由于小数部分的舍入而导致的截断不是错误，即使在严格模式下也是如此。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果值在整数部分中的位数太多，则它太大（超出范围）并按如下方式处理：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果未启用严格模式，则会将值截断为最接近的合法值，并生成警告。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果启用了严格模式，则会发生溢出错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      未检测到下溢，因此未定义下溢处理。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于将字符串插入数字列，如果字符串具有非数字内容，则从字符串到数字的转换将按如下方式处理：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不以数字开头的字符串不能用作数字，在严格模式下会产生错误，否则会产生错误。</font><font style="vertical-align: inherit;">这包括空字符串。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以转换以数字开头的字符串，但会截断尾随的非数字部分。</font><font style="vertical-align: inherit;">如果截断的部分包含空格以外的任何内容，则会在严格模式下生成错误，否则会生成警告。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      默认情况下，除以零会产生结果
       </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不会发出警告。</font><font style="vertical-align: inherit;">通过适当地设置SQL模式，可以限制除零。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      随着
       </font></font><a class="link" href="server-administration.html#sqlmode_error_for_division_by_zero"><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用SQL模式，MySQL的零不同的方式处理部门：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果未启用严格模式，则会发出警告。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果启用了严格模式，则禁止包含除零的插入和更新，并发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      换句话说，涉及执行除零的表达式的插入和更新可以被视为错误，但</font></font><a class="link" href="server-administration.html#sqlmode_error_for_division_by_zero"><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除了严格模式之外</font><font style="vertical-align: inherit;">，这还需要
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      假设我们有这样的声明：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INSERT INTO SET i = 1/0;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这是严格和</font></font><a class="link" href="server-administration.html#sqlmode_error_for_division_by_zero"><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      模式</font><font style="vertical-align: inherit;">组合的情况
       </font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="informaltable">
<table summary="What happens for combinations of strict and ERROR_FOR_DIVISION_BY_ZERO modes."><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr>
          <th scope="col"><a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 值</font></font></th>
          <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果</font></font></th>
        </tr></thead><tbody><tr>
          <td scope="row"><code class="literal">''</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （默认）</font></font></td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有警告，没有错误; </font></font><code class="literal">i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
        </tr><tr>
          <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">严格</font></font></td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有警告，没有错误; </font></font><code class="literal">i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
        </tr><tr>
          <td scope="row"><a class="link" href="server-administration.html#sqlmode_error_for_division_by_zero"><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></a></td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告，没有错误; </font></font><code class="literal">i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置为
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
        </tr><tr>
          <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">严格，</font></font><a class="link" href="server-administration.html#sqlmode_error_for_division_by_zero"><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></a></td>
          <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误情况; </font><font style="vertical-align: inherit;">没有插入行。</font></font></td>
</tr></tbody></table>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="precision-math-rounding"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.4舍入行为</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节讨论</font></font><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数的</font><font style="vertical-align: inherit;">精确数学舍入</font><font style="vertical-align: inherit;">以及插入具有精确值类型（</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和整数）的</font><font style="vertical-align: inherit;">列的</font><font style="vertical-align: inherit;">精度
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该</font></font><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能几轮不同，这取决于它的参数是准确的还是近似的：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于精确值数字，
           </font></font><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">round half up</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规则：如果为正数，则小数部分为.5或更大的值将向上舍入到下一个整数，如果为负，则向下舍入到下一个整数。</font><font style="vertical-align: inherit;">（换句话说，它从零开始舍入。）小数小于.5的值如果为正则向下舍入到下一个整数，如果为负，则向下舍入到下一个整数。</font><font style="vertical-align: inherit;">（换句话说，它向零舍入。）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于近似值数字，结果取决于C库。</font><font style="vertical-align: inherit;">在许多系统中，这意味着
           </font></font><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">舍入到最接近的偶数</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规则：具有小数部分的值恰好在两个整数之间的一半被舍入到最接近的偶数整数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下示例显示精确值和近似值的舍入方式有何不同：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ROUND(2.5), ROUND(25E-1);</code></strong><font></font>
+------------+--------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ROUND（2.5）| </font><font style="vertical-align: inherit;">ROUND（25E-1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------+--------------+</font></font><font></font>
| 3          |            2 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------+--------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于插入到</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数列或整数列中，目标是精确数据类型，因此舍入使用
       </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从零开始的一半</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，无论要插入的值是精确的还是近似的：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (d DECIMAL(10,0));</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES(2.5),(2.5E0);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，2行受影响，2次警告（0.00秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：2个重复：0警告：2</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW WARNINGS;</code></strong><font></font>
+-------+------+----------------------------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">等级| </font><font style="vertical-align: inherit;">代码| </font><font style="vertical-align: inherit;">消息|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+------+----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">注意| </font><font style="vertical-align: inherit;">1265 | </font><font style="vertical-align: inherit;">第1行的列'd'截断数据</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">注意| </font><font style="vertical-align: inherit;">1265 | </font><font style="vertical-align: inherit;">第2行的列'd'截断数据</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+------+----------------------------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT d FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">d |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font>
|    3 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|    3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该</font></font><a class="link" href="sql-syntax.html#show-warnings" title="13.7.6.40 SHOW WARNINGS语法"><code class="literal">SHOW WARNINGS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句显示由于小数部分的舍入而由截断生成的注释。</font><font style="vertical-align: inherit;">即使在严格的SQL模式下，这种截断也不是错误（参见
       </font></font><a class="xref" href="functions.html#precision-math-expressions" title="12.25.3表达处理"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.25.3节“表达式处理”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="precision-math-examples"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12.25.5精确数学例子</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节提供了一些在MySQL中显示精确数学查询结果的示例。</font><font style="vertical-align: inherit;">这些示例演示了</font></font><a class="xref" href="functions.html#precision-math-expressions" title="12.25.3表达处理"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.25.3节“表达式处理”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="xref" href="functions.html#precision-math-rounding" title="12.25.4舍入行为"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.25.4节“舍入行为”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述的原则</font><font style="vertical-align: inherit;">。
    </font></font></p><p>
      <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例1</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果可能，使用数字的确切值：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT (.1 + .2) = .3;</code></strong><font></font>
+----------------+<font></font>
| (.1 + .2) = .3 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------+</font></font><font></font>
|              1 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于浮点值，结果不准确：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT (.1E0 + .2E0) = .3E0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">（.1E0 + .2E0）=。3E0 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+</font></font><font></font>
|                    0 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+----------------------+</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      另一种查看精确值和近似值处理差异的方法是多次向总和中添加一个小数字。</font><font style="vertical-align: inherit;">请考虑以下存储过程，该过程将</font></font><code class="literal">.0001</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">添加
       </font><font style="vertical-align: inherit;">1,000次。
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE PROCEDURE p（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
开始</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  DECLARE i INT DEFAULT 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  DECLARE d DECIMAL（10,4）DEFAULT 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  DECLARE f FLOAT DEFAULT 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  虽然我&lt;10000 DO</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    SET d = d + .0001;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    SET f = f + .0001E0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    SET i = i + 1;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  结束时间;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SELECT d，f;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结束;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两者</font></font><code class="literal">d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      逻辑上</font><font style="vertical-align: inherit;">的总和</font><font style="vertical-align: inherit;">应该是1，但这仅适用于小数计算。</font><font style="vertical-align: inherit;">浮点计算引入了小错误：
    </font></font></p><pre data-lang="none" class="programlisting">+--------+------------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">d | </font><font style="vertical-align: inherit;">f |</font></font><font></font>
+--------+------------------+<font></font>
| 1.0000 | 0.99999999999991 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+------------------+</font></font><font></font>
</pre><p>
      <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例2</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用标准SQL所需的比例执行乘法。</font><font style="vertical-align: inherit;">也就是说，对于两个数字</font></font><em class="replaceable"><code>X1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并
      </font></font><em class="replaceable"><code>X2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有规模
      </font></font><em class="replaceable"><code>S1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><em class="replaceable"><code>S2</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，结果的比例为</font><font style="vertical-align: inherit;">：
    </font></font><code class="literal"><em class="replaceable"><code>S1</code></em>
      + <em class="replaceable"><code>S2</code></em></code><font style="vertical-align: inherit;"></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT .01 * .01;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+</font></font><font></font>
| .01 * .01 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+</font></font><font></font>
| 0.0001    |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-----------+</font></font><font></font>
</pre><p>
      <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例3</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">精确值数字的舍入行为是明确定义的：
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      舍入行为（例如，使用
       </font></font><a class="link" href="functions.html#function_round"><code class="literal">ROUND()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数）独立于底层C库的实现，这意味着结果在平台之间是一致的。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          舍入精确值列（</font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和整数）和精确值数字使用</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从零开始的一半</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规则。</font><font style="vertical-align: inherit;">小数部分为.5或更大的值从零舍入到最接近的整数，如下所示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ROUND(2.5), ROUND(-2.5);</code></strong><font></font>
+------------+-------------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ROUND（2.5）| </font><font style="vertical-align: inherit;">ROUND（-2.5）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------+-------------+</font></font><font></font>
| 3          | -3          |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------------+-------------+</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          舍入浮点值使用C库，在许多系统上使用</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">舍入到最近偶数</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          规则。</font><font style="vertical-align: inherit;">具有小数部分的值恰好在两个整数之间的中间值四舍五入到最接近的偶数：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT ROUND(2.5E0), ROUND(-2.5E0);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+---------------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">ROUND（2.5E0）| </font><font style="vertical-align: inherit;">ROUND（-2.5E0）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+---------------+</font></font><font></font>
|            2 |            -2 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------------+---------------+</font></font><font></font>
</pre></li></ul>
</div>
<p>
      <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例4</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在严格模式下，插入超出范围的值会导致错误，而不是截断为合法值。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      当MySQL未在严格模式下运行时，会发生截断为合法值的情况：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET sql_mode='';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t SET i = 128;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响，1警告（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT i FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">我|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font>
|  127 |<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.00秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      但是，如果严格模式生效，则会发生错误：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET sql_mode='STRICT_ALL_TABLES';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t SET i = 128;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ERROR 1264（22003）：超出了第1行第'i列'的范围值</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT i FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空集（0.00秒）</font></font><font></font>
</pre><p>
      <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例5</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：在严格模式下并使用</font></font><a class="link" href="server-administration.html#sqlmode_error_for_division_by_zero"><code class="literal">ERROR_FOR_DIVISION_BY_ZERO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      set，除以零会导致错误，而不是结果
      </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在非严格模式下，除以零的结果是
       </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET sql_mode='';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.01秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t SET i = 1 / 0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，1行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT i FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">我|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">NULL |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1排（0.03秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      但是，如果正确的SQL模式生效，除以零是错误的：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET sql_mode='STRICT_ALL_TABLES,ERROR_FOR_DIVISION_BY_ZERO';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (i TINYINT);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询正常，0行受影响（0.00秒）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>INSERT INTO t SET i = 1 / 0;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ERROR 1365（22012）：除以0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT i FROM t;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空集（0.01秒）</font></font><font></font>
</pre><p>
      <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例6</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">精确值文字被评估为精确值。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用浮点计算近似值文字，但精确值文字的处理方式如下
       </font></font><a class="link" href="data-types.html#fixed-point-types" title="11.2.2定点类型（精确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t SELECT 2.5 AS a, 25E-1 AS b;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，1行受影响（0.01秒）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
记录：1个重复：0警告：0</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>DESCRIBE t;</code></strong><font></font>
+-------+-----------------------+------+-----+---------+-------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">领域| </font><font style="vertical-align: inherit;">输入| </font><font style="vertical-align: inherit;">空| </font><font style="vertical-align: inherit;">钥匙| </font><font style="vertical-align: inherit;">默认| </font><font style="vertical-align: inherit;">额外的|</font></font><font></font>
+-------+-----------------------+------+-----+---------+-------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">a | </font><font style="vertical-align: inherit;">十进制（2,1）无符号| </font><font style="vertical-align: inherit;">没有| </font><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">0.0 | </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">b | </font><font style="vertical-align: inherit;">双| </font><font style="vertical-align: inherit;">没有| </font><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">0 | </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+-------+-----------------------+------+-----+---------+-------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行（0.01秒）</font></font><font></font>
</pre><p>
      <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例7</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果聚合函数的参数是精确的数字类型，则结果也是精确的数字类型，其比例至少为参数的比例。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      请考虑以下陈述：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (i INT, d DECIMAL, f FLOAT);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>INSERT INTO t VALUES(1,1,1);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>CREATE TABLE y SELECT AVG(i), AVG(d), AVG(f) FROM t;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      结果是浮点参数只有一个double。</font><font style="vertical-align: inherit;">对于精确类型参数，结果也是精确类型：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>DESCRIBE y;</code></strong><font></font>
+--------+---------------+------+-----+---------+-------+<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">领域| </font><font style="vertical-align: inherit;">输入| </font><font style="vertical-align: inherit;">空| </font><font style="vertical-align: inherit;">钥匙| </font><font style="vertical-align: inherit;">默认| </font><font style="vertical-align: inherit;">额外的|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+--------+---------------+------+-----+---------+-------+</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">AVG（i）| </font><font style="vertical-align: inherit;">十进制（14,4）| </font><font style="vertical-align: inherit;">是的| </font><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">AVG（d）| </font><font style="vertical-align: inherit;">十进制（14,4）| </font><font style="vertical-align: inherit;">是的| </font><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">AVG（f）| </font><font style="vertical-align: inherit;">双| </font><font style="vertical-align: inherit;">是的| </font><font style="vertical-align: inherit;">| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">|</font></font><font></font>
+--------+---------------+------+-----+---------+-------+<font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      结果是浮点参数只有一个double。</font><font style="vertical-align: inherit;">对于精确类型参数，结果也是精确类型。
</font></font></p>
</div>

</div>

</div>
<div class="copyright-footer">

</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tbody><tr>
<td width="40%" align="left"><a accesskey="p" href="data-types.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a></td>
<td width="20%" align="center"><a accesskey="u" href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向上</font></font></a></td>
<td width="40%" align="right">&nbsp;<a accesskey="n" href="sql-syntax.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个</font></font></a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11章数据类型</font></font></td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">家</font></font></a></td>
<td width="40%" align="right" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13章SQL语句语法</font></font></td>
</tr>
</tbody></table>
</div>


